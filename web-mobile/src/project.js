window.__require=function t(i,e,s){function o(c,r){if(!e[c]){if(!i[c]){var a=c.split("/");if(a=a[a.length-1],!i[a]){var h="function"==typeof __require&&__require;if(!r&&h)return h(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+c+"'")}}var l=e[c]={exports:{}};i[c][0].call(l.exports,function(t){return o(i[c][1][t]||t)},l,l.exports,t,i,e,s)}return e[c].exports}for(var n="function"==typeof __require&&__require,c=0;c<s.length;c++)o(s[c]);return o}({Ball:[function(t,i,e){"use strict";cc._RF.push(i,"d18c48vSMtNz6oJOIZ7Nuvw","Ball");var s=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.rolling=!0,this.touchH=!1,this.touchV=!1,this.touchT=!1;for(var t=0;t<5||t>85&&t<95||t>175&&t<185||t>265&&t<275||t>355;)t=360*Math.random();if(this.velocity=cc.v2(Math.sin(t),Math.cos(t)),this.node.runAction(cc.rotateBy(3,360).repeatForever()),this.speed=5,s.mode<=3){var i=o.get(["cfg_classic","cfg_memory","cfg_three"][s.mode-1],s.level);this.speed*=i.monsterSpeed}this.freeze=!1},update:function(){if(this.rolling){var t=this.freeze?.5:1;s.mode>=4&&(t*=.9+.1*s.level),this.node.position=this.node.position.add(this.velocity.mul(t*this.speed))}},onCollisionEnter:function(t,i){if(t.getComponent("Collider").completed){if(0==t.node.rotation||180==t.node.rotation)this.touchV||(this.touchV=!0,this.velocity.x=-this.velocity.x);else if(90==t.node.rotation||-90==t.node.rotation)this.touchH||(this.touchH=!0,this.velocity.y=-this.velocity.y);else if(45==t.node.rotation){if(!this.touchT){var e=this.velocity.x;this.velocity.x=this.velocity.y,this.velocity.y=e}}else if(-45==t.node.rotation&&!this.touchT){e=this.velocity.x;this.velocity.x=-this.velocity.y,this.velocity.y=-e}}else window.btLayer.loseHeart()},onCollisionExit:function(t,i){0==t.node.rotation||180==t.node.rotation?this.touchV=!1:90==t.node.rotation||-90==t.node.rotation?this.touchH=!1:this.touchT=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Collider:[function(t,i,e){"use strict";cc._RF.push(i,"b2c9ff5IQJBbrd59wTtuaVe","Collider"),cc.Class({extends:cc.Component,properties:{sprite:cc.Node},onLoad:function(){this.completed=!1},complete:function(){this.completed=!0,this.sprite.active=!1}}),cc._RF.pop()},{}],Config:[function(t,i,e){"use strict";cc._RF.push(i,"30b552upFFFvoTj8ujb6KXR","Config");var s={jsonTable:{},load:function(t){for(var i=this,e=["cfg_classic","cfg_memory","cfg_three"],s=0,o=function(o){c="Config/"+e[o],cc.loader.loadRes(c,function(i,n){this.jsonTable[e[o]]=n.json,(s+=1)==e.length&&t()}.bind(i))},n=0;n<e.length;n++){var c;o(n)}},get:function(t,i){return this.jsonTable[t][i]}};i.exports=s,cc._RF.pop()},{}],Editor:[function(t,i,e){"use strict";cc._RF.push(i,"039b3lgeElENYX0FxVe9mjC","Editor"),cc.Class({extends:cc.Component,properties:{ground:cc.Graphics,graphics:cc.Graphics,line:cc.Graphics,txtPos:cc.Label,boxPoints:cc.EditBox,boxX:cc.EditBox,boxY:cc.EditBox,signal:cc.Node},onLoad:function(){this.pointList=[],this.drawGround(),this.ground.node.on(cc.Node.EventType.MOUSE_MOVE,this.mouseMove,this)},drawGround:function(){var t=[cc.v2(-340,340),cc.v2(-340,-340),cc.v2(340,-340),cc.v2(340,340)],i=this.ground;i.moveTo(t[0].x,t[0].y);for(var e=1;e<t.length;e++)i.lineTo(t[e].x,t[e].y);i.close(),i.stroke(),i.fill();for(var s=this.line,o=0;o<16;o++)s.moveTo(40*o-300,340),s.lineTo(40*o-300,-340),s.stroke();for(var n=0;n<16;n++)s.moveTo(-340,40*n-300),s.lineTo(340,40*n-300),s.stroke()},mouseMove:function(t){var i=Math.max(Math.min(Math.round(t._x-cc.winSize.width/2),340),-340),e=Math.max(Math.min(Math.round(t._y-cc.winSize.height/2),340),-340);this.txtPos.string="("+i+", "+e+")"},add:function(){if(""!=this.boxX.string&&""!=this.boxY.string){var t=cc.v2(parseInt(this.boxX.string),parseInt(this.boxY.string));this.boxPoints.string=this.boxPoints.string+"("+t.x+";"+t.y+")",this.boxX.string=this.boxY.string="",0==this.pointList.length?this.graphics.moveTo(t.x,t.y):(this.graphics.lineTo(t.x,t.y),this.graphics.stroke()),this.pointList.push(t),this.signal.position=t}},delete:function(){this.pointList.splice(this.pointList.length-1,1);var t=this.graphics;t.clear();var i="";this.pointList.length>0&&(this.signal.position=this.pointList[this.pointList.length-1],t.moveTo(this.pointList[0].x,this.pointList[0].y),i+="("+this.pointList[0].x+";"+this.pointList[0].y+")");for(var e=1;e<this.pointList.length;e++)t.lineTo(this.pointList[e].x,this.pointList[e].y),i+="("+this.pointList[e].x+";"+this.pointList[e].y+")";this.pointList.length>1&&t.stroke(),this.boxPoints.string=i},clear:function(){this.boxPoints.string=this.boxX.string=this.boxY.string="",this.pointList=[],this.graphics.clear()},draw:function(){for(var t=[],i=this.boxPoints.string.slice(1,-1).split(")("),e=0;e<i.length;e++){var s=i[e].split(";"),o=cc.v2(parseInt(s[0]),parseInt(s[1]));t.push(o)}var n=this.graphics;n.clear(),t.length>0&&(this.signal.position=t[t.length-1],n.moveTo(t[0].x,t[0].y));for(var c=1;c<t.length;c++)n.lineTo(t[c].x,t[c].y);t.length>1&&n.stroke(),this.pointList=t}}),cc._RF.pop()},{}],EndLayer:[function(t,i,e){"use strict";cc._RF.push(i,"01016IA6M9OLqauOHhgoKX3","EndLayer");var s=t("Game");cc.Class({extends:cc.Component,properties:{btnNext:cc.Node},init:function(t){this.btnNext.active=t},nextLevel:function(){s.level++,cc.director.loadScene("main")},retry:function(){cc.director.loadScene("main")},back:function(){s.mode<=3?cc.director.loadScene("prepare"):cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],Game:[function(t,i,e){"use strict";cc._RF.push(i,"c695f0rYj9JK4KCz1V2sNHB","Game");var s={mode:1,level:1,heart:2,getData:function(t){if(void 0!=window.wx)wx.getStorage({key:"scale",success:function(i){cc.log("getStorageSuccess:"+i.data),void 0!=i.data?(s.data=JSON.parse(i.data),this.checkCompatible(),t()):(this.setDataToBase(),t())}.bind(this),fail:function(){this.setDataToBase(),t()}.bind(this)});else{var i=cc.sys.localStorage.getItem("scale");void 0!=i?(s.data=JSON.parse(i),this.checkCompatible()):this.setDataToBase(),t()}},setDataToBase:function(){s.data={copper:0,energy:10,fullCount:[0,0],star:[[],[],[]],metre:0,challenge:0,sign:0}},saveData:function(){void 0!=window.wx?wx.setStorage({key:"scale",data:JSON.stringify(s.data),success:function(){}}):cc.sys.localStorage.setItem("scale",JSON.stringify(s.data))},checkCompatible:function(){}};i.exports=s,cc._RF.pop()},{}],HelloWorld:[function(t,i,e){"use strict";cc._RF.push(i,"3c1c6BjeShPVLeEd+EAbaKC","HelloWorld");var s=t("Game");cc.Class({extends:cc.Component,properties:{UINode:cc.Node},onLoad:function(){cc.director.getCollisionManager().enabled=!0;var t=cc.view.getFrameSize();t.height/t.width>1.78&&(this.UINode.height=180)},btnEvent:function(t,i){5==i?cc.director.loadScene("editor"):(s.mode=parseInt(i)+1,s.mode<=3?cc.director.loadScene("prepare"):cc.director.loadScene("main"))}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(t,i,e){"use strict";cc._RF.push(i,"0d3a7lkkPZLpqDV+M1/xdSW","Opening");var s=t("Config");t("Game");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.login()},login:function(){s.load(function(){cc.director.loadScene("helloworld")}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PauseLayer:[function(t,i,e){"use strict";cc._RF.push(i,"3f277N4lCBMZJdvbhMRgrDD","PauseLayer");var s=t("Game");cc.Class({extends:cc.Component,properties:{},continue:function(){this.node.destroy();for(var t=window.playgound.balls,i=0;i<t.length;i++)t[i].isValid&&(t[i].getComponent("Ball").rolling=!0)},back:function(){s.mode<=3?cc.director.loadScene("prepare"):cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],PlayGound:[function(t,i,e){"use strict";cc._RF.push(i,"0ee2epUJOxOI4tyzz/z4+nl","PlayGound");var s=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{graphics:[cc.Graphics],graphicsBase:cc.Graphics,graphicsNode:cc.Node,colliderPrefab:cc.Prefab,ballPrefab:cc.Prefab,friendPrefab:cc.Prefab,graphicsThrons:[cc.Graphics]},onLoad:function(){if(window.playgound=this,this.width=680,s.mode<=3){this.cfg=o.get(["cfg_classic","cfg_memory","cfg_three"][s.mode-1],s.level)}else 4==s.mode&&(this.width=640);if(this.freeze=!1,2==s.mode){this.points=[];for(var t=this.cfg.shapePos.slice(1,-1).split(")("),i=0;i<t.length;i++){var e=t[i].split(";"),n=cc.v2(parseInt(e[0]),parseInt(e[1]));this.points.push(n)}}else this.points=[cc.v2(-this.width/2,340),cc.v2(-this.width/2,-340),cc.v2(this.width/2,-340),cc.v2(this.width/2,340)];this.draw(),this.drawBase(),this.createColliders(),this.createFriend(),this.createBall(),4==s.mode&&this.createThron()},draw:function(){for(var t=0;t<this.graphics.length;t++){var i=this.graphics[t];i.clear(),i.moveTo(this.points[0].x,this.points[0].y);for(var e=1;e<this.points.length;e++)i.lineTo(this.points[e].x,this.points[e].y);i.close(),i.stroke(),0==t&&i.fill()}},drawBase:function(){var t=this.graphicsBase;t.clear(),t.moveTo(this.points[0].x,this.points[0].y);for(var i=1;i<this.points.length;i++)t.lineTo(this.points[i].x,this.points[i].y);t.close(),t.fill()},createBall:function(){this.balls=[];for(var t=5==s.mode?1:4==s.mode?2:this.cfg.monsterNum,i=0;i<t;i++){var e=cc.instantiate(this.ballPrefab);this.node.addChild(e),this.balls.push(e);for(var o=null;!o;){for(var n=cc.v2(Math.random()*(this.width-40)-(this.width-40)/2,640*Math.random()-320),c=[cc.v2(-17,17),cc.v2(17,17),cc.v2(17,-17),cc.v2(-17,-17)],r=!1,a=0;a<4;a++){var h=n.add(c[a]),l=n.add(c[3==a?0:a+1]);if(cc.Intersection.linePolygon(h,l,this.points)){r=!0;break}}cc.Intersection.pointInPolygon(n,this.points)&&!r&&(o=n)}e.position=o}},createFriend:function(){if(this.friends=[],this.friendMarks=[],s.mode<=3){var t=this.cfg.friendsNum,i=[];if(s.mode<3)for(var e=this.cfg.friendsPos.slice(1,-1).split(")("),o=0;o<e.length;o++){var n=e[o].split(";"),c=cc.v2(parseInt(n[0]),parseInt(n[1]));i.push(c)}for(var r=0;r<t;r++){var a=cc.instantiate(this.friendPrefab);this.node.addChild(a),this.friends.push(a),a.position=3==s.mode?cc.v2(640*Math.random()-320,640*Math.random()-320):i[r]}}},startSlice:function(t,i){this.pMid=i,this.pCrossList=t,this.scissorsList=[];for(var e=0;e<2;e++){var s=this.pCrossList[e].sub(this.pMid),o=cc.instantiate(this.colliderPrefab);o.position=this.pMid,this.node.addChild(o),this.scissorsList.push(o),s.y>0||(s.y<0?o.rotation=180:s.x>0?o.rotation=90:o.rotation=-90)}window.btLayer.touchabled=!1,window.btLayer.slicer.node.scale=1,this.schedule(this.updateSlicer,0)},updateSlicer:function(){for(var t=0,i=0;i<2;i++){var e=5*this.scissorsList[i].scaleY,o=this.pCrossList[i].sub(this.pMid).mag();e>=o?(e=o,t++):e+=5,this.scissorsList[i].scaleY=e/5}if(t>=2){for(var n=0;n<2;n++)this.scissorsList[n].getComponent("Collider").complete(),this.colliders.push(this.scissorsList[n]);this.unschedule(this.updateSlicer),this.splitPoints(),window.btLayer.slicer.node.position=window.btLayer.selectPos,3==s.mode?window.btLayer.checkThree():window.btLayer.resetSlicer()}},insertTemp:function(t,i){for(var e=0;e<this.pTempList.length;e++)if(this.pTempList[e]===i){this.pTempList.splice(e+1,0,t);break}},splitPoints:function(){for(var t=[[],[]],i=0,e=0;e<this.pTempList.length;e++){var s=this.pTempList[e];s===this.pCrossList[0]||s===this.pCrossList[1]?(t[0].push(s),t[1].push(s),window.btLayer.type>1&&t[i].push(this.pMid),i=1-i):t[i].push(s)}this.selectPolygon(t)},selectPolygon:function(t){for(var i=[0,0],e=[[],[]],o=0;o<2;o++){for(var n=t[o],c=0;c<this.width/10+1;c++)for(var r=0;r<69;r++){var a=cc.v2(-this.width/2+10*c,10*r-340);cc.Intersection.pointInPolygon(a,n)&&i[o]++}for(var h=0;h<this.balls.length;h++)this.balls[h].isValid&&cc.Intersection.pointInPolygon(this.balls[h].position,n)&&e[o].push(this.balls[h])}var l=0;if(4==s.mode){for(var d=0;d<t[1].length;d++)if(340==t[1][d].y){l=1;break}}else e[0].length==e[1].length?i[0]<i[1]&&(l=1):e[0].length<e[1].length&&(l=1);this.points=t[l],this.draw(),window.btLayer.updateStar(i[l]);for(var p=0;p<this.friends.length;p++)this.friends[p].isValid&&cc.Intersection.pointInPolygon(this.friends[p].position,t[1-l])&&(this.friends[p].destroy(),window.btLayer.addStar());for(var f=0;f<e[1-l].length;f++){var v=e[1-l][f];4==s.mode?v.active=!1:v.destroy()}if(4==s.mode&&this.updateTower(),this.freeze){this.freeze=!1;for(var u=0;u<this.balls.length;u++)this.balls[u].isValid&&(this.balls[u].getComponent("Ball").freeze=!1)}},createColliders:function(){this.colliders=[];for(var t=0;t<this.points.length;t++){var i=this.points[t],e=(this.points[t+1]?this.points[t+1]:this.points[0]).sub(i),s=cc.instantiate(this.colliderPrefab);s.position=i,s.scaleY=e.mag()/5,this.node.addChild(s),this.colliders.push(s),s.getComponent("Collider").complete(),e.y>0||(e.y<0?s.rotation=180:e.x>0?s.rotation=90:s.rotation=-90)}},createThron:function(){for(var t=0;t<10;t++)for(var i=cc.v2(64*t-288,308),e=0;e<2;e++){var s=cc.instantiate(this.colliderPrefab);s.position=i,s.scaleY=9.6,this.node.addChild(s),s.getComponent("Collider").complete(),s.rotation=0==e?-45:45}for(var o=0;o<2;o++){var n=this.graphicsThrons[o];n.moveTo(-320,350),n.lineTo(-320,340);for(var c=0;c<10;c++){var r=cc.v2(64*c-288,308);n.lineTo(r.x,r.y),n.lineTo(r.x+32,340)}n.lineTo(320,350),n.close(),n.fill()}},resizeSquare:function(){for(var t=340,i=340,e=-340,s=-340,o=0;o<this.points.length;o++){var n=this.points[o];t=Math.min(t,n.x),i=Math.min(i,n.y),e=Math.max(e,n.x),s=Math.max(s,n.y)}var c=1,r=cc.v2(),a=cc.v2();if(e-t>s-i){c=680/(e-t);for(var h=0;h<this.points.length;h++){(n=this.points[h]).x=Math.round((n.x-t)*c-340),n.y=Math.round((n.y-(s+i)/2)*c)}r=cc.v2(-340-t*c,-(s+i)/2*c),a=cc.v2((this.balls[0].x-t)*c-340,(this.balls[0].y-(s+i)/2)*c)}else{c=680/(s-i);for(var l=0;l<this.points.length;l++){(n=this.points[l]).x=Math.round((n.x-(e+t)/2)*c),n.y=Math.round((n.y-i)*c-340)}r=cc.v2(-(e+t)/2*c,-340-i*c),a=cc.v2((this.balls[0].x-(e+t)/2)*c,(this.balls[0].y-i)*c-340)}for(var d=0,p=0;p<69;p++)for(var f=0;f<69;f++){var v=cc.v2(10*p-340,10*f-340);cc.Intersection.pointInPolygon(v,this.points)&&d++}window.btLayer.total=d;for(var u=0;u<this.colliders.length;u++)this.colliders[u].destroy();this.graphicsBase.clear(),this.graphicsNode.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,c),cc.moveTo(.5,r)),cc.callFunc(function(){this.graphicsNode.position=cc.v2(),this.graphicsNode.scale=1,this.draw(),this.drawBase(),this.createColliders(),window.btLayer.strip.progress=0,window.btLayer.txtPecent.string="0%"}.bind(this)))),this.balls[0].getComponent("Ball").rolling=!1,this.balls[0].runAction(cc.sequence(cc.moveTo(.5,a),cc.callFunc(function(){this.balls[0].getComponent("Ball").rolling=!0}.bind(this)))),window.btLayer.gotoNextLevel()},speedDown:function(){if(!this.freeze){this.freeze=!0;for(var t=0;t<this.balls.length;t++)this.balls[t].isValid&&(this.balls[t].getComponent("Ball").freeze=!0)}},updateTower:function(){for(var t=this,i=340,e=0;e<this.points.length;e++)this.points[e].y<i&&(i=this.points[e].y);if(i>-340){for(var o=i+340,n=0;n<this.points.length;n++)this.points[n].y<340&&(this.points[n].y-=o);this.graphicsNode.y+=o;for(var c=0;c<this.colliders.length;c++)this.colliders[c].destroy();this.draw(),this.graphicsBase.clear(),this.createColliders(),window.btLayer.addMeter(o),s.level++,this.graphicsNode.runAction(cc.sequence(cc.moveTo(.4,cc.v2(0,0)),cc.moveBy(.05,cc.v2(0,30)),cc.moveTo(.05,cc.v2(0,0)),cc.callFunc(function(){this.drawBase(),this.addBall()}.bind(this))));for(var r=function(i){var e=t.balls[i];e.isValid&&e.active&&(e.getComponent("Ball").rolling=!1,e.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,-o)),cc.callFunc(function(){var t=360*Math.random();e.getComponent("Ball").velocity=cc.v2(Math.sin(t),Math.cos(t)),e.getComponent("Ball").rolling=!0}.bind(t)))))},a=0;a<this.balls.length;a++)r(a)}else this.addBall()},addBall:function(){for(var t=0;t<this.balls.length;t++){var i=this.balls[t];if(i.isValid&&(!i.active||!cc.Intersection.pointInPolygon(i.position,this.points))){i.active=!0;for(var e=null;!e;){var s=cc.v2(600*Math.random()-300,500*Math.random()-230);cc.Intersection.pointInPolygon(s,this.points)&&(e=s)}i.position=e,window.btLayer.addPiece()}}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayLayer:[function(t,i,e){"use strict";cc._RF.push(i,"32a9dKicsVIF4FeRuQq0DvJ","PlayLayer");var s=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{slicers:[cc.Sprite],strip:cc.ProgressBar,txtPecent:cc.Label,starList:[cc.Node],pauseLayerPrefab:cc.Prefab,endLayerPrefab:cc.Prefab,starNode:cc.Node,txtLevel:cc.Label,txtHeart:cc.Label,friendsNode:cc.Node,friendPrefab:cc.Prefab,reviveLayerPrefab:cc.Prefab},onLoad:function(){if(window.btLayer=this,this.width=680,s.mode<=3){this.cfg=o.get(["cfg_classic","cfg_memory","cfg_three"][s.mode-1],s.level)}else 4==s.mode?(s.level=1,this.width=640,this.starNode.active=!1,this.strip.node.active=!1,this.meter=1,this.txtLevel.string="1M",this.piece=0):5==s.mode&&(s.level=1,this.starNode.active=!1,this.txtLevel.string=1);this.total=69*(this.width/10+1),this.friendsSaved=0,this.heart=2,this.types=[],this.revived=!1,this.gameover=!1,this.refreshStrip(),this.createFriendMaks();for(var t=0;t<3;t++)0==t||3==s.mode?(this.slicers[t].node.zIndex=10,this.slicers[t].node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.slicers[t].node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.slicers[t].node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.slicers[t].node.on(cc.Node.EventType.TOUCH_END,this.touchCancel,this),this.resetSlicer(t)):this.slicers[t].node.active=!1},createFriendMaks:function(){if(this.friendMarks=[],s.mode<=3)for(var t=this.cfg.friendsNum,i=0;i<t;i++){var e=cc.instantiate(this.friendPrefab);e.scale=2,e.color=cc.Color.GRAY,e.x=-(t-1)/2*60+60*i,this.friendsNode.addChild(e),this.friendMarks.push(e)}},refreshStrip:function(){if(s.mode<=3)for(var t=this.cfg.starRequire.split(";"),i=0;i<3;i++)this.starList[i].x=parseFloat(t[i])/parseFloat(t[2])*620-310},touchStart:function(t){if(this.touchabled){this.slicer=t.target.getComponent(cc.Sprite),this.selectPos=this.slicer.node.position;for(var i=0,e=0;e<3;e++)if(this.slicer==this.slicers[e]){i=e;break}this.type=this.types[i]}},touchMove:function(t){if(this.touchabled){this.slicer.node.position=t.touch._point.sub(cc.v2(cc.winSize.width/2,cc.winSize.height/2));var i=this.slicer.node.y+480,e=Math.min(Math.max(0,3*i),200);this.slicer.node.y+=e}},touchCancel:function(t){if(this.touchabled){var i=cc.v2(Math.round(this.slicer.node.x),Math.round(this.slicer.node.y));if(this.points=window.playgound.points,!cc.Intersection.pointInPolygon(i,this.points)||4==s.mode&&i.y>308)this.slicer.node.position=this.selectPos;else{var e=[cc.v2(i.x,340),cc.v2(this.width/2,i.y),cc.v2(i.x,-340),cc.v2(-this.width/2,i.y)];window.playgound.pTempList=this.points.concat();for(var o=[[1,3],[0,2],[0,3],[0,1],[1,2],[2,3]][this.type],n=[],c=0;c<2;c++){for(var r=o[c],a=e[r],h=680,l=cc.v2(),d=cc.v2(),p=0;p<this.points.length;p++){var f=this.points[p],v=this.points[p+1]?this.points[p+1]:this.points[0];if(cc.Intersection.lineLine(i,a,f,v)){var u=cc.v2();(u=r%2==0?cc.v2(i.x,f.y):cc.v2(f.x,i.y)).sub(i).mag()<h&&(h=u.sub(i).mag(),l=f,d=u)}}window.playgound.insertTemp(d,l),n.push(d)}window.playgound.startSlice(n,i)}}},touchEnd:function(){this.type>1?(this.type++,this.type>5&&(this.type=2)):this.type=1-this.type,cc.loader.loadRes("Texture/slicer"+this.type,cc.SpriteFrame,function(t,i){this.slicer.spriteFrame=i}.bind(this))},resetSlicer:function(t){var i=null!=t?this.slicers[t]:this.slicer,e=null!=t?t:0;if(this.touchabled=!0,i.node.scale=1.5,4==s.mode){this.types[e]=[0,4,4,5,5][Math.floor(5*Math.random())]}else this.types[e]=Math.floor(6*Math.random());cc.loader.loadRes("Texture/slicer"+this.types[e],cc.SpriteFrame,function(t,e){i&&(i.spriteFrame=e)}.bind(this))},loseHeart:function(){window.playgound.unschedule(window.playgound.updateSlicer);for(var t=0;t<2;t++)window.playgound.scissorsList[t].destroy();this.slicer.node.position=this.selectPos,3==s.mode?this.checkThree():(this.resetSlicer(),this.heart--,this.txtHeart.string=this.heart,this.heart<=0&&this.lose())},openEnding:function(t){var i=cc.instantiate(this.endLayerPrefab);i.getComponent("EndLayer").init(t),this.node.addChild(i,20)},updateStar:function(t){var i=.27+.03*s.level,e=(this.total-t)/this.total;if(s.mode<=3){var o=this.cfg.starRequire.split(";");i=parseFloat(o[2]);for(var n=0;n<3;n++)e>=parseFloat(o[n])&&(this.starList[n].getChildren()[0].active=!0)}else 5==s.mode&&e>=i&&window.playgound.resizeSquare();this.strip.progress=e/i},addStar:function(){this.friendsSaved++;var t=this.cfg.friendsNum;this.friendMarks[this.friendsSaved-1].color=cc.Color.WHITE,this.friendsSaved>=t&&(this.gameover=!0,this.openEnding(!0))},gotoNextLevel:function(){s.level++,this.txtLevel.string=s.level,this.txtLevel.node.position=cc.v2(),this.txtLevel.node.scale=10,this.txtLevel.node.opacity=150,this.txtLevel.node.runAction(cc.spawn(cc.scaleTo(.5,1),cc.moveTo(.5,cc.v2(0,502),cc.fadeIn(.5))))},change:function(){for(var t=this,i=function(i){if(t.slicers[i].node.active){for(o=t.types[i];o==t.types[i];)o=4==s.mode?[0,4,4,5,5][Math.floor(5*Math.random())]:Math.floor(6*Math.random());t.types[i]=o,cc.loader.loadRes("Texture/slicer"+t.types[i],cc.SpriteFrame,function(t,e){this.slicers[i]&&(this.slicers[i].spriteFrame=e)}.bind(t))}},e=0;e<3;e++){var o;i(e)}},speedDown:function(){window.playgound.speedDown()},stop:function(){var t=cc.instantiate(this.pauseLayerPrefab);this.node.addChild(t,20);for(var i=window.playgound.balls,e=0;e<i.length;e++)i[e].isValid&&(i[e].getComponent("Ball").rolling=!1)},checkThree:function(){if(this.slicer.node.scale=1.5,this.slicer.node.active=!1,this.touchabled=!0,!this.gameover){for(var t=0,i=0;i<3;i++)this.slicers[i].node.active&&t++;t<=0&&this.lose()}},lose:function(){if(!this.gameover)if(this.gameover=!0,this.revived)this.openEnding(!1);else{var t=cc.instantiate(this.reviveLayerPrefab);this.node.addChild(t,20)}},addMeter:function(t){this.meter+=t/680,this.txtLevel.string=Math.round(100*this.meter)/100+"M"},addPiece:function(){this.piece++,this.piece>=3&&(this.piece-=3,this.heart++,this.txtHeart.string=this.heart)},revive:function(){if(this.revived=!0,this.heart=2,this.txtHeart.string=2,this.gameover=!1,3==s.mode)for(var t=0;t<3;t++)this.slicers[t].node.active=!0,this.resetSlicer(t);else this.resetSlicer()}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Prepare:[function(t,i,e){"use strict";cc._RF.push(i,"807924B+/NFNoJMOgJ1ruNO","Prepare");var s=t("Game");cc.Class({extends:cc.Component,properties:{btn:cc.Node,content:cc.Node},onLoad:function(){for(var t=[85,30,30],i=0;i<t[s.mode-1];i++){var e=this.btn;i>0&&((e=cc.instantiate(e)).getChildren()[0].getComponent(cc.Label).string=i+1,e.getComponent(cc.Button).clickEvents[0].customEventData=i+1,this.content.addChild(e)),e.position=cc.v2(i%5*120-240,-50-100*Math.floor(i/5))}this.content.height=Math.max(1e3,20+100*Math.ceil(t[s.mode-1]/5))},gotoPlay:function(t,i){s.level=i,cc.director.loadScene("main")},back:function(){cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],ReviveLayer:[function(t,i,e){"use strict";cc._RF.push(i,"0483cI1cPhMkpz244nePWEt","ReviveLayer");t("Game");cc.Class({extends:cc.Component,properties:{},revive:function(){this.node.destroy(),window.btLayer.revive()},skip:function(){this.node.destroy(),window.btLayer.openEnding(!1)}}),cc._RF.pop()},{Game:"Game"}]},{},["Ball","Collider","Config","Editor","EndLayer","Game","HelloWorld","Opening","PauseLayer","PlayGound","PlayLayer","Prepare","ReviveLayer"]);