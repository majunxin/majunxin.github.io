window.__require=function e(t,i,c){function o(s,n){if(!i[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!n&&h)return h(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+s+"'")}}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){return o(t[s][1][e]||e)},d,d.exports,e,t,i,c)}return i[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<c.length;s++)o(c[s]);return o}({AIYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){var i=this.player.diceList[t].getComponent("DiceYahtzee");e[i.element-1]++}for(var c=-1,o=-1,a=0;a<6;a++)e[a]>(e[c]||0)&&(c=a);for(var s=0;s<6;s++)s!=c&&e[s]>(e[o]||0)&&(o=s);this.scheduleOnce(function(){e[c]>1?e[c]==e[o]?this.hold(c,o):this.hold(c):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(e,t){for(var i=0,c=0;c<5;c++){var o=this.player.diceList[c].getComponent("DiceYahtzee");o.holded?o.element!=e+1&&null!=t&&o.element!=t+1&&(o.doHold(),i++):(o.element==e+1||null!=t&&o.element==t+1)&&(o.doHold(),i++)}var a=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),a)}}),cc._RF.pop()},{}],AI:[function(e,t,i){"use strict";cc._RF.push(t,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy"),this.castList=[]},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var e=1,t=100,i=null,c=0;c<this.cards.length;c++){var o=this.cards[c].getComponent("Card");o.usable&&(o.cfg.priority<t||o.cfg.priority==t&&o.rate>e)&&(e=o.rate,t=o.cfg.priority,i=o)}i?i.cast():this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.8):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.6)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var e=[0,0,0,0,0,0],t=0;t<this.cards.length;t++){var i=this.cards[t].getComponent("Card");(m=i.require.split(";")).length>1&&e[m[0]-1]++;for(var c=["A","B","C","D","E","F"],o=0;o<6;o++)if(i.cfg.desc.indexOf(c[o])>=0){e[o]++;break}}for(var a=!1,s=0;s<6;s++)if(e[s]>0){a=!0;break}for(var n=[],r=0;r<this.cards.length;r++){var h=this.cards[r].getComponent("Card"),d=[0,0,0,0,0,0];if(h.require>=101&&h.require<=105){for(var l=0,f=0,u=0;u<6;u++)(!a||e[u]>0)&&this.player.elementList[u]>l&&(l=this.player.elementList[u],f=u+1);if(d=[-100,-100,-100,-100,-100,-100],l>=a||2){d[f-1]=[2,3,3,4,5][h.require-101]-l}}else{var p=[0,0,0,0,0,0];if(106==h.require||107==h.require)p=[1,1,1,1,1,1];else for(var m=h.require.split(";"),g=0;g<m.length;g++)p[m[g]-1]++;for(var w=["A","B","C","D","E","F"],y=0;y<6;y++){var v=p[y];h.cfg.desc.indexOf(w[y])>=0&&(v=this.player.elementList[y]+1),d[y]=v-this.player.elementList[y]}}n.push(d)}for(var b=100,C=0,x=0,k=1,L=0;L<n.length;L++){for(var I=n[L],B=0,q=0,T=0;T<I.length;T++)B+=I[T]<-10?0:Math.abs(I[T]),q+=I[T];(B<b||B==b&&q>C||B==b&&q==C&&this.cards[L].getComponent("Card").rate<k)&&(b=B,C=q,x=L,k=this.cards[L].getComponent("Card").rate)}for(var E=n[x],N=0;N<6;N++)if(0!=E[N]){var R=E[N]+this.player.elementList[N]-this.player.holdList[N];if(R>0)for(var M=0;M<this.dices.length;M++){var S=this.dices[M].getComponent("Dice");if(S.element==N+1&&!(S.holded||S.lock||S.freeze||S.temp)&&(S.hold(),0==--R))break}else if(R<0)for(var F=0;F<this.dices.length;F++){var A=this.dices[F].getComponent("Dice");if(A.element==N+1&&A.holded&&!A.lock&&!A.freeze&&!A.temp&&(A.hold(),0==++R))break}}this.player.roll();for(var D=!1,P=0;P<this.dices.length;P++){var _=this.dices[P].getComponent("Dice");if(!(_.holded||_.lock||_.freeze||_.temp)){D=!0;break}}this.scheduleOnce(function(){D?this.check():this.player.endRound()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var e=0;e<this.player.cardList.length;e++){var t=this.player.cardList[e].getComponent("Card");t.silence||t.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(t)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var c=this.player.diceList[i];c.lock||this.dices.push(c)}},insertAndCast:function(e){}}),cc._RF.pop()},{}],Buff:[function(e,t,i){"use strict";cc._RF.push(t,"76faa8y1jVIcqDL176r9ktK","Buff");var c=e("Game");cc.Class({extends:cc.Component,properties:{buffBox:cc.Node,txtBuff:cc.RichText},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.multiCast=0,this.multiCastMax=0,this.selfHarmCast=0,this.selfHarmCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.burnIce=!1,this.silenceDark=!1,this.atkAd3=!1,this.creatDiceFire=0,this.exCreateDice=0,this.tempBuff=[0,0,0,0],this.doubleWind=!1,this.darkRedice=0,this.table={};for(var e=[13,21,22,23,24,25,26,27,28,29,30,101,102,103,104,105,106,107,108],t=0;t<e.length;t++)this.table[e[t]]=0;this.quote(),this.refreshBuff()},addBuff:function(e,t){if(!(t<=0)){if(13==e)this.player.anim.show(13);else if(e>=21&&e<=30){if(this.immunity>0)return this.removeBuff(105,1),this.player.equip.doTrigger(37),void this.player.assertHpChange("MISS",3);if(e<=26){if(this.opponent.equip.checkWithTrigger(e+10))t+=26==e?2:1;23==e&&this.opponent.equip.trigger(68)}this.player.anim.show(e)}this.table[e]+=t,this.quote();for(var i=!1,c=0;c<this.buffList.length;c++)if(this.buffList[c]==e){i=!0;break}i||this.buffList.push(e),this.refreshBuff()}},removeBuff:function(e,t){if(!(t<=0)){if(this.table[e]-=t,this.table[e]<=0){this.table[e]=0;var i=this.buffList.indexOf(e);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28],this.chaos=this.table[29],this.blind=this.table[30],this.exRound=this.table[101],this.undead=this.table[102],this.atkBack=this.table[103],this.atkAdd=this.table[104],this.immunity=this.table[105],this.hurtReduce=this.table[106],this.doubleDmg=this.table[107],this.doubleCast=this.table[108]},refreshBuff:function(){var e="",t={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",29:"\u6df7\u4e71",30:"\u76f2\u76ee",101:"\u989d\u5916\u56de\u5408",102:"\u4e0d\u6b7b",103:"\u53cd\u4f24",104:"\u4f24\u5bb3\u63d0\u5347",105:"\u514d\u75ab",106:"\u53d7\u4f24\u51cf\u514d",107:"\u53cc\u500d\u4f24\u5bb3",108:"\u91cd\u590d\u884c\u52a8"},i={13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1",101:"FFF830",102:"FF5567",103:"FF5567",104:"FFF830",105:"42EBFF",106:"FF5567",107:"F15162",108:"E2BD6D"};if(1==this.buffList.length){var c=this.buffList[0];e+="<img src='"+this.getBuffImg(c)+"'/>",e+="<color="+i[c]+">"+t[c]+this.table[c]+"</c>"}else for(var o=0;o<this.buffList.length;o++){var a=this.buffList[o];e+="<img src='"+this.getBuffImg(a)+"'/>",e+="<color="+i[a]+">"+this.table[a]+"</c>  "}if(this.player.host.txtBuff.string=e,this.buffBox.active){e="";var s=50;this.opponent.equip.check(54)&&(s+=25),this.player.equip.check(56)&&(s-=25),this.player.equip.check(113)&&(s*=2),this.opponent.equip.check(113)&&(s*=2);for(var n={13:"\u8eb2\u907f\u5bf9\u624b\u4f7f\u7528\u7684\u653b\u51fb\u724c\uff0c\u89e6\u53d1\u540e\u5c42\u6570-1",21:"\u4f7f\u7528\u71c3\u70e7\u7684\u5361\u724c\u65f6\uff0c\u53d7\u52303\u706b\u4f24\u5bb3",22:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u88ab\u91cd\u63b7",23:"\u989d\u5916\u627f\u53d7"+s+"%\u7684\u5361\u724c\u4f24\u5bb3\uff0c \u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",24:"\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u51cf\u5c11"+(this.opponent.equip.check(55)?50:30)+"%\uff0c \u56de\u5408\u7ed3\u675f\u65f6\u5c42\u6570-1",25:"\u4f7f\u5361\u724c\u65e0\u6cd5\u4f7f\u7528",26:"\u56de\u5408\u5f00\u59cb\u65f6\u53d7\u5230\u4e2d\u6bd2\u5c42\u6570\u7684\u4f24\u5bb3\uff0c\u4e2d\u6bd2\u5c42\u6570-1",27:"\u4f7f\u7528\u5361\u724c\u65f6\u670950%\u6982\u7387\u65e0\u6548\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",28:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u4f7f\u7528",29:"\u4f7f\u7528\u653b\u51fb\u724c\u65f6\u670950%\u6982\u7387\u653b\u51fb\u81ea\u8eab\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",30:"\u4f7f\u9ab0\u5b50\u7684\u5143\u7d20\u65e0\u6cd5\u88ab\u67e5\u770b",101:"\u56de\u5408\u7ed3\u675f\u65f6\u5f00\u59cb\u989d\u5916\u7684\u5df1\u65b9\u56de\u5408\uff0c\u5c42\u6570-1",102:"\u751f\u547d\u65e0\u6cd5\u51cf\u5c11\u52301\u4ee5\u4e0b\uff0c\u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",103:"\u53d7\u5230\u5361\u724c\u4f24\u5bb3\u65f6\uff0c\u4f7f\u5bf9\u624b\u627f\u53d7\u53cd\u4f24\u5c42\u6570\u7684\u4f24\u5bb3",104:"\u589e\u52a0\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3",105:"\u514d\u9664\u83b7\u5f97\u8d1f\u9762\u72b6\u6001",106:"\u51cf\u5c11\u53d7\u5230\u7684\u5361\u724c\u4f24\u5bb3",107:"\u4e0b\u4e00\u5f20\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u7ffb\u500d",108:"\u4e0b\u4e00\u5f20\u5361\u724c\u989d\u5916\u4f7f\u7528\u4e00\u6b21\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1"},r=0;r<this.buffList.length;r++){var h=this.buffList[r];e+="<img src='"+this.getBuffImg(h)+"'/>",e+="<color="+i[h]+">"+t[h]+this.table[h]+": "+n[h]+"</c>",r!=this.buffList.length-1&&(e+="\r\n")}this.txtBuff.string=e,this.buffBox.height=14+30*this.buffList.length,this.buffBox.width=this.txtBuff.node.width+20,this.txtBuff.node.x=-this.txtBuff.node.width/2}},getBuffImg:function(e){var t={13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind",101:"exRound",102:"undead",103:"atkback",104:"atkAdd",105:"immunity",106:"hurtReduce",107:"doubleDmg",108:"doubleAction"}[e];if(23==e){var i=0;(this.opponent.equip.check(54)||this.opponent.equip.check(113)||this.player.equip.check(113))&&i++,this.player.equip.check(56)&&i--,i>0?t="frailPlus":i<0&&(t="frailMinus")}else 24==e&&this.opponent.equip.check(55)&&(t="weakPlus");return t},openBuffList:function(){if(0!=this.buffList.length){if(window.mainLayer.buffTip){if(window.mainLayer.buffTip==this)return void this.hideTip();window.mainLayer.buffTip.hideTip()}this.buffBox.active=!0,this.refreshBuff(),window.mainLayer.buffTip=this,this.scheduleOnce(this.hideTip,5),11==c.data.guide&&window.guide&&window.guide.close()}},hideTip:function(){this.unscheduleAllCallbacks(),this.buffBox.active=!1,window.mainLayer.buffTip=null}}),cc._RF.pop()},{Game:"Game"}],CampLayer:[function(e,t,i){"use strict";cc._RF.push(t,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{txtHeal:cc.Label,txtCopper:cc.Label,btnHeal:cc.Node,btnCopper:cc.Node,btnDelete:cc.Node,btnEquip:cc.Node,boxHeal:cc.Node,boxCopper:cc.Node,boxDelete:cc.Node,boxEquip:cc.Node},onLoad:function(){window.campLayer=this;var e=1;c.data.equip.indexOf(89)>=0&&(e=0,this.txtHeal.node.color=cc.color(49,248,255)),this.hp=Math.floor(.35*c.data.hpMax*e),this.copper=7*(c.data.castle+3),c.data.equip.indexOf(39)>=0?(this.hp=c.data.hpMax-c.data.hp,this.txtHeal.node.color=cc.color(255,230,62),this.txtHeal.string="\u751f\u547d\u56de\u6ee1",this.copper*=2,this.txtCopper.node.color=cc.color(255,230,62)):this.txtHeal.string="\u751f\u547d+"+this.hp,this.txtCopper.string="\u91d1\u5e01+"+this.copper,4==c.data.heroId&&(this.boxCopper.active=!1,this.boxDelete.active=!0),c.data.equip.indexOf(38)>=0&&(this.boxEquip.active=!0,this.boxHeal.x=-240,this.boxCopper.x=this.boxDelete.x=0),this.btnHeal.opacity=1,this.btnCopper.opacity=1,this.btnDelete.opacity=1,this.btnEquip.opacity=1,this.btnHeal.y-=150,this.btnCopper.y-=150,this.btnDelete.y-=150,this.btnEquip.y-=150,this.btnHeal.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnCopper.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnDelete.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnEquip.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))},onHeal:function(){c.data.hp=Math.min(c.data.hp+this.hp,c.data.hpMax),cc.audioEngine.playEffect(window.sound.healSound),this.close()},onCopper:function(){c.data.copper+=this.copper,cc.audioEngine.playEffect(window.sound.copperSound),this.close()},onDelete:function(){window.homeLayer.openDelete(),this.close()},onEquip:function(){window.homeLayer.openTreasure(),this.close()},close:function(){this.node.destroy(),window.homeLayer.refreshHeroData(),c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.room.ready(),window.room.hero.centerial(),window.campLayer=null}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,chestPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node,mask:cc.Node,scrollView:cc.ScrollView,boxRandom:cc.Node},onLoad:function(){window.bagLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var e=0;window.equipLayer?(e=.15,window.equipLayer.close()):window.mapLayer&&(e=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initDeck(),this.initBag(),c.newCard&&(c.newCard=!1,window.homeLayer.refreshHeroData()),cc.audioEngine.playEffect(window.sound.bagOpenSound),window.guide&&window.guide.close(),c.data.deck.length+c.data.cardBag.length>=7&&0==c.data.guideBag&&(c.data.guideBag=1,window.homeLayer.showGuide(31))},initDeck:function(){if(4==c.data.heroId)return this.boxDeck.active=!1,this.scrollView.getComponent(cc.Widget).top=158,void this.scrollView.getComponent(cc.Widget).updateAlignment();this.deck=[];for(var e=5==c.data.heroId?2:3,t=0;t<c.data.deck.length;t++){var i=cc.instantiate(this.cardPrefab);i.getComponent("CardCollection").init(c.data.deck[t],0),i.position=cc.v2(t%e*247-247,104-210*Math.floor(t/e)),this.boxDeck.addChild(i),this.deck[t]=i}if(5==c.data.heroId){var o=cc.instantiate(this.chestPrefab);o.position=cc.v2(240,0),this.boxDeck.addChild(o)}else 2==c.data.heroId&&3==c.data.difficulty&&(this.boxRandom.active=!0)},initBag:function(){c.data.cardBag.sort(function(e,t){return o.get("cfg_card",e).element==o.get("cfg_card",t).element?e-t:o.get("cfg_card",e).element-o.get("cfg_card",t).element}),this.bagList=[];for(var e=0;e<c.data.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.cardBag[e],1),t.position=cc.v2(e%3*247-247,-120-210*Math.floor(e/3)),this.content.addChild(t),this.bagList.push(t)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+530,4==c.data.heroId&&(this.contentHeight+=450),this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},equip:function(e){for(var t=-1,i=5==c.data.heroId?4:2==c.data.heroId&&3==c.data.difficulty?5:6,o=0;o<i;o++)if(null==this.deck[o]){t=o;break}if(t>=0){e.parent=this.boxDeck;var a=5==c.data.heroId?2:3;e.position=cc.v2(t%a*247-247,104-210*Math.floor(t/a)),e.getComponent("CardCollection").colletType=0;var s=e.getComponent("CardCollection").cfgId;this.deck[t]=e;var n=c.data.cardBag.indexOf(s);c.data.cardBag.splice(n,1);n=this.bagList.indexOf(e);this.bagList.splice(n,1),this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)}},unEquip:function(e){var t=this.deck.indexOf(e);this.deck[t]=null;for(var i=c.data.cardBag.length,a=e.getComponent("CardCollection").cfgId,s=0;s<c.data.cardBag.length;s++)if(o.get("cfg_card",a).element<o.get("cfg_card",c.data.cardBag[s]).element||o.get("cfg_card",a).element==o.get("cfg_card",c.data.cardBag[s]).element&&a<c.data.cardBag[s]){i=s;break}c.data.cardBag.splice(i,0,a),this.bagList.splice(i,0,e),e.parent=this.content,e.position=cc.v2(i%3*247-247,-120-210*Math.floor(i/3)),e.getComponent("CardCollection").colletType=1,this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)},refreshBag:function(){for(var e=0;e<this.bagList.length;e++)this.bagList[e].runAction(cc.moveTo(.15,cc.v2(e%3*247-247,-120-210*Math.floor(e/3))));this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},close:function(){if(4!=c.data.heroId){c.data.deck=[];for(var e=0;e<6;e++)null!=this.deck[e]&&c.data.deck.push(this.deck[e].getComponent("CardCollection").cfgId)}this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null,window.homeLayer.btnDeck.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardChangeLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0efbet/DcpBqY6/+LvJ5kbp","CardChangeLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,btns:[cc.Node],bg:cc.Node},init:function(e,t,i){window.changeLayer=this,this.cfgId=e,this.cfgId2=t,this.closeFunc=i,this.count=0,this.initDeck(),this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initDeck:function(){for(var e=0;e<c.data.deck.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.deck[e]),t.position=cc.v2(e%3*248-248,385-300*Math.floor(e/3)),this.bg.addChild(t)}},initCards:function(){var e=cc.instantiate(this.cardPrefab);if(e.getComponent("CardCollection").init(this.cfgId),e.position=cc.v2(0,-420),this.bg.addChild(e),this.cfgId2){e.x=-165;var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(this.cfgId2),t.position=cc.v2(165,-420),this.bg.addChild(t)}},onChange:function(e,t){this.btns[t].active=!1,0==this.count?(c.data.deck[t]=this.cfgId,this.count++,this.cfgId2||this.close()):(c.data.deck[t]=this.cfgId2,this.close()),cc.audioEngine.playEffect(window.sound.bingo)},close:function(){this.node.destroy(),window.changeLayer=null,this.closeFunc&&this.closeFunc()}}),cc._RF.pop()},{Game:"Game"}],CardCollection:[function(e,t,i){"use strict";cc._RF.push(t,"a28bfVp4ABL54sr47isHV8F","CardCollection");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,btn:cc.Button,box:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,markDelete:cc.Node,explode:cc.Node},init:function(e,t,i){this.cfgId=e,this.cfg=o.get("cfg_card",e);var a=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],s=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],n=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.element=this.cfg.element,this.btn.node.color=a[this.element-1],this.box.color=s[this.element-1],this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=n[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.txtDesc.string=c.analysisDesc(this.cfg.desc1);var r=this.cfg.require;if(r>=101&&r<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][r-101];for(var h=[[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][r-101],d=0;d<h.length;d++)this.createCircle(0,h[d])}else{this.requireNode.y-=8;for(var l=r.split(";"),f=(h=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][l.length-1],0);f<l.length;f++)this.createCircle(parseInt(l[f]),h[f])}null!=t&&(this.btn.interactable=!0,this.colletType=t),null!=i&&(this.explode.active=!0,-1==i?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(e,t){this.explode.getComponent(cc.Sprite).spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(e,t){this.explode.getComponent(cc.Sprite).spriteFrame=t}.bind(this)))},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.requireNode.addChild(i),e>0&&i.getComponent("RequireRound").refreshSatisfy(!0)},changeCollectType:function(){1==c.data.heroId&&3==c.data.difficulty||4==c.data.heroId&&2!=this.colletType||(0==this.colletType?window.bagLayer.unEquip(this.node):1==this.colletType?window.bagLayer.equip(this.node):2==this.colletType&&window.deleteLayer.confirm(this.cfgId))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardDeleteLayer:[function(e,t,i){"use strict";cc._RF.push(t,"ba205encTVLE4/a2/Sy3k6o","CardDeleteLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,content:cc.Node,confirmNode:cc.Node},onLoad:function(){window.deleteLayer=this,this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initCards:function(){c.data.cardBag.sort(function(e,t){return o.get("cfg_card",e).element==o.get("cfg_card",t).element?e-t:o.get("cfg_card",e).element-o.get("cfg_card",t).element});for(var e=0;e<c.data.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.cardBag[e],2),t.position=cc.v2(e%3*247-247,-120-210*Math.floor(e/3)),this.content.addChild(t)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+1120,this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},confirm:function(e){this.cardId=e,this.confirmNode.active=!0;var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(e,0,-1),t.getComponent("CardCollection").markDelete.active=!0,t.position=cc.v2(0,100),this.confirmNode.addChild(t),cc.audioEngine.playEffect(window.sound.btn1)},doCancel:function(){this.confirmNode.active=!1},doDelete:function(){var e=c.data.cardBag.indexOf(this.cardId);c.data.cardBag.splice(e,1),this.close(),cc.audioEngine.playEffect(window.sound.delete)},close:function(){this.node.destroy(),window.deleteLayer=null}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardManager:[function(e,t,i){"use strict";cc._RF.push(t,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var c=e("Game"),o=e("Config"),a={doCast:function(e,t){this.cfgId=e;var i=o.get("cfg_card",e);if(this.desc=i.desc,this.card=t,this.chaos=!1,1==i.target1||1==i.target2||1==i.target3)if(window.player.atkPlayed++,window.player.buff.chaos>0&&Math.random()<.5)window.player.buff.removeBuff(29,1),this.chaos=!0;else if(window.opponent.buff.dodge>0)return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("MISS",2),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(e)},doEffect:function(e,t,i){1==i&&this.chaos&&(i=2);var c=null,o=(c=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,a=window.player.buff,s=0,n=1;if((t+="")<0){for(var r=["A","B","C","D","E","F"],h=0,d=0;d<6;d++)if(this.desc.indexOf(r[d])>=0){h=d;break}s=window.player.elementList[h]*Math.abs(parseInt(t))}else{var l=t.split(";");if(8==e)s=parseInt(l[0]),n=parseInt(l[1]);else if(1==l.length)s=parseInt(t);else{var f=parseInt(l[0]),u=parseInt(l[1]);s=3==e&&window.player.equip.checkWithTrigger(120)?u:Math.floor(Math.random()*(u-f+1))+f}}if(e<10){if(1==i){if(s*=Math.pow(2,a.doubleDmg),a.removeBuff(107,a.doubleDmg),window.player.equip.wolfBlood&&a.addBuff(107,1),a.weak>0&&!window.player.equip.checkWithTrigger(65)){var p=.7;window.opponent.equip.checkWithTrigger(55)&&(p=.5),s=Math.floor(s*p)}1==window.player.atkPlayed&&window.player.equip.checkWithTrigger(100)&&(s*=2)}for(var m=0;m<n;m++)c.onHurt(s,0,e,i)}else 11==e?c.player.updateArmor(s):12==e?c.onHeal(s):14==e?c.addPower&&c.addPower(s):(13==e||e>=21)&&o.addBuff(e,s)},doSpecial:function(e){var t=window.opponent.buff,i=window.player.buff;if(132==e)this.doEffect(11,window.host.armor,2);else if(133==e)this.doEffect(7,Math.floor(window.host.armor/2),1);else if(134==e)this.doEffect(7,2*window.host.armor,1),window.player.updateArmor(-window.host.armor);else if(135==e)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==e)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==e)this.doEffect(7,Math.floor(window.host.hp/2),1);else if(138==e)i.addBuff(102,2);else if(139==e)i.addBuff(101,1);else if(140==e)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==e)null!=window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==e)null!=window.host.power&&(this.doEffect(11,window.host.power,2),window.host.addPower(-window.host.power));else if(143==e)null!=window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==e)this.doEffect(7,2*t.poison,1);else if(145==e)this.doEffect(7,4*t.poison,1),t.removeBuff(26,t.table[26]);else if(146==e)t.addBuff(26,t.poison);else if(147==e){for(var a=window.player.deck,s=0,n=0;n<a.length;n++){var r=o.get("cfg_card",a[n]);23!=r.effect1&&23!=r.effect2&&23!=r.effect3||s++}var h=20+4*s;this.doEffect(3,"4;"+h,1)}else if(148==e){var d=t.weak>0?20:10;this.doEffect(4,d,1)}else if(149==e)t.poison>0&&this.doEffect(26,2,1);else if(150==e){d=t.burn>0?16:8;this.doEffect(1,d,1)}else if(151==e)t.freeze>0&&this.doEffect(22,1,1);else if(152==e)t.silence>0&&this.doEffect(25,1,1);else if(e>=153&&e<=158){var l=[2,3,5,0,1,4][e-153];window.player.elementList[l]>=[2,2,2,3,3,3][e-153]&&this.doEffect(l+21,[1,1,2,2,2,1][e-153],1)}else if(e>=159&&e<=162)t.addBuff(Math.floor(10*Math.random())+21,162==e?2:1);else if(e>=163&&e<=166)this.doEffect(108,1,2);else if(167==e)i.multiCast++,i.multiCastMax++;else if(e>=168&&e<=171)this.doEffect(107,1,2);else if(172==e)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-t.freeze,1);else if(173==e)this.doEffect(21,window.opponent.deck.length-t.burn,1);else if(174==e)this.doEffect(1,6*t.burn,1);else if(175==e)this.doEffect(7,6*t.freeze,1);else if(176==e)this.doEffect(7,6*t.silence,1);else if(177==e)this.doEffect(7,4*t.frail,1);else if(178==e)this.doEffect(7,4*t.weak,1);else if(e>=179&&e<=182){d=(f=[1,6,6,10])[e-179]+(u=[3,2,3,4])[e-179]*(i.iteraList[e-179]-1);this.doEffect(7,d,1)}else if(e>=183&&e<=186){var f=[8,13,15,21],u=[3,3,4,5];s=Math.min(i.iteraList[e-179]-1,[2,4,3,4][e-183]),d=f[e-183]-u[e-183]*s;this.doEffect(7,d,1)}else if(187==e)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==e)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==e)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==e)this.doEffect(1,12+3*i.elementRoundCasted[0],1);else if(191==e)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==e)this.doEffect(3,12+3*i.elementRoundCasted[2],1);else if(193==e){if((s=Math.min(window.opponent.deck.length,6))>0){var p=Math.floor(Math.random()*s),m=window.opponent.deck[p];window.opponent.deck.splice(p,1),window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(194==e){if((s=Math.min(window.opponent.deck.length,6))>0){p=Math.floor(Math.random()*s),m=window.opponent.deck[p];window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(195==e){if((s=Math.min(window.opponent.deck.length,6))>0){p=Math.floor(Math.random()*s),m=window.opponent.deck[p];window.player.patchCard(m)}}else if(196==e){var g=c.getRandomCardId(2);window.player.patchCard(g,!0),window.player.deck.push(g)}else if(197==e){g=c.getRandomCardId(2);window.player.patchCard(g,null,!0)}else if(198==e||376==e){var w=function(){var e=window.player.patchCard();e&&(2!=e.getComponent("Card").element&&window.player.cardList.length<6?e.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){w()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&(window.mainLayer.gameOver||window.mainLayer.enemy.ai.check())}.bind(this),.8))}.bind(this);w()}else if(199==e)window.player.diceCount++,window.player.host.txtDice.string="\xd7"+window.player.diceCount,window.player.createExDice();else if(200==e)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==e){for(var y=21;y<=30;y++)i.removeBuff(y,i.table[y]);for(var v=0;v<window.player.cardList.length;v++)window.player.cardList[v].getComponent("Card").clear();for(var b=0;b<window.player.diceList.length;b++)window.player.diceList[b].getComponent("Dice").clear();window.player.checkElement()}else if(202==e){for(var C=0,x=21;x<=30;x++)t.table[x]>0&&C++;this.doEffect(7,6*C,1)}else if(203==e)window.player.addRollCount();else if(204==e)window.player.rollCount++,window.player.roll();else if(205==e){if(window.player.cardList.length>0){p=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[p].getComponent("Card").discard(),this.doEffect(7,15,1)}}else if(206==e||207==e){if(window.player.cardList.length>0){p=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[p].getComponent("Card").discard(null,!0),this.doEffect(7,206==e?25:30,1)}}else if(208==e){this.doEffect(7,5*window.player.cardList.length,1);for(var k=[],L=0;L<window.player.cardList.length;L++)k.push(window.player.cardList[L].getComponent("Card"));for(var I=0;I<k.length;I++)k[I].discard()}else if(e>=209&&e<=214){f=214==e?2:1;this.doEffect(e-209+21,f+i.iteraList2[e-209]-1,1)}else if(215==e)window.opponent.buff.burnIce=!0;else if(216==e)window.opponent.buff.silenceDark=!0;else if(217==e)c.data.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(218==e){g=c.getRandomCardId(2);window.player.patchCard(g)}else if(219==e)window.player.patchCard();else if(220==e)this.doEffect(3,2*window.player.atkRound-1,1);else if(221==e)i.selfHarmCast++,i.selfHarmCastMax++;else if(222==e)window.host.hpMax+=20,window.host.hp+=20,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(225==e||226==e)window.player.elementList[e-223]>=2&&this.doEffect(7,4,1);else if(227==e||228==e)window.player.elementList[e-225]>=3&&this.doEffect(11,4,2);else if(229==e)window.player.createExDice(3);else if(230==e)window.player.createExDice(4);else if(231==e)1==window.player.cardPlayedRound&&this.doEffect(23,1,1);else if(234==e){h=t.frail>0?30:20;this.doEffect(3,"4;"+h,1)}else if(235==e)i.creatDiceFire++;else if(236==e)window.player.addRollCount();else if(237==e)this.doEffect(7,Math.floor(window.host.hp/2),2),this.doEffect(7,Math.min(30,Math.floor(window.opponent.host.hp/2)),1);else if(238==e)this.doEffect(7,6+6*window.player.createDiceRound[4],1);else if(239==e)i.exCreateDice++;else if(342==e)t.weak>0&&this.doEffect(12,6,2);else if(382==e){window.player.addRollCount();k=[];for(var B=0;B<window.player.cardList.length;B++)k.push(window.player.cardList[B].getComponent("Card"));s=Math.min(k.length,3);for(var q=0;q<s;q++){k[S=Math.floor(Math.random()*k.length)].discard(),k.splice(S,1)}}else if(391==e){this.doEffect(11,5*window.player.cardList.length,2);k=[];for(var T=0;T<window.player.cardList.length;T++)k.push(window.player.cardList[T].getComponent("Card"));for(var E=0;E<k.length;E++)k[E].discard(null,!0)}else if(392==e)window.player.delayCard.push(392);else if(393==e){for(var N=0;N<window.player.diceList.length;N++)window.player.legacyDice.push(window.player.diceList[N].getComponent("Dice").element),window.player.dicePool.put(window.player.diceList[N]);window.player.diceList=[],window.player.checkElement(),window.host.checkBtnRoll()}else if(394==e)window.player.delayCard.push(394);else if(395==e){k=[];for(var R=0;R<window.player.cardList.length;R++)k.push(window.player.cardList[R].getComponent("Card"));s=Math.min(k.length,2);for(var M=0;M<s;M++){var S;k[S=Math.floor(Math.random()*k.length)].discard(null,!0),k.splice(S,1),window.player.createExDice()}}else if(396==e)window.player.delayCard.push(396);else if(397==e)for(var F=0;F<2;F++)window.player.createExDice(),window.player.deck.push(224),window.player.deckArray&&window.player.deckArray.push(224);else if(398==e)this.doEffect(7,5*window.player.diceList.length,1);else if(399==e){k=[];for(var A=0;A<window.player.cardList.length;A++){var D=window.player.cardList[A].getComponent("Card");1==D.element&&k.push(D)}if(k.length>0){var P=k[Math.floor(Math.random()*k.length)];this.doCast(P.cfgId)}}else if(400==e){k=[];for(var _=0;_<window.player.cardList.length;_++){var H=window.player.cardList[_].getComponent("Card");2==H.element&&k.push(H)}if(k.length>0)k[Math.floor(Math.random()*k.length)].discard()}else if(401==e)i.doubleWind=!0;else if(402==e){k=[];for(var G=0;G<window.player.cardList.length;G++){var O=window.player.cardList[G].getComponent("Card");4==O.element&&k.push(O)}if(k.length>0)k[Math.floor(Math.random()*k.length)].discard(null,!0)}else if(403==e){if(W=window.player.deckArray)for(var z=0;z<W.length;z++)if(5==o.get("cfg_card",W[z]).element){window.player.patchCard(W[z],!0)&&W.splice(z,1);break}}else if(405==e)1==window.player.cardPlayedRound&&window.player.createExDice(1,!0);else if(406==e)window.player.diceList.length<=0&&window.player.createExDice(2,!0);else if(407==e){var W;if(W=window.player.deckArray)for(var U=0;U<W.length;U++){var Y=o.get("cfg_card",W[U]);if(11==Y.effect1||11==Y.effect2||11==Y.effect3){window.player.patchCard(W[U],!0)&&W.splice(U,1);break}}}else if(408==e)window.opponent.host.armor>0&&window.opponent.updateArmor(-window.opponent.host.armor);else if(409==e)if(0==window.player.index){for(var j=0;j<=0;){var J=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1,K=o.get("cfg_item",J);K.get<3&&(0==K.hero||4==K.hero)&&K.battle&&0==K.num&&(j=J)}window.player.equip.addEquip(j)}else{var V=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1;window.player.equip.addEquip(V)}else 410==e&&(0==window.player.index?this.doEffect(7,3*c.data.equip.length,1):this.doEffect(7,3*window.host.equipList.length,1))},doDiscard:function(e){383==e?this.doEffect(1,12,1):384==e?this.doEffect(2,12,1):385==e?this.doEffect(3,12,1):386==e?this.doEffect(11,12,2):387==e?this.doEffect(12,10,2):388==e?this.doEffect(9,8,1):389==e?this.doEffect(22,3,1):390==e&&this.doEffect(27,2,1)},doDelayEffect:function(e){392==e?null!=window.host.power&&this.doEffect(7,2*window.host.power,1):394==e?(window.player.buff.addBuff(104,3),window.player.buff.tempBuff[1]+=3):396==e&&(window.player.extraDice+=2)}};t.exports=a,cc._RF.pop()},{Config:"Config",Game:"Game"}],CardTavern:[function(e,t,i){"use strict";cc._RF.push(t,"a4f5bK9YrVNG5vdkkTG5T0R","CardTavern");var c=e("Game"),o=e("Config");e("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,bg:cc.Node,box:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(e,t){this.cfgId=e,this.index=t,this.pos=cc.v2(t%3,Math.floor(t/3)),this.node.position=cc.v2(248*this.pos.x-248,95-206*this.pos.y-500),this.node.opacity=1;var i=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-206*this.pos.y+20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(1-this.pos.y)),i,cc.moveBy(.05,cc.v2(0,-20)))),this.cfg=o.get("cfg_tavern",e),this.element=this.cfg.element,this.require=this.cfg.require,this.initInfo(),this.mask.active=!0,this.bg.active=!0,this.animationDiscard.node.active=!1,this.usable=!1},initInfo:function(){var e=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],t=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],i=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.bg.color=e[this.element-1],this.box.color=t[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name;var o=c.analysisDesc(this.cfg.desc1);this.txtDesc.string=o,this.circleNode.removeAllChildren(),this.requireCircles=[];var a=this.cfg.require;if(this.requireNode.y=0,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),a>=100&&a<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][a-100];for(var s=[[0],[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][a-100],n=0;n<s.length;n++)this.createCircle(0,s[n])}else{this.txtRequire.string="",this.requireNode.y-=8;for(var r=a.split(";"),h=(s=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][r.length-1],0);h<r.length;h++){this.createCircle(parseInt(r[h]),s[h]).zIndex=4-h}}},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},checkRequire:function(){if(this.usable)return!0;var e=!1,t=window.player.elementList.concat();if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],c=102==this.require?2:1,o=[],a=0;a<6;a++)t[a]>=i[this.require-100]&&(c--,o.push(a+1)),102==this.require&&t[a]>=4&&(c-=2,o.push(a+1),o.push(a+1));if(c<=0&&(e=!0),102!=this.require){var s=0,n=this.requireCircles[0].getComponent("RequireRound").element;if(n)o.indexOf(n)<0&&(s=o.length>0?1:-1);else o.length>0&&(s=1);for(var r=0;r<this.requireCircles.length;r++){var h=this.requireCircles[r].getComponent("RequireRound");1==s?(h.refreshElement(o[0]),h.refreshSatisfy(!0)):-1==s&&h.hideElement()}}else{var d,l=[null,null],f=[0,0],u=this.requireCircles[0].getComponent("RequireRound").element,p=this.requireCircles[2].getComponent("RequireRound").element;if(u)(d=o.indexOf(u))>=0&&(l[0]=0,o.splice(d,1),f[0]=u);if(p)(d=o.indexOf(p))>=0&&(l[1]=0,o.splice(d,1),f[1]=u);for(var m=0;m<2;m++){if(null==l[m])(0==m?u:p)?o.length>0?(l[m]=1,f[m]=o[0],o.splice(0,1)):l[m]=-1:o.length>0?(l[m]=1,f[m]=o[0],o.splice(0,1)):l[m]=0}for(var g=0;g<this.requireCircles.length;g++){var w=this.requireCircles[g].getComponent("RequireRound"),y=g<2?0:1;1==l[y]?(w.refreshElement(f[y]),w.refreshSatisfy(!0)):-1==l[y]&&w.hideElement()}}}else{for(var v=[0,0,0,0,0,0],b=this.require.split(";"),C=0;C<b.length;C++)v[b[C]-1]++;e=!0;for(var x=0;x<6;x++)if(t[x]<v[x]){e=!1;break}for(var k=0;k<this.requireCircles.length;k++){var L=this.requireCircles[k].getComponent("RequireRound");t[L.element-1]>0?(L.refreshSatisfy(!0),t[L.element-1]--):L.refreshSatisfy(!1)}}if(this.usable=e,e){this.mask.active=!1;for(var I=0;I<this.requireCircles.length;I++){this.requireCircles[I].getComponent("RequireRound").bingo()}cc.audioEngine.playEffect(window.sound.bingo)}else this.mask.active=!0;return e},discard:function(){this.bg.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.LOOP_COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(window.sound.discardSound);var e=window.player.cardList.indexOf(this.node);e>=0&&window.player.cardList.splice(e,1)}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Card:[function(e,t,i){"use strict";cc._RF.push(t,"cfa35/uH59ANIsjw79G+feg","Card");var c=e("Game"),o=e("Config"),a=e("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,box:cc.Node,fires:dragonBones.ArmatureDisplay,nodeSilence:cc.Node,markSilence:cc.Node,markDelete:cc.Node,animationCursed:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,animationCounter:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(e,t,i){this.cfgId=e,this.index=t,this.buffId=i,this.pos=cc.v2(t%3,Math.floor(t/3)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(248*this.pos.x-248,95-206*this.pos.y-500*this.delta),this.btn.interactable=!1,this.node.opacity=1;var a=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-206*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(0==window.mainLayer.roundId?1-this.pos.y:this.pos.y)),a,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),this.cfg=o.get("cfg_card",e),this.element=this.cfg.element,this.initInfo(),this.mask.active=!0,this.btn.node.active=!0,this.nodeSilence.active=this.fires.node.active=this.animationCursed.active=this.animationDiscard.node.active=this.animationCounter.active=this.markDelete.active=!1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1,this.hasCopy=!1,this.unCost=!1,this.rate=1;var s=this.require=this.cfg.require;if(s>=100&&s<=107){this.rate=[1,1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][s-100]}else{this.rate=[1/6,1/36,1/216,1/1296,1/7776][s.split(";").length-1]}0==window.mainLayer.roundId&&4==c.data.heroId&&this.disCost(!0)},initInfo:function(){var e=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],t=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],i=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.btn.node.color=e[this.element-1],this.box.color=t[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.initDesc(),this.circleNode.removeAllChildren(),this.requireCircles=[];var c=this.cfg.require;if(this.requireNode.y=0,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),c>=100&&c<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][c-100];for(var o=[[0],[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][c-100],a=0;a<o.length;a++)this.createCircle(0,o[a])}else{this.txtRequire.string="",this.requireNode.y-=8;for(var s=c.split(";"),n=(o=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][s.length-1],0);n<s.length;n++){this.createCircle(parseInt(s[n]),o[n]).zIndex=4-n}}},initWithCopy:function(e,t){this.cfgId=e,this.pos=t,this.isCopy=!0,this.isTemp=!0,this.cfg=o.get("cfg_card",e),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(e){this.usable=!1,this.btn.interactable=!1;var t=e?.3:0;this.scheduleOnce(function(){if(0==window.mainLayer.roundId){var e=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{e=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var t=window.player.cardList.indexOf(this.node);t>=0&&(window.player.cardList.splice(t,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}.bind(this),t)},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},initBuff:function(){6==this.element&&window.opponent.equip.checkWithTrigger(172)&&(this.buffId=25);var e=this.buffId;this.burn=21==e,this.burn?(this.fires.node.active=!0,this.fires.playAnimation("play0",0),cc.audioEngine.playEffect(window.sound.burnSound)):this.fires.node.active=!1,this.silence=25==e,this.silence?(this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.nodeSilence.active=!0}.bind(this)))),this.titles[1].active=!1,this.markSilence.stopAllActions(),this.markSilence.y=130,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5))),cc.audioEngine.playEffect(window.sound.blackSound)):(this.nodeSilence.active=!1,this.titles[1].active=3==this.cfg.quality)},checkRequire:function(){var e=!1,t=window.player.elementList.concat();if(0==window.player.index&&4==c.data.heroId)e=this.element<7?t[this.element-1]>0:window.player.diceList.length>0;else if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],o=102==this.require?2:1,a=[],s=0;s<6;s++)t[s]>=i[this.require-100]&&(o--,a.push(s+1)),102==this.require&&t[s]>=4&&(o-=2,a.push(s+1),a.push(s+1));if(o<=0&&(e=!0),102!=this.require){var n=0,r=this.requireCircles[0].getComponent("RequireRound").element;if(r)a.indexOf(r)<0&&(n=a.length>0?1:-1);else a.length>0&&(n=1);for(var h=0;h<this.requireCircles.length;h++){var d=this.requireCircles[h].getComponent("RequireRound");1==n?(d.refreshElement(a[0]),d.refreshSatisfy(!0)):-1==n&&d.hideElement()}}else{var l,f=[null,null],u=[0,0],p=this.requireCircles[0].getComponent("RequireRound").element,m=this.requireCircles[2].getComponent("RequireRound").element;if(p)(l=a.indexOf(p))>=0&&(f[0]=0,a.splice(l,1),u[0]=p);if(m)(l=a.indexOf(m))>=0&&(f[1]=0,a.splice(l,1),u[1]=p);for(var g=0;g<2;g++){if(null==f[g])(0==g?p:m)?a.length>0?(f[g]=1,u[g]=a[0],a.splice(0,1)):f[g]=-1:a.length>0?(f[g]=1,u[g]=a[0],a.splice(0,1)):f[g]=0}for(var w=0;w<this.requireCircles.length;w++){var y=this.requireCircles[w].getComponent("RequireRound"),v=w<2?0:1;1==f[v]?(y.refreshElement(u[v]),y.refreshSatisfy(!0)):-1==f[v]&&y.hideElement()}}}else{for(var b=[0,0,0,0,0,0],C=this.require.split(";"),x=0;x<C.length;x++)b[C[x]-1]++;e=!0;for(var k=0;k<6;k++)if(t[k]<b[k]){e=!1;break}for(var L=0;L<this.requireCircles.length;L++){var I=this.requireCircles[L].getComponent("RequireRound");t[I.element-1]>0?(I.refreshSatisfy(!0),t[I.element-1]--):I.refreshSatisfy(!1)}}return this.unCost&&(e=!0),this.silence&&(e=!1),224==this.cfgId&&(e=!1),this.usable=e,e?(this.mask.active=!1,this.btn.interactable=!0):this.silence?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),e},doCast:function(){this.usable&&0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?(this.btn.node.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound),cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c")):this.silence?(this.markSilence.stopAllActions(),this.markSilence.y=90,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,15)),cc.delayTime(.5),cc.fadeOut(.5)))):(this.cast(),window.guide&&window.guide.close()))},cast:function(){if(0==window.mainLayer.roundId){if(this.cfgId>=205&&this.cfgId<=208&&!window.player.cardUsabled)return}else if(!window.player.cardUsabled)return;this.burn&&window.host.onHurt(3,1,21,0);var e=!1,t=!1;if(0==window.player.cardPlayedRound&&window.opponent.equip.trigger(127)?(t=!0,e=!0):window.player.buff.curse&&Math.random()<.5&&!window.player.equip.checkWithTrigger(107)&&(e=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.trigger(108)),this.btn.interactable=!1,window.player.cardUsabled=!1,e)this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1;var e=cc.instantiate(t?this.animationCounter:this.animationCursed);e.active=!0,e.parent=window.player.boxCard,e.position=this.node.position.add(cc.v2(10,-10)),e.zIndex=100,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("play0"),e.getComponent(dragonBones.ArmatureDisplay).on(dragonBones.EventObject.LOOP_COMPLETE,function(){e.destroy()}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(t?0:.1),cc.callFunc(function(){this.maskBlack.active=!1,this.endCast(),198!=this.cfgId&&376!=this.cfgId||1!=window.mainLayer.roundId||this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.5)}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(t?window.sound.counterSound:window.sound.curseSound),window.player.equip.luckyCard>0&&(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43)),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1));else{var i=cc.spawn(cc.moveBy(.05,cc.v2(0,-20)),cc.scaleTo(.05,1)),o=cc.moveBy(.35,cc.v2(0,1100)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),i,o,cc.callFunc(function(){window.mainLayer.gameOver||(a.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var s=window.player.cardList.indexOf(this.node);s>=0&&(window.player.cardList.splice(s,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var n=0;n<3;n++)if(this.cfg["effect"+(n+1)]<10&&1==this.cfg["target"+(n+1)]){var r=1;8==this.cfg["effect"+(n+1)]&&(r=parseInt(this.cfg["num"+(n+1)].split(";")[1])),window.player.atkRound+=r}for(var h=0;h<window.player.cardList.length;h++){var d=window.player.cardList[h].getComponent("Card");(d.cfgId>=179&&d.cfgId<=186||d.cfgId>=209&&d.cfgId<=214||220==d.cfgId)&&d.initDesc(),232==d.cfgId&&Math.random()<.2&&window.opponent.buff.addBuff(23,1)}e||this.isCopy||(this.cfgId<163||this.cfgId>166)&&(3==this.element&&window.player.buff.doubleWind?(this.reuse(),window.player.buff.doubleWind=!1):233==this.cfgId&&window.opponent.buff.frail>0?this.reuse():window.player.buff.selfHarmCast>0&&this.cfg.effect1<10&&2==this.cfg.target1?(window.player.buff.selfHarmCast--,this.reuse()):window.player.buff.doubleCast>0?(window.player.buff.removeBuff(108,1),this.reuse()):window.player.equip.luckyCard>0?(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1)):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)&&167!=this.cfgId?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)?this.reuse():Math.random()<.3&&window.player.equip.checkWithTrigger(149)&&this.reuse()),this.isRemove&&this.doDelete(),this.isCopy||(window.player.cardPlayed++,window.player.cardPlayedRound++),0==window.player.index&&(4==c.data.heroId?(window.player.deleteDice(this.element),2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId))):2==c.data.heroId&&window.player.randomCard&&window.player.randomCard==this.node&&(window.player.randomCard=null))},endCast:function(){if(!this.isCopy){var e=window.player.equip;if(e.trigger(1),e.trigger(4),e.trigger(97),e.trigger(153),e.trigger(169),this.cfg.element<=6&&e.trigger(this.cfg.element+77),2==this.cfg.element&&e.trigger(157),window.opponent.equip.trigger(24),window.opponent.equip.trigger(166),window.player.cardPlayed%4==0&&window.opponent.equip.trigger(144),this.isRemove&&window.player.equip.trigger(183),0==window.player.index&&(2==c.data.heroId?2==c.data.difficulty?(window.player.rollCount++,window.player.roll()):window.player.addRollCount():4==c.data.heroId&&(window.player.suppleCard(),c.data.cardPlayed[this.cfgId]?c.data.cardPlayed[this.cfgId]++:c.data.cardPlayed[this.cfgId]=1)),window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.selfHarmCastMax>0&&window.player.buff.selfHarmCast<=0&&(window.player.buff.selfHarmCast=window.player.buff.selfHarmCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++,window.player.equip.elementPlayed[this.cfg.element-1]++,window.player.equip.trigger(184),window.player.equip.trigger(185),6==this.element&&window.player.buff.darkRedice>0)for(var t=0;t<window.player.buff.darkRedice;t++)window.player.createExDice(6,!0);window.player.buff.darkRedice=0,404==this.cfgId&&window.player.buff.darkRedice++}window.player.cardPool.put(this.node),window.player.cardUsabled=!0,1!=window.mainLayer.roundId||this.hasCopy||198!=this.cfgId&&376!=this.cfgId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.6),6==c.data.guide&&2==window.player.cardPlayedRound?window.mainLayer.showGuide(6):10==c.data.guide&&3==window.player.cardPlayedRound&&window.mainLayer.showGuide(10)},discard:function(e,t){this.btn.interactable=!1,this.btn.node.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.LOOP_COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(window.sound.discardSound);var i=window.player.cardList.indexOf(this.node);i>=0&&(window.player.cardList.splice(i,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll()),t?(this.markDelete.active=!0,this.markDelete.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5)))):4==c.data.heroId&&2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId)),e||t?t&&this.doDelete():(a.doDiscard(this.cfgId),window.player.equip.trigger(22),window.player.equip.trigger(182)),0==window.player.index&&4==c.data.heroId&&window.player.suppleCard()},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),window.player.equip.trigger(181),!this.isTemp){var e=window.player.deck.indexOf(this.cfgId);e>=0&&window.player.deck.splice(e,1)}},reuse:function(){var e=cc.instantiate(this.node);e.position=this.node.position,window.player.boxCard.addChild(e,this.node.zIndex-1),e.getComponent("Card").initWithCopy(this.cfgId,this.pos),this.hasCopy=!0,e.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){e.getComponent("Card").cast()}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},initDesc:function(){var e=c.analysisDesc(this.cfg.desc1);if(147==this.cfgId){for(var t=window.player.deck,i=0,a=0;a<t.length;a++){var s=o.get("cfg_card",t[a]);23!=s.effect1&&23!=s.effect2&&23!=s.effect3||i++}e+="<color=#EBC82E>  (\u4e0a\u9650"+(20+4*i)+")</c>"}else if(this.cfgId>=179&&this.cfgId<=182){var n=[3,2,3,4];e+="<color=#EBC82E>  (\u5f53\u524d"+((r=[1,6,6,10])[this.cfgId-179]+n[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var r=[8,13,15,21];n=[3,3,4,5],i=Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,3,4][this.cfgId-183]);e+="<color=#EBC82E>  (\u5f53\u524d"+(r[this.cfgId-183]-n[this.cfgId-183]*i)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){e+="<color=#EBC82E>  (\u5f53\u524d"+((r=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}else 220==this.cfgId?e+="<color=#EBC82E>  (\u5f53\u524d"+(2*window.player.atkRound+1)+")</c>":238==this.cfgId&&(e+="<color=#EBC82E>  (\u5f53\u524d"+(6+6*window.player.createDiceRound[4])+")</c>");this.txtDesc.string=e},disCost:function(e){e||(this.unCost=!0);for(var t=0;t<this.requireCircles.length;t++){var i=this.requireCircles[t].getComponent("RequireRound");i.disCost(),this.require>=100&&this.require<=105&&i.hideElement()}},discribeRandom:function(){this.txtTitle.string=this.txtTitle2.string=this.cfg.name+"*"}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Chess:[function(e,t,i){"use strict";cc._RF.push(t,"52ab21v1YlCW5nnj9YYUNmp","Chess");var c=e("Utils"),o=e("Game");cc.Class({extends:cc.Component,properties:{figureNode:cc.Node,figures:[cc.Node],waterNode:cc.Node,waterFigures:[cc.Node]},onLoad:function(){this.speed=800,this.distances=[0,100,80,120,100,160,160,100,100]},come:function(e,t){this.from=e,this.roomType=o.data.roomType,this.node.position=c.getDirectionVector(e,320);var i=c.getDirectionVector(e,this.distances[this.roomType]);this.node.runAction(cc.sequence(cc.moveTo(320/this.speed,i),cc.callFunc(t))),this.refreshDiration(e,1)},stay:function(e){this.from=e,this.roomType=o.data.roomType;this.node.position=c.getDirectionVector(e,[0,0,0,120,100,160,160,0,0][this.roomType]),this.refreshDiration(e,1)},leave:function(e,t){this.farward=e,this.callBack=t;var i=c.getDirectionVector(e,320);if(this.roomType<=2||this.roomType>=7)this.refreshDiration(e),this.node.runAction(cc.sequence(cc.moveTo(320/this.speed,i),cc.callFunc(t)));else{if(this.from==(e+2)%4)if(0==e||2==e){var o=Math.random()<.5?1:3;this.stepList=[o,e,e,4-o]}else this.stepList=[2,e,e,0];else this.stepList=[e,(this.from+2)%4];this.doStep()}},doStep:function(){if(this.stepList.length>0)this.walk(this.stepList.shift());else{this.refreshDiration(this.farward);var e=c.getDirectionVector(this.farward,320),t=e.sub(this.node.position).mag();this.node.runAction(cc.sequence(cc.moveTo(t/this.speed,e),cc.callFunc(this.callBack)))}},walk:function(e){var t=this.distances[this.roomType];this.refreshDiration(e),this.node.runAction(cc.sequence(cc.moveBy(t/this.speed*1.2,c.getDirectionVector(e,t)),cc.callFunc(function(){this.doStep()}.bind(this))))},refreshDiration:function(e,t){var i=t?(e+2)%4:e;this.refreshFace(i),0==e?this.node.zIndex--:2==e&&this.node.zIndex++},refreshFace:function(e){for(var t=0;t<4;t++)this.figures[t].active=e==t,2==this.roomType&&(this.waterFigures[t].active=e==t)},centerial:function(){var e=this.node.position.mag()/this.speed;this.node.runAction(cc.moveTo(e,cc.v2()))},update:function(){2==this.roomType&&(this.figureNode.active?this.node.position.mag()<140&&(this.figureNode.active=!1,this.waterNode.active=!0):this.waterNode.active&&this.node.position.mag()>140&&(this.figureNode.active=!0,this.waterNode.active=!1))}}),cc._RF.pop()},{Game:"Game",Utils:"Utils"}],Chest:[function(e,t,i){"use strict";cc._RF.push(t,"282832AcdZFNov+QpH9gQcZ","Chest");var c=e("Utils");cc.Class({extends:cc.Component,properties:{txtRequire:cc.RichText,btn:cc.Button},init:function(e){this.index=e,this.node.position=cc.v2(240*e-240,-500),this.btn.node.color=cc.Color.GRAY,this.node.opacity=1;var t=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.3),t,cc.moveBy(.05,cc.v2(0,-20)))),this.satisfied=[!1,!1,!1,!1,!1,!1],this.requireList=c.getDifferentRandomNum(4,6,1),this.refreshRequire()},refreshRequire:function(){this.usable=!0;for(var e="",t=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],i=0;i<this.requireList.length;i++){var c=this.requireList[i];this.satisfied[c-1]?e+="<color=#EBC82E>"+t[c-1]+"</c>":(e+="<color=#000000>"+t[c-1]+"</c>",this.usable=!1)}this.txtRequire.string=e,this.usable&&(this.btn.interactable=!0,this.btn.node.color=cc.Color.WHITE)},remove:function(){this.btn.interactable=!1;var e=cc.moveBy(.2,cc.v2(0,-500));this.node.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.1,cc.v2(0,20)),e,cc.callFunc(function(){this.node.destroy()}.bind(this)))),window.player.chestList[this.index]=null},checkRequire:function(){for(var e=window.player.elementList,t=0;t<6;t++)e[t]>0&&!this.satisfied[t]&&(this.satisfied[t]=!0);this.refreshRequire()},doCast:function(){this.remove();for(var e=0;e<6;e++)window.player.patchCard()}}),cc._RF.pop()},{Utils:"Utils"}],ChooseDiceLayer:[function(e,t,i){"use strict";cc._RF.push(t,"a7b85fk8JhBnoBwYoqOsmoi","ChooseDiceLayer"),cc.Class({extends:cc.Component,properties:{mask:cc.Node,diceNode:cc.Node,dice:cc.Prefab},onLoad:function(){window.chooseDiceLayer=this,this.mask.opacity=10,this.mask.runAction(cc.fadeTo(.2,120)),this.createDice()},createDice:function(){var e=[];for(window.player.buff.creatDiceFire>0&&(e.push(1),window.player.buff.creatDiceFire--);e.length<3;){var t=Math.floor(6*Math.random())+1;e.indexOf(t)<0&&e.push(t)}for(var i=0;i<3;i++){var c=cc.instantiate(this.dice);c.x=425,this.diceNode.addChild(c),c.getComponent("DiceChoose").init(e[i],i)}},close:function(){window.chooseDiceLayer=null,this.node.destroy()}}),cc._RF.pop()},{}],CompleteLayer:[function(e,t,i){"use strict";cc._RF.push(t,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var c=e("Game"),o=e("Utils"),a=e("Config");cc.Class({extends:cc.Component,properties:{markOccupation:cc.Sprite,txtName:cc.Label,txtDuration:cc.Label,heads:[cc.Sprite],txtTime:cc.Label,cardPrefab:cc.Prefab,cardNode:cc.Node,itemNode:cc.Node,btnRestart:cc.Node,itemPrefab:cc.Prefab},onLoad:function(){window.completeLayer=this;var e=new Date,t=e.getTime()-c.data.startTime;this.txtDuration.string=o.timeFormat(t,2);var i=function(e){return e<10?"0"+e:e};this.txtTime.string=e.getFullYear()+"-"+i(e.getMonth()+1)+"-"+i(e.getDate())+" "+i(e.getHours())+":"+i(e.getMinutes()),this.initMonster(),this.initDeck(),this.initEquip(),this.btnRestart.y-=280,this.btnRestart.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(0,280))));this.txtName.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1]+"("+["\u666e\u901a","\u56f0\u96be","\u9ad8\u624b","\u5927\u5e08","\u82e6\u75db"][c.data.difficulty-1]+")",cc.audioEngine.playEffect(window.sound.cheer),cc.audioEngine.playMusic(window.sound.bgmComplete,!0)},initMonster:function(){for(var e=this,t=[],i=0;i<c.data.monsterBeats.length;i++){var o=c.data.monsterBeats[i];a.get("cfg_monster",o).type>=2&&t.push(o)}for(var s=function(i){var c=e.heads[i];cc.loader.loadRes("Texture/monster/head/"+t[i],cc.SpriteFrame,function(e,t){c.spriteFrame=t}.bind(e))},n=0;n<t.length;n++)s(n)},initDeck:function(){if(this.deck=[],4==c.data.heroId){var e=[];for(var t in c.data.cardPlayed){var i=[t,c.data.cardPlayed[t]];e.push(i)}e.sort(function(e,t){return t[1]-e[1]});for(var o=Math.min(e.length,6),a=0;a<o;a++)this.deck.push(e[a][0])}else this.deck=c.data.deck;for(var s=0;s<this.deck.length;s++){var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(this.deck[s],0),n.position=cc.v2(s%3*247-247,105-210*Math.floor(s/3)),this.cardNode.addChild(n),n.y-=1e3,n.runAction(cc.sequence(cc.delayTime(s<3?.2:0),cc.moveBy(.3,cc.v2(0,1e3))))}},initEquip:function(){for(var e=Math.max(Math.ceil(c.data.equip.length/2),6),t=600/(e-1),i=0;i<c.data.equip.length;i++){var o=c.data.equip[i],a=cc.instantiate(this.itemPrefab);a.getComponent("Item").init(o,null,!0),a.position=cc.v2(i%e*t-300,50-100*Math.floor(i/e)),this.itemNode.addChild(a)}this.itemNode.y-=480,this.itemNode.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.2,cc.v2(0,480))))},restart:function(){window.completeLayer=null;var e=c.data.guide;c.setDataToBase(),c.data.guide=e,c.data.guideBag=-1,cc.director.loadScene("prepare")}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],Config:[function(e,t,i){"use strict";cc._RF.push(t,"e9b6cHrlOtILogPlENB3GXp","Config");var c={jsonTable:{},load:function(e){for(var t=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event","cfg_hero","cfg_tavern"],c=0,o=function(o){s="Config/"+i[o],cc.loader.loadRes(s,function(t,a){this.jsonTable[i[o]]=a.json,(c+=1)==i.length&&e()}.bind(t))},a=0;a<i.length;a++){var s;o(a)}},get:function(e,t){return this.jsonTable[e][t]}};t.exports=c,cc._RF.pop()},{}],Cover:[function(e,t,i){"use strict";cc._RF.push(t,"ae1236WRt5CIb6OKjZX1HCw","Cover");var c=e("Game");cc.Class({extends:cc.Component,properties:{sky:cc.Node,moon:cc.Node,shadow:cc.Node,smoke:cc.Node,rail2:cc.Node,house2:cc.Node,house1:cc.Node,bg:cc.Node,light:cc.Node,player:cc.Node,player2:cc.Node,table:cc.Node,spider:cc.Node,rail:cc.Node,tree:cc.Node,title:cc.Node,books:[cc.Node],btnStart:cc.Node,btnNew:cc.Node,btnContinue:cc.Node,mask:cc.Node,words:[cc.Node]},onLoad:function(){this.show=!1,this.doActions()},doActions:function(){this.correctedHeight=(cc.winSize.height/cc.winSize.width*750-1334)/2,this.images=[this.sky,this.moon,this.shadow,this.smoke,this.rail2,this.house2,this.house1,this.bg,this.light,this.player,this.player2,this.table,this.rail,this.tree,this.title],this.pathLength=[556,367,2068,1674,2164,2584,2701,2578,2526,2355,2938,2990,2659,3400,2846],this.tops=[224,557,978,885,892,1187,1290,0,574,73,-144,-488,865,2358,840],this.speed=.4,this.speedUp=1,this.doReady()},updateFrame:function(){this.speed>1.2&&(this.speedUp=-1),this.speed+=.7/300*this.speedUp,this.speed=Math.max(.35,this.speed);for(var e=0;e<15;e++)this.images[e].y>=this.tops[e]-this.correctedHeight?(this.images[e].y=this.tops[e]-this.correctedHeight,9!=e||this.show||this.doBtns()):this.images[e].y+=(this.pathLength[e]-this.correctedHeight)/600*this.speed},doBtns:function(){this.show=!0;for(var e=0;e<3;e++){var t=this.books[e];t.scale=1.1,t.y+=30,t.runAction(cc.sequence(cc.fadeIn(.15),cc.spawn(cc.scaleTo(.5,1).easing(cc.easeIn(5)),cc.moveBy(.5,cc.v2(0,-30)).easing(cc.easeIn(5)))))}var i=cc.sequence(cc.delayTime(.15),cc.moveBy(.3,cc.v2(0,30)),cc.delayTime(.15),cc.moveBy(.3,cc.v2(0,-30))).repeatForever();this.spider.runAction(cc.sequence(cc.moveBy(.2,cc.v2(0,-130-2*this.correctedHeight)),cc.callFunc(function(){this.spider.runAction(i)}.bind(this)))),this.scheduleOnce(function(){for(var e=0;e<3;e++)this.words[e].y-=40,this.words[e].runAction(cc.spawn(cc.fadeIn(.3),cc.moveBy(.3,cc.v2(0,40))))}.bind(this),.6),this.scheduleOnce(function(){1==c.data.castle&&1==c.data.floor?(this.btnStart.active=!0,this.btnStart.scale=.5,this.btnStart.runAction(cc.sequence(cc.scaleTo(.3,1.1),cc.scaleTo(.3,1)))):(this.btnNew.active=!0,this.btnNew.scale=.5,this.btnContinue.active=!0,this.btnContinue.scale=.5,this.btnNew.runAction(cc.sequence(cc.scaleTo(.3,1.1),cc.scaleTo(.3,1))),this.btnContinue.runAction(cc.sequence(cc.scaleTo(.3,1.1),cc.scaleTo(.3,1))))}.bind(this),1)},doReady:function(){this.scheduleOnce(function(){for(var e=0;e<15;e++)this.images[e].y=this.tops[e]-this.correctedHeight;this.doBtns()}.bind(this),.01)},newGame:function(){this.mask.active=!0;var e=c.data.guide;c.setDataToBase(),c.data.guide=e,c.data.guideBag=-1,c.data.guide>=0?(c.begin=!0,c.data.startTime=Date.now(),c.data.restartCount=999,cc.director.loadScene("helloworld")):cc.director.loadScene("prepare")},continue:function(){this.mask.active=!0,cc.director.loadScene("helloworld")},goGuide:function(){this.mask.active=!0,c.data.guide=0,c.begin=!0,cc.director.loadScene("helloworld")},clean:function(){c.setDataToBase()}}),cc._RF.pop()},{Game:"Game"}],DiceChoose:[function(e,t,i){"use strict";cc._RF.push(t,"2f252xYsv5IdrGnewf/1jBc","DiceChoose");var c=e("Game");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.element=e,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var i=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=i[this.element-1],this.node.runAction(cc.moveTo(.2,cc.v2(110*t-110,0)))},choose:function(){if(5==c.data.difficulty){var e=Math.floor(10*Math.random())+21;if(21==e){for(var t=[],i=window.player.cardList,o=0;o<i.length;o++){var a=i[o].getComponent("Card");a.burn||a.silence||t.push(a)}if(t.length>0){var s=t[Math.floor(Math.random()*t.length)];s.buffId=21,s.initBuff()}else window.player.buff.addBuff(21,1)}else if(25==e){t=[];for(var n=window.player.cardList,r=0;r<n.length;r++){var h=n[r].getComponent("Card");h.silence||t.push(h)}if(t.length>0){var d=t[Math.floor(Math.random()*t.length)];d.buffId=25,d.initBuff()}else window.player.buff.addBuff(25,1)}else window.player.buff.addBuff(e,1)}for(var l=1+window.player.buff.exCreateDice,f=0;f<l;f++)window.player.createExDice(this.element,!0,!0);window.player.endRoll(),window.player.buff.exCreateDice=0,3==c.data.difficulty&&(window.player.diceCount+=l),window.player.createDiceRound[this.element-1]++;for(var u=0;u<window.player.cardList.length;u++){var p=window.player.cardList[u].getComponent("Card");238==p.cfgId&&p.initDesc()}window.chooseDiceLayer.close()}}),cc._RF.pop()},{Game:"Game"}],DiceTavern:[function(e,t,i){"use strict";cc._RF.push(t,"2a3b72qgEZPdL0PbR9yMWKz","DiceTavern"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,mask:cc.Node},onLoad:function(){this.holded=!1,this.element=0,this.mask.active=!1},roll:function(){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var e=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=e[this.element-1],this.node.y=-200,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20)),cc.moveTo(.1,cc.v2(this.node.x,0)))))},doHold:function(){window.player.diceUsabld&&this.hold()},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)}}),cc._RF.pop()},{}],DiceYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.id=e,this.index=t,this.player=0==t?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1,this.holded=!1;var i=this.delta=0==this.index?1:-1;this.node.position=cc.v2(110*e-220,-320*i),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*i)),cc.moveBy(.1,cc.v2(0,-20*i))))},roll:function(e){this.abled=!0,this.holded=!1;var t=this.player.holdList.indexOf(this.node);if(t>=0&&this.player.holdList.splice(t,1),!e){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var i=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=i[this.element-1]}var c=50*Math.random()+150*this.id-325,o=(460*Math.random()+240)*this.delta,a=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(c,o)),cc.rotateTo(.2,a)))},toHold:function(){0==this.index&&this.doHold()},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var e=0;e<this.player.holdList.length;e++)this.player.holdList[e].runAction(cc.moveTo(.1,cc.v2(110*e-220,0)));this.player.txtBtn.string="\u6295\u63b7",cc.audioEngine.playEffect(window.sound.rollSound2)}else this.hold(),cc.audioEngine.playEffect(window.sound.holdSound)},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(e,t,i){"use strict";cc._RF.push(t,"24e6aDXOPZNaoyluEGeZSR/","Dice");var c=e("Game");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node,mask:cc.Node,markTemp:cc.Node,markBlind:cc.Node},init:function(e,t){this.id=e,this.holded=!1,this.element=0,this.mask.active=!1,this.temp=!1,this.isRemoved=!1,this.remembered=!1,this.buffList=t,this.markIce.active=this.markLock.active=this.markTemp.active=this.markBlind.active=!1,this.blind=t.indexOf(30)>=0,this.markBlind.active=this.blind},initBuff:function(e){e||(1==this.element&&window.opponent.equip.checkWithTrigger(171)?this.buffList.indexOf(22)<0&&this.buffList.indexOf(28)<0&&this.buffList.push(22):4==this.element&&window.opponent.equip.checkWithTrigger(173)&&this.buffList.indexOf(28)<0&&this.buffList.push(28));var t=this.buffList;this.freeze=t.indexOf(22)>=0,this.markIce.active=this.freeze,this.lock=t.indexOf(28)>=0,this.markLock.active=this.lock},roll:function(e){if(!this.isRemoved){this.element=e||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=t[this.element-1],this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=200*-this.delta,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20*this.delta)),cc.moveTo(.1,cc.v2(this.node.x,0)))))}},doHold:function(){c.data.guide>0&&c.data.guide<9||0!=window.mainLayer.roundId||this.freeze||this.lock||this.temp||window.player.diceUsabld&&(this.hold(),10==c.data.guide&&window.guide&&(window.guide.close(),window.host.checkBtnRoll()))},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)},remove:function(){this.isRemoved=!0,this.node.stopAllActions();var e=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.buffList=[],this.initBuff(!0),this.markBlind.active=!1},doTemp:function(){this.temp=!0,this.markTemp.active=!0;var e=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.markTemp.color=e[this.element-1]}}),cc._RF.pop()},{Game:"Game"}],DmgAnimation:[function(e,t,i){"use strict";cc._RF.push(t,"267b8j4vWVAPaVTrMCIVdTi","DmgAnimation");e("Utils");cc.Class({extends:cc.Component,properties:{atks:[dragonBones.ArmatureDisplay],heal:dragonBones.ArmatureDisplay,fireAtk:dragonBones.ArmatureDisplay,waterAtk:dragonBones.ArmatureDisplay,windAtk:dragonBones.ArmatureDisplay,earthAtk:dragonBones.ArmatureDisplay,lightAtk:dragonBones.ArmatureDisplay,darkAtk:dragonBones.ArmatureDisplay,armor:dragonBones.ArmatureDisplay,dodge:dragonBones.ArmatureDisplay,frail:dragonBones.ArmatureDisplay,weak:dragonBones.ArmatureDisplay,silence:dragonBones.ArmatureDisplay,poison:dragonBones.ArmatureDisplay,curse:dragonBones.ArmatureDisplay,lock:dragonBones.ArmatureDisplay,atkback:dragonBones.ArmatureDisplay,blind:dragonBones.ArmatureDisplay,undead:dragonBones.ArmatureDisplay,revive:dragonBones.ArmatureDisplay},init:function(e){this.index=e,this.host=0==e?window.mainLayer.hero:window.mainLayer.enemy,this.step=0},show:function(e){var t;if(e<=6){var i=[this.fireAtk,this.waterAtk,this.windAtk,this.earthAtk,this.lightAtk,this.darkAtk];t=i[e-1];i=[window.sound.fireSound,window.sound.iceSound,window.sound.windSound,window.sound.earthSound,window.sound.lightSound,window.sound.darkSound];cc.audioEngine.playEffect(i[e-1])}else if(e>=7&&e<=9)(t=this.atks[this.step%3]).node.rotation=360*Math.random(),cc.audioEngine.playEffect(window.sound.atkSound);else if(e<=16){i=[this.armor,this.heal,this.dodge,null,null,this.atkback];t=i[e-11];i=[window.sound.armorSound,window.sound.healSound,window.sound.dodgeSound,null,null,window.sound.atkSound];cc.audioEngine.playEffect(i[e-11])}else if(e>=21&&e<=30&&29!=e){i=[this.fireAtk,this.waterAtk,this.frail,this.weak,this.silence,this.poison,this.curse,this.lock,null,this.blind];t=i[e-21];i=[window.sound.fireSound,window.sound.iceSound,window.sound.frailSound,window.sound.weakSound,window.sound.silenceSound,window.sound.poisonSound,window.sound.curseSound,window.sound.lockSound,null,window.sound.blindSound];cc.audioEngine.playEffect(i[e-21])}else 201==e?(t=this.undead,cc.audioEngine.playEffect(window.sound.undeadSound)):202==e&&(t=this.revive,cc.audioEngine.playEffect(window.sound.reviveSound));t&&(t.node.active=!0,t.node.zIndex=this.step,t.playAnimation("play0"),t.on(dragonBones.EventObject.LOOP_COMPLETE,function(){t.node.active=!1}.bind(this))),this.host.doShake(e),this.step++}}),cc._RF.pop()},{Utils:"Utils"}],Door:[function(e,t,i){"use strict";cc._RF.push(t,"03087MNqj9O2qA5J4CBmWTy","Door");var c=e("Game");cc.Class({extends:cc.Component,properties:{light:cc.Node,image:cc.Sprite,btn:cc.Button,gate1:cc.Node,gate2:cc.Node,mask:cc.Node,stair:cc.Node,bossLight:cc.Node},init:function(e,t){this.type=e,this.index=t,cc.loader.loadRes("Texture/map/door/door"+e,cc.SpriteFrame,function(e,t){this.image.spriteFrame=t}.bind(this));var i=["tavern","battle","camp","treasure","event","shop","tavern","elite","boss"],o=c.data.roomType<=1||c.data.roomType>=7?"castle"+c.data.castle:i[c.data.roomType];cc.loader.loadRes("Texture/map/door/light/"+o,cc.SpriteFrame,function(e,i){this.light.getComponent(cc.Sprite).spriteFrame=i,this.mask.parent=window.room.node,this.mask.rotation=this.node.rotation;var c=[cc.v2(0,-15),cc.v2(-15,0),cc.v2(0,15),cc.v2(15,0)];this.mask.position=this.node.position.add(c[t])}.bind(this)),cc.loader.loadRes("Texture/map/door/gate/"+i[e]+"1",cc.SpriteFrame,function(e,t){this.gate1.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/map/door/gate/"+i[e]+"2",cc.SpriteFrame,function(e,t){this.gate2.getComponent(cc.Sprite).spriteFrame=t}.bind(this));var a=[null,null,cc.color(13,120,61),cc.color(234,162,59),cc.color(232,136,45),cc.color(251,230,180),cc.color(186,114,82)],s=[cc.color(93,135,192),cc.color(78,83,125),cc.color(203,158,115),cc.color(203,158,115)],n=a[c.data.roomType]||s[c.data.castle-1];this.mask.color=n},onEvent:function(){window.room.gotoDoor(this.index)},open:function(e){e?(this.gate1.runAction(cc.scaleTo(.3,.3,1)),this.gate2.runAction(cc.scaleTo(.3,.3,1)),this.light.runAction(cc.scaleTo(.3,1,1)),8==this.type&&(this.stair.active=!0,this.bossLight.active=!0,this.stair.opacity=0,this.stair.y=25,this.stair.runAction(cc.sequence(cc.delayTime(.1),cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.25,cc.v2(0,-40)),cc.moveBy(.05,cc.v2(0,5)))))))):8==this.type?(this.stair.active=!0,this.bossLight.active=!0,this.stair.y=-10,this.stair.runAction(cc.spawn(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.gate1.scaleX=.3,this.gate2.scaleX=.3,this.light.scaleX=1}.bind(this)),cc.fadeOut(.2)),cc.sequence(cc.moveBy(.05,cc.v2(0,-5)),cc.moveBy(.25,cc.v2(0,40)))))):(this.gate1.scaleX=.3,this.gate2.scaleX=.3,this.light.scaleX=1),this.btn.interactable=!0},close:function(e){this.btn.interactable=!1,e?(this.gate1.runAction(cc.scaleTo(.3,1,1)),this.gate2.runAction(cc.scaleTo(.3,1,1)),this.light.runAction(cc.scaleTo(.3,0,1))):(this.gate1.scaleX=1,this.gate2.scaleX=1,this.light.scaleX=0)}}),cc._RF.pop()},{Game:"Game"}],EditEndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){c.data.deck=c.editCfg.deckHero.split(";"),c.data.equip=c.editCfg.equip.split(";"),c.data.hp=c.data.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(e,t,i){"use strict";cc._RF.push(t,"463d3gvgvdIabmN6qTyXAVR","Edit");var c=e("Game");cc.Class({extends:cc.Component,properties:{editHpEnemy:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox,editId:cc.EditBox,editHpHero:cc.EditBox},onLoad:function(){c.editCfg&&(this.editHpEnemy.string=c.editCfg.hpEnemy,this.editDice.string=c.editCfg.dice,this.editDeckEnemy.string=c.editCfg.deckEnemy,this.editEquipEnemy.string=c.editCfg.equipEnemy,this.editDeckHero.string=c.editCfg.deckHero,this.editEquip.string=c.editCfg.equip,this.editHpHero.string=c.editCfg.hpHero),this.editId.string=c.data.heroId},goBattle:function(){c.editCfg={hpEnemy:this.editHpEnemy.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string,hpHero:this.editHpHero.string};var e=this.editDeckHero.string.split(";");if(4==parseInt(this.editId.string)){c.data.cardBag=[];for(var t=0;t<e.length;t++)c.data.cardBag.push(parseInt(e[t]))}else{c.data.deck=[];for(var i=0;i<e.length;i++)c.data.deck.push(parseInt(e[i]))}var o=this.editEquip.string.split(";");c.data.equip=[];for(var a=0;a<o.length;a++)c.data.equip.push(parseInt(o[a]));c.data.hp=c.data.hpMax=parseInt(c.editCfg.hpHero),c.data.heroId=parseInt(this.editId.string),c.data.level=7,cc.director.loadScene("mainLayer")},goBack:function(){cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,boxReward:cc.Node,boxCard:cc.Node,boxEquip:cc.Node,cardBtns:[cc.Node],equipBtns:[cc.Node],txtCopper:cc.Label,txtExp:cc.Label,txtHp:cc.Label,rewardNodes:[cc.Node],mask:cc.Node,endNode:cc.Node,txtNext:cc.Node,cardNodes:[cc.Node],equipNodes:[cc.Node],treasurePrefab:cc.Prefab,cardChangePrefab:cc.Prefab,btnGiveUp:cc.Node},init:function(e){window.endLayer=this,this.isEscape=e,this.step=0;var t=2,i=window.mainLayer.hero.player;this.initCopper(),this.initExp(),4==c.data.castle?this.step++:this.isEscape?this.step++:1==c.data.roomType?i.equip.check(26)?(c.data.hpMax+=6,c.data.hp+=6,this.rewardNodes[2].active=!0,t++,this.step++):this.initCards():this.initEquip();var o=0;i.equip.trigger(7)&&(o+=10),i.equip.trigger(8)&&(o+=20),o>0&&(this.rewardNodes[3].active=!0,this.txtHp.string=o,t++),-1==i.equip.feather&&(c.data.itemEffect.feather=-1),-1==i.equip.reviveBook&&(c.data.itemEffect.reviveBook=-1);for(var a=[[30,-30],[50,0,-50],[60,20,-20,-60]][t-2],s=0;s<t;s++)this.rewardNodes[s].y=a[s]-20;c.data.floorBeats[c.data.floor-1]=!0,c.data.monsterBeats.push(c.monsterId),this.mask.on(cc.Node.EventType.TOUCH_START,this.nextStep,this),this.boxReward.scale=.8,this.boxReward.runAction(cc.sequence(cc.scaleTo(.15,1.2),cc.scaleTo(.1,1),cc.callFunc(function(){this.step++,this.txtNext.active=!0}.bind(this)))),cc.audioEngine.playMusic(window.sound.win,!1)},initCards:function(){if(this.boxCard.active=!0,this.boxCard.y-=cc.winSize.height/cc.winSize.width*750,1==c.data.heroId&&2==c.data.difficulty){var e=(i=window.mainLayer.enemy.initialDeck)[Math.floor(Math.random()*i.length)],t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(e,null,1),t.position=cc.v2(0,40),this.boxCard.addChild(t),c.getCard(e),this.cardNodes[0].active=this.cardNodes[1].active=!1}else if(4==c.data.heroId&&4==c.data.difficulty){var i=window.mainLayer.enemy.initialDeck;this.cardIdList=[];for(var a=0;a<2;a++)if(i.length>0){var s=Math.floor(Math.random()*i.length),n=i[s];i.splice(s,1),this.cardIdList.push(n),c.getCard(n)}if(1==this.cardIdList.length){var r=cc.instantiate(this.cardPrefab);r.getComponent("CardCollection").init(this.cardIdList[0],null,1),r.position=cc.v2(0,40),this.boxCard.addChild(r),this.cardNodes[0].active=this.cardNodes[1].active=!1}else{for(var h=0;h<this.cardIdList.length;h++){var d=cc.instantiate(this.cardPrefab);d.getComponent("CardCollection").init(this.cardIdList[h]),d.position=cc.v2(0,40),this.cardNodes[h].addChild(d)}this.cardBtns[0].active=this.cardBtns[1].active=!1}}else{for(var l=0,f=[[.5,.4,.1],[.2,.5,.3],[0,.5,.5]],u=Math.random(),p=0,m=0;m<3;m++)if(u<(p+=f[c.data.castle-1][m])){l=m+1;break}this.cardIdList=[];for(var g=0;g<=0;){var w=c.getNewCardId(l),y=o.get("cfg_card",w).require;(c.data.castle>1||2==y.split(";").length||y<=102)&&(g=w)}this.cardIdList.push(g);for(var v=0;v<=0;){var b=c.getNewCardId(l),C=o.get("cfg_card",b).require;b!=g&&(c.data.castle>1||2==C.split(";").length||C<=102)&&(v=b)}this.cardIdList.push(v),9==c.data.guide&&(this.cardIdList=[9,10]);for(var x=0;x<2;x++){var k=cc.instantiate(this.cardPrefab);k.getComponent("CardCollection").init(this.cardIdList[x]),k.position=cc.v2(0,40),this.cardNodes[x].addChild(k)}}4==c.data.heroId&&4!=c.data.difficulty&&(this.btnGiveUp.active=!0)},chooseCard:function(e,t){this.getCard(this.cardIdList[t]),this.cardNodes[1-t].destroy(),this.cardNodes[t].runAction(cc.moveTo(.2,cc.v2(0,0))),this.cardBtns[0].active=this.cardBtns[1].active=!1,this.step++,this.txtNext.active=!0,this.btnGiveUp.active=!1,9==c.data.guide&&(c.guideChoose=parseInt(t)),cc.audioEngine.playEffect(window.sound.selectSound)},initCopper:function(){var e=window.mainLayer.enemy.cfg.level,t=1,i=window.mainLayer.hero.player;i.equip.check(73)&&(t+=.5),i.equip.check(90)&&(t-=.5);var o=Math.max([6,8,10,12,14,16,0][e-1]*t,1);this.isEscape&&(o=0),this.txtCopper.string=o,c.data.copper+=o},initExp:function(){var e=window.mainLayer.enemy.cfg.level,t=1==c.data.roomType?e:[3,9,15,27,37,55,100][e-1];this.isEscape&&(t=0),this.txtExp.string=t,c.data.exp+=t;var i=[5,15,21,39,47,73,150][c.data.level-1];c.data.exp>=i&&(c.data.exp-=i,c.data.level++,c.data.hpMax+=10,c.data.hp=window.mainLayer.hero.hp=c.data.hpMax,c.data.levelUp=!0)},initEquip:function(){this.boxEquip.active=!0,this.boxEquip.y-=cc.winSize.height/cc.winSize.width*750;for(var e=8==c.data.roomType?2:0,t=0,i=8==c.data.roomType?[[.4,.4,.2],[.3,.4,.3],[.2,.4,.4]]:[[.6,.3,.1],[.4,.3,.3],[.2,.4,.4]],o=Math.random(),a=0,s=0;s<3;s++)if(o<(a+=i[c.data.castle-1][s])){t=s+1;break}this.cfgIdList=[];var n=c.getNewItemId(e,t);if(this.cfgIdList.push(n),8==c.data.roomType){for(var r=0;r<=0;){var h=c.getNewItemId(e,t);h!=n&&(r=h)}this.cfgIdList.push(r)}},showEquip:function(){if(1==this.cfgIdList.length)(t=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),t.y=-120,this.boxEquip.addChild(t),c.getItem(this.cfgIdList[0]),this.equipNodes[0].active=!1,this.equipNodes[1].active=!1,this.scheduleOnce(function(){this.step++,this.txtNext.active=!0}.bind(this),1);else for(var e=0;e<2;e++){var t;(t=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[e]),t.y=-120,this.equipNodes[e].addChild(t),this.equipBtns[e].y-=150;var i=cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))));this.equipBtns[e].runAction(cc.sequence(cc.delayTime(.8),i))}},chooseEquip:function(e,t){c.getItem(this.cfgIdList[t]),this.equipNodes[1-t].destroy(),this.equipNodes[t].runAction(cc.moveTo(.2,cc.v2(0,0))),this.equipBtns[0].active=this.equipBtns[1].active=!1,this.step++,this.txtNext.active=!0},nextStep:function(){this.txtNext.active&&(1==this.step?(this.txtNext.active=!1,cc.audioEngine.playEffect(window.sound.reward),this.endNode.runAction(cc.sequence(cc.moveBy(.35,cc.v2(0,cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){c.data.roomType>=7?this.showEquip():(1==c.data.heroId&&2==c.data.difficulty||4==c.data.heroId&&4==c.data.difficulty)&&(this.step++,this.txtNext.active=!0)}.bind(this))))):2==this.step&&this.close())},getCard:function(e){if(1==c.data.heroId&&3==c.data.difficulty)if(c.data.deck.length<6)c.getCard(e);else{var t=cc.instantiate(this.cardChangePrefab);t.getComponent("CardChangeLayer").init(e),this.node.addChild(t,100)}else c.getCard(e)},close:function(){c.data.hp=Math.min(window.mainLayer.hero.hp,c.data.hpMax),c.data.power=window.mainLayer.hero.power,cc.director.loadScene("helloworld",function(){4==c.data.castle&&window.homeLayer.openComplete()})}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndTavernLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2d083apwQNCHIRnqoFt5WSN","EndTavernLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{txtNode:cc.Node,rewardNode:cc.Node,boxSingle:cc.Node,iconSingle:cc.Sprite,txtSingle:cc.Label,txtName:cc.Label,markTxt:cc.Sprite,markDouble:cc.Node,itemPrefab:cc.Prefab,cardPrefab:cc.Prefab,itemChangeNode:cc.Node,bg:cc.Node,mask:cc.Node,cardChangePrefab:cc.Prefab,losePrefab:cc.Prefab,itemNode:cc.Node},init:function(e){this.rewards=e,this.getCardList=[],this.showReward(),this.bg.scale=.8,this.bg.runAction(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.1,1))),this.mask.on(cc.Node.EventType.TOUCH_START,this.doNext,this),cc.audioEngine.playEffect(window.sound.end)},showReward:function(){this.abled=!1,this.scheduleOnce(function(){this.abled=!0}.bind(this),.3),0==this.rewards.length?this.showSingle("\u6ca1\u6709\u83b7\u5f97\u5956\u52b1","mark_empty",-1):this.checkResult()},changeReward:function(){this.abled=!1;var e=cc.instantiate(this.bg);this.node.addChild(e),e.runAction(cc.sequence(cc.moveBy(.3,cc.v2(-750,0)),cc.callFunc(function(){e.destroy()}.bind(this)))),this.bg.x=750,this.bg.runAction(cc.sequence(cc.moveBy(.3,cc.v2(-750,0)),cc.callFunc(function(){this.abled=!0}.bind(this)))),this.checkResult()},checkResult:function(){this.iconSingle.node.x=0,this.txtNode.active=this.boxSingle.active=this.markTxt.node.active=this.markDouble.active=this.itemChangeNode.active=!1,this.itemNode.removeAllChildren();var e=this.rewards.shift();if(1==e)this.showBox("\u83b7\u5f97\u666e\u901a\u88c5\u5907"),this.getItem(1);else if(2==e)this.showBox("\u83b7\u5f97\u7a00\u6709\u88c5\u5907"),this.getItem(2);else if(3==e)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u88c5\u5907"),this.getItem(3);else if(4==e)this.showSingle("\u83b7\u5f9720\u91d1\u5e01","mark_copper1"),c.data.copper+=20;else if(5==e){var t=Math.floor(99*Math.random())+1;this.showSingle("\u83b7\u5f97"+t+"\u91d1\u5e01","mark_copper1"),c.data.copper+=t}else if(6==e)this.showSingle("\u83b7\u5f97100\u91d1\u5e01","mark_copper1"),c.data.copper+=100;else if(7==e)this.showSingle("\u83b7\u5f97188\u91d1\u5e01","mark_copper1"),c.data.copper+=188;else if(8==e)this.showSingle("\u5f53\u524d\u91d1\u5e01\u6570\u91cf\u7ffb\u500d","mark_copper1"),this.iconSingle.node.x=-42,this.markDouble.active=!0,c.data.copper*=2;else if(9==e)this.showBox("\u83b7\u5f97\u968f\u673a\u5361\u724c"),this.getCard();else if(10==e)this.showBox("\u83b7\u5f97\u7a00\u6709\u5361\u724c"),this.getCard(2);else if(11==e)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u5361\u724c"),this.getCard(3);else if(12==e)this.showSingle("\u6062\u590d10\u751f\u547d","mark_hp"),c.data.hp=Math.min(c.data.hp+10,c.data.hpMax);else if(13==e)this.showSingle("\u6062\u590d30%\u6700\u5927\u751f\u547d","mark_hp"),c.data.hp=Math.min(Math.floor(c.data.hp+.3*c.data.hpMax),c.data.hpMax);else if(14==e)this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),c.data.hp=c.data.hpMax;else if(15==e){this.showBox("\u83b7\u5f97\u590d\u5236\u5361\u724c");var i=c.data.deck[Math.floor(Math.random()*c.data.deck.length)];4==c.data.heroId&&(i=c.data.cardBag[Math.floor(Math.random()*c.data.cardBag.length)]),this.getCard(null,i)}else 16==e?(this.showSingle("\u989d\u5916\u751f\u547d +5","mark_hpMax1"),c.data.hpMax+=5,c.data.hp+=5):17==e?(this.showSingle("\u989d\u5916\u751f\u547d +10","mark_hpMax1"),c.data.hpMax+=10,c.data.hp+=10):18==e?(this.showSingle("\u989d\u5916\u751f\u547d +15","mark_hpMax1"),c.data.hpMax+=15,c.data.hp+=15):19==e?this.changeItem():20==e?this.deleteItem():21==e?(this.showSingle("\u5931\u53bb20\u91d1\u5e01","mark_copper2",-1),c.data.copper=Math.max(c.data.copper-20,0)):22==e?(this.showSingle("\u5931\u53bb50\u91d1\u5e01","mark_copper2",-1),c.data.copper=Math.max(c.data.copper-50,0)):23==e?(this.showSingle("\u5931\u53bb\u4e00\u534a\u91d1\u5e01","mark_copper2",-1),c.data.copper=Math.ceil(c.data.copper/2)):24==e?(this.showBox("\u5931\u53bb1\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c"),this.deleteCard(4==c.data.heroId?1:0)):25==e?(this.showBox("\u5931\u53bb2\u5f20\u80cc\u5305\u4e2d\u7684\u724c"),this.deleteCard(1,0),this.deleteCard(1,1)):26==e?(this.showSingle("\u5931\u53bb10\u751f\u547d","mark_hp2",-1),this.loseHp(10)):27==e?(this.showSingle("\u5931\u53bb30%\u6700\u5927\u751f\u547d","mark_hp2",-1),this.loseHp(Math.floor(.3*c.data.hpMax))):28==e?(this.showSingle("\u751f\u547d\u4e0a\u9650-5","Mark_hpMax2",-1),c.data.hpMax-=5,c.data.hp=Math.min(c.data.hp,c.data.hpMax)):29==e?(this.showSingle("\u751f\u547d\u4e0a\u9650-10","Mark_hpMax2",-1),c.data.hpMax-=10,c.data.hp=Math.min(c.data.hp,c.data.hpMax)):30==e&&(this.showSingle("\u6028\u5ff5","mark_curse",-1),this.showBox("\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59315\u751f\u547d"),this.boxSingle.y-=60,c.data.debuff++)},showSingle:function(e,t,i){this.boxSingle.active=!0,t&&cc.loader.loadRes("Texture/UI/yahtzee/"+t,cc.SpriteFrame,function(e,t){this.iconSingle.spriteFrame=t}.bind(this)),this.txtSingle.string=e,-1==i?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(e,t){this.boxSingle.getComponent(cc.Sprite).spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(e,t){this.boxSingle.getComponent(cc.Sprite).spriteFrame=t}.bind(this))},showBox:function(e,t){this.txtNode.active=!0,this.txtName.string=e,t&&(cc.loader.loadRes("Texture/UI/yahtzee/"+t,cc.SpriteFrame,function(e,t){this.markTxt.spriteFrame=t}.bind(this)),this.txtName.node.x=50)},getCard:function(e,t,i){var o=t||c.getNewCardId(e),a=cc.instantiate(this.cardPrefab);return a.getComponent("CardCollection").init(o,null,i?null:1),a.y=-60,this.itemNode.addChild(a),1==c.data.heroId&&3==c.data.difficulty&&c.data.deck.length>=6?this.getCardList.push(o):c.getCard(o),a},getItem:function(e,t){var i=t||c.getNewItemId(0,e);c.getItem(i);var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(i,1),o.position=cc.v2(0,-60),this.itemNode.addChild(o)},loseHp:function(e){this.dmg=e,c.data.hp-=e},changeCard:function(e){var t;if(1==e){this.showBox("\u53d8\u63621\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c");var i=Math.floor(Math.random()*c.data.deck.length);t=c.data.deck[i],c.data.deck.splice(i,1)}else{this.showBox("\u53d8\u63621\u5f20\u80cc\u5305\u4e2d\u7684\u724c");i=Math.floor(Math.random()*c.data.cardBag.length);t=c.data.cardBag[i],c.data.cardBag.splice(i,1)}if(t){var o,a=c.getNewCardId();c.getCard(a),this.itemChangeNode.active=!0,(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(t),o.position=cc.v2(-165,-60),this.itemNode.addChild(o),(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(a),o.position=cc.v2(165,-60),this.itemNode.addChild(o)}else this.showBox("\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362")},changeItem:function(){if(c.data.equip.length>0){this.showBox("\u53d8\u63621\u4ef6\u5df2\u6709\u88c5\u5907");var e,t=c.deleteItem(),i=c.getNewItemId(0);c.getItem(i),this.itemChangeNode.active=!0,(e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(t),e.position=cc.v2(-165,-60),this.itemNode.addChild(e),(e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(i),e.position=cc.v2(165,-60),this.itemNode.addChild(e)}else this.showBox("\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362")},deleteCard:function(e,t){var i=0==e?c.data.deck:c.data.cardBag;if(i.length>0){var o=Math.floor(Math.random()*i.length),a=i[o];i.splice(o,1);var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(a,null,null!=t?null:-1),s.getComponent("CardCollection").markDelete.active=!0,null!=t&&(s.x=330*t-165),s.y=-60,this.itemNode.addChild(s)}},deleteItem:function(){if(c.data.equip.length>0){var e=c.deleteItem(),t=cc.instantiate(this.itemPrefab);t.getComponent("ItemCommodity").init(e,-1),t.position=cc.v2(0,-60),this.itemNode.addChild(t)}},doNext:function(){this.abled&&(0==this.rewards.length?this.doClose():this.changeReward())},doClose:function(){if(c.data.hp<=0){c.data.hp+=this.dmg;var e=cc.instantiate(this.losePrefab);this.node.addChild(e)}else if(this.getCardList.length>0){var t=cc.instantiate(this.cardChangePrefab);t.getComponent("CardChangeLayer").init(this.getCardList[0],this.getCardList[1],this.close.bind(this)),this.node.addChild(t,100)}else this.close()},close:function(){cc.director.loadScene("helloworld"),c.data.floorBeats[c.data.floor-1]=!0}}),cc._RF.pop()},{Game:"Game"}],EndYahtzeeLayer:[function(e,t,i){"use strict";cc._RF.push(t,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var c=e("Game");e("Config");cc.Class({extends:cc.Component,properties:{titles:[cc.Node],txtNode:cc.Node,rewardNode:cc.Node,boxSingle:cc.Node,iconSingle:cc.Sprite,txtSingle:cc.Label,txtName:cc.Label,markTxt:cc.Sprite,markDouble:cc.Node,itemPrefab:cc.Prefab,cardPrefab:cc.Prefab,itemChangeNode:cc.Node,bg:cc.Node,mask:cc.Node,cardChangePrefab:cc.Prefab,losePrefab:cc.Prefab},init:function(e){this.result=e,-1==e?this.titles[1].active=!0:2==e?this.titles[2].active=!0:this.titles[0].active=!0,this.getCardList=[],this.checkResult(),this.bg.scale=.8,this.bg.runAction(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.1,1))),this.abled=!1,this.mask.on(cc.Node.EventType.TOUCH_START,this.doClose,this),this.scheduleOnce(function(){this.abled=!0}.bind(this),.3),cc.audioEngine.playEffect(window.sound.end)},checkResult:function(){var e=c.data.eventIds[c.data.castle-1];if(0==this.result||1==this.result)if(1==e||15==e||22==e)this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),c.data.hp=c.data.hpMax;else if(2==e||8==e)this.showSingle("\u989d\u5916\u751f\u547d +10","mark_hpMax"),c.data.hpMax+=10,c.data.hp+=10;else if(3==e)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u88c5\u5907"),this.getItem(3);else if(4==e)this.showSingle("\u83b7\u5f9788\u91d1\u5e01","mark_copper1"),c.data.copper+=88;else if(5==e||9==e||19==e||26==e||30==e)this.showBox("\u83b7\u5f97\u968f\u673a\u88c5\u5907"),this.getItem();else if(6==e)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u5361\u724c"),this.getCard(3);else if(7==e)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-50,0),this.getItem(3);else if(10==e)this.showSingle("\u5f53\u524d\u91d1\u5e01\u6570\u91cf\u7ffb\u500d","mark_copper1"),this.iconSingle.node.x=-42,this.markDouble.active=!0,c.data.copper*=2;else if(11==e||21==e){this.showBox("\u83b7\u5f97\u590d\u5236\u5361\u724c");var t=c.data.deck[Math.floor(Math.random()*c.data.deck.length)];4==c.data.heroId&&(t=c.data.cardBag[Math.floor(Math.random()*c.data.cardBag.length)]),this.getCard(null,t)}else if(12==e||16==e||20==e)this.showSingle("\u83b7\u5f97100\u91d1\u5e01","mark_copper1"),c.data.copper+=100;else if(13==e||25==e){this.showBox("\u83b7\u5f972\u5f20\u53f2\u8bd7\u5361\u724c"),this.getCard(3,null,!0).x-=140,this.getCard(3,null,!0).x+=140}else if(14==e||29==e)this.showBox("\u751f\u547d\u4e0a\u9650+5","mark_hpMax"),this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),this.boxSingle.y-=60,c.data.hpMax+=5,c.data.hp=c.data.hpMax;else if(17==e){this.showBox("\u83b7\u5f972\u5f20\u7a00\u6709\u5361\u724c"),this.getCard(2,null,!0).x-=140,this.getCard(2,null,!0).x+=140}else if(18==e)this.showBox('\u83b7\u5f97\u88c5\u5907"\u7eaa\u5ff5\u5e01"'),this.getItem(null,73);else if(23==e)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),this.showSingle("\u989d\u5916\u751f\u547d +15","mark_hpMax"),this.boxSingle.y-=60,c.data.copper=Math.max(c.data.copper-50,0),c.data.hpMax+=15,c.data.hp+=15;else if(24==e){this.showBox("\u83b7\u5f972\u5f20\u968f\u673a\u5361\u724c"),this.getCard(null,null,!0).x-=140,this.getCard(null,null,!0).x+=140}else 27==e?(this.showSingle("\u83b7\u5f97188\u91d1\u5e01","mark_copper1"),c.data.copper+=188):28==e&&(this.showBox("\u5931\u53bb10\u751f\u547d","mark_hp3"),this.showSingle("\u83b7\u5f97188\u91d1\u5e01","mark_copper1"),this.boxSingle.y-=60,c.data.copper+=188,this.loseHp(10));else if(-1==this.result)if(1==e||8==e||24==e)this.showSingle("\u6062\u590d10\u751f\u547d","mark_hp"),c.data.hp=Math.min(c.data.hp+10,c.data.hpMax);else if(2==e)this.showBox("\u751f\u547d\u4e0a\u9650-5","Mark_hpMax3"),this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),this.boxSingle.y-=60,c.data.hpMax-=5,c.data.hp=c.data.hpMax;else if(3==e||29==e)this.changeItem();else if(4==e||9==e)this.showBox("\u83b7\u5f97\u968f\u673a\u5361\u724c"),this.getCard();else if(5==e)this.showSingle("\u83b7\u5f9750\u91d1\u5e01","mark_copper1"),c.data.copper+=50;else if(6==e||11==e)this.changeCard(2);else if(7==e)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-50,0),this.getItem(2);else if(10==e)this.showSingle("\u5931\u53bb\u4e00\u534a\u91d1\u5e01","mark_copper2"),c.data.copper=Math.ceil(c.data.copper/2);else if(12==e||18==e)this.showSingle("\u83b7\u5f9720\u91d1\u5e01","mark_copper1"),c.data.copper+=20;else if(13==e)this.showBox("\u5931\u53bb1\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c"),this.deleteCard(4==c.data.heroId?1:0);else if(14==e||16==e)this.showSingle("\u5931\u53bb10\u751f\u547d","mark_hp2"),this.loseHp(10);else if(15==e)this.showSingle("\u6028\u5ff5","mark_curse"),this.showBox("\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59315\u751f\u547d"),this.boxSingle.y-=60,c.data.debuff++;else if(17==e)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-50,0),this.getCard(2);else if(19==e)this.showSingle("\u989d\u5916\u751f\u547d +5","mark_hpMax"),c.data.hpMax+=5,c.data.hp+=5;else if(20==e)this.showBox("\u83b7\u5f97\u7a00\u6709\u5361\u724c"),this.getCard(2);else if(21==e){var i=Math.floor(99*Math.random())+1;this.showSingle("\u83b7\u5f97"+i+"\u91d1\u5e01","mark_copper1"),c.data.copper+=i}else 22==e?(this.showBox("\u989d\u5916\u751f\u547d +5","mark_hpMax"),this.showSingle("\u5931\u53bb10\u751f\u547d","mark_hp2"),this.boxSingle.y-=60,c.data.hpMax+=5,this.loseHp(5)):23==e?(this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),this.boxSingle.y-=60,c.data.copper=Math.max(c.data.copper-50,0),c.data.hp=c.data.hpMax):25==e?(this.showBox("\u5931\u53bb10\u751f\u547d","mark_hp3"),this.loseHp(10),this.getCard(3)):26==e?(this.showBox("\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59315\u751f\u547d"),c.data.debuff++,this.getItem()):27==e?(this.showBox("\u5931\u53bb100\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-100,0)):28==e?(this.showBox("\u5931\u53bb10\u751f\u547d","mark_hp3"),this.showSingle("\u83b7\u5f9788\u91d1\u5e01","mark_copper1"),this.boxSingle.y-=60,c.data.copper+=88,this.loseHp(10)):30==e&&(this.showBox("\u5931\u53bb2\u5f20\u80cc\u5305\u4e2d\u7684\u724c"),this.deleteCard(1,0),this.deleteCard(1,1));window.homeLayer&&window.homeLayer.refreshHeroData()},showSingle:function(e,t){this.boxSingle.active=!0,t&&cc.loader.loadRes("Texture/UI/yahtzee/"+t,cc.SpriteFrame,function(e,t){this.iconSingle.spriteFrame=t}.bind(this)),this.txtSingle.string=e,-1==this.result||2==this.result?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(e,t){this.boxSingle.getComponent(cc.Sprite).spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(e,t){this.boxSingle.getComponent(cc.Sprite).spriteFrame=t}.bind(this))},showBox:function(e,t){this.txtNode.active=!0,this.txtName.string=e,t&&(cc.loader.loadRes("Texture/UI/yahtzee/"+t,cc.SpriteFrame,function(e,t){this.markTxt.spriteFrame=t}.bind(this)),this.txtName.node.x=50)},getCard:function(e,t,i){var o=t||c.getNewCardId(e),a=cc.instantiate(this.cardPrefab);return a.getComponent("CardCollection").init(o,null,i?null:1),a.y=-60,this.rewardNode.addChild(a),1==c.data.heroId&&3==c.data.difficulty&&c.data.deck.length>=6?this.getCardList.push(o):c.getCard(o),a},getItem:function(e,t){var i=t||c.getNewItemId(0,e);c.getItem(i);var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(i,1),o.position=cc.v2(0,-60),this.rewardNode.addChild(o)},loseHp:function(e){this.dmg=e,c.data.hp-=e},changeCard:function(e){var t;if(1==e){this.showBox("\u53d8\u63621\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c");var i=Math.floor(Math.random()*c.data.deck.length);t=c.data.deck[i],c.data.deck.splice(i,1)}else{this.showBox("\u53d8\u63621\u5f20\u80cc\u5305\u4e2d\u7684\u724c");i=Math.floor(Math.random()*c.data.cardBag.length);t=c.data.cardBag[i],c.data.cardBag.splice(i,1)}if(t){var o,a=c.getNewCardId();c.getCard(a),this.itemChangeNode.active=!0,(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(t),o.position=cc.v2(-165,-60),this.rewardNode.addChild(o),(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(a),o.position=cc.v2(165,-60),this.rewardNode.addChild(o)}else this.showBox("\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362")},changeItem:function(){if(c.data.equip.length>0){this.showBox("\u53d8\u63621\u4ef6\u5df2\u6709\u88c5\u5907");var e,t=c.deleteItem(),i=c.getNewItemId(0);c.getItem(i),this.itemChangeNode.active=!0,(e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(t),e.position=cc.v2(-165,-60),this.rewardNode.addChild(e),(e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(i),e.position=cc.v2(165,-60),this.rewardNode.addChild(e)}else this.showBox("\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362")},deleteCard:function(e,t){var i=0==e?c.data.deck:c.data.cardBag;if(i.length>0){var o=Math.floor(Math.random()*i.length),a=i[o];i.splice(o,1);var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(a,null,null!=t?null:-1),s.getComponent("CardCollection").markDelete.active=!0,null!=t&&(s.x=330*t-165),s.y=-60,this.rewardNode.addChild(s)}},doClose:function(){if(c.data.hp<=0){c.data.hp+=this.dmg;var e=cc.instantiate(this.losePrefab);this.node.addChild(e)}else if(this.getCardList.length>0){var t=cc.instantiate(this.cardChangePrefab);t.getComponent("CardChangeLayer").init(this.getCardList[0],this.getCardList[1],this.close.bind(this)),this.node.addChild(t,100)}else this.close()},close:function(){this.abled&&(window.homeLayer?this.node.destroy():(cc.director.loadScene("helloworld"),c.data.floorBeats[c.data.floor-1]=!0))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(e,t,i){"use strict";cc._RF.push(t,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,boxBuff:cc.Node,txtName:cc.Label,txtLevel:cc.Label,txtDice:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,figure:cc.Node,figureNode:cc.Node,equipDesc:cc.RichText,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){if(c.editCfg)this.initEdit();else{if(this.cfgId=c.monsterId,this.cfg=o.get("cfg_monster",this.cfgId),this.hpMax=this.cfg.hp,3==c.data.difficulty?1!=c.data.heroId&&4!=c.data.heroId||(this.hpMax=1.1*this.hpMax):4==c.data.difficulty&&(this.hpMax=1.2*this.hpMax),c.data.equip.indexOf(91)>=0&&(this.hpMax=1.1*this.hpMax),1==c.data.roomType&&c.data.itemEffect.pen>0&&(this.hpMax=this.hpMax/2,c.data.itemEffect.pen--),this.hpMax=Math.floor(this.hpMax),10==c.data.guide)this.hpMax=32;else if(0==this.cfg.type)for(var e=0;e<c.data.monsterBeats.length;e++){var t=c.data.monsterBeats[e];t&&this.cfg.level==o.get("cfg_monster",t).level&&(this.hpMax+=5)}this.hp=this.hpMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,2==c.data.heroId&&4==c.data.difficulty&&this.diceCount++,this.cfg.item>0?this.equipList=[this.cfg.item]:this.equipList=[],this.txtName.string=this.cfg.name,this.txtLevel.string="Lv."+this.cfg.level,this.initDeck()}this.player.init(1),this.escapeRate=0,this.exRollCount=0,this.ai=this.getComponent("AI"),this.board=window.mainLayer.board,cc.loader.loadRes("Texture/monster/figure/"+this.cfgId,cc.SpriteFrame,function(e,t){this.figure.getComponent(cc.Sprite).spriteFrame=t,12==this.cfgId||17==this.cfgId||20==this.cfgId||33==this.cfgId||42==this.cfgId||45==this.cfgId||55==this.cfgId||62==this.cfgId||65==this.cfgId||76==this.cfgId||1==this.cfgId?(this.figureNode.scaleX=1.5,this.figureNode.scaleY=.6,this.figureNode.runAction(cc.sequence(cc.scaleTo(.4,.8,1.2),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))):(this.figureNode.y+=250,this.figureNode.scaleX=.8,this.figureNode.scaleY=1.2,this.figureNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,-250)),cc.scaleTo(.3,1.2,.8)),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))),this.scheduleOnce(function(){window.sound.monsterSound[this.cfgId-1]&&cc.audioEngine.playEffect(window.sound.monsterSound[this.cfgId-1])}.bind(this),.2)}.bind(this))},startRound:function(){this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5),this.board.runAction(cc.sequence(cc.delayTime(.5),cc.moveBy(.15,cc.v2(0,120))))},endRound:function(){this.exRollCount=0,this.board.runAction(cc.moveBy(.15,cc.v2(0,-120))),this.equip.check(126)&&(this.escapeRate+=.1,Math.random()<this.escapeRate&&this.escape())},onHurt:function(e,t,i,c){window.mainLayer.gameOver||(i=i||7,c=null!=c?c:1,this.player.onHurt(e,t,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(0)))},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},initDeck:function(){if(0==this.cfg.card1)if(4==c.data.heroId){var e=Math.min(c.data.cardBag.length,6),t=c.data.cardBag.concat();this.deck=[];for(var i=0;i<e;i++){var o=Math.floor(t.length*Math.random()),a=t[o];this.deck.push(a),t.splice(o,1)}}else this.deck=c.data.deck.concat();else{this.deck=[];for(var s=0;s<6;s++){var n=this.cfg["card"+(s+1)];n>0&&this.deck.push(n)}}this.initialDeck=this.deck.concat()},initEdit:function(){this.cfgId=35,this.hp=this.hpMax=parseInt(c.editCfg.hpEnemy),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(c.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.equipList=""!=c.editCfg.equipEnemy?[c.editCfg.equipEnemy]:[],this.deck=[];for(var e=c.editCfg.deckEnemy.split(";"),t=0;t<e.length;t++)""!=e[t]&&this.deck.push(parseInt(e[t]))},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};t[e]&&(this.figure.color=cc.Color.WHITE.fromHEX("#"+t[e]),this.figure.stopAllActions(),this.figure.runAction(cc.sequence(cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(-15,-5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.08,cc.v2(-15,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){this.figure.position=cc.v2(0,0),this.figure.color=cc.Color.WHITE}.bind(this)))))},escape:function(){window.mainLayer.showEnd(0,!0)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(e,t,i){"use strict";cc._RF.push(t,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,mask:cc.Node},onLoad:function(){window.equipLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var e=0;window.bagLayer?(e=.15,window.bagLayer.close()):window.mapLayer&&(e=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initItems(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initItems:function(){for(var e=0;e<c.data.equip.length;e++){var t=cc.instantiate(this.itemPrefab);t.getComponent("ItemCollection").init(c.data.equip[e]),t.position=cc.v2(-20,-70-124*e),this.content.addChild(t)}this.content.height=Math.max(124*c.data.equip.length+20,cc.winSize.height/cc.winSize.width*750-1334+870)},close:function(){this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.equipLayer=null,window.homeLayer.btnEquip.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(e,t,i){"use strict";cc._RF.push(t,"a22ddJNtUJBS6PVq98jP/g9","Equip");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?c.data.equip.concat():this.host.equipList,this.boxEquip=this.host.boxEquip,this.abled=1==this.index||159!=this.opponent.host.equipList[0],this.swiftGlove=!1,this.luckDice=!1,this.luckFlag=!1,this.suckRemainder=0,this.armorRemainder=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0,this.feedBack=0,this.feather=0,this.reviveBook=0,this.wolfBlood=!1,this.elementPlayed=[0,0,0,0,0,0],this.initItems()},initItems:function(){if(this.itemList=[],0==this.index){for(var e=0;e<this.equipList.length;e++){if(this.equipList[e]>0)if(o.get("cfg_item",this.equipList[e]).battle){var t=!1;if(10==this.equipList[e]&&c.data.itemEffect.feather>0?(this.feather=1,t=!0):158==this.equipList[e]&&c.data.itemEffect.reviveBook>0?(this.reviveBook=1,t=!0):t=(74==this.equipList[e]&&c.data.itemEffect.pen,!0),t){var i=cc.instantiate(this.itemPrefab);i.getComponent("Item").init(this.equipList[e],this),this.boxEquip.addChild(i),this.itemList.push(i),this.abled||i.getComponent("Item").doDisabled()}}}for(var a=0;a<this.itemList.length;a++){var s=72;this.itemList.length>10&&(s=648/(this.itemList.length-1)),this.itemList[a].x=s*a-324}}else if(this.equipList.length>0){var n=o.get("cfg_item",this.equipList[0]);this.host.equipDesc.string="<color=#FEF64B>"+n.name+"\uff1a</c>"+c.analysisDesc(n.desc1);var r=cc.instantiate(this.itemPrefab);r.getComponent("Item").init(this.equipList[0],this),r.x=-this.host.equipDesc.node.width/2-25,r.scale=.5,this.boxEquip.addChild(r),this.itemList.push(r),r.getComponent("Item").boxNum.scale=2,10==this.equipList[0]?this.feather=1:158==this.equipList[0]&&(this.reviveBook=1)}else this.boxEquip.active=!1},check:function(e){if(!this.abled)return!1;for(var t=0;t<this.equipList.length;t++)if(this.equipList[t]==e)return!0;return!1},checkWithTrigger:function(e){return!!this.check(e)&&(this.doTrigger(e),!0)},trigger:function(e){var t=!1;if(this.check(e))if(1==e)this.opponent.host.onHurt(1,2),t=!0;else if(2==e)this.player.cardList.length<=0&&(this.player.updateArmor(5),t=!0);else if(3==e)this.player.cardList.length<=0&&(this.host.onHeal(3),t=!0);else if(4==e)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),t=!0);else if(5==e)this.opponent.buff.addBuff(26,2),t=!0;else if(6==e)this.player.buff.addBuff(13,1),t=!0;else if(7==e)this.host.onHeal(10),t=!0;else if(8==e)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(20),t=!0);else if(9==e)this.opponent.host.onHurt(6,2),t=!0;else if(10==e)this.feather>0&&(this.player.anim.show(202),this.host.hp=Math.floor(.3*this.host.hpMax),t=!0,this.feather=-1);else if(11==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.player.updateArmor(-this.host.armor),t=!0);else if(e>=12&&e<=18){this.opponent.buff.addBuff(e+9,[3,2,1,2,1,4,1][e-12]),t=!0}else if(19==e)this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0;else if(20==e)this.player.updateArmor(10),t=!0;else if(21==e)this.player.buff.addBuff(104,1);else if(22==e)this.opponent.host.onHurt(5,2),t=!0;else if(23==e){if(this.suckRemainder>=4){var i=Math.floor(this.suckRemainder/4);this.suckRemainder=this.suckRemainder%4,this.host.onHeal(i),t=!0}}else if(24==e)this.opponent.host.onHurt(2,2,1),t=!0;else if(25==e)this.host.hp==this.host.hpMax&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(27==e)this.host.armor<=0&&(this.player.updateArmor(5),t=!0);else if(30==e)3==this.player.round&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(37==e)this.player.buff.addBuff(105,2);else if(44==e)this.player.buff.addBuff(103,3),t=!0;else if(45==e)this.scheduleOnce(function(){this.player.createExDice()}.bind(this),.5),t=!0;else if(e>=48&&e<=53)this.scheduleOnce(function(){window.player.createExDice(e-47)}.bind(this),.5),t=!0;else if(57==e)this.player.cardList.length>0&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(59==e)this.player.cardList.length>0&&(this.player.updateArmor(3*this.player.cardList.length),t=!0);else if(60==e)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),t=!0);else if(61==e)this.host.onHeal(15),t=!0;else if(68==e)this.opponent.buff.addBuff(24,1),t=!0;else if(69==e)this.opponent.host.onHurt(10,2),t=!0;else if(70==e){var a=c.getRandomCardId();window.player.patchCard(a,!0),window.player.deck.push(a),t=!0}else if(75==e)this.host.hp<.3*this.host.hpMax?this.player.buff.atkAd3||(this.player.buff.addBuff(104,3),this.player.buff.atkAd3=!0):this.player.buff.atkAd3&&(this.buff.removeBuff(104,3),this.player.buff.atkAd3=!1);else if(82==e||83==e)this.host.onHeal(2),t=!0;else if(79==e||78==e)this.player.updateArmor(2),t=!0;else if(80==e||81==e)this.opponent.host.onHurt(2,2),t=!0;else if(84==e)this.player.buff.addBuff(27,1),t=!0;else if(86==e)this.host.onHurt(3,2,7,2),t=!0;else if(88==e){var s=4==c.data.heroId?c.data.cardBag:c.data.deck;if(s.length>0){t=!0;for(var n=o.get("cfg_card",s[0]).element,r=1;r<s.length;r++)if(o.get("cfg_card",s[r]).element!=n){t=!1;break}}}else if(93==e){if(1==this.player.round){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard(!0);for(a=0;a<=0;){var h=c.getRandomCardId();3==o.get("cfg_card",h).quality&&(a=h)}window.player.patchCard(a),t=!0}}else if(96==e)this.opponent.buff.addBuff(26,5),t=!0;else if(97==e)this.player.updateArmor(1),t=!0;else if(102==e)this.host.hp>this.host.hpMax&&(this.player.updateArmor(this.host.hp-this.host.hpMax),t=!0);else if(104==e)this.opponent.buff.addBuff(Math.floor(10*Math.random())+21,1),t=!0;else if(105==e)this.host.onHurt(2,2,7,2),t=!0;else if(108==e)Math.random()<.3&&(this.opponent.buff.addBuff(27,1),t=!0);else if(109==e)Math.random()<.3&&(this.player.buff.addBuff(13,1),t=!0);else if(110==e)this.host.onHurt(1,2,7,2),this.opponent.buff.addBuff(26,2),t=!0;else if(111==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),t=!0);else if(114==e)this.player.buff.addBuff(106,1);else if(115==e)this.luckDice||(this.luckDice=!0,this.player.addRollCount(),t=!0);else if(116==e)this.luckFlag||(this.luckFlag=!0,this.opponent.host.onHurt(6,2),t=!0);else if(118==e){for(var d=0,l=0;l<this.opponent.cardList.length;l++){this.opponent.cardList[l].getComponent("Card").burn&&d++}d>0&&(this.opponent.host.onHurt(6*d,2),t=!0)}else if(119==e)this.opponent.host.onHurt(5,2),t=!0;else if(121==e){for(var f=[],u=0;u<=this.player.buff.buffList.length;u++){var p=this.player.buff.buffList[u];p>=21&&p<=28&&f.push(p)}if(f.length>0){var m=f[Math.floor(Math.random()*f.length)];this.player.buff.removeBuff(m,this.player.buff.table[m]),t=!0}}else if(122==e)this.opponent.host.onHurt(1,2),t=!0;else if(123==e)this.host.hp>this.host.hpMax&&(this.opponent.host.onHurt(this.host.hp-this.host.hpMax,2),t=!0);else if(124==e)this.player.buff.addBuff(106,2);else if(126==e)c.data.copper=Math.max(c.data.copper-10,0),t=!0;else if(128==e){if(this.player.cardList.length>0&&this.opponent.deck.length>0){var g=Math.floor(Math.random()*this.player.cardList.length),w=(a=this.player.cardList[g].getComponent("Card").cfgId,Math.floor(Math.random()*this.opponent.deck.length)),y=this.opponent.deck[w];this.player.deck[g]=y,this.opponent.deck[w]=a,this.player.cardList[g].getComponent("Card").discard(!0),this.player.patchCard(y)}t=!0}else if(129==e)this.host.onHeal(3),t=!0;else if(138==e)this.opponent.buff.addBuff(29,1),t=!0;else if(142==e)this.player.diceCount++,this.host.txtDice.string="\xd7"+this.player.diceCount,t=!0;else if(143==e)this.player.updateArmor(this.host.hpMax-this.host.hp),t=!0;else if(144==e)this.opponent.buff.addBuff(27,1),t=!0;else if(145==e){if(1==this.player.round){if(this.opponent.equip.itemList.length>0){var v=this.opponent.equip.itemList[Math.floor(Math.random()*this.opponent.equip.itemList.length)].getComponent("Item");this.addEquip(v.cfgId),this.player.checkGameBegin()}t=!0}}else if(146==e)this.feedBack=8,this.refreshItemNum(146,8),t=!0;else if(147==e)this.player.buff.addBuff(104,1),t=!0;else if(148==e)this.opponent.host.onHurt(2*this.player.round,2,1),t=!0;else if(150==e)this.player.updateArmor(3),t=!0;else if(151==e)0==this.player.cardPlayedRound&&(this.player.extraDice+=2,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(152==e)null!=this.host.power&&(this.host.addPower(5),t=!0);else if(153==e)Math.random()<.1&&(this.player.patchCard(),t=!0);else if(155==e)this.opponent.host.armor>0&&(this.opponent.updateArmor(-this.opponent.host.armor),t=!0);else if(156==e)this.player.updateArmor(this.player.dmgRound),t=!0;else if(157==e)Math.random()<.3&&(this.player.patchCard(c.getRandomCardId(2)),t=!0);else if(158==e)this.reviveBook>0&&(this.player.anim.show(202),this.host.hp=this.host.hpMax,t=!0,this.reviveBook=-1);else if(160==e)!this.wolfBlood&&this.host.hp<this.host.hpMax/2&&(this.wolfBlood=!0,this.host.onHeal(Math.floor(this.host.hpMax/2)),this.player.buff.addBuff(107,1),1==this.player.index&&cc.loader.loadRes("Texture/monster/figure/999",cc.SpriteFrame,function(e,t){this.host.figure.getComponent(cc.Sprite).spriteFrame=t,this.host.figure.scale=.5,this.host.figure.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.1,1))),cc.audioEngine.playEffect(window.sound.wolfSound)}.bind(this)),t=!0);else if(161==e)this.opponent.buff.addBuff(30,3),t=!0;else if(162==e)this.host.power&&(this.opponent.host.onHurt(this.host.power,2),t=!0);else if(164==e)this.armorRemainder>=3&&(this.player.updateArmor(Math.floor(this.armorRemainder/3)),this.armorRemainder=this.armorRemainder%3,t=!0);else if(165==e){(x=Math.random())<1/3?this.opponent.host.onHurt(7,2):x<2/3?this.opponent.buff.addBuff(26,4):this.player.buff.addBuff(27,1),t=!0}else if(166==e){if(this.refreshItemNum(166,this.opponent.cardPlayed%5),this.opponent.cardPlayed%5==0){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}t=!0}}else if(168==e)this.host.armor>0&&(this.host.onHeal(Math.floor(this.host.armor/2)),t=!0);else if(169==e){if(this.player.cardList.length<=0){for(var b=0;b<6;b++)this.player.patchCard();this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),t=!0}}else if(170==e){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}t=!0}else if(174==e){if((d=this.player.cardList.length-this.player.cardAbledCount)>0){for(var C=0;C<d;C++)this.opponent.host.onHurt(3,2);t=!0}}else if(176==e)this.opponent.host.onHurt(3,2);else if(181==e)this.player.createExDice(),t=!0;else if(182==e)this.player.updateArmor(5),t=!0;else if(183==e){var x;(x=Math.random())<1/6?this.host.onHeal(6):x<2/6?this.player.updateArmor(6):x<.5?this.player.buff.addBuff(105,1):x<4/6?this.player.buff.addBuff(13,1):x<5/6?this.player.buff.addBuff(107,1):this.player.buff.addBuff(108,1),t=!0}else 184==e?this.elementPlayed[1]>=3&&(this.elementPlayed[1]-=3,this.player.createExDice(),t=!0):185==e?this.elementPlayed[2]>=3&&(this.elementPlayed[2]-=3,this.player.buff.addBuff(107,1),t=!0):t=!0;return t&&this.doTrigger(e),t},doTrigger:function(e){for(var t=0;t<this.itemList.length;t++){var i=this.itemList[t].getComponent("Item");if(i.cfgId==e&&!i.isRemoved){i.trigger();break}}},refreshItemNum:function(e,t){for(var i=0;i<this.itemList.length;i++){var c=this.itemList[i].getComponent("Item");if(c.cfgId==e){c.txtCount.string=t;break}}},doDisabled:function(e){for(var t=0;t<this.itemList.length;t++){var i=this.itemList[t].getComponent("Item");if(i.cfgId==e){i.doDisabled();break}}},addEquip:function(e){if(0==this.index){this.equipList.push(e);var t=cc.instantiate(this.itemPrefab);t.getComponent("Item").init(e,this),this.boxEquip.addChild(t),this.itemList.push(t);for(var i=0;i<this.itemList.length;i++){var a=72;this.itemList.length>10&&(a=648/(this.itemList.length-1)),this.itemList[i].x=a*i-324}}else{this.equipList[0]=e,this.itemList[0].getComponent("Item").refresh(e);var s=o.get("cfg_item",e);this.host.equipDesc.string="<color=#FEF64B>"+s.name+"\uff1a</c>"+c.analysisDesc(s.desc1),this.itemList[0].x=-this.host.equipDesc.node.width/2-25}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0d029pbdspBQZQHImTjZ76I","EventLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{figure:cc.Sprite,txtName:cc.Label,txtDesc:cc.Label,txtResults:[cc.Label],endPrefab:cc.Prefab,btnLeave:cc.Node,btnPlay:cc.Node},onLoad:function(){window.eventLayer=this,this.cfgId=c.data.eventIds[c.data.castle-1];var e=o.get("cfg_event",this.cfgId);this.txtName.string=e.name,this.txtDesc.string=e.desc,cc.loader.loadRes("Texture/npc/figure/"+this.cfgId,cc.SpriteFrame,function(e,t){this.figure.spriteFrame=t}.bind(this));for(var t=0;t<3;t++)this.txtResults[t].string=e["result"+(t+1)];this.btnLeave.opacity=1,this.btnPlay.opacity=1,this.btnLeave.y-=150,this.btnPlay.y-=150,this.btnLeave.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnPlay.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),c.data.guide>0&&(this.btnLeave.active=!1)},onBattle:function(){window.homeLayer=null,window.eventLayer=null,cc.director.loadScene("yahtzee")},onLeave:function(){if("\u65e0"!=o.get("cfg_event",this.cfgId).result3){var e=cc.instantiate(this.endPrefab);e.getComponent("EndYahtzeeLayer").init(2),window.homeLayer.node.addChild(e)}this.close()},close:function(){this.node.destroy(),c.data.floorBeats[c.data.floor-1]=!0,window.eventLayer=null,window.room.ready()}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(e,t,i){"use strict";cc._RF.push(t,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{box:cc.Sprite,mark:cc.Sprite,markCurrent:cc.Node},init:function(e,t,i){i&&(cc.loader.loadRes("Texture/UI/map/box_fort1",cc.SpriteFrame,function(e,t){this.box.spriteFrame=t}.bind(this)),this.markCurrent.active=!0,this.markCurrent.runAction(cc.sequence(cc.moveBy(.35,cc.v2(0,10)),cc.moveBy(.35,cc.v2(0,-10))).repeatForever())),0==t?cc.loader.loadRes("Texture/UI/map/image_fort0"+e,cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)):(cc.loader.loadRes(e>0?"Texture/UI/map/image_fort"+e:"Texture/UI/map/box_fort2",cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)),i||(this.mark.node.scale=.8))},hide:function(){this.markCurrent.active=!1,cc.loader.loadRes("Texture/UI/map/box_fort2",cc.SpriteFrame,function(e,t){this.box.spriteFrame=t}.bind(this))}}),cc._RF.pop()},{}],Game:[function(e,t,i){"use strict";cc._RF.push(t,"f5308O6zsVOxr+EKRsyR7ba","Game");var c=e("Config"),o={version:0,getData:function(e){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(t){cc.log("getStorageSuccess:"+t.data),void 0!=t.data?(o.data=JSON.parse(t.data),e()):(this.setDataToBase(),e())}.bind(this),fail:function(){this.setDataToBase(),e()}.bind(this)});else{var t=cc.sys.localStorage.getItem("dice");void 0!=t?o.data=JSON.parse(t):this.setDataToBase(),e()}},setDataToBase:function(){o.data={heroId:1,difficulty:1,deck:[],cardBag:[],equip:[],hp:35,hpMax:35,power:0,powerMax:20,heroPos:2,exp:0,level:1,castle:1,floor:1,roomType:0,copper:99,debuff:0,shopIds:[],eventIds:[],monsterList:[],historyPath:[],historyChoose:[0],floorBeats:[],specialRoomIds:[],monsterBeats:[],monsterUnbeats:[],discountCard:-1,discountItem:-1,itemEffect:{feather:0,vase:0,flagon:0,pen:0,vip1:!1,vip2:!1,reviveBook:0},startTime:0,face:1,restartCount:0,cardPlayed:{},guide:0,guideBag:0},o.saveData()},saveData:function(){o.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(o.data),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(o.data))},getItem:function(e){if(o.data.equip.push(e),10==e)o.data.itemEffect.feather=1;else if(28==e)o.data.itemEffect.vase=2;else if(29==e)o.data.itemEffect.flagon=2;else if(40==e)o.data.hpMax+=5,o.data.hp+=5;else if(41==e)o.data.hpMax+=10,o.data.hp+=10;else if(46==e)o.data.itemEffect.vip1=!0;else if(47==e)o.data.itemEffect.vip2=!0;else if(71==e)o.data.copper+=50;else if(72==e)o.data.copper+=50,o.data.hpMax+=10,o.data.hp+=10;else if(74==e)o.data.itemEffect.pen+=2;else if(84==e)for(var t=0;t<3;t++)o.getItem(o.getNewItemId(0));else if(87==e)for(var i=0;i<2;i++)o.getItem(o.getNewItemId(0,2));else 92==e?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hp,o.data.hpMax)):95==e?(o.data.hpMax+=10,o.data.hp=o.data.hpMax):96==e?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hp,o.data.hpMax)):105==e?(o.data.hpMax+=20,o.data.hp+=20):106==e?o.data.powerMax+=10:158==e&&(o.data.itemEffect.reviveBook=1);94!=e&&o.data.equip.indexOf(94)>=0&&(o.data.hpMax+=5,o.data.hp+=5),window.homeLayer&&window.homeLayer.refreshHeroData()},getCard:function(e){var t=5==o.data.heroId?4:2==o.data.heroId&&3==o.data.difficulty?5:6;4!=o.data.heroId&&o.data.deck.length<t?o.data.deck.push(e):(o.data.cardBag.push(e),o.newCard=!0,window.homeLayer&&window.homeLayer.refreshHeroData())},getNewItemId:function(e,t,i){for(var a=0;a<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_item).length)+1,n=c.get("cfg_item",s);if(o.data.equip.indexOf(s)<0&&(0==e&&n.get<=1||1==e&&0==n.get||2==e&&3!=n.get)){var r=0;t?n.quality==t&&(r=s):r=s,i?n.hero==o.data.heroId&&(a=r):n.hero!=o.data.heroId&&0!=n.hero||(a=r)}}return a},getNewCardId:function(e,t){for(var i=0;i<=0;){var c=o.getRandomCardId(null,t?2:1,e);o.data.deck.indexOf(c)<0&&o.data.cardBag.indexOf(c)<0&&(i=c)}return i},getRandomCardId:function(e,t,i){for(var a=0;a<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_card).length)+1,n=c.get("cfg_card",s);n.hero!=o.data.heroId&&0!=n.hero||(3==t?n.get<=1:n.get==(t||1))&&(4!=o.data.heroId||n.element<7)&&(e?n.element==e&&(a=s):i?n.quality==i&&(a=s):a=s)}return a},getNewMonsterId:function(e,t){for(var i=0,a=0;i<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_monster).length)+1;o.data.monsterBeats.indexOf(s)<0&&c.get("cfg_monster",s).level==e&&c.get("cfg_monster",s).type==t&&(i=s),o.data.monsterUnbeats.indexOf(s)>=0&&a<500&&(i=0,a++)}return i},deleteItem:function(){var e=Math.floor(Math.random()*o.data.equip.length),t=o.data.equip[e];return o.data.equip.splice(e,1),10==t?o.data.itemEffect.feather=0:28==t?o.data.itemEffect.vase=0:29==t?o.data.itemEffect.flagon=0:40==t?(o.data.hpMax=Math.max(o.data.hpMax-5,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):41==t?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):46==t?o.data.itemEffect.vip1=!1:47==t?o.data.itemEffect.vip2=!1:72==t?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):74==t?o.data.itemEffect.pen=0:92==t?o.data.hpMax+=20:95==t?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):96==t?o.data.hpMax+=10:105==t?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):106==t?(o.data.powerMax-=10,o.data.power=Math.min(o.data.powerMax,o.data.power)):158==t&&(o.data.itemEffect.reviveBook=0),t},analysisDesc:function(e,t){for(var i="",c=0,o="",a={1:"fire",2:"water",3:"wind",4:"earth",5:"light",6:"dark",7:"atk",9:"suck",11:"armor",12:"heal",13:"dodge",14:"power",15:"heart",16:"atkback",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind"},s={1:"FF3832",2:"2CB4FF",3:"00F776",4:"FF9652",5:"FFFB4B",6:"BF7FE4",7:"FFFFFF",9:"FF5567",11:"42EBFF",12:"98F700",13:"FFF830",14:"FFFB4B",15:"FF5567",16:"FF5567",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1"},n=0;n<e.length;n++)"#"==e[n]?0==c?(c=1,o="",i+="<img src='"):(i+=a[parseInt(o)],i+="'/>",c=0):"["==e[n]?(o="",0==c&&(c=2,i+="<color=#")):"]"==e[n]?""!=o?(i+=s[parseInt(o)],i+=">",c=-1):(c=0,i+="</c>"):c<=0?e[n]>="A"&&e[n]<="F"?i+=" <img src='dice"+(e[n].charCodeAt()-64)+"'/> ":i+=e[n]:o+=e[n];return i}};t.exports=o,cc._RF.pop()},{Config:"Config"}],Guide:[function(e,t,i){"use strict";cc._RF.push(t,"de3f2Q4A3JOtrWLJf8I4ofG","Guide");var c=e("Game");cc.Class({extends:cc.Component,properties:{mask:cc.Node,label:cc.Label,hand:cc.Node,btnNode:cc.Node,btnNode2:cc.Node,box:cc.Node},init:function(e){window.guide=this,this.id=e;var t=!1,i=!1;0==e?(this.hand.active=!1,this.btnNode.active=!0,t=!0,this.label.string="\u4eb2\u7231\u7684\u5192\u9669\u8005\uff0c\u662f\u5426\u9700\u8981\u6211\u6765\u5e2e\u52a9\u4f60\u4e86\u89e3\u4e00\u4e0b \u6e38\u620f\u73a9\u6cd5 \u5462\uff1f"):1==e?(this.hand.position=cc.v2(0,315),this.label.string="\u70b9\u51fb \u51fa\u53e3 \u8fdb\u5165\u4e0b\u4e00\u4e2a\u623f\u95f4\u3002"):2==e?(this.hand.rotation=180,this.hand.position=cc.v2(0,120),this.label.string="\u906d\u9047\u602a\u7269\uff0c\u70b9\u51fb\u8fdb\u5165\u6218\u6597\u3002"):3==e?(i=!0,this.hand.rotation=180,this.hand.position=cc.v2(0,-cc.winSize.height/2+310),this.label.string="\u4e0b\u65b9\u662f\u4f60\u63b7\u51fa\u6765\u7684\u5143\u7d20\u9ab0\u5b50\u3002"):4==e?(i=!0,this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u4e0a\u9762\u662f\u4f60\u643a\u5e26\u7684\u5143\u7d20\u6280\u80fd\u5361\u724c\u3002"):5==e?(this.hand.position=cc.v2(-248,-cc.winSize.height/2+600),this.label.string="\u70b9\u4eae\u5361\u724c\u6240\u9700\u5143\u7d20\uff0c\u5373\u53ef\u4f7f\u7528\u5361\u724c\u3002\u70b9\u51fb\u91ca\u653e\u5361\u724c\u6280\u80fd!"):6==e?(this.hand.position=cc.v2(310,-cc.winSize.height/2+760),this.label.string="\u672a\u70b9\u4eae\u7684\u5361\u724c\u4e0d\u80fd\u4f7f\u7528\uff0c\u600e\u4e48\u529e\u5462\uff1f\u70b9\u51fb \u91cd\u63b7 \u6309\u94ae\uff0c\u53ef\u4ee5\u91cd\u65b0\u6295\u51fa\u9ab0\u5b50\u3002",window.host.checkBtnRoll()):7==e?(this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u8fd0\u6c14\u4e0d\u9519\uff01\u6210\u529f\u70b9\u4eae\u5361\u724c\uff0c\u70b9\u51fb\u91ca\u653e\uff01"):8==e?(this.hand.rotation=180,this.hand.position=cc.v2(290,-cc.winSize.height/2+180),this.label.string="\u5b8c\u7f8e\uff01\u624b\u724c\u5168\u90e8\u6253\u5b8c\uff0c\u70b9\u51fb \u56de\u5408\u7ed3\u675f\u3002\u4e0b\u56de\u5408\u770b\u4f60\u7684\u8868\u73b0\uff01"):10==e?(this.hand.rotation=180,this.hand.position=cc.v2(-110,-cc.winSize.height/2+310),this.label.string="\u70b9\u51fb\u9ab0\u5b50 \u53ef\u9501\u5b9a/\u89e3\u9501\uff0c\u5728\u91cd\u63b7\u9ab0\u5b50\u65f6\u88ab\u4fdd\u7559\uff0c\u9002\u5408\u70b9\u4eae\u591a\u9700\u6c42\u5361\u724c\u3002"):11==e?(this.hand.rotation=180,this.hand.position=cc.v2(-280,-cc.winSize.height/2+230),this.label.string="\u70b9\u51fb \u6548\u679c\u56fe\u6807 \u53ef\u67e5\u770b\u6548\u679c\u8be6\u7ec6\u8bf4\u660e\u3002"):12==e?(this.hand.rotation=180,this.hand.position=cc.v2(130,-cc.winSize.height/2+180),this.label.string="\u53d7\u5230\u4f24\u5bb3\u53ef\u83b7\u5f97\u6012\u6c14\u3002\u6d88\u8017\u4e00\u5b9a\u6012\u6c14\uff0c\u53ef\u91ca\u653e\u6012\u6c14\u6280\u80fd\uff0c\u70b9\u51fb\u91ca\u653e\u3002"):20==e?(i=!0,this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u63b7\u51fa\u7684\u9ab0\u5b50\u5143\u7d20\u7b26\u5408\u5b9d\u7bb1\u5f00\u542f\u6761\u4ef6\uff0c\u5373\u53ef\u6fc0\u6d3b\u5b9d\u7bb1\u3002"):21==e?(i=!0,this.hand.rotation=180,this.hand.position=cc.v2(160,-cc.winSize.height/2+130),this.label.string="\u4e24\u4e2a\u5c0f\u6280\u80fd 2\u90091 \u91ca\u653e\uff0c\u53ef\u5e2e\u52a9\u4f60\u83b7\u5f97\u66f4\u591a\u5956\u52b1\u3002"):22==e?(i=!0,this.hand.rotation=180,this.hand.position=cc.v2(290,-cc.winSize.height/2+130),this.label.string="\u89c9\u5f97\u6ee1\u610f\u4e86\u968f\u65f6\u53ef\u4ee5\u9886\u53d6\u5956\u52b1\u79bb\u5f00\uff0c\u4e0d\u8981\u592a\u8d2a\u5fc3\u54af\u3002"):23==e?(i=!0,this.hand.active=!1,this.label.string="\u63a5\u4e0b\u6765\u5c31\u770b\u4f60\u7684\u5566\u3002"):24==e?(this.hand.active=!1,this.btnNode2.active=!0,t=!0,this.label.string="\u57fa\u7840\u4ecb\u7ecd\u5b8c\u6210!\r\n\u6b63\u5f0f\u7684\u5192\u9669\u8fd8\u6709\u66f4\u591a\u7cbe\u5f69\u5185\u5bb9!\r\n\u63a5\u4e0b\u6765\u4f60\u60f3..."):30==e?(this.hand.rotation=180,this.hand.position=cc.v2(312,-cc.winSize.height/2+110),this.label.string="\u83b7\u5f97\u65b0\u7684\u5361\u724c\u540e\uff0c\u53ef\u8fdb\u5165\u5361\u5305\u66f4\u6362\u51fa\u6218\u5361\u724c\u3002"):31==e&&(i=!0,this.hand.position=cc.v2(0,cc.winSize.height/2-400),this.label.string="\u70b9\u51fb\u5df2\u51fa\u6218\u5361\u724c\u53ef\u653e\u56de\u5361\u5305\uff0c\u70b9\u51fb\u5361\u5305\u4e2d\u7684\u724c\u53ef\u66f4\u6362\u4e3a\u51fa\u6218\u5361\u724c\u3002"),this.scheduleOnce(function(){i?this.mask.once(cc.Node.EventType.TOUCH_START,this.close,this):t||(this.mask.active=!1)}.bind(this),.2)},close:function(){this.id<30&&(c.data.guide=this.id+1),this.node.destroy(),window.guide=null,0==this.id?window.homeLayer.showGuide(this.id+1):3==this.id||4==this.id||6==this.id||7==this.id?window.mainLayer.showGuide(this.id+1):20==this.id||21==this.id||22==this.id?window.tavernLayer.showGuide(this.id+1):31==this.id&&(c.data.guideBag=-1)},startGuide:function(){c.data.guide=0,this.close(),window.homeLayer.initPath(),c.data.floorQuests[0]=[[1],[3],[1],[4],[7],[6],[8]],c.data.deck=[67,1,2]},skip:function(){c.data.guide=-1,this.node.destroy(),window.guide=null,window.homeLayer.initPath()},reguide:function(){this.close(),c.setDataToBase(),c.data.guide=0,c.begin=!0,cc.director.loadScene("helloworld")},goBattle:function(){this.close(),c.setDataToBase(),c.data.guide=-1,c.data.guideBag=-1,cc.director.loadScene("prepare")}}),cc._RF.pop()},{Game:"Game"}],HelloWorld:[function(e,t,i){"use strict";cc._RF.push(t,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var c=e("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,roomPrefab:cc.Prefab,stripHp:cc.ProgressBar,txtHp:cc.Label,stripExp:cc.ProgressBar,txtExp:cc.Label,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,txtEquipCount:cc.Label,markRed:cc.Node,layerNode:cc.Node,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,equipPrefab:cc.Prefab,completePrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab,btnMap:cc.Node,btnEquip:cc.Node,btnDeck:cc.Node,mask:cc.Node,chessPrefab:cc.Prefab,fortPrefab:cc.Prefab,boxFort:cc.Node,cardChangePrefab:cc.Prefab,cardDeletePrefab:cc.Prefab,soundPrefab:cc.Prefab,guidePrefab:cc.Prefab},onLoad:function(){window.homeLayer=this;var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmMap[c.data.castle-1],!0),this.boxFort.active=!1,0!=c.data.guide&&this.initPath(),c.data.historyChoose.length<=1&&this.initGameConfig(),this.hero=cc.instantiate(this.chessPrefab),this.bg.addChild(this.hero),this.createRoom(),this.refreshHeroData(),c.data.levelUp&&this.scheduleOnce(this.openLvUp,.3),this.status=0,this.mask.active=!0,this.mask.zIndex=1e3,this.mask.width=this.mask.height=100,this.schedule(this.updateMask,0),c.data.deck.length+c.data.cardBag.length>=7&&0==c.data.guideBag&&this.showGuide(30)},createRoom:function(){var e=cc.instantiate(this.roomPrefab);this.bg.addChild(e),this.room=e,this.hero.parent=e,this.hero.zIndex=10,c.begin?(e.getComponent("Room").init(!1),c.begin=!1):e.getComponent("Room").init(!1)},changeRoom:function(e){var t=cc.instantiate(this.roomPrefab);this.bg.addChild(t),t.getComponent("Room").init(!0);var i=cc.v2();0==e?(t.position=cc.v2(0,1450),i=cc.v2(0,-1450)):1==e?(t.position=cc.v2(1080,0),i=cc.v2(-1080,0)):2==e?(t.position=cc.v2(0,-1450),i=cc.v2(0,1450)):3==e&&(t.position=cc.v2(-1080,0),i=cc.v2(1080,0));var c=this.room;c.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.hero.parent=t,this.hero.zIndex=10,c.destroy()}.bind(this)))),t.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.room=t,t.getComponent("Room").initHero()}.bind(this))))},openAlter:function(){if(2==c.data.roomType){if(!window.campLayer){var e=cc.instantiate(this.campPrefab);this.node.addChild(e)}}else if(3==c.data.roomType)window.treasureLayer||this.openTreasure();else if(4==c.data.roomType){if(!window.eventLayer){var t=cc.instantiate(this.eventPrefab);this.node.addChild(t)}}else if(5==c.data.roomType){if(!window.shopLayer){var i=cc.instantiate(this.shopPrefab);this.layerNode.addChild(i)}}else 6==c.data.roomType&&(cc.director.loadScene("tavern"),window.homeLayer=null)},refreshHeroData:function(){this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax;var e=[5,15,21,39,47,73,150][c.data.level-1];this.txtExp.string=c.data.exp+"/"+e,this.stripExp.progress=c.data.exp/e;this.txtName.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtLevel.string="Lv."+c.data.level,this.txtCopper.string=c.data.copper,this.txtEquipCount.string=c.data.equip.length,this.markRed.active=c.newCard},openMap:function(){var e=cc.instantiate(this.mapPrefab);this.node.addChild(e)},openCardBag:function(){if(c.data.guide<0||c.data.guide>2){var e=cc.instantiate(this.bagPrefab);this.layerNode.addChild(e)}},openEquip:function(){if(c.data.guide<0||c.data.guide>2){var e=cc.instantiate(this.equipPrefab);this.layerNode.addChild(e)}},openTreasure:function(){var e=cc.instantiate(this.treasurePrefab);e.getComponent("TreasureLayer").init(),this.node.addChild(e)},openLvUp:function(){var e=cc.instantiate(this.lvUpPrefab);this.node.addChild(e)},openComplete:function(){var e=cc.instantiate(this.completePrefab);this.node.addChild(e)},initDeck:function(){if(4==c.data.heroId)c.data.cardBag=[1,2,3,4,5,6];else{var e=5==c.data.heroId?2:3;if(c.data.deck.length+c.data.cardBag.length<=e)for(;c.data.deck.length+c.data.cardBag.length<e;){var t=c.getNewCardId(null,!0);c.getCard(t)}}},initGameConfig:function(){this.initDeck(),c.data.eventIds=[];for(var e=0;e<30;e++){var t=Math.floor(Math.random()*(c.data.eventIds.length+1));c.data.eventIds.splice(t,0,e+1)}c.data.specialRoomIds=[3,4];for(var i=[[2,6,5],[2,3,4,6,5],[2,3,4,6]],o=0;o<3;o++)for(var a=i[o],s=a.length-1;s>=0;s--){var n=Math.floor(Math.random()*a.length);c.data.specialRoomIds.push(a[n]),a.splice(n,1)}c.data.specialRoomIds.push(5),c.data.floorQuests=[[],[],[],[[8],[-1]]];for(var r=0;r<3;r++)for(var h=0;h<13;h++)this.initFloorConfig(r,h)},initFloorConfig:function(e,t){var i=[];if(0==t)i=[1];else if(4==t)i=[7,7];else if(11==t)i=[8];else if(12==t)i=[0];else if(2==t||5==t||7==t||9==t)i=Math.random()<.4?[1,1,1]:[1,1];else{var o=c.data.specialRoomIds.shift();i=Math.random()<.3?[o,1,1]:[o,1]}c.data.floorQuests[e].push(i)},gotoEdit:function(){cc.director.loadScene("edit")},goBattle:function(){this.status=2,this.mask.active=!0,this.schedule(this.updateMask,0)},updateMask:function(){0==this.status?(this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1,this.status)):2==this.status&&(this.mask.width-=60,this.mask.height-=60,this.mask.width<=100&&(this.mask.width=this.mask.height=100,this.unschedule(this.updateMask),window.homeLayer=null,cc.director.loadScene("mainLayer")))},initPath:function(){if(c.data.castle<4){this.boxFort.active=!0,this.pathList=[];for(var e=c.data.guide>0?7:12,t=0;t<e;t++){var i=cc.instantiate(this.fortPrefab);i.scale=.8,i.x=-(e-1)/2*54+54*t,this.boxFort.addChild(i),this.pathList.push(i),0==t?i.getComponent("Fort").init(1,1,!1):t==e-1?i.getComponent("Fort").init(8,1,!1):t<=c.data.historyChoose.length-2&&i.getComponent("Fort").init(c.data.historyChoose[t+1],1,!1)}this.boxFort.width=54*(e-1)}else this.boxFort.active=!1},refreshPath:function(){c.data.floor>1&&c.data.castle<4&&(this.pathList[c.data.floor-2].getComponent("Fort").init(c.data.roomType,1,!0),c.data.floor>2&&this.pathList[c.data.floor-3].getComponent("Fort").hide())},getCard:function(e){if(1==c.data.heroId&&3==c.data.difficulty)if(c.data.deck.length<6)c.getCard(e);else{var t=cc.instantiate(this.cardChangePrefab);t.getComponent("CardChangeLayer").init(e),this.node.addChild(t,100)}else c.getCard(e)},openDelete:function(){var e=cc.instantiate(this.cardDeletePrefab);this.node.addChild(e,100)},showGuide:function(e){this.scheduleOnce(function(){if(!window.guide){var t=cc.instantiate(this.guidePrefab);t.getComponent("Guide").init(e),this.node.addChild(t)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],Hero:[function(e,t,i){"use strict";cc._RF.push(t,"7311fX1RYNN1bDgBGcTZsee","Hero");var c=e("Game");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,skillPrefab:cc.Prefab,head:cc.Node,skillNode:cc.Node,txtDice:cc.Label,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){this.btnEnd=window.mainLayer.btnEnd,this.btnRoll=window.mainLayer.btnRoll,this.txtRollCount=window.mainLayer.txtRollCount,this.initDeck(),this.diceCount=5,3==c.data.heroId&&3==c.data.difficulty&&(this.diceCount=2),this.player.init(0),this.hpMax=c.data.hpMax,this.hp=c.data.hp,this.power=c.data.power,10==c.data.guide&&(this.power=3),this.powerMax=c.data.powerMax,this.armor=0,this.rollabled=!0,this.refreshStrip(),this.initSkills()},startRound:function(){this.btnEnd.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.2,cc.v2(-275,this.btnEnd.y))))},endRound:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").abled=!0;this.checkSkills(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-475,this.btnEnd.y))),this.player.totalRollCount=this.player.rollCount,this.player.rollCount=0,this.checkBtnRoll()},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onHurt:function(e,t,i,c){if(!window.mainLayer.gameOver){var o=this.hp;if(i=i||7,c=null!=c?c:1,this.player.onHurt(e,t,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),o>this.hp){var a=o-this.hp;this.equip.checkWithTrigger(163)&&(a*=2),this.addPower(a)}}},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(e){e>0&&this.player.opponent.equip.checkWithTrigger(178)||(this.power+=e,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.checkSkills())},initSkills:function(){this.btnSkills=[];for(var e=0;e<2;e++){var t=cc.instantiate(this.skillPrefab);t.position=cc.v2(0==e?127:285,31),t.getComponent("Skill").init(e),this.skillNode.addChild(t),this.btnSkills.push(t)}},checkSkills:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").check()},checkBtnRoll:function(e){var t=!1;if(this.player.rollCount>0&&this.player.diceList.length>0)if(this.player.cardList.length>0)t=!0;else if(this.player.chestList)for(var i=0;i<3;i++)if(this.player.chestList[i]){t=!0;break}(c.data.guide>0&&c.data.guide<6||10==c.data.guide)&&(t=!1);var o=this.btnRoll.y;t!=this.rollabled?(this.rollabled=t,this.btnRoll.stopAllActions(),t?this.btnRoll.runAction(cc.moveTo(.15,cc.v2(310,o))):this.btnRoll.runAction(cc.moveTo(.15,cc.v2(425,o)))):t&&e&&(this.btnRoll.stopAllActions(),this.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(425,o)),cc.moveTo(.15,cc.v2(310,o))))),this.txtRollCount.string=this.player.rollCount},initDeck:function(){if(4==c.data.heroId){if(this.deck=c.data.cardBag.concat(),3==c.data.difficulty)for(var e=0;e<c.data.level;e++)this.deck.push(224)}else this.deck=c.data.deck.concat()},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};t[e]&&(this.head.color=cc.Color.WHITE.fromHEX("#"+t[e]),window.mainLayer.camera.stopAllActions(),window.mainLayer.camera.runAction(cc.sequence(cc.moveTo(.05,cc.v2(5,5)),cc.moveTo(.1,cc.v2(-5,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){window.mainLayer.camera.position=cc.v2(0,0),this.head.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Game:"Game"}],ItemCollection:[function(e,t,i){"use strict";cc._RF.push(t,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.RichText,icon:cc.Sprite,boxHead:cc.Sprite},init:function(e){var t=o.get("cfg_item",e),i=[cc.color(85,229,255),cc.color(255,128,242),cc.color(255,154,73)];this.txtName.string=t.name;var a=c.analysisDesc(t.desc1),s=-1;10==e?s=c.data.itemEffect.feather>0?1:0:28==e?s=c.data.itemEffect.vase:29==e?s=c.data.itemEffect.flagon:74==e?s=c.data.itemEffect.pen:158==e&&(s=c.data.itemEffect.reviveBook>0?1:0),s>=0&&(a+="<color=#EBC82E>  (\u5269\u4f59\u6b21\u6570"+s+")</c>"),this.txtDesc.string=a,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][t.quality-1],this.txtQuality.node.color=i[t.quality-1],cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+t.quality,cc.SpriteFrame,function(e,t){this.boxHead.spriteFrame=t}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ItemCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtName2:cc.Label,icon:cc.Sprite,bg:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,explode:cc.Node},init:function(e,t){var i=o.get("cfg_item",e);this.txtName.string=this.txtName2.string=i.name,this.txtDesc.string=c.analysisDesc(i.desc1),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_item"+i.quality,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+i.quality,cc.SpriteFrame,function(e,t){this.boxIcon.spriteFrame=t}.bind(this)),null!=t&&(this.explode.active=!0,-1==t?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(e,t){this.explode.getComponent(cc.Sprite).spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(e,t){this.explode.getComponent(cc.Sprite).spriteFrame=t}.bind(this)))},hideBox:function(){this.bg.node.active=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Item:[function(e,t,i){"use strict";cc._RF.push(t,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,iconBtn:cc.Button,boxNum:cc.Node,txtCount:cc.Label,tip:cc.Node,txtDesc:cc.RichText,box:cc.Node,bg:cc.Sprite},init:function(e,t,i){this.cfgId=e,this.cfg=o.get("cfg_item",e),this.equip=t,cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),43!=e&&146!=e&&166!=e||(this.boxNum.active=!0),i&&(this.boxNum.active=!1,cc.loader.loadRes("Texture/UI/box_icon"+this.cfg.quality,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this))),this.layer=window.mainLayer||window.completeLayer},trigger:function(){this.action&&this.icon.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.5),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,1==this.cfg.num&&this.doDisabled()}.bind(this))),this.icon.node.runAction(this.action)},doDisabled:function(){this.iconBtn.enableAutoGrayEffect=!0},openTip:function(){if(!this.equip||1!=this.equip.index){if(this.layer.equipTip){if(this.layer.equipTip==this)return void this.hideTip();this.layer.equipTip.hideTip()}this.tip.active=!0,this.layer.equipTip=this;this.txtDesc.string="<color=#"+["5CC7FF","C262FF","FF9231"][this.cfg.quality-1]+">"+this.cfg.name+"\uff1a</c>"+c.analysisDesc(this.cfg.desc1),this.node.x<-220?this.box.x=-220-this.node.x:this.node.x>220&&(this.box.x=220-this.node.x),this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.tip.active=!1,this.layer.equipTip=null},refresh:function(e){this.cfgId=e,this.cfg=o.get("cfg_item",e),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),43!=e&&146!=e&&166!=e||(this.boxNum.active=!0),this.iconBtn.enableAutoGrayEffect=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LevelUpLayer:[function(e,t,i){"use strict";cc._RF.push(t,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,boxSkill:cc.Node,iconSkill:cc.Sprite,txtSkill:cc.Label,boxCard:cc.Node,btns:[cc.Node],txtLevel:cc.Label,shine:cc.Node,boxReward:cc.Node,txtNext:cc.Node,mask:cc.Node,bg:cc.Node,bgNode:cc.Node,boxMax:cc.Node},onLoad:function(){this.type=3,3==c.data.level?this.initSkill():5==c.data.level||7==c.data.level?(this.type=2,this.initItems()):(this.type=1,this.initCards()),this.txtLevel.string=c.data.level,this.boxReward.opacity=1,this.shine.opacity=1,this.bg.height=400,this.step=0,this.schedule(this.updateFrame,0),this.shine.runAction(cc.rotateBy(5,360).repeatForever()),this.shine.runAction(cc.fadeIn(.5)),cc.audioEngine.playEffect(window.sound.levelUpSound)},updateFrame:function(){if(0==this.step)this.bg.height+=30,this.bg.height>846&&this.step++;else if(this.bg.height-=3,this.bg.height<=826){this.unschedule(this.updateFrame),this.boxReward.opacity=255;for(var e=0;e<2;e++)this.btns[e].opacity=1,this.btns[e].y-=100,this.btns[e].runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,110)),cc.moveBy(.1,cc.v2(0,-10)))))}},initCards:function(){this.boxCard.active=!0,this.itemIdList=[],this.items=[];var e=c.getNewCardId(null,!1,!0);this.itemIdList.push(e);for(var t=0;t<=0;){var i=c.getNewCardId(null,!1,!0);i!=e&&(t=i)}this.itemIdList.push(t);for(var o=0;o<2;o++){var a=cc.instantiate(this.cardPrefab);a.getComponent("CardCollection").init(this.itemIdList[o]),a.position=cc.v2(0==o?-170:170,45),this.boxCard.addChild(a),this.items.push(a)}},initItems:function(){this.boxCard.active=!0,this.itemIdList=[],this.items=[];var e=c.getNewItemId(0,null,!0);this.itemIdList.push(e);for(var t=0;t<=0;){var i=c.getNewItemId(0,null,!0);i!=e&&(t=i)}this.itemIdList.push(t);for(var o=0;o<2;o++){var a=cc.instantiate(this.itemPrefab);a.getComponent("ItemCommodity").init(this.itemIdList[o]),a.position=cc.v2(0==o?-170:170,45),this.boxCard.addChild(a),this.items.push(a)}},initSkill:function(){this.boxSkill.active=!0;this.txtSkill.string=["\u72c2\u6012","\u5927\u6ee1\u8d2f","\u6536\u5272","\u751f\u673a"][c.data.heroId-1],cc.loader.loadRes("Texture/hero/skill/"+2*c.data.heroId,cc.SpriteFrame,function(e,t){this.iconSkill.spriteFrame=t}.bind(this)),this.scheduleOnce(function(){this.txtNext.active=!0,this.mask.on(cc.Node.EventType.TOUCH_START,this.close,this)}.bind(this),.5)},choose:function(e,t){1==this.type?window.homeLayer.getCard(this.itemIdList[t]):c.getItem(this.itemIdList[t]),this.close(t),cc.audioEngine.playEffect(window.sound.selectSound)},close:function(e){if(c.data.levelUp=!1,3==this.type)this.node.destroy();else{this.mask.runAction(cc.fadeOut(.2)),this.bgNode.active=!1,this.boxMax.active=!1,this.btns[0].active=this.btns[1].active=!1,this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4);var t=cc.winSize.height/cc.winSize.width*750;this.items[1-e].active=!1,1==this.type?this.items[e].runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.spawn(cc.moveTo(.3,cc.v2(312,-t/2-80+115+33+120-30)),cc.scaleTo(.3,.4)))):(this.items[e].getComponent("ItemCommodity").hideBox(),this.items[e].runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveTo(.3,cc.v2(211,-t/2-80+115+33+120-30-35)))))}}}),cc._RF.pop()},{Game:"Game"}],LoseLayer:[function(e,t,i){"use strict";cc._RF.push(t,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,btnRestart:cc.Node,btnQuit:cc.Node,txtCount:cc.Label},onLoad:function(){this.title.y+=350,this.title.runAction(cc.moveBy(.2,cc.v2(0,-350))),this.btnRestart.opacity=1,this.btnQuit.opacity=1,this.btnRestart.y-=150,this.btnQuit.y-=150,this.btnRestart.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnQuit.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.scheduleOnce(function(){this.txtCount.string=c.data.restartCount>100?"":"\u5269\u4f59\u6b21\u6570 "+c.data.restartCount}.bind(this),.4),c.data.restartCount<=0&&(this.btnRestart.getComponent(cc.Button).interactable=!1),cc.audioEngine.playEffect(window.sound.lose)},restart:function(){var e=JSON.parse(JSON.stringify(c.data));c.data=c.tempData,c.data.historyPath=e.historyPath,c.data.historyChoose=e.historyChoose,c.data.monsterList=e.monsterList,c.data.restartCount--,cc.director.loadScene("helloworld")},quit:function(){var e=c.data.guide;c.setDataToBase(),c.data.guide=e,c.data.guideBag=-1,cc.director.loadScene("prepare")}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(e,t,i){"use strict";cc._RF.push(t,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{heroPrefab:cc.Prefab,enemyPrefab:cc.Prefab,enemyNode:cc.Node,endPrefab:cc.Prefab,losePrefab:cc.Prefab,editEndPrefab:cc.Prefab,btnEnd:cc.Node,btnRoll:cc.Node,boxCardHero:cc.Node,boxDiceHero:cc.Node,boxCardEnemy:cc.Node,boxDiceEnemy:cc.Node,board:cc.Node,camera:cc.Node,txtRollCount:cc.Label,bg:cc.Sprite,mask:cc.Node,chooseDiceLayer:cc.Prefab,soundPrefab:cc.Prefab,guidePrefab:cc.Prefab},onLoad:function(){window.mainLayer=this,this.gameOver=!1,cc.loader.loadRes("Texture/scene/castle"+c.data.castle,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this)),this.bg.node.on(cc.Node.EventType.TOUCH_START,this.hideTip,this),this.mask.active=!0,this.mask.zIndex=1e3,this.schedule(this.updateMask,0);var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),8==c.data.roomType?cc.audioEngine.playMusic(window.sound.bgmBoss[c.data.castle-1],!0):cc.audioEngine.playMusic(window.sound.bgmBattle[c.data.castle-1],!0)},start:function(){var e=cc.instantiate(this.heroPrefab);e.position=cc.v2(0,115-cc.winSize.height/2),this.node.addChild(e),this.hero=e.getComponent("Hero");var t=cc.instantiate(this.enemyPrefab);t.position=cc.v2(0,cc.winSize.height/2-330),this.enemyNode.addChild(t),this.enemy=t.getComponent("Enemy"),this.enemy.init(),this.hero.init(),this.roundId=1,this.scheduleOnce(function(){this.enemy.equip.checkWithTrigger(141)&&!this.hero.equip.checkWithTrigger(141)&&(this.roundId=0),this.doRound()}.bind(this),.5)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.player.startRound(),0==this.roundId&&(11==c.data.guide?this.showGuide(11):12==c.data.guide&&(window.host.power<10&&window.host.addPower(10-window.host.power),this.showGuide(12)))},showEnd:function(e,t){if(!this.gameOver)if(this.gameOver=!0,c.editCfg){var i=cc.instantiate(this.editEndPrefab);this.node.addChild(i)}else this.scheduleOnce(function(){if(0==e){var i=cc.instantiate(this.endPrefab);i.getComponent("EndLayer").init(t),this.node.addChild(i)}else{c.data.monsterUnbeats.push(c.monsterId);var o=cc.instantiate(this.losePrefab);this.node.addChild(o)}}.bind(this),.5)},roll:function(){3==c.data.heroId?this.chooseDice():this.hero.player.roll()},chooseDice:function(){var e=cc.instantiate(this.chooseDiceLayer);this.node.addChild(e,100)},endRound:function(){c.data.guide>0&&c.data.guide<8||10==c.data.guide||(this.hero.player.endRound(),window.guide&&window.guide.close())},hideTip:function(){this.equipTip&&this.equipTip.hideTip(),this.buffTip&&this.buffTip.hideTip()},updateMask:function(){this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1)},showGuide:function(e){this.scheduleOnce(function(){if(!window.guide){var t=cc.instantiate(this.guidePrefab);t.getComponent("Guide").init(e),this.node.addChild(t)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2be16dXDepLLbZP42Rqq+om","MapLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{mask:cc.Node,view:cc.Node,top:cc.Node,bottom:cc.Node,box:cc.Node,maskList:[cc.Node],dice:dragonBones.ArmatureDisplay},onLoad:function(){window.mapLayer=this,this.box.opacity=1,this.mask.opacity=1,this.mask.runAction(cc.sequence(cc.fadeTo(.2,180),cc.callFunc(function(){this.openMap()}.bind(this))));for(var e=0;e<4;e++)e<c.data.castle-1&&(this.maskList[e].active=!1);this.scheduleOnce(this.roll,.5),cc.audioEngine.playEffect(window.sound.bagOpenSound)},openMap:function(){this.box.opacity=255,this.winHeight=cc.winSize.height/cc.winSize.width*750,this.bottom.y=-this.winHeight/2+275,this.bottom.runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.05,cc.v2(0,-150)),cc.moveBy(.1,cc.v2(0,-50)),cc.moveBy(.1,cc.v2(0,15)))),this.top.y=-this.winHeight/2+380,this.top.runAction(cc.sequence(cc.delayTime(.05),cc.moveTo(.3,cc.v2(0,this.winHeight/2-39)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.1,cc.v2(0,-10)))),this.view.height=50,this.view.y=(this.bottom.y+this.top.y)/2-30,this.frame=0,this.schedule(this.updateFrame,0)},updateFrame:function(){this.frame++,this.view.height=this.top.y-this.bottom.y-15,this.view.y=(this.bottom.y+this.top.y)/2-30},roll:function(){var e=[cc.v2(10,-430),cc.v2(-50,-135),cc.v2(-25,125),cc.v2(-65,390)];this.dice.node.position=e[c.data.castle-1],c.data.castle%2==0&&(this.dice.node.scaleX=-1),this.dice.playAnimation("play0",1),this.dice.on(dragonBones.EventObject.LOOP_COMPLETE,function(){this.maskList[c.data.castle-1].runAction(cc.fadeOut(.5))}.bind(this)),this.scheduleOnce(this.close,2.5)},close:function(){this.bottom.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveBy(.1,cc.v2(0,50)),cc.moveTo(.1,cc.v2(0,-this.winHeight/2+280)))),this.top.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,10)),cc.moveBy(.1,cc.v2(0,-20)),cc.moveTo(.2,cc.v2(0,-this.winHeight/2+385)))),this.mask.runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.15,cc.v2(0,-400)),cc.callFunc(function(){this.node.destroy(),window.mapLayer=null,c.data.guide>=0&&1==c.data.heroId&&1==c.data.difficulty&&window.homeLayer.showGuide(0)}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(e,t,i){"use strict";cc._RF.push(t,"52880hyyK1GjLw1tAGJFFaD","Opening");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.login()},login:function(){o.load(function(){c.getData(function(){cc.director.loadScene("cover")}.bind(this))}.bind(this))},loadRes:function(){}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerTavern:[function(e,t,i){"use strict";cc._RF.push(t,"f1734zLgkZCHperU+957PgJ","PlayerTavern");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,btnRoll:cc.Node,btnEnd:cc.Node,boxCard:cc.Node,boxDice:cc.Node,txtRollCount:cc.Label},onLoad:function(){window.player=this,this.cardPool=new cc.NodePool;for(var e=0;e<6;e++){var t=cc.instantiate(this.cardPrefab);this.cardPool.put(t)}this.dicePool=new cc.NodePool;for(var i=0;i<5;i++){var c=cc.instantiate(this.dicePrefab);this.dicePool.put(c)}this.diceUsabld=!0,this.scheduleOnce(this.startRound,.5)},startRound:function(){this.rollCount=2,this.diceUsabld=!1,this.initCards(),this.initDices(),c.data.guide>0&&window.tavernLayer.showGuide(20)},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];for(var e=0;e<5;e++){var t=null;(t=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab)).position=cc.v2(110*e-220,-200),this.boxDice.addChild(t),this.diceList.push(t)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[],this.deck=this.getRandomCards();for(var e=0;e<6;e++)this.drawCard(this.deck[e])},getRandomCards:function(e){for(var t=[],i=0;t.length<6;){for(var c=0,a=Math.random(),s=0,n=t.length<4?1:19,r=t.length<4?18:30,h=n;h<=r;h++){if(a<(s+=o.get("cfg_tavern",h).rate)){c=h;break}}t.indexOf(c)<0&&(!e||e.indexOf(c)<0)&&(c>=9&&c<=11||15==c?i<2&&(t.push(c),i++):t.push(c))}return t},drawCard:function(e){var t=this.getEmptyIndex();if(!(t<0)){var i=null;(i=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("CardTavern").init(e,t),this.boxCard.addChild(i,100),this.cardList.push(i),cc.audioEngine.playEffect(window.sound.drawSound)}},patchCard:function(e){this.drawCard(e),this.checkCardsRequire(),this.checkBtnRoll()},roll:function(e){for(var t=0;t<this.diceList.length;t++){var i=this.diceList[t].getComponent("DiceTavern");1==e?i.roll():i.holded||i.roll()}this.endRoll(e),e?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound)},endRoll:function(e){e?this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2):(this.checkElement(),this.rollCount--,this.checkBtnRoll())},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var e=0;e<this.diceList.length;e++){var t=this.diceList[e].getComponent("DiceTavern");t.lock||this.elementList[t.element-1]++}this.cardAbledCount=this.checkCardsRequire()},refreshDiceBuff:function(){this.checkElement(),this.checkBtnRoll(),this.diceUsabld=!0,this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-275,this.btnEnd.y)))},checkCardsRequire:function(){for(var e=0,t=0;t<this.cardList.length;t++){this.cardList[t].getComponent("CardTavern").checkRequire()&&e++}return e},getEmptyIndex:function(){for(var e=0;e<6;e++){for(var t=!1,i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("CardTavern").index==e){t=!0;break}}if(!t)return e}return-1},addRollCount:function(){this.rollCount++,this.checkBtnRoll()},checkBtnRoll:function(){var e=this.btnRoll.y;this.rollCount>0?this.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(425,e)),cc.moveTo(.15,cc.v2(310,e)))):this.btnRoll.runAction(cc.moveTo(.15,cc.v2(425,e))),this.txtRollCount.string=this.rollCount},changeAllCards:function(){for(var e=0;e<6;e++){this.cardList[0].getComponent("CardTavern").discard()}var t=this.deck.concat();this.deck=this.getRandomCards(t);for(var i=0;i<6;i++)this.drawCard(this.deck[i]);this.checkCardsRequire(),this.checkBtnRoll()},checkRewards:function(){for(var e=[],t=0;t<this.cardList.length;t++){var i=this.cardList[t].getComponent("CardTavern");i.usable&&e.push(i.cfgId)}return e}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Sprite]},init:function(e){this.index=e,this.win=0,this.dicePool=new cc.NodePool;for(var t=0;t<5;t++){var i=cc.instantiate(this.dicePrefab);this.dicePool.put(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){this.diceList=[];for(var e=0;e<5;e++){var t=this.dicePool.get();t.getComponent("DiceYahtzee").init(e,this.index),this.boxDice.addChild(t),this.diceList.push(t)}this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check(),cc.audioEngine.playEffect(window.sound.rollSound2)}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.hold(),t.abled=!1}cc.audioEngine.playEffect(window.sound.holdSound)}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){e[this.diceList[t].getComponent("DiceYahtzee").element-1]++}e.sort(function(e,t){return t-e}),5==e[0]?this.score=7:4==e[0]?this.score=6:3==e[0]?2==e[1]?this.score=5:this.score=4:2==e[0]?2==e[1]?this.score=3:this.score=1:this.score=2},doWin:function(){cc.loader.loadRes("Texture/battle/mark_crown1",cc.SpriteFrame,function(e,t){this.crowns[this.win].spriteFrame=t,this.win++}.bind(this)),cc.audioEngine.playEffect(window.sound.bingo)}}),cc._RF.pop()},{}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"ba4f5YaUElBy61UWqBofsfz","Player");var c=e("Game"),o=e("Utils"),a=e("Config"),s=e("CardManager");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,chestPrefab:cc.Prefab,dmgAnimation:cc.Prefab},init:function(e){this.index=e,0==e?(this.host=this.getComponent("Hero"),this.opponent=window.mainLayer.enemy.player,this.boxCard=window.mainLayer.boxCardHero,this.boxDice=window.mainLayer.boxDiceHero):(this.host=this.getComponent("Enemy"),this.opponent=window.mainLayer.hero.player,this.boxCard=window.mainLayer.boxCardEnemy,this.boxDice=window.mainLayer.boxDiceEnemy),this.cardPool=new cc.NodePool;for(var t=0;t<6;t++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var o=0;o<5;o++){var a=cc.instantiate(this.dicePrefab);this.dicePool.put(a)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.atkPlayed=0,this.atkRound=0,this.dmgRound=0,this.diceUsabld=!0,this.cardUsabled=!0,this.elementList=[0,0,0,0,0,0],this.createDiceRound=[0,0,0,0,0,0],this.delayCard=[],this.legacyDice=[],this.deck=this.host.deck,0==this.index&&(3==c.data.heroId&&4==c.data.difficulty?this.bag=c.data.cardBag.concat():4==c.data.heroId&&2==c.data.difficulty&&(this.cemetery=[]));var s=cc.instantiate(this.dmgAnimation);this.node.addChild(s),0==this.index?(s.scale=.8,s.position=cc.v2(-302,33)):s.position=cc.v2(0,this.host.figureNode.y+this.host.figure.height/2),this.anim=s.getComponent("DmgAnimation"),this.anim.init(e)},start:function(){this.buff=this.getComponent("Buff"),this.buff.init(),this.equip=this.getComponent("Equip"),this.equip.init(),this.diceCount=this.host.diceCount;for(var e=[85,86,89,90,91,92],t=0;t<e.length;t++)this.equip.checkWithTrigger(e[t])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++,this.host.txtDice.string="\xd7"+this.diceCount,this.scheduleOnce(function(){this.checkGameBegin(),0==this.index&&c.data.debuff>0&&this.host.onHurt(5*c.data.debuff,1,7,2)}.bind(this),.4),0==this.index&&3==c.data.heroId&&2==c.data.difficulty&&(this.totalRollCount=this.equip.checkWithTrigger(58)?7:6)},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,0==this.index?2==c.data.heroId?this.rollCount=1:3==c.data.heroId&&(2==c.data.difficulty?this.rollCount=this.totalRollCount:3==c.data.difficulty&&this.rollCount--):(this.rollCount+=this.host.exRollCount,2==c.data.heroId&&4==c.data.difficulty&&this.rollCount++),this.checkStart(),0==this.index&&(this.diceUsabld=!1,this.cardUsabled=!1,4==c.data.heroId?(2!=c.data.difficulty||this.round<=1)&&(this.deckArray=this.deck.concat(),this.deckArray.sort(function(e,t){return.5-Math.random()})):5==c.data.heroId&&(this.chestList=[null,null,null],this.createChest())),this.initCards(),this.initDices(),window.mainLayer.gameOver||this.host.startRound()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var e=this.diceCount+this.extraDice,t=o.getDifferentRandomNum(e,e-1,0),i=Math.min(this.buff.lock,e),a=t.splice(0,i);this.buff.removeBuff(28,i);var s=0,n=[];this.equip.checkWithTrigger(63)||(s=Math.min(this.buff.freeze,e-i),n=t.splice(0,s),this.buff.removeBuff(22,s));var r=t.concat(n),h=Math.min(this.buff.blind,e-i),d=r.splice(0,h);this.buff.removeBuff(30,h);for(var l=0;l<e;l++){for(var f=[],u=0;u<a.length;u++)if(l==a[u]){f.push(28);break}if(0==f.length){for(var p=0;p<n.length;p++)if(l==n[p]){f.push(22);break}for(var m=0;m<d.length;m++)if(l==d[m]){f.push(30);break}}var g=null;g=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab);var w=0;w=e<=6?-(e-1)/2*110+110*l:640/(e-1)*l-320,g.position=cc.v2(w,0==window.mainLayer.roundId?-120:600),g.getComponent("Dice").init(l,f),this.boxDice.addChild(g),this.diceList.push(g),3==c.data.heroId&&3==c.data.difficulty&&(g.getComponent("Dice").remembered=!0)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[];var e=this.deck;0==this.index&&4==c.data.heroId&&(e=this.deckArray);for(var t=Math.min(e.length,6),i=this.equip.checkWithTrigger(66)?0:this.buff.silence,o=this.equip.checkWithTrigger(62)?0:this.buff.burn,s=0;s<t;s++){var n=null,r=a.get("cfg_card",e[s]).element;this.buff.silenceDark&&6==r?n=25:Math.random()<i/(t-s)?(n=25,i--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==r?n=21:Math.random()<o/(t-s)&&(n=21,o--,this.buff.removeBuff(21,1)),this.drawCard(e[s],n)}0==this.index&&4==c.data.heroId&&this.deckArray.splice(0,t)},drawCard:function(e,t,i){var c=this.getEmptyIndex();if(!(c<0)){var o=null;return(o=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(e,c,t,0),o.getComponent("Card").isTemp=i,this.boxCard.addChild(o,100),this.cardList.push(o),cc.audioEngine.playEffect(window.sound.drawSound),o}},patchCard:function(e,t,i){var o=this.buff,s=null;e=e||c.getRandomCardId();var n=a.get("cfg_card",e).element;o.silenceDark&&6==n?s=25:o.silence>0&&!this.equip.checkWithTrigger(66)?(s=25,o.removeBuff(25,1)):o.burnIce&&2==n?s=21:o.burn>0&&!this.equip.checkWithTrigger(62)&&(s=21,o.removeBuff(21,1));var r=this.drawCard(e,s,!t);if(r)return r.getComponent("Card").initBuff(),i&&r.getComponent("Card").disCost(),this.checkCardsRequire(),this.host.checkBtnRoll&&this.host.checkBtnRoll(),this.equip.trigger(119),r},suppleCard:function(){if(!(this.deckArray.length<=0)){var e=this.deckArray[0];this.patchCard(e,!0)&&this.deckArray.shift()}},roll:function(e,t){var i=void 0;3==c.data.guide?i=[2,2,5,6,2]:6==c.data.guide?i=[4,1,4,6,5]:7==c.data.guide?i=[3,2,1,3,6]:10==c.data.guide?i=[1,c.guideChoose+3,1,2,5]:11==c.data.guide&&1==this.index&&(i=[4,2,5,6]);for(var o=0;o<this.diceList.length;o++){var a=this.diceList[o].getComponent("Dice");i?a.roll(i[o]):1==e?0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.lastDices&&this.lastDices[o]?a.roll(this.lastDices[o]):a.roll():a.freeze||a.lock||a.temp||(t?(a.holded&&a.hold(),a.roll(t)):a.holded||a.roll(),a.initBuff())}this.endRoll(e),e?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound),window.guide&&6==c.data.guide&&window.guide.close()},endRoll:function(e){if(e)this.scheduleOnce(function(){this.refreshCardBuff(),this.checkElement(),0==this.index&&3==c.data.heroId&&2==c.data.difficulty||this.rollCount--,3==c.data.guide&&window.mainLayer.showGuide(3);for(var e=0;e<this.legacyDice.length;e++)this.createExDice(this.legacyDice[e],!0);this.legacyDice=[]}.bind(this),.2);else{this.checkElement();for(var t=0,i=0;i<6;i++)this.elementList[i]>0&&t++;if(t>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.rollCount--,this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),this.opponent.equip.trigger(176),0==this.index)if(2==c.data.heroId){if(3==c.data.difficulty);else if(5==c.data.difficulty){for(var o=[],a=0;a<this.diceList.length;a++){var s=this.diceList[a].getComponent("Dice");s.blind||s.lock||o.push(s)}if(o.length>0){var n=o[Math.floor(Math.random()*o.length)];n.buffList.push(30),n.blind=!0,n.markBlind.active=!0}else window.player.buff.addBuff(30,1)}}else 4==c.data.heroId&&5==c.data.difficulty&&Math.random()<.5&&this.buff.addBuff(27,1)}},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var e=0;e<this.diceList.length;e++){var t=this.diceList[e].getComponent("Dice");t.lock||this.elementList[t.element-1]++}if(this.cardAbledCount=this.checkCardsRequire(),this.chestList)for(var i=0;i<3;i++)this.chestList[i]&&this.chestList[i].getComponent("Chest").checkRequire()},refreshCardBuff:function(){for(var e=0;e<this.cardList.length;e++)this.cardList[e].getComponent("Card").initBuff();this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2),this.opponent.equip.trigger(170)},refreshDiceBuff:function(){for(var e=0;e<this.diceList.length;e++)this.diceList[e].getComponent("Dice").initBuff();if(this.checkElement(),1==this.index&&1==c.data.heroId&&4==c.data.difficulty&&this.cardList.length<6){var t=c.getRandomCardId(null,3);this.patchCard(t)}else 0==this.index&&2==c.data.heroId&&3==c.data.difficulty&&(this.randomCard=this.patchCard(),this.randomCard.getComponent("Card").discribeRandom());for(var i=0,o=0;o<6;o++)this.elementList[o]>0&&i++;i>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.cardAbledCount<=0&&this.equip.trigger(45);for(var a=48;a<=53;a++)this.equip.trigger(a);this.equip.trigger(93),this.equip.trigger(128),this.equip.trigger(174),this.host.checkBtnRoll&&(this.host.checkBtnRoll(!0),this.diceUsabld=!0,this.cardUsabled=!0)},createExDice:function(e,t,i){var o=[];this.buff.lock>0?(o.push(28),this.buff.removeBuff(28,1)):(this.buff.freeze>0&&!this.equip.checkWithTrigger(63)&&(o.push(22),this.buff.removeBuff(22,1)),this.buff.blind>0&&(o.push(30),this.buff.removeBuff(30,1)));var a=null;a=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab),this.diceList.length<=5?a.x=this.diceList.length/2*110:a.x=320,a.getComponent("Dice").init(this.diceList.length-1,o),this.boxDice.addChild(a),this.diceList.push(a),a.getComponent("Dice").roll(e),a.getComponent("Dice").initBuff(),e&&!t&&a.getComponent("Dice").doTemp(),3==c.data.heroId&&3==c.data.difficulty&&i&&(a.getComponent("Dice").remembered=!0);for(var s=0;s<this.diceList.length;s++){var n=this.diceList[s];n.stopAllActions(),n.opacity=255;var r=0;r=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*s:640/(this.diceList.length-1)*s-320,n.runAction(cc.moveTo(.2,cc.v2(r,0)))}this.checkElement(),this.extraDice++,this.host.txtExDice.string="(+"+this.extraDice+")"},endRound:function(){for(var e=this.cardList.length-1;e>=0;e--){if(0==this.index)if(3==c.data.heroId&&4==c.data.difficulty){if(this.bag.length>0){var t=this.deck.indexOf(this.cardList[e].getComponent("Card").cfgId);if(t>=0){var i=Math.floor(Math.random()*this.bag.length),o=this.bag.splice(i,1);this.deck.splice(t,1,o),this.bag.push(this.cardList[e].getComponent("Card").cfgId)}}}else 4==c.data.heroId&&2==c.data.difficulty&&this.deckArray.unshift(this.cardList[e].getComponent("Card").cfgId);this.cardList[e].getComponent("Card").remove(!0)}this.lastDices=[];for(var a=0;a<this.diceList.length;a++)0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.diceList[a].getComponent("Dice").remembered&&this.lastDices.push(this.diceList[a].getComponent("Dice").element),this.diceList[a].getComponent("Dice").remove();if(0==this.index&&4==c.data.heroId&&2==c.data.difficulty&&(this.deckArray=this.deckArray.concat(this.cemetery),this.cemetery=[]),this.chestList)for(var s=0;s<3;s++)this.chestList[s]&&this.chestList[s].getComponent("Chest").remove();this.host.endRound(),this.scheduleOnce(function(){window.mainLayer.gameOver||(this.buff.exRound>0?(this.startRound(),this.buff.removeBuff(101,1)):window.mainLayer.doRound())}.bind(this),.5),this.extraDice=0,this.host.txtExDice.string="",this.settleBuff(),this.settleEquip()},checkCardsRequire:function(){for(var e=0,t=0;t<this.cardList.length;t++){this.cardList[t].getComponent("Card").checkRequire()&&e++}return e},checkGameBegin:function(){for(var e=[6,12,13,14,15,16,17,18,19,20,21,30,37,44,86,91,96,114,124],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),c.data.roomType>=7&&this.equip.trigger(61)},checkStart:function(){this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]);for(var e=[5,9,25,30,84,105,111,121,126,129,142,143,145,146,147,152,155,160,162,165,168],t=0;t<e.length;t++)this.equip.trigger(e[t]);if(this.dmgRound=0,this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var i=this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?2:1);this.host.onHurt(i,1,26,0),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.removeBuff(102,1),this.buff.table[23]>0&&this.buff.removeBuff(23,1);for(var c=0;c<this.delayCard.length;c++)s.doDelayEffect(this.delayCard[c]);this.delayCard=[]},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.removeBuff(29,this.buff.table[29]),this.buff.removeBuff(30,this.buff.table[30]),this.buff.table[24]>0&&this.buff.removeBuff(24,1);for(var e=0;e<4;e++)this.buff.removeBuff(103+e,this.buff.tempBuff[e]),this.buff.tempBuff[e]=0;this.buff.multiCast=this.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1,this.buff.selfHarmCast=this.buff.selfHarmCastMax=0,this.buff.doubleWind=!1,this.buff.darkRedice=0},settleEquip:function(){for(var e=[2,3,27,57,59,60,104,110,138,148,150,151,156,161,11],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.opponent.equip.trigger(118),this.equip.doDisabled(139),this.equip.doDisabled(140),this.cardPlayedRound=0,this.atkRound=0,this.dmgRound=0,this.createDiceRound=[0,0,0,0,0,0],this.equip.swiftGlove=!1,this.equip.luckDice=!1,this.equip.luckFlag=!1,this.equip.suckRemainder=0,this.equip.armorRemainder=0,this.equip.elementPlayed=[0,0,0,0,0,0]},onHurt:function(e,t,i,o){if(1==o){if(i<=6){this.equip.checkWithTrigger(130)&&(e*=.5);this.equip.checkWithTrigger([133,132,135,134,137,136][i-1])&&(e*=2)}else this.equip.checkWithTrigger(131)&&(e*=.5);if(this.buff.frail>0&&0==t&&!this.equip.checkWithTrigger(64)){var a=.5;this.opponent.equip.checkWithTrigger(54)&&(a+=.25),this.equip.checkWithTrigger(56)&&(a-=.25),this.equip.checkWithTrigger(113)&&(a*=2),this.opponent.equip.checkWithTrigger(113)&&(a*=2),e*=a+1}this.host.hp<.3*this.host.hpMax&&this.opponent.equip.checkWithTrigger(154)&&(e*=2),e=Math.floor(e),e+=this.opponent.buff.atkAdd,this.opponent.equip.checkWithTrigger(21),this.opponent.equip.checkWithTrigger(147),this.opponent.host.hp<.3*this.opponent.host.hpMax&&this.opponent.equip.checkWithTrigger(75),i<=6?0==this.round&&this.equip.checkWithTrigger(139)?e=0:this.equip.checkWithTrigger(i+131)&&(e=0):0==this.round&&this.equip.checkWithTrigger(140)&&(e=0),e>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),e=1),e>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),e=1),e>0&&this.buff.hurtReduce>0&&(e=Math.max(0,e-this.buff.hurtReduce),this.equip.checkWithTrigger(114),this.equip.checkWithTrigger(124)),e>4&&this.equip.checkWithTrigger(125)&&(e=4);var s=!1;if(e>=this.host.hp+this.host.armor&&(this.host.hp%2==1&&this.equip.checkWithTrigger(179)||this.equip.checkWithTrigger(180)||0==this.index&&c.data.guide>0)&&(s=!0,e=0),9==i&&e>0&&this.opponent.host.onHeal(e),this.opponent.equip.suckRemainder+=e,this.opponent.equip.trigger(23),this.opponent.equip.armorRemainder+=e,this.opponent.equip.trigger(164),this.equip.feedBack>0&e>0){var n=0;this.equip.feedBack>e?(n=e,this.equip.feedBack-=e,e=0):(n=this.equip.feedBack,e-=this.equip.feedBack,this.equip.feedBack=0),this.equip.checkWithTrigger(146),this.equip.refreshItemNum(146,this.equip.feedBack),this.opponent.host.onHurt(n,2,16)}this.buff.atkBack>0&&0==t&&e>0&&this.opponent.host.onHurt(this.buff.atkBack,1,16)}if(this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(e=0),e>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(e,2,16),1==o&&(this.opponent.dmgRound+=e),s?this.assertHpChange("MISS",2):this.assertHpChange("-"+e,0),this.anim.show(i),this.host.armor>0){if(this.host.armor>=e)return void this.updateArmor(-e);e-=this.host.armor,this.updateArmor(-this.armor)}this.host.hp-=e,this.host.hp<=0&&this.buff.undead>0&&(this.anim.show(201),this.host.hp=1),1==o&&e>0&&this.equip.checkWithTrigger(175)&&this.updateArmor(e),this.host.hp<=0&&this.equip.trigger(10),this.host.hp<=0&&this.equip.trigger(158),this.equip.trigger(75),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},updateArmor:function(e){var t=this.host.armor;this.host.armor+=e,this.host.armor>0?(this.host.boxArmor.active=!0,this.host.txtArmor.string=this.host.armor,this.host.stripHp.node.color=cc.color(24,136,176),this.host.barHp.color=cc.color(92,214,255)):(this.host.armor=0,this.host.boxArmor.active=!1,this.host.stripHp.node.color=cc.color(172,45,56),this.host.barHp.color=cc.color(252,94,108)),e>0?this.anim.show(11):t>this.host.armor&&this.equip.checkWithTrigger(167)&&this.opponent.host.onHurt(t-this.host.armor,2)},onHeal:function(e){if(this.equip.checkWithTrigger(122)){var t=Math.min(e,this.host.hpMax-this.host.hp);this.opponent.host.onHurt(t,2)}this.host.hp+=e,this.equip.trigger(102),this.equip.trigger(123),this.anim.show(12),this.equip.trigger(75)},assertHpChange:function(e,t){this.showQueue.push([e,t]),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var e=this.showQueue[0],t=e[0],i=e[1],c=[cc.Color.WHITE,cc.color(139,255,70),cc.color(255,40,40),cc.color(60,247,255)],o=cc.instantiate(this.host.txtNum);o.getComponent(cc.Label).string=t,o.color=c[i],o.position=this.host.txtNum.position,this.node.addChild(o),o.scale=0;var a=cc.spawn(cc.moveBy(.1,cc.v2(30,10)),cc.scaleTo(.1,1.1));a=cc.spawn(cc.moveBy(.05,cc.v2(0,0==this.index?0:-10)),cc.scaleTo(.05,1));o.runAction(cc.sequence(a,a,cc.moveBy(.05,cc.v2(13+10*Math.random(),3+5*Math.random())),cc.moveBy(.1,cc.v2(3+10*Math.random(),-3-10*Math.random())),cc.fadeOut(.5),cc.callFunc(function(){o.destroy()}.bind(this)))),o.runAction(cc.sequence(cc.delayTime(.15),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this)))),"MISS"==t&&cc.audioEngine.playEffect(window.sound.missSound)},getEmptyIndex:function(){for(var e=0;e<6;e++){var t=!1;if(this.chestList&&this.chestList[e%3]&&(t=!0),!t)for(var i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==e){t=!0;break}}if(!t)return e}return-1},addRollCount:function(){if(0==this.index&&2==c.data.heroId){var e=2==c.data.difficulty?0:1;if(this.rollCount>=e)return}this.rollCount++,this.host.checkBtnRoll&&this.host.checkBtnRoll()},deleteDice:function(e){for(var t=[],i=0;i<this.diceList.length;i++){var c=this.diceList[i].getComponent("Dice");if(!c.lock)if(7==e)t.push(this.diceList[i]);else if(c.element==e){this.dicePool.put(this.diceList[i]),this.diceList.splice(i,1);break}}if(7==e&&t.length>0){var o=t[Math.floor(Math.random()*t.length)],a=this.diceList.indexOf(o);a>=0&&(this.dicePool.put(this.diceList[a]),this.diceList.splice(a,1))}for(var s=0;s<this.diceList.length;s++){var n=this.diceList[s];n.stopAllActions(),n.opacity=255;var r=0;r=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*s:640/(this.diceList.length-1)*s-320,n.runAction(cc.moveTo(.2,cc.v2(r,0)))}this.checkElement(),this.host.checkBtnRoll()},createChest:function(e){for(var t=-1,i=2;i>=0;i--)if(!this.chestList[i]){t=i;break}if(t>=0){var c=cc.instantiate(this.chestPrefab);c.getComponent("Chest").init(t),this.boxCard.addChild(c,100),this.chestList[t]=c,e&&c.getComponent("Chest").checkRequire()}}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game",Utils:"Utils"}],PotionCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"85c55EVbbNKe72lZU+lcHho","PotionCommodity"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,txtName:cc.Label},init:function(e){cc.loader.loadRes("Texture/UI/image_potion"+e,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)),this.txtName.string="\u751f\u547d +"+10*e}}),cc._RF.pop()},{}],PrepareLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c0348borGFFHIk076MyCFu2","PrepareLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{btns:[cc.Node],boxSelected:cc.Node,edges:[cc.Node],boxDesc:cc.Sprite,txtName:cc.Label,txtDesc:cc.Label,txtDifficulty:cc.Label,btnDifficulty:[cc.Button],markDifficulty:cc.Node,btnStart:cc.Button,tree:cc.Node,descNode:cc.Node,characterNode:cc.Node,figure:cc.Node,figureNode:cc.Node,mask:cc.Node,endPrefab:cc.Prefab,soundPrefab:cc.Prefab},onLoad:function(){this.abled=!1,this.heroId=1,this.difficultyId=1,this.refreshInfo();for(var e=0;e<4;e++){var t=this.edges[e].position;this.edges[e].runAction(cc.sequence(cc.moveTo(.3,t.mul(1.1)),cc.moveTo(.3,t)).repeatForever())}this.tree.getComponent(cc.Widget).left=-300,this.characterNode.getComponent(cc.Widget).bottom=-135,this.descNode.getComponent(cc.Widget).bottom=-.08,this.figure.x+=550,this.btnStart.node.x+=200;for(var i=0;i<5;i++){this.btnDifficulty[i].node.x-=450;var c=i<2?.1:0;this.btnDifficulty[i].node.runAction(cc.sequence(cc.delayTime(c),cc.moveBy(.2,cc.v2(450,0))))}var o=cc.winSize.height/cc.winSize.width*750;this.btnStart.node.runAction(cc.moveBy(.2,cc.v2(-200,0))),this.characterNode.runAction(cc.moveBy(.2,cc.v2(0,154))),this.descNode.runAction(cc.sequence(cc.delayTime(.1),cc.moveTo(.2,cc.v2(0,.182*o-o/2)))),this.figure.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.15,cc.v2(-550,0)))),this.tree.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.15,cc.v2(300,0)),cc.callFunc(function(){this.tree.getComponent(cc.Widget).left=0,this.characterNode.getComponent(cc.Widget).bottom=19,this.descNode.getComponent(cc.Widget).bottom=.182,this.markDifficulty.active=!0,this.abled=!0}.bind(this)))),this.figure.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever());var a=cc.instantiate(this.soundPrefab);this.node.addChild(a),window.sound=a.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmPrepare,!0)},goBattle:function(){this.btnStart.interactable=!1,c.data.heroId=this.heroId,c.data.difficulty=this.difficultyId,c.data.startTime=Date.now(),c.data.restartCount=1==this.difficultyId?999:2==this.difficultyId?3:1,cc.audioEngine.playEffect(window.sound.btnStart),c.begin=!0,cc.director.loadScene("helloworld")},selectCharacter:function(e,t){parseInt(t)+1!=this.heroId&&this.abled&&(this.btns[this.heroId-1].scale=1,this.heroId=parseInt(t)+1,this.boxSelected.x=120*t-300,this.btns[t].scale=1.19,this.refreshInfo(),this.changeFigure(),cc.audioEngine.playEffect(window.sound.btn2))},refreshInfo:function(){var e=[cc.color(116,164,255),cc.color(182,93,255),cc.color(255,247,121),cc.color(107,255,153),cc.color(255,84,80),cc.color(255,165,87)];this.boxSelected.color=e[this.heroId-1];for(var t=0;t<4;t++)this.edges[t].color=e[this.heroId-1];var i=o.get("cfg_hero",this.heroId);this.txtName.string=i.name,this.txtDesc.string=i.desc,this.refreshDifficulty(),cc.loader.loadRes("Texture/UI/prepare/box_desc"+this.heroId,cc.SpriteFrame,function(e,t){this.boxDesc.spriteFrame=t}.bind(this)),this.btnStart.interactable=this.heroId<=4},selectDifficulty:function(e,t){this.btnDifficulty[this.difficultyId-1].interactable=!0,this.difficultyId=parseInt(t)+1,this.btnDifficulty[t].interactable=!1,this.markDifficulty.position=this.btnDifficulty[t].node.position,this.refreshDifficulty(),cc.audioEngine.playEffect(window.sound.btn1)},refreshDifficulty:function(){var e=o.get("cfg_hero",this.heroId);this.txtDifficulty.string=e["difficulty"+this.difficultyId],1==this.difficultyId?this.mask.active=!1:(cc.loader.loadRes("Texture/UI/prepare/mask"+this.difficultyId,cc.SpriteFrame,function(e,t){this.mask.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.mask.active=!0,this.mask.stopAllActions(),this.mask.runAction(cc.sequence(cc.fadeTo(.5,127.5),cc.fadeIn(.5)).repeatForever()))},changeFigure:function(){this.abled=!1;var e=cc.instantiate(this.figure);e.opacity=1,e.position=cc.v2(650,-250),this.figureNode.addChild(e),e.runAction(cc.spawn(cc.moveBy(.2,cc.v2(-550,0)),cc.fadeIn(.2))),this.heroId<=4?(e.color=cc.Color.WHITE,e.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever())):e.color=cc.Color.BLACK,this.figure.runAction(cc.sequence(cc.spawn(cc.moveBy(.2,cc.v2(-550,0)),cc.fadeOut(.2)),cc.callFunc(function(){this.figure.destroy(),this.figure=e,this.abled=!0}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],RequireRound:[function(e,t,i){"use strict";cc._RF.push(t,"3a0eeaFa/FFsJmcvXZBEaHe","RequireRound"),cc.Class({extends:cc.Component,properties:{circle:cc.Sprite,sprite:cc.Sprite,markRight:cc.Node},init:function(e,t){var i=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)];this.node.color=i[t-1],this.hide=!1,this.unCost=!1,this.satisfied=!1,e>0&&(this.element=e,this.refreshElement())},refreshElement:function(e){e&&(this.element=e),cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.unCost||(this.sprite.node.active=!0,this.sprite.spriteFrame=t)}.bind(this))},refreshSatisfy:function(e){if(this.satisfied=e,this.satisfied&&!this.unCost&&this.element){var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=t[this.element-1]}else this.sprite.node.color=cc.color(255,255,255)},hideElement:function(){this.element=null,this.sprite.node.active=!1},disCost:function(){this.unCost=!0,cc.loader.loadRes("Texture/battle/image_requireLine2",cc.SpriteFrame,function(e,t){this.circle.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/battle/unelement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.node.active&&(this.sprite.spriteFrame=t)}.bind(this)),this.refreshSatisfy(!0)},bingo:function(){this.hideElement(),this.markRight.active=!0}}),cc._RF.pop()},{}],Room:[function(e,t,i){"use strict";cc._RF.push(t,"20286qrg/RMq6rq0m6qk3EY","Room");var c=e("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Sprite,circle:cc.Sprite,doorPrefab:cc.Prefab,btnCamp:cc.Node,btnNpc:cc.Node,npcFigure:cc.Sprite,btnTreasure:cc.Node,btnShop:cc.Node,btnTavern:cc.Node,monsterNode:cc.Node,monsterFigure:cc.Sprite,decoration:cc.Node,boxTip:cc.Node,imageBox:cc.Sprite,crystal:cc.Node,carpet:cc.Sprite,shopKeeper:[cc.Node],tavernKeeper:[cc.Node],crystalShadow:cc.Node,crystalBase:cc.Node,star:cc.Node,starNode:cc.Node},init:function(e){window.room=this,this.pos=c.data.heroPos,this.abled=!1,this.isNewRoom=e,e||c.begin?this.initFloorConfig():this.typeList=c.data.historyPath[c.data.floor-1],this.initDoors(),this.initRoom(),e||this.initHero(),this.initMap()},initHero:function(){this.hero=window.homeLayer.hero.getComponent("Chess"),window.homeLayer.refreshPath(),this.isNewRoom?(this.hero.come(this.pos,function(){0==c.data.roomType&&this.scheduleOnce(this.ready,.2),this.doors[this.pos].close(!0),2==c.data.guide&&window.homeLayer.showGuide(2)}.bind(this)),this.checkEquip(),this.doors[this.pos].open(!1)):(this.scheduleOnce(this.ready,.5),this.doors[this.pos]&&this.doors[this.pos].close(!1),c.begin?(this.hero.stay(0),window.homeLayer.openMap()):this.hero.stay(this.pos))},initDoors:function(){this.doors=[];for(var e=[cc.v2(0,315),cc.v2(315,0),cc.v2(0,-315),cc.v2(-315,0)],t=0;t<4;t++){var i=this.typeList[t];if(-2==i&&(i=c.data.roomType),i>=0){var o=cc.instantiate(this.doorPrefab);o.getComponent("Door").init(i,t),o.rotation=90*t,o.position=e[t],o.zIndex=20,this.node.addChild(o),this.doors[t]=o.getComponent("Door")}}},initRoom:function(){1==c.data.roomType||c.data.roomType>=7?this.isNewRoom&&(this.monsterNode.active=!0,this.monsterNode.zIndex=10,2==c.data.guide?c.monsterId=3:9==c.data.guide&&(c.data.guide++,c.monsterId=1),cc.loader.loadRes("Texture/monster/figure/"+c.monsterId,cc.SpriteFrame,function(e,t){this.monsterFigure&&(this.monsterFigure.spriteFrame=t)}.bind(this)),this.monsterNode.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())):c.data.roomType>0&&this.initAlter()},gotoDoor:function(e){e!=this.pos&&this.abled&&(this.abled=!1,c.tempData=JSON.parse(JSON.stringify(c.data)),c.data.heroPos=(parseInt(e)+2)%4,c.data.floor++,c.data.floor>13&&(c.data.floor=1,c.data.castle++,c.data.historyPath=[],c.data.historyChoose=[0],c.data.floorBeats=[],c.data.monsterList=[]),this.hero.leave(e,function(){if(window.homeLayer.changeRoom(e),1==c.data.floor){window.homeLayer.openMap();for(var t=window.homeLayer.pathList,i=0;i<t.length;i++)t[i].destroy();window.homeLayer.initPath()}}.bind(this)),c.data.roomType=this.typeList[e],c.data.historyChoose[c.data.floor-1]=c.data.roomType,(1==c.data.roomType||c.data.roomType>=7)&&(c.monsterId=this.checkMonster()),window.guide&&window.guide.close())},initAlter:function(){if(2==c.data.roomType)if(this.btnCamp.active=!0,c.data.floorBeats[c.data.floor-1])this.crystal.active=!1,this.crystalBase.active=!1,this.crystalShadow.active=!1,this.starNode.active=!1;else{this.crystal.active=!0,this.crystal.runAction(cc.sequence(cc.moveBy(.7,cc.v2(0,25)),cc.moveBy(.7,cc.v2(0,-25))).repeatForever()),this.crystalShadow.runAction(cc.sequence(cc.moveBy(.7,cc.v2(0,-25)),cc.moveBy(.7,cc.v2(0,25))).repeatForever());for(var e=0;e<30;e++){var t=cc.instantiate(this.star);t.x=250*Math.random()-125;var i=Math.sqrt(Math.pow(125,2)-Math.pow(t.x,2));t.y=Math.random()*i*2-i,t.opacity=255*Math.random(),this.starNode.addChild(t);var o=3*Math.random()+.5;t.runAction(cc.sequence(cc.fadeIn(o),cc.fadeOut(o)).repeatForever())}}else 3==c.data.roomType?(this.btnTreasure.active=!0,this.btnTreasure.zIndex=10,c.data.floorBeats[c.data.floor-1]?(this.imageBox.node.y=-75,this.imageBox.node.scale=1,this.imageBox.node.stopAllActions(),cc.loader.loadRes("Texture/map/alter/treasure2",cc.SpriteFrame,function(e,t){this.imageBox.spriteFrame=t}.bind(this))):this.imageBox.node.runAction(cc.sequence(cc.delayTime(.8),cc.scaleTo(.05,1.1,.9),cc.spawn(cc.scaleTo(.25,.95,1.05),cc.moveBy(.25,cc.v2(0,30))),cc.spawn(cc.scaleTo(.25,1.1,.9),cc.moveBy(.25,cc.v2(0,-30))),cc.scaleTo(.05,1,1)).repeatForever())):4==c.data.roomType?(this.btnNpc.active=!0,this.btnNpc.zIndex=10):5==c.data.roomType?(this.btnShop.active=!0,this.btnShop.zIndex=10,this.shopKeeper[0].runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0)).repeatForever()),this.shopKeeper[1].runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0)).repeatForever())):6==c.data.roomType&&(this.btnTavern.active=!0,this.btnTavern.zIndex=10,this.tavernKeeper[0].runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0)).repeatForever()),this.tavernKeeper[1].runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0)).repeatForever()),c.data.guide>0&&c.data.guide<20?c.data.guide=20:24==c.data.guide&&window.homeLayer.showGuide(24));this.abled=!0},openAlter:function(){5!=c.data.roomType&&c.data.floorBeats[c.data.floor-1]?4!=c.data.roomType||this.boxTip.active||(this.boxTip.active=!0,this.boxTip.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){this.boxTip.active=!1}.bind(this))))):window.homeLayer.openAlter()},ready:function(e){this.abled=!0;for(var t=0;t<4;t++)this.doors[t]&&t!=this.pos&&this.doors[t].open(!0);c.saveData()},goBattle:function(){window.homeLayer.goBattle(),window.guide&&window.guide.close()},checkEquip:function(){3==c.data.roomType&&c.data.equip.indexOf(42)>=0&&(c.data.copper+=50)},initFloorConfig:function(){if(c.data.historyPath[c.data.floor-1]&&c.data.historyPath[c.data.floor-1].indexOf(-2)==this.pos)this.typeList=c.data.historyPath[c.data.floor-1];else{var e=c.data.floorQuests[c.data.castle-1][c.data.floor-1].concat();if(1==e.length)this.typeList=[-1,-1,-1,-1],c.begin||(this.typeList[this.pos]=-2),this.typeList[(this.pos+2)%4]=e[0];else{for(;e.length<3;)e.splice(Math.floor(Math.random()*(e.length+1)),0,-1);e.splice(this.pos,0,-2),this.typeList=e}if(c.data.historyPath[c.data.floor-1]=this.typeList,5==c.data.roomType){for(var t=[],i=[],o=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];t.length<3;){for(var a=0,s=Math.random(),n=0,r=0;r<3;r++)if(s<(n+=o[c.data.castle-1][r])){a=r+1;break}for(var h=c.getNewCardId(a),d=!1,l=0;l<t.length;l++)if(h==t[l]){d=!0;break}d||t.push(h)}for(o=[[.4,.3,.3],[.3,.4,.3],[.2,.4,.4]];i.length<3;){for(var f=0,u=Math.random(),p=0,m=0;m<3;m++)if(u<(p+=o[c.data.castle-1][m])){f=m+1;break}for(var g=c.getNewItemId(1,f),w=!1,y=0;y<i.length;y++)if(g==i[y]){w=!0;break}w||i.push(g)}c.data.shopIds=t.concat(i,[1,2,3]),c.data.itemEffect.vip1&&(c.data.discountItem=Math.floor(3*Math.random())),c.data.itemEffect.vip2&&(c.data.discountCard=Math.floor(3*Math.random()))}}},checkMonster:function(){if(c.data.monsterList[c.data.floor-1]||(c.data.monsterList[c.data.floor-1]=[0,0,0,0]),!c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]){var e=2*(c.data.castle-1)+(c.data.floor<=6?1:2),t=7==c.data.roomType?1:8==c.data.roomType?2:0;4==c.data.castle&&(t=3),c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]=c.getNewMonsterId(e,t)}return c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]},initMap:function(){var e=this;cc.loader.loadRes("Texture/scene/map"+c.data.castle,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this));var t=[null,null,"camp","treasure","event","shop","tavern"][c.data.roomType];cc.loader.loadRes("Texture/map/floor/"+(t||"castle"+c.data.castle),cc.SpriteFrame,function(e,t){this.circle.spriteFrame=t}.bind(this)),t||cc.loader.loadRes("Texture/map/floor/carpet"+c.data.castle+(4==c.data.castle?"":Math.floor(3*Math.random()+1)),cc.SpriteFrame,function(e,t){this.carpet.spriteFrame=t}.bind(this));for(var i=0;i<4;i++)for(var o=0;o<5;){var a=0;a=i%2==0?155*-Math.random()-220:155*Math.random()+220;var s=0,n=cc.winSize.height/cc.winSize.width*750;s=i<2?Math.random()*(n/2-130)+130:-Math.random()*(n/2-130)-130,cc.v2(a,s).mag()>=410&&function(){var t=cc.instantiate(e.decoration);t.scaleX=Math.random()<.5?1:-1,t.position=cc.v2(a,s),e.bg.node.addChild(t),o++,cc.loader.loadRes("Texture/map/decoration/"+Math.floor(29*Math.random()+1),cc.SpriteFrame,function(e,i){t&&(t.getComponent(cc.Sprite).spriteFrame=i)}.bind(e))}()}}}),cc._RF.pop()},{Game:"Game"}],ShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"47158KpbiJMF46lKbQmGdRL","ShopItem");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,potionPrefab:cc.Prefab,txtCost:cc.Label,boxDiscount:cc.Node,txtDiscount:cc.Label,iconNode:cc.Node,markDelete:cc.Node},init:function(e,t,i){this.cfgId=e,this.type=t;var c=void 0;0==t?((c=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),this.cost=3*o.get("cfg_card",e).value):1==t?((c=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(e),this.cost=6*o.get("cfg_item",e).value):2==t?((c=cc.instantiate(this.potionPrefab)).getComponent("PotionCommodity").init(e),this.cost=1==e?20:50):(this.markDelete.active=!0,this.cost=50),c&&(c.position=cc.v2(0,1==t?20:10),this.iconNode.addChild(c),this.item=c),i&&(this.boxDiscount.active=!0,0==t?(this.cost=Math.ceil(.5*this.cost),this.txtDiscount.string="5\u6298"):(this.cost=Math.ceil(.7*this.cost),this.txtDiscount.string="7\u6298"),this.txtCost.node.color=cc.Color.BLACK.fromHEX("#54EAD0"),this.txtCost.getComponent(cc.LabelOutline).color=cc.Color.BLACK.fromHEX("#54EAD0")),this.txtCost.string=this.cost},buy:function(){if(c.data.copper>=this.cost){c.data.copper-=this.cost,0==this.type?window.homeLayer.getCard(this.cfgId):1==this.type?c.getItem(this.cfgId):2==this.type?c.data.hp=Math.min(c.data.hp+10*this.cfgId,c.data.hpMax):window.homeLayer.openDelete();var e=3==this.type?8:c.data.shopIds.indexOf(this.cfgId,3*this.type);c.data.shopIds[e]=0,this.node.destroy(),window.homeLayer.refreshHeroData(),cc.audioEngine.playEffect(window.sound.buy)}else{(this.item||this.markDelete).runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound)}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(e,t,i){"use strict";cc._RF.push(t,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{boxs:[cc.Node],shopItemPrefab:cc.Prefab,curtain:cc.Node,title:cc.Node},onLoad:function(){window.shopLayer=this,this.initCards(),this.initEquip(),this.initPotions(),4==c.data.heroId&&this.initDelete(),this.curtain.runAction(cc.moveTo(.15,cc.v2(0,-17))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.moveTo(.25,cc.v2(9,-35)))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.skewTo(.2,2,0),cc.skewTo(.2,-2,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,0,0))),cc.audioEngine.playEffect(window.sound.shopOpen)},initCards:function(){for(var e=0;e<3;e++){var t=c.data.shopIds[e];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,0,c.data.itemEffect.vip2),i.position=cc.v2(e%3*245-245,0),this.boxs[0].addChild(i)}}this.boxs[0].x=-750,this.boxs[0].y+=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[0].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0))))},initEquip:function(){for(var e=0;e<3;e++){var t=c.data.shopIds[e+3];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,1,c.data.itemEffect.vip1),i.position=cc.v2(e%3*245-245,0),this.boxs[1].addChild(i)}}this.boxs[1].x=750,this.boxs[1].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0))))},initPotions:function(){for(var e=0;e<2;e++){var t=c.data.shopIds[e+6];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,2),i.position=cc.v2(e%3*245-245,0),this.boxs[2].addChild(i)}}this.boxs[2].x=-750,this.boxs[2].y-=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[2].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.2,cc.v2(750,0))))},initDelete:function(){if(c.data.shopIds[8]>0){var e=cc.instantiate(this.shopItemPrefab);e.getComponent("ShopItem").init(3,3),e.position=cc.v2(245,0),this.boxs[2].addChild(e)}},close:function(){this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0)))),this.boxs[0].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0)))),this.title.runAction(cc.moveTo(.2,cc.v2(9,230))),this.curtain.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.1,cc.v2(0,43)))),this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4),window.shopLayer=null,window.room.ready(),cc.audioEngine.playEffect(window.sound.shopClose)}}),cc._RF.pop()},{Game:"Game"}],SkillManager:[function(e,t,i){"use strict";cc._RF.push(t,"f9b8a6FzCFFt4zg92Jc9Ljj","SkillManager");var c=e("Game"),o={doCast:function(e){var t=window.mainLayer.hero,i=window.mainLayer.enemy;if(1==c.data.heroId)0==e?i.onHurt(5,4):1==e&&t.buff.addBuff(107,1);else if(2==c.data.heroId){if(0==e){for(var o=[],a=t.player.cardList.length-1;a>=0;a--){var s=t.player.cardList[a].getComponent("Card");s.unCost||s.isCopy||s.silence||o.push(a)}if(o.length>0){var n=Math.floor(o.length*Math.random());t.player.cardList[o[n]].getComponent("Card").disCost(),o.splice(n,1)}t.player.checkCardsRequire()}else if(1==e)for(var r=t.player.cardList.length,h=0;h<6-r;h++)t.player.patchCard()}else if(3==c.data.heroId){if(0==e)t.player.rollCount++,t.player.roll();else if(1==e)for(var d=0;d<6;d++)t.player.elementList[d]>0&&i.buff.addBuff(21+d,t.player.elementList[d])}else if(4==c.data.heroId){if(0==e){for(var l=t.player.cardList.length,f=[],u=l-1;u>=0;u--){var p=t.player.cardList[u].getComponent("Card");f.push(p.cfgId),p.discard(!0)}for(var m=Math.min(t.player.deckArray.length,l),g=0;g<m;g++)t.player.suppleCard();for(var w=0;w<f.length;w++)t.player.deckArray.push(f[w]);if(t.player.deckArray.sort(function(){return.5-Math.random()}),m<l)for(var y=0;y<l-m;y++)t.player.suppleCard();t.scheduleOnce(function(){window.mainLayer.hero.checkBtnRoll(!0)},.3)}else if(1==e){for(var v=0;v<2;v++)t.player.createExDice();window.mainLayer.hero.checkBtnRoll(!0)}}else if(5==c.data.heroId)if(0==e)t.player.createExDice();else if(1==e){for(var b=t.player.cardList.length-1;b>=0;b--)t.player.cardList[b].getComponent("Card").discard();t.player.cardList=[],t.player.createChest(!0)}},doCastTavern:function(e){0==e?window.player.addRollCount():1==e&&window.player.changeAllCards()}};t.exports=o,cc._RF.pop()},{Game:"Game"}],SkillTavern:[function(e,t,i){"use strict";cc._RF.push(t,"9a0667w2/RNgIs9zTdi7tpI","SkillTavern");var c=e("SkillManager");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,btn:cc.Button,txtName:cc.Label,mask:cc.Node},init:function(e){this.index=e;this.txtName.string=["\u8865\u6295","\u6362\u724c"][e],cc.loader.loadRes("Texture/hero/skill/"+(e+1),cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this))},check:function(){this.btn.interactable=window.tavernLayer.power>0,this.btn.interactable?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!0)},doSkill:function(){window.tavernLayer.costPower(),c.doCastTavern(this.index)}}),cc._RF.pop()},{SkillManager:"SkillManager"}],Skill:[function(e,t,i){"use strict";cc._RF.push(t,"84424zovvVHiZ6bvX7VE49L","Skill");var c=e("Game"),o=e("SkillManager");cc.Class({extends:cc.Component,properties:{txtCost:cc.Label,icon:cc.Sprite,btn:cc.Button,txtName:cc.Label,mask:cc.Node},init:function(e){if(this.index=e,this.unlock=!0,this.abled=!0,this.cost=10*(e+1),1==e&&c.data.level<3&&(this.unlock=!1),this.unlock){var t=[["\u731b\u51fb","\u72c2\u6012"],["\u8ff7\u9b42","\u5927\u6ee1\u8d2f"],["\u91cd\u63b7","\u6536\u5272"],["\u6362\u724c","\u751f\u673a"],["\u521b\u9020","\u5927\u6ee1\u8d2f"]][c.data.heroId-1];this.txtName.string=t[e],this.txtCost.string=this.cost,cc.loader.loadRes("Texture/hero/skill/"+(2*c.data.heroId-1+e),cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this))}else this.txtName.string="3\u7ea7\u89e3\u9501",cc.loader.loadRes("Texture/battle/mark_skill",cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this));this.check()},check:function(){this.unlock?177==window.mainLayer.enemy.equipList[0]?this.btn.interactable=!1:this.abled&&window.mainLayer.hero.power>=this.cost?this.btn.interactable=!0:this.btn.interactable=!1:this.btn.interactable=!1,this.btn.interactable?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=this.unlock)},doSkill:function(){c.data.guide>0&&c.data.guide<12||0==window.mainLayer.roundId&&(this.abled=!1,window.mainLayer.hero.addPower(-this.cost),o.doCast(this.index),window.guide&&(window.guide.close(),c.data.guide=13))}}),cc._RF.pop()},{Game:"Game",SkillManager:"SkillManager"}],Sound:[function(e,t,i){"use strict";cc._RF.push(t,"77726IJdzpF843mufBZFnYQ","Sound"),cc.Class({extends:cc.Component,properties:{btn1:{type:cc.AudioClip,default:null},btn2:{type:cc.AudioClip,default:null},btnStart:{type:cc.AudioClip,default:null},selectSound:{type:cc.AudioClip,default:null},levelUpSound:{type:cc.AudioClip,default:null},endRound:{type:cc.AudioClip,default:null},copperSound:{type:cc.AudioClip,default:null},blackSound:{type:cc.AudioClip,default:null},delete:{type:cc.AudioClip,default:null},shopOpen:{type:cc.AudioClip,default:null},shopClose:{type:cc.AudioClip,default:null},buy:{type:cc.AudioClip,default:null},fireSound:{type:cc.AudioClip,default:null},iceSound:{type:cc.AudioClip,default:null},windSound:{type:cc.AudioClip,default:null},earthSound:{type:cc.AudioClip,default:null},lightSound:{type:cc.AudioClip,default:null},darkSound:{type:cc.AudioClip,default:null},atkSound:{type:cc.AudioClip,default:null},armorSound:{type:cc.AudioClip,default:null},healSound:{type:cc.AudioClip,default:null},dodgeSound:{type:cc.AudioClip,default:null},frailSound:{type:cc.AudioClip,default:null},weakSound:{type:cc.AudioClip,default:null},silenceSound:{type:cc.AudioClip,default:null},poisonSound:{type:cc.AudioClip,default:null},curseSound:{type:cc.AudioClip,default:null},lockSound:{type:cc.AudioClip,default:null},blindSound:{type:cc.AudioClip,default:null},reviveSound:{type:cc.AudioClip,default:null},undeadSound:{type:cc.AudioClip,default:null},burnSound:{type:cc.AudioClip,default:null},counterSound:{type:cc.AudioClip,default:null},errorSound:{type:cc.AudioClip,default:null},discardSound:{type:cc.AudioClip,default:null},missSound:{type:cc.AudioClip,default:null},bagOpenSound:{type:cc.AudioClip,default:null},bagCloseSound:{type:cc.AudioClip,default:null},rollSound:{type:cc.AudioClip,default:null},rollSound2:{type:cc.AudioClip,default:null},holdSound:{type:cc.AudioClip,default:null},drawSound:{type:cc.AudioClip,default:null},treasureSound:{type:cc.AudioClip,default:null},win:{type:cc.AudioClip,default:null},reward:{type:cc.AudioClip,default:null},lose:{type:cc.AudioClip,default:null},bingo:{type:cc.AudioClip,default:null},end:{type:cc.AudioClip,default:null},cheer:{type:cc.AudioClip,default:null},bgmTavetn:{type:cc.AudioClip,default:null},bgmPrepare:{type:cc.AudioClip,default:null},bgmYahtzee:{type:cc.AudioClip,default:null},bgmMap:{type:[cc.AudioClip],default:[]},bgmBattle:{type:[cc.AudioClip],default:[]},bgmBoss:{type:[cc.AudioClip],default:[]},bgmBossBig:{type:cc.AudioClip,default:null},bgmComplete:{type:cc.AudioClip,default:null},monsterSound:{type:[cc.AudioClip],default:[]},wolfSound:{type:cc.AudioClip,default:null}}}),cc._RF.pop()},{}],TavernLayer:[function(e,t,i){"use strict";cc._RF.push(t,"f73f9BbTilOdoWM2Ad26x3Z","TavernLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{enemyNode:cc.Node,endPrefab:cc.Prefab,mask:cc.Node,stripHp:cc.ProgressBar,txtHp:cc.Label,stripEnergy:cc.ProgressBar,txtEnergy:cc.Label,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,skillPrefab:cc.Prefab,skillNode:cc.Node,soundPrefab:cc.Prefab,guidePrefab:cc.Prefab},onLoad:function(){window.tavernLayer=this,this.gameOver=!1,this.mask.active=!0,this.mask.zIndex=1e3,this.schedule(this.updateMask,0),this.enemyNode.scaleX=.8,this.enemyNode.scaleY=1.2,this.enemyNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,-250)),cc.scaleTo(.3,1.2,.8)),cc.scaleTo(.2,1),cc.callFunc(function(){this.enemyNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this)))),this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax;this.txtName.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtLevel.string="Lv."+c.data.level,this.txtCopper.string=c.data.copper,this.initSkills();var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmTavetn,!0)},initSkills:function(){this.power=1,this.btnSkills=[];for(var e=0;e<2;e++){var t=cc.instantiate(this.skillPrefab);t.position=cc.v2(0==e?127:285,31),t.getComponent("SkillTavern").init(e),this.skillNode.addChild(t),this.btnSkills.push(t)}},costPower:function(){this.power=0,this.txtEnergy.string="0/1",this.stripEnergy.progress=0;for(var e=0;e<2;e++)this.btnSkills[e].getComponent("SkillTavern").check()},showEnd:function(e){if(!this.gameOver){this.gameOver=!0;var t=cc.instantiate(this.endPrefab);t.getComponent("EndTavernLayer").init(e),this.node.addChild(t)}},roll:function(){window.player.roll()},checkRewards:function(){var e=window.player.checkRewards();this.showEnd(e)},updateMask:function(){this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1)},showGuide:function(e){this.scheduleOnce(function(){if(!window.guide){var t=cc.instantiate(this.guidePrefab);t.getComponent("Guide").init(e),this.node.addChild(t)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],TreasureLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{treasurePrefab:cc.Prefab,btnGets:[cc.Node],btnClose:cc.Node,boxNode:cc.Node,btnNode:cc.Node,mask:cc.Node},init:function(){window.treasureLayer=this;for(var e=0,t=[[.6,.3,.1],[.4,.3,.3],[.2,.4,.4]],i=Math.random(),o=0,a=0;a<3;a++)if(i<(o+=t[c.data.castle-1][a])){e=a+1;break}5==c.data.roomType?e++:c.data.itemEffect.vase>0&&(c.data.itemEffect.vase--,e++),e=Math.min(e,3),this.cfgIdList=[];var s=1;c.data.itemEffect.flagon>0&&(c.data.itemEffect.flagon--,s=2);var n=c.getNewItemId(0,e);if(this.cfgIdList.push(n),2==s){for(var r=0;r<=0;){var h=c.getNewItemId(0,e);h!=n&&(r=h)}this.cfgIdList.push(r)}9==c.data.guide&&(this.cfgIdList=[180]),this.initItem(),this.btnNode.active=!1,this.scheduleOnce(function(){this.btnNode.active=!0,this.btnNode.opacity=10,this.btnNode.y-=150,this.btnNode.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))}.bind(this),.8)},initItem:function(){var e;(this.itemList=[],this.gotList=[],1==this.cfgIdList.length)?((e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),this.boxNode.addChild(e),this.itemList.push(e)):((e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),e.position=cc.v2(180,0),this.boxNode.addChild(e),this.itemList.push(e),(e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[1]),e.position=cc.v2(-180,0),this.boxNode.addChild(e),this.itemList.push(e),this.btnGets[1].active=!0,this.btnGets[0].position=cc.v2(180,30),this.btnClose.position=cc.v2(0,-100))},onGet:function(e,t){c.getItem(this.cfgIdList[t]),this.gotList.push(this.itemList[t]),this.btnGets[t].active=!1,this.gotList.length>=this.cfgIdList.length&&this.close()},onGiveUp:function(){this.close()},close:function(){c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.room.ready(),window.treasureLayer=null;for(var e=0;e<this.itemList.length;e++)this.itemList[e].opacity=1;if(this.gotList.length>0){this.mask.runAction(cc.fadeOut(.2)),this.btnNode.active=!1;for(var t=0;t<this.gotList.length;t++)this.gotList[t].getComponent("Treasure").got();this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4)}else this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Treasure:[function(e,t,i){"use strict";cc._RF.push(t,"ab4bd76AwVKk6GKzcwjcSfb","Treasure");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,icon:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,infoNode:cc.Node,mask:cc.Node,anmation:cc.Node},init:function(e){var t=o.get("cfg_item",e);this.txtName.string=t.name;this.txtName.node.color=cc.Color.BLACK.fromHEX(["#31BEFF","#B689FF","#FF7F18"][t.quality-1]),this.txtDesc.string=c.analysisDesc(t.desc1),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+t.quality,cc.SpriteFrame,function(e,t){this.boxIcon.spriteFrame=t}.bind(this)),this.doAction()},doAction:function(){this.mask.opacity=this.infoNode.opacity=this.boxIcon.node.opacity=1;var e=cc.spawn(cc.moveTo(.4,cc.v2(0,173)),cc.sequence(cc.scaleTo(.2,.8,1.1),cc.scaleTo(.2,1)));this.mask.runAction(cc.sequence(cc.delayTime(.5),cc.fadeIn(0),e,cc.fadeOut(.3))),this.boxIcon.node.runAction(cc.sequence(cc.delayTime(.9),cc.fadeIn(0))),this.infoNode.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.3))),cc.audioEngine.playEffect(window.sound.treasureSound)},got:function(){this.node.opacity=255,this.anmation.active=!1,this.infoNode.active=!1;var e=cc.winSize.height/cc.winSize.width*750;this.boxIcon.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveTo(.3,cc.v2(211-this.node.x,-e/2-80+115+33-70))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Utils:[function(e,t,i){"use strict";cc._RF.push(t,"85bfaYPayFNlrAFvtzNUMAc","Utils");var c={numberFormat:function(e){return e/1e13>=1?Math.floor(e/1e12)+"T":e/1e10>=1?Math.floor(e/1e9)+"B":e/1e7>=1?Math.floor(e/1e6)+"M":e/1e4>=1?Math.floor(e/1e3)+"K":e},timeFormat:function(e,t){var i=Math.round(e/1e3),c=i%60,o=t>1?Math.floor(i/60)%60:Math.floor(i/60),a=3==t?Math.floor(i/3600)%24:Math.floor(i/3600),s=Math.floor(i/86400),n=function(e){return e<10?"0"+e:e};return 1==t?n(o)+":"+n(c):2==t?n(a)+":"+n(o)+":"+n(c):s+"\u5929"+a+"\u65f6"+o+"\u5206"},getDifferentRandomNum:function(e,t,i){t=t||1,i=i||0;for(var c=[];c.length<e;){for(var o=Math.floor(Math.random()*(t-i+1))+i,a=!1,s=0;s<c.length;s++)if(c[s]-o==0){a=!0;break}a||c.push(o)}return c},createImage:function(e,t){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var e=new cc.Texture2D;e.initWithElement(i),e.handleLoadedTexture(),t.spriteFrame=new cc.SpriteFrame(e)}catch(e){cc.log(e),t.node.active=!1}},i.src=e}catch(e){cc.log(e),t.node.active=!1}else try{cc.loader.load({url:e,type:"jpg"},function(e,i){t.spriteFrame=new cc.SpriteFrame(i)})}catch(e){cc.log(e),t.node.active=!1}},substring:function(e,t){if(e.replace(/[\u4e00-\u9fa5]/g,"**").length<=t)return e;for(var i=0,c="",o=0;o<e.length&&(/[\u4e00-\u9fa5]/.test(e[o])?i+=2:i+=1,!(i>t));o++)c+=e[o];return c},getMd5Url:function(e){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(e)):cc.url.raw(e)},numToStr:function(e,t){t=t||1;for(var i=""+e,c=1;c<=t;c++)e<Math.pow(10,c)&&(i="0"+i);return i},getDirectionVector:function(e,t){return[cc.v2(0,1),cc.v2(1,0),cc.v2(0,-1),cc.v2(-1,0)][e].mul(t)}};t.exports=c,cc._RF.pop()},{}],Yahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label,boxDesc:cc.Node,txtNameHero:cc.Label,txtNameEnemy:cc.Label,soundPrefab:cc.Prefab,btnGuide:cc.Node,guide:cc.Node,mask:cc.Node},onLoad:function(){window.yahtzeeLayer=this,this.descOpen=!0;this.txtNameHero.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtNameEnemy.string=o.get("cfg_event",c.data.eventIds[c.data.castle-1]).name;var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmYahtzee,!0)},start:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),c.data.guide>0?(this.btnGuide.active=!0,this.openGuide()):this.beginGame()},beginGame:function(){this.roundId=1,this.hostId=0,this.doRound(),this.boxDesc.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(this.openDesc,this)))},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,window.player.startRound()},endRound:function(){for(var e=this,t=function(t){var i=e.hero.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,300)),cc.delayTime(1.5),cc.callFunc(function(){this.hero.dicePool.put(i)}.bind(e))))},i=0;i<5;i++)t(i);var c=function(t){var i=e.enemy.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-300)),cc.delayTime(1.5),cc.callFunc(function(){this.enemy.dicePool.put(i)}.bind(e))))};for(i=0;i<5;i++)c(i);this.scheduleOnce(function(){this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.hero.doWin():this.hero.score<this.enemy.score?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),1.5),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(e){var t=cc.instantiate(this.endPrefab);t.getComponent("EndYahtzeeLayer").init(e),this.node.addChild(t)},openDesc:function(){this.boxDesc.stopAllActions(),this.descOpen?(this.descOpen=!1,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-428,93)))):(this.descOpen=!0,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-279,93))))},openGuide:function(){this.mask.active=!0,this.mask.opacity=1,this.mask.runAction(cc.fadeTo(.2,180)),this.guide.active=!0,this.guide.scale=.1,this.guide.position=this.btnGuide.position,this.guide.runAction(cc.spawn(cc.moveTo(.2,cc.v2(0,0)),cc.scaleTo(.2,1)))},closeGuide:function(){this.mask.runAction(cc.fadeOut(.2)),this.guide.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,this.btnGuide.position),cc.scaleTo(.2,.1)),cc.callFunc(function(){this.guide.active=!1,this.mask.active=!1,13==c.data.guide&&(c.data.guide++,this.beginGame())}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardChangeLayer","CardCollection","CardDeleteLayer","CardManager","CardTavern","Chess","Chest","ChooseDiceLayer","CompleteLayer","Config","Cover","Dice","DiceChoose","DiceTavern","DiceYahtzee","DmgAnimation","Door","Edit","EditEndLayer","EndLayer","EndTavernLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","Guide","HelloWorld","Hero","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerTavern","PlayerYahtzee","PotionCommodity","PrepareLayer","RequireRound","Room","ShopItem","ShopLayer","Skill","SkillManager","SkillTavern","Sound","TavernLayer","Treasure","TreasureLayer","Utils","Yahtzee"]);