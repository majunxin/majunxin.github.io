window.__require=function e(t,i,c){function o(n,s){if(!i[n]){if(!t[n]){var r=n.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!s&&h)return h(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+n+"'")}}var d=i[n]={exports:{}};t[n][0].call(d.exports,function(e){return o(t[n][1][e]||e)},d,d.exports,e,t,i,c)}return i[n].exports}for(var a="function"==typeof __require&&__require,n=0;n<c.length;n++)o(c[n]);return o}({AIYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){var i=this.player.diceList[t].getComponent("DiceYahtzee");e[i.element-1]++}for(var c=-1,o=-1,a=0;a<6;a++)e[a]>(e[c]||0)&&(c=a);for(var n=0;n<6;n++)n!=c&&e[n]>(e[o]||0)&&(o=n);this.scheduleOnce(function(){e[c]>1?e[c]==e[o]?this.hold(c,o):this.hold(c):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(e,t){for(var i=0,c=0;c<5;c++){var o=this.player.diceList[c].getComponent("DiceYahtzee");o.holded?o.element!=e+1&&null!=t&&o.element!=t+1&&(o.doHold(),i++):(o.element==e+1||null!=t&&o.element==t+1)&&(o.doHold(),i++)}var a=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),a)}}),cc._RF.pop()},{}],AI:[function(e,t,i){"use strict";cc._RF.push(t,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy"),this.castList=[]},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var e=1,t=100,i=null,c=0;c<this.cards.length;c++){var o=this.cards[c].getComponent("Card");o.usable&&(o.cfg.priority<t||o.cfg.priority==t&&o.rate>e)&&(e=o.rate,t=o.cfg.priority,i=o)}i?i.cast():this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.8):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.6)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var e=[0,0,0,0,0,0],t=0;t<this.cards.length;t++){var i=this.cards[t].getComponent("Card");(m=i.require.split(";")).length>1&&e[m[0]-1]++;for(var c=["A","B","C","D","E","F"],o=0;o<6;o++)if(i.cfg.desc.indexOf(c[o])>=0){e[o]++;break}}for(var a=!1,n=0;n<6;n++)if(e[n]>0){a=!0;break}for(var s=[],r=0;r<this.cards.length;r++){var h=this.cards[r].getComponent("Card"),d=[0,0,0,0,0,0];if(h.require>=101&&h.require<=105){for(var l=0,u=0,f=0;f<6;f++)(!a||e[f]>0)&&this.player.elementList[f]>l&&(l=this.player.elementList[f],u=f+1);if(d=[-100,-100,-100,-100,-100,-100],l>=a||2){d[u-1]=[2,3,3,4,5][h.require-101]-l}}else{var p=[0,0,0,0,0,0];if(106==h.require||107==h.require)p=[1,1,1,1,1,1];else for(var m=h.require.split(";"),g=0;g<m.length;g++)p[m[g]-1]++;for(var y=["A","B","C","D","E","F"],v=0;v<6;v++){var w=p[v];h.cfg.desc.indexOf(y[v])>=0&&(w=this.player.elementList[v]+1),d[v]=w-this.player.elementList[v]}}s.push(d)}for(var b=100,C=0,x=0,L=1,k=0;k<s.length;k++){for(var T=s[k],I=0,B=0,q=0;q<T.length;q++)I+=T[q]<-10?0:Math.abs(T[q]),B+=T[q];(I<b||I==b&&B>C||I==b&&B==C&&this.cards[k].getComponent("Card").rate<L)&&(b=I,C=B,x=k,L=this.cards[k].getComponent("Card").rate)}for(var E=s[x],A=0;A<6;A++)if(0!=E[A]){var R=E[A]+this.player.elementList[A]-this.player.holdList[A];if(R>0)for(var N=0;N<this.dices.length;N++){var F=this.dices[N].getComponent("Dice");if(F.element==A+1&&!(F.holded||F.lock||F.freeze||F.temp)&&(F.hold(),0==--R))break}else if(R<0)for(var M=0;M<this.dices.length;M++){var S=this.dices[M].getComponent("Dice");if(S.element==A+1&&S.holded&&!S.lock&&!S.freeze&&!S.temp&&(S.hold(),0==++R))break}}this.player.roll();for(var D=!1,P=0;P<this.dices.length;P++){var O=this.dices[P].getComponent("Dice");if(!(O.holded||O.lock||O.freeze||O.temp)){D=!0;break}}this.scheduleOnce(function(){D?this.check():this.player.endRound()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var e=0;e<this.player.cardList.length;e++){var t=this.player.cardList[e].getComponent("Card");t.silence||t.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(t)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var c=this.player.diceList[i];c.lock||this.dices.push(c)}},insertAndCast:function(e){}}),cc._RF.pop()},{}],Buff:[function(e,t,i){"use strict";cc._RF.push(t,"76faa8y1jVIcqDL176r9ktK","Buff");var c=e("Game");cc.Class({extends:cc.Component,properties:{buffBox:cc.Node,txtBuff:cc.RichText},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.multiCast=0,this.multiCastMax=0,this.selfHarmCast=0,this.selfHarmCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.burnIce=!1,this.silenceDark=!1,this.atkAd3=!1,this.creatDiceFire=0,this.exCreateDice=0,this.tempBuff=[0,0,0,0],this.doubleWind=!1,this.darkRedice=0,this.table={};for(var e=[13,21,22,23,24,25,26,27,28,29,30,101,102,103,104,105,106,107,108],t=0;t<e.length;t++)this.table[e[t]]=0;this.quote(),this.refreshBuff()},addBuff:function(e,t){if(!(t<=0)){if(13==e)this.player.anim.show(13);else if(e>=21&&e<=30){if(this.immunity>0)return this.removeBuff(105,1),this.player.equip.doTrigger(37),void this.player.assertHpChange("MISS",3);if(e<=26){if(this.opponent.equip.checkWithTrigger(e+10))t+=26==e?2:1;23==e&&this.opponent.equip.trigger(68)}this.player.anim.show(e)}this.table[e]+=t,this.quote();for(var i=!1,c=0;c<this.buffList.length;c++)if(this.buffList[c]==e){i=!0;break}i||this.buffList.push(e),this.refreshBuff()}},removeBuff:function(e,t){if(!(t<=0)){if(this.table[e]-=t,this.table[e]<=0){this.table[e]=0;var i=this.buffList.indexOf(e);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28],this.chaos=this.table[29],this.blind=this.table[30],this.exRound=this.table[101],this.undead=this.table[102],this.atkBack=this.table[103],this.atkAdd=this.table[104],this.immunity=this.table[105],this.hurtReduce=this.table[106],this.doubleDmg=this.table[107],this.doubleCast=this.table[108]},refreshBuff:function(){var e="",t={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",29:"\u6df7\u4e71",30:"\u76f2\u76ee",101:"\u989d\u5916\u56de\u5408",102:"\u4e0d\u6b7b",103:"\u53cd\u4f24",104:"\u4f24\u5bb3\u63d0\u5347",105:"\u514d\u75ab",106:"\u53d7\u4f24\u51cf\u514d",107:"\u53cc\u500d\u4f24\u5bb3",108:"\u91cd\u590d\u884c\u52a8"},i={13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1",101:"FFF830",102:"FF5567",103:"FF5567",104:"FFF830",105:"42EBFF",106:"FF5567",107:"F15162",108:"E2BD6D"};if(1==this.buffList.length){var c=this.buffList[0];e+="<img src='"+this.getBuffImg(c)+"'/>",e+="<color="+i[c]+">"+t[c]+this.table[c]+"</c>"}else for(var o=0;o<this.buffList.length;o++){var a=this.buffList[o];e+="<img src='"+this.getBuffImg(a)+"'/>",e+="<color="+i[a]+">"+this.table[a]+"</c>  "}if(this.player.host.txtBuff.string=e,this.buffBox.active){e="";var n=40;this.opponent.equip.check(54)&&(n+=20),this.player.equip.check(56)&&(n-=20),this.player.equip.check(113)&&(n*=2),this.opponent.equip.check(113)&&(n*=2);for(var s={13:"\u8eb2\u907f\u5bf9\u624b\u4f7f\u7528\u7684\u653b\u51fb\u724c\uff0c\u89e6\u53d1\u540e\u5c42\u6570-1",21:"\u4f7f\u7528\u71c3\u70e7\u7684\u5361\u724c\u65f6\uff0c\u53d7\u52303\u706b\u4f24\u5bb3",22:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u88ab\u91cd\u63b7",23:"\u989d\u5916\u627f\u53d7"+n+"%\u7684\u5361\u724c\u4f24\u5bb3\uff0c \u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",24:"\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u51cf\u5c11"+(this.opponent.equip.check(55)?50:30)+"%\uff0c \u56de\u5408\u7ed3\u675f\u65f6\u5c42\u6570-1",25:"\u4f7f\u5361\u724c\u65e0\u6cd5\u4f7f\u7528",26:"\u56de\u5408\u5f00\u59cb\u65f6\u53d7\u5230\u4e2d\u6bd2\u5c42\u6570\u7684\u4f24\u5bb3\uff0c\u4e2d\u6bd2\u5c42\u6570-1",27:"\u4f7f\u7528\u5361\u724c\u65f6\u670950%\u6982\u7387\u65e0\u6548\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",28:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u4f7f\u7528",29:"\u4f7f\u7528\u653b\u51fb\u724c\u65f6\u670950%\u6982\u7387\u653b\u51fb\u81ea\u8eab\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",30:"\u4f7f\u9ab0\u5b50\u7684\u5143\u7d20\u65e0\u6cd5\u88ab\u67e5\u770b",101:"\u56de\u5408\u7ed3\u675f\u65f6\u5f00\u59cb\u989d\u5916\u7684\u5df1\u65b9\u56de\u5408\uff0c\u5c42\u6570-1",102:"\u751f\u547d\u65e0\u6cd5\u51cf\u5c11\u52301\u4ee5\u4e0b\uff0c\u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",103:"\u53d7\u5230\u5361\u724c\u4f24\u5bb3\u65f6\uff0c\u4f7f\u5bf9\u624b\u627f\u53d7\u53cd\u4f24\u5c42\u6570\u7684\u4f24\u5bb3",104:"\u589e\u52a0\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3",105:"\u514d\u9664\u83b7\u5f97\u8d1f\u9762\u72b6\u6001",106:"\u51cf\u5c11\u53d7\u5230\u7684\u5361\u724c\u4f24\u5bb3",107:"\u4e0b\u4e00\u5f20\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u7ffb\u500d",108:"\u4e0b\u4e00\u5f20\u5361\u724c\u989d\u5916\u4f7f\u7528\u4e00\u6b21\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1"},r=0;r<this.buffList.length;r++){var h=this.buffList[r];e+="<img src='"+this.getBuffImg(h)+"'/>",e+="<color="+i[h]+">"+t[h]+": "+s[h]+"</c>",r!=this.buffList.length-1&&(e+="\r\n")}this.txtBuff.string=e,this.buffBox.height=14+30*this.buffList.length,this.buffBox.width=this.txtBuff.node.width+20,this.txtBuff.node.x=-this.txtBuff.node.width/2}},getBuffImg:function(e){var t={13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind",101:"exRound",102:"undead",103:"atkback",104:"atkAdd",105:"immunity",106:"hurtReduce",107:"doubleDmg",108:"doubleAction"}[e];if(23==e){var i=0;(this.opponent.equip.check(54)||this.opponent.equip.check(113)||this.player.equip.check(113))&&i++,this.player.equip.check(56)&&i--,i>0?t="frailPlus":i<0&&(t="frailMinus")}else 24==e&&this.opponent.equip.check(55)&&(t="weakPlus");return t},openBuffList:function(){if(0!=this.buffList.length){if(window.mainLayer.buffTip){if(window.mainLayer.buffTip==this)return void this.hideTip();window.mainLayer.buffTip.hideTip()}this.buffBox.active=!0,this.refreshBuff(),window.mainLayer.buffTip=this,this.scheduleOnce(this.hideTip,5),11==c.data.guide&&window.guide&&window.guide.close()}},hideTip:function(){this.unscheduleAllCallbacks(),this.buffBox.active=!1,window.mainLayer.buffTip=null}}),cc._RF.pop()},{Game:"Game"}],CampLayer:[function(e,t,i){"use strict";cc._RF.push(t,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{txtHeal:cc.Label,txtCopper:cc.Label,btnHeal:cc.Node,btnCopper:cc.Node,btnDelete:cc.Node,btnEquip:cc.Node,boxHeal:cc.Node,boxCopper:cc.Node,boxDelete:cc.Node,boxEquip:cc.Node},onLoad:function(){window.campLayer=this;var e=1;c.data.equip.indexOf(89)>=0&&(e=0,this.txtHeal.node.color=cc.color(49,248,255)),this.hp=Math.floor(.5*c.data.hpMax*e),this.copper=7*(c.data.castle+3),c.data.equip.indexOf(39)>=0?(this.hp=c.data.hpMax-c.data.hp,this.txtHeal.node.color=cc.color(255,230,62),this.txtHeal.string="\u751f\u547d\u56de\u6ee1",this.copper*=2,this.txtCopper.node.color=cc.color(255,230,62)):this.txtHeal.string="\u751f\u547d+"+this.hp,this.txtCopper.string="\u91d1\u5e01+"+this.copper,4==c.data.heroId&&(this.boxCopper.active=!1,this.boxDelete.active=!0),c.data.equip.indexOf(38)>=0&&(this.boxEquip.active=!0,this.boxHeal.x=-240,this.boxCopper.x=this.boxDelete.x=0),this.btnHeal.opacity=1,this.btnCopper.opacity=1,this.btnDelete.opacity=1,this.btnEquip.opacity=1,this.btnHeal.y-=150,this.btnCopper.y-=150,this.btnDelete.y-=150,this.btnEquip.y-=150,this.btnHeal.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnCopper.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnDelete.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnEquip.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))},onHeal:function(){c.data.hp=Math.min(c.data.hp+this.hp,c.data.hpMax),cc.audioEngine.playEffect(window.sound.healSound),this.close()},onCopper:function(){c.updateCopper(this.copper),cc.audioEngine.playEffect(window.sound.copperSound),this.close()},onDelete:function(){window.homeLayer.openDelete(),this.close()},onEquip:function(){window.homeLayer.openTreasure(),this.close()},close:function(){this.node.destroy(),window.homeLayer.refreshHeroData(),c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.room.ready(),window.room.hero.centerial(),window.campLayer=null}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node,mask:cc.Node,scrollView:cc.Node,boxRandom:cc.Node,animation:dragonBones.ArmatureDisplay,btnClose:cc.Node,cardNode:cc.Node},onLoad:function(){window.bagLayer=this,this.animation.node.zIndex=10,this.scrollView.zIndex=this.cardNode.zIndex=1,this.mask.runAction(cc.fadeTo(.1,180)),this.animation.timeScale=1.5,this.animation.playAnimation("play0",1),this.initDeck(),this.initBag(),c.newCard&&(c.newCard=!1,window.homeLayer.refreshHeroData()),cc.audioEngine.playEffect(window.sound.bagOpenSound),this.scheduleOnce(function(){this.animation.node.zIndex=0,this.scrollView.runAction(cc.fadeIn(.15)),this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(-130,0)),cc.moveBy(.1,cc.v2(10,0)))),window.guide&&window.guide.close(),c.data.deck.length+c.data.cardBag.length>=7&&0==c.data.guideBag&&(c.data.guideBag=1,window.homeLayer.showGuide(31))}.bind(this),.8)},initDeck:function(){this.deck=[];for(var e=0;e<c.data.deck.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.deck[e],0),t.position=cc.v2(e%3*247-247,71-208*Math.floor(e/3)),this.cardNode.addChild(t),this.deck[e]=t}2==c.data.heroId&&3==c.data.difficulty&&(this.boxRandom.active=!0)},initBag:function(){c.data.cardBag.sort(function(e,t){return o.get("cfg_card",e).element==o.get("cfg_card",t).element?e-t:o.get("cfg_card",e).element-o.get("cfg_card",t).element}),this.bagList=[];for(var e=0;e<c.data.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.cardBag[e],1),t.position=cc.v2(e%3*248-248,-108-207*Math.floor(e/3)),this.content.addChild(t),this.bagList.push(t)}this.content.height=Math.max(207*Math.ceil(c.data.cardBag.length/3)+20,530)},equip:function(e){for(var t=-1,i=2==c.data.heroId&&3==c.data.difficulty?5:6,o=0;o<i;o++)if(null==this.deck[o]){t=o;break}if(t>=0){e.parent=this.cardNode,e.position=cc.v2(t%3*248-248,71-208*Math.floor(t/3)),e.getComponent("CardCollection").colletType=0;var a=e.getComponent("CardCollection").cfgId;this.deck[t]=e;var n=c.data.cardBag.indexOf(a);c.data.cardBag.splice(n,1);n=this.bagList.indexOf(e);this.bagList.splice(n,1),this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)}},unEquip:function(e){var t=this.deck.indexOf(e);this.deck[t]=null;for(var i=c.data.cardBag.length,a=e.getComponent("CardCollection").cfgId,n=0;n<c.data.cardBag.length;n++)if(o.get("cfg_card",a).element<o.get("cfg_card",c.data.cardBag[n]).element||o.get("cfg_card",a).element==o.get("cfg_card",c.data.cardBag[n]).element&&a<c.data.cardBag[n]){i=n;break}c.data.cardBag.splice(i,0,a),this.bagList.splice(i,0,e),e.parent=this.content,e.position=cc.v2(i%3*248-248,-108-207*Math.floor(i/3)),e.getComponent("CardCollection").colletType=1,this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)},refreshBag:function(){for(var e=0;e<this.bagList.length;e++)this.bagList[e].runAction(cc.moveTo(.15,cc.v2(e%3*248-248,-108-207*Math.floor(e/3))));this.content.height=Math.max(207*Math.ceil(c.data.cardBag.length/3)+20,530)},close:function(){c.data.deck=[];for(var e=0;e<6;e++)null!=this.deck[e]&&c.data.deck.push(this.deck[e].getComponent("CardCollection").cfgId);this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(120,0)),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.bagCloseSound)}.bind(this)))),this.mask.runAction(cc.sequence(cc.delayTime(1),cc.fadeOut(.2))),this.scrollView.active=!1,this.animation.node.zIndex=10,this.animation.timeScale=-1.5,this.animation.playAnimation("play0",1),this.boxDeck.runAction(cc.sequence(cc.delayTime(.8),cc.moveBy(.2,cc.v2(0,cc.winSize.height/cc.winSize.width*750/2)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardBagMageLayer:[function(e,t,i){"use strict";cc._RF.push(t,"9c13cGNBSlDIYkB1fQUoF3z","CardBagMageLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,box:cc.Node,content:cc.Node,mask:cc.Node,btnClose:cc.Node},onLoad:function(){window.bagLayer=this,this.box.opacity=0,this.mask.runAction(cc.fadeTo(.15,180)),this.box.runAction(cc.sequence(cc.delayTime(.01),cc.moveBy(0,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.fadeIn(0),cc.moveTo(.35,cc.v2(0,0)),cc.callFunc(function(){this.btnClose.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveBy(.2,cc.v2(0,-130)),cc.moveBy(.1,cc.v2(0,10)))))}.bind(this)))),this.initBag(),c.newCard&&(c.newCard=!1,window.homeLayer.refreshHeroData()),cc.audioEngine.playEffect(window.sound.bagOpenSound),window.guide&&window.guide.close()},initBag:function(){c.data.cardBag.sort(function(e,t){return o.get("cfg_card",e).element==o.get("cfg_card",t).element?e-t:o.get("cfg_card",e).element-o.get("cfg_card",t).element}),this.bagList=[];for(var e=0;e<c.data.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.cardBag[e]),t.position=cc.v2(e%3*248-248,-116-207*Math.floor(e/3)),this.content.addChild(t),this.bagList.push(t)}this.content.height=Math.max(207*Math.ceil(c.data.cardBag.length/3)+20,1140)},close:function(){this.btnClose.runAction(cc.sequence(cc.spawn(cc.fadeOut(.2),cc.moveBy(.2,cc.v2(0,120))),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.bagCloseSound)}.bind(this)))),this.mask.runAction(cc.sequence(cc.delayTime(.3),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.25,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardChangeLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0efbet/DcpBqY6/+LvJ5kbp","CardChangeLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,btns:[cc.Node],bg:cc.Node},init:function(e,t,i){window.changeLayer=this,this.cfgId=e,this.cfgId2=t,this.closeFunc=i,this.count=0,this.initDeck(),this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initDeck:function(){for(var e=0;e<c.data.deck.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.deck[e]),t.position=cc.v2(e%3*248-248,385-300*Math.floor(e/3)),this.bg.addChild(t)}},initCards:function(){var e=cc.instantiate(this.cardPrefab);if(e.getComponent("CardCollection").init(this.cfgId),e.position=cc.v2(0,-420),this.bg.addChild(e),this.cfgId2){e.x=-165;var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(this.cfgId2),t.position=cc.v2(165,-420),this.bg.addChild(t)}},onChange:function(e,t){this.btns[t].active=!1,0==this.count?(c.data.deck[t]=this.cfgId,this.count++,this.cfgId2||this.close()):(c.data.deck[t]=this.cfgId2,this.close()),cc.audioEngine.playEffect(window.sound.bingo)},close:function(){this.node.destroy(),window.changeLayer=null,this.closeFunc&&this.closeFunc()}}),cc._RF.pop()},{Game:"Game"}],CardCollection:[function(e,t,i){"use strict";cc._RF.push(t,"a28bfVp4ABL54sr47isHV8F","CardCollection");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,btn:cc.Button,title:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,markDelete:cc.Node,mask:cc.Node,txtChosen:cc.Node,tipNode:cc.Node,tip:cc.Node,txtEmpty:cc.Node,nail:cc.Node},init:function(e,t){if(e<=0)this.btn.node.active=!1,this.markDelete.active=!0,this.txtEmpty.active=!0;else{this.cfgId=e,this.cfg=o.get("cfg_card",e);var i=[cc.color(97,29,31),cc.color(21,41,97),cc.color(9,76,47),cc.color(117,63,26),cc.color(137,106,23),cc.color(74,44,96),cc.color(73,73,73)],a=[cc.color(203,44,46),cc.color(22,104,224),cc.color(0,183,79),cc.color(230,121,30),cc.color(188,160,0),cc.color(169,80,228),cc.color(133,133,133)],n=[cc.color(205,48,39),cc.color(25,84,218),cc.color(0,158,64),cc.color(229,104,24),cc.color(184,144,0),cc.color(152,63,225),cc.color(119,119,119)];this.element=this.cfg.element,this.btn.node.color=i[this.element-1],this.title.color=a[this.element-1],this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=n[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.txtDesc.string=c.analysisDesc(this.cfg.desc1),this.requireNode.y=2,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5);var s=this.cfg.require;if(s>=101&&s<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][s-101];for(var r=[[17,-17],[-30,-56,56,30],[35,0,-35],[52,17,-17,-52]][s-101],h=0;h<r.length;h++)this.createCircle(0,r[h])}else{this.requireNode.y-=10;for(var d=s.split(";"),l=(r=[[0],[-29,29],[-52,0,52],[-78,-26,26,78]][d.length-1],0);l<d.length;l++)this.createCircle(parseInt(d[l]),r[l])}null!=t&&(this.btn.interactable=!0,this.colletType=t)}},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.requireNode.addChild(i),e>0&&i.getComponent("RequireRound").refreshSatisfy(!0)},changeCollectType:function(){0==this.colletType?1==c.data.heroId&&3==c.data.difficulty||window.bagLayer.unEquip(this.node):1==this.colletType?window.bagLayer.equip(this.node):2==this.colletType?window.deleteLayer.confirm(this.cfgId):3==this.colletType&&(window.treasureChest?window.treasureChest.chooseCard(this.cfgId):window.levelUpLayer&&window.levelUpLayer.choose(this.cfgId))},runOut:function(e,t){this.btn.interactable=!1,this.mask.active=!0,this.node.opacity=0,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*t),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,e),cc.scaleTo(.2,1)),cc.callFunc(function(){this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},enableChoosen:function(){this.btn.interactable=!0,this.txtChosen.active=!0,this.txtChosen.opacity=0,this.txtChosen.y-=50,this.txtChosen.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))),cc.callFunc(function(){this.showTip()}.bind(this))))},showTip:function(){for(var e=this,t={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",29:"\u6df7\u4e71",30:"\u76f2\u76ee"},i={13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1"},c={13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind"},o={13:"\u8eb2\u907f\u5bf9\u624b\u4f7f\u7528\u7684\u653b\u51fb\u724c\uff0c\u89e6\u53d1\u540e\u5c42\u6570-1",21:"\u4f7f\u7528\u71c3\u70e7\u7684\u5361\u724c\u65f6\uff0c\u53d7\u52303\u706b\u4f24\u5bb3",22:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u88ab\u91cd\u63b7",23:"\u989d\u5916\u627f\u53d740%\u7684\u5361\u724c\u4f24\u5bb3\uff0c \u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",24:"\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u51cf\u5c1130%\uff0c \u56de\u5408\u7ed3\u675f\u65f6\u5c42\u6570-1",25:"\u4f7f\u5361\u724c\u65e0\u6cd5\u4f7f\u7528",26:"\u56de\u5408\u5f00\u59cb\u65f6\u53d7\u5230\u4e2d\u6bd2\u5c42\u6570\u7684\u4f24\u5bb3\uff0c\u4e2d\u6bd2\u5c42\u6570-1",27:"\u4f7f\u7528\u5361\u724c\u65f6\u670950%\u6982\u7387\u65e0\u6548\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",28:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u4f7f\u7528",29:"\u4f7f\u7528\u653b\u51fb\u724c\u65f6\u670950%\u6982\u7387\u653b\u51fb\u81ea\u8eab\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",30:"\u4f7f\u9ab0\u5b50\u7684\u5143\u7d20\u65e0\u6cd5\u88ab\u67e5\u770b"},a=[],n=0;n<3;n++){var s=this.cfg["effect"+(n+1)];(13==s||s>20)&&a.push(s)}this.tips=[];for(var r=0,h=function(n){var s=a[n],h=cc.instantiate(e.tip);h.active=!0;var d=h.getChildren()[0];h.position=cc.v2(0,30),e.tipNode.addChild(h),e.tips.push(h),h.runAction(cc.sequence(cc.delayTime(.2*n),cc.moveTo(.2,cc.v2(0,115+r)),cc.callFunc(function(){d.runAction(cc.fadeIn(.2))}.bind(e))));var l="<img src='"+c[s]+"'/>";l+="<color="+i[s]+">"+t[s]+": </c>"+o[s],d.getComponent(cc.RichText).string=l,h.height=10+d.height,r+=h.height+10},d=0;d<a.length;d++)h(d)},hideTip:function(){for(var e=0;e<this.tips.length;e++)this.tips[e].runAction(cc.fadeOut(.2));this.txtChosen.active&&this.txtChosen.runAction(cc.fadeOut(.2))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardDeleteLayer:[function(e,t,i){"use strict";cc._RF.push(t,"ba205encTVLE4/a2/Sy3k6o","CardDeleteLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,content:cc.Node,confirmNode:cc.Node},onLoad:function(){window.deleteLayer=this,this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initCards:function(){c.data.cardBag.sort(function(e,t){return o.get("cfg_card",e).element==o.get("cfg_card",t).element?e-t:o.get("cfg_card",e).element-o.get("cfg_card",t).element});for(var e=0;e<c.data.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.data.cardBag[e],2),t.position=cc.v2(e%3*247-247,-120-210*Math.floor(e/3)),this.content.addChild(t)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+1120,this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},confirm:function(e){this.cardId=e,this.confirmNode.active=!0;var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(e),t.getComponent("CardCollection").markDelete.active=!0,t.position=cc.v2(0,100),this.confirmNode.addChild(t),cc.audioEngine.playEffect(window.sound.btn1)},doCancel:function(){this.confirmNode.active=!1},doDelete:function(){var e=c.data.cardBag.indexOf(this.cardId);c.data.cardBag.splice(e,1),this.close(),cc.audioEngine.playEffect(window.sound.delete)},close:function(){this.node.destroy(),window.deleteLayer=null}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardManager:[function(e,t,i){"use strict";cc._RF.push(t,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var c=e("Game"),o=e("Config"),a={doCast:function(e,t){this.cfgId=e;var i=o.get("cfg_card",e);if(this.desc=i.desc,this.card=t,this.chaos=!1,1==i.target1||1==i.target2||1==i.target3)if(window.player.atkPlayed++,window.player.buff.chaos>0&&Math.random()<.5)window.player.buff.removeBuff(29,1),this.chaos=!0;else if(window.opponent.buff.dodge>0)return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("MISS",2),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(e)},doEffect:function(e,t,i){1==i&&this.chaos&&(i=2);var c=null,o=(c=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,a=window.player.buff,n=0,s=1;if((t+="")<0){for(var r=["A","B","C","D","E","F"],h=0,d=0;d<6;d++)if(this.desc.indexOf(r[d])>=0){h=d;break}n=window.player.elementList[h]*Math.abs(parseInt(t))}else{var l=t.split(";");if(8==e)n=parseInt(l[0]),s=parseInt(l[1]);else if(1==l.length)n=parseInt(t);else{var u=parseInt(l[0]),f=parseInt(l[1]);n=3==e&&window.player.equip.checkWithTrigger(120)?f:Math.floor(Math.random()*(f-u+1))+u}}if(e<10){if(1==i){if(n*=Math.pow(2,a.doubleDmg),a.removeBuff(107,a.doubleDmg),window.player.equip.wolfBlood&&a.addBuff(107,1),a.weak>0&&!window.player.equip.checkWithTrigger(65)){var p=.7;window.opponent.equip.checkWithTrigger(55)&&(p=.5),n=Math.round(n*p)}1==window.player.atkPlayed&&window.player.equip.checkWithTrigger(100)&&(n*=2)}for(var m=0;m<s;m++)c.onHurt(n,0,e,i)}else 11==e?c.player.updateArmor(n):12==e?c.onHeal(n):14==e?c.addPower&&c.addPower(n):(13==e||e>=21)&&o.addBuff(e,n)},doSpecial:function(e){var t=window.opponent.buff,i=window.player.buff;if(132==e)this.doEffect(11,window.host.armor,2);else if(133==e)this.doEffect(7,Math.floor(window.host.armor/2),1);else if(134==e)this.doEffect(7,2*window.host.armor,1),window.player.updateArmor(-window.host.armor);else if(135==e)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==e)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==e)this.doEffect(7,Math.floor(window.host.hp/2),1);else if(138==e)i.addBuff(102,2);else if(139==e)i.addBuff(101,1);else if(140==e)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==e)null!=window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==e)null!=window.host.power&&(this.doEffect(11,window.host.power,2),window.host.addPower(-window.host.power));else if(143==e)null!=window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==e)this.doEffect(7,2*t.poison,1);else if(145==e)this.doEffect(7,4*t.poison,1),t.removeBuff(26,t.table[26]);else if(146==e)t.addBuff(26,t.poison);else if(147==e){for(var a=window.player.deck,n=0,s=0;s<a.length;s++){var r=o.get("cfg_card",a[s]);23!=r.effect1&&23!=r.effect2&&23!=r.effect3||n++}var h=20+4*n;this.doEffect(3,"4;"+h,1)}else if(148==e){var d=t.weak>0?20:10;this.doEffect(4,d,1)}else if(149==e)t.poison>0&&this.doEffect(26,2,1);else if(150==e){d=t.burn>0?16:8;this.doEffect(1,d,1)}else if(151==e)t.freeze>0&&this.doEffect(22,1,1);else if(152==e)t.silence>0&&this.doEffect(25,1,1);else if(e>=153&&e<=158){var l=[2,3,5,0,1,4][e-153];window.player.elementList[l]>=[2,2,2,3,3,3][e-153]&&this.doEffect(l+21,[1,1,2,2,2,1][e-153],1)}else if(e>=159&&e<=162)t.addBuff(Math.floor(10*Math.random())+21,162==e?2:1);else if(e>=163&&e<=166)this.doEffect(108,1,2);else if(167==e)i.multiCast++,i.multiCastMax++;else if(e>=168&&e<=171)this.doEffect(107,1,2);else if(172==e)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-t.freeze,1);else if(173==e)this.doEffect(21,window.opponent.deck.length-t.burn,1);else if(174==e)this.doEffect(1,6*t.burn,1);else if(175==e)this.doEffect(7,6*t.freeze,1);else if(176==e)this.doEffect(7,6*t.silence,1);else if(177==e)this.doEffect(7,4*t.frail,1);else if(178==e)this.doEffect(7,4*t.weak,1);else if(e>=179&&e<=182){d=(u=[1,6,6,10])[e-179]+(f=[3,2,3,4])[e-179]*(i.iteraList[e-179]-1);this.doEffect(7,d,1)}else if(e>=183&&e<=186){var u=[8,13,15,21],f=[3,3,4,5];n=Math.min(i.iteraList[e-179]-1,[2,4,3,4][e-183]),d=u[e-183]-f[e-183]*n;this.doEffect(7,d,1)}else if(187==e)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==e)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==e)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==e)this.doEffect(1,12+3*i.elementRoundCasted[0],1);else if(191==e)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==e)this.doEffect(3,12+3*i.elementRoundCasted[2],1);else if(193==e){if((n=Math.min(window.opponent.deck.length,6))>0){var p=Math.floor(Math.random()*n),m=window.opponent.deck[p];window.opponent.deck.splice(p,1),window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(194==e){if((n=Math.min(window.opponent.deck.length,6))>0){p=Math.floor(Math.random()*n),m=window.opponent.deck[p];window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(195==e){if((n=Math.min(window.opponent.deck.length,6))>0){p=Math.floor(Math.random()*n),m=window.opponent.deck[p];window.player.patchCard(m)}}else if(196==e){var g=c.getRandomCardId(2);window.player.patchCard(g,!0),window.player.deck.push(g)}else if(197==e){g=c.getRandomCardId(2);window.player.patchCard(g,null,!0)}else if(198==e||376==e){var y=function(){var e=window.player.patchCard();e&&(2!=e.getComponent("Card").element&&window.player.cardList.length<6?e.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){y()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&(window.mainLayer.gameOver||window.mainLayer.enemy.ai.check())}.bind(this),.8))}.bind(this);y()}else if(199==e)window.player.diceCount++,window.player.createExDice();else if(200==e)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==e){for(var v=21;v<=30;v++)i.removeBuff(v,i.table[v]);for(var w=0;w<window.player.cardList.length;w++)window.player.cardList[w].getComponent("Card").clear();for(var b=0;b<window.player.diceList.length;b++)window.player.diceList[b].getComponent("Dice").clear();window.player.checkElement()}else if(202==e){for(var C=0,x=21;x<=30;x++)t.table[x]>0&&C++;this.doEffect(7,6*C,1)}else if(203==e)window.player.addRollCount();else if(204==e)window.player.rollCount++,window.player.roll();else if(205==e){if(window.player.cardList.length>0){p=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[p].getComponent("Card").discard(),this.doEffect(7,15,1)}}else if(206==e||207==e){if(window.player.cardList.length>0){p=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[p].getComponent("Card").discard(null,!0),this.doEffect(7,206==e?25:30,1)}}else if(208==e){this.doEffect(7,5*window.player.cardList.length,1);for(var L=[],k=0;k<window.player.cardList.length;k++)L.push(window.player.cardList[k].getComponent("Card"));for(var T=0;T<L.length;T++)L[T].discard()}else if(e>=209&&e<=214){u=214==e?2:1;this.doEffect(e-209+21,u+i.iteraList2[e-209]-1,1)}else if(215==e)window.opponent.buff.burnIce=!0;else if(216==e)window.opponent.buff.silenceDark=!0;else if(217==e)c.data.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(218==e){g=c.getRandomCardId(2);window.player.patchCard(g)}else if(219==e)window.player.patchCard();else if(220==e)this.doEffect(3,2*window.player.atkRound-1,1);else if(221==e)i.selfHarmCast++,i.selfHarmCastMax++;else if(222==e)window.host.hpMax+=20,window.host.hp+=20,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(225==e||226==e)window.player.elementList[e-223]>=2&&this.doEffect(7,4,1);else if(227==e||228==e)window.player.elementList[e-225]>=3&&this.doEffect(11,4,2);else if(229==e)window.player.createExDice(3);else if(230==e)window.player.createExDice(4);else if(231==e)1==window.player.cardPlayedRound&&this.doEffect(23,1,1);else if(234==e){h=t.frail>0?30:20;this.doEffect(3,"4;"+h,1)}else if(235==e)i.creatDiceFire++;else if(236==e)window.player.addRollCount();else if(237==e)this.doEffect(7,Math.floor(window.host.hp/2),2),this.doEffect(7,Math.min(30,Math.floor(window.opponent.host.hp/2)),1);else if(238==e)this.doEffect(7,6+6*window.player.createDiceRound[4],1);else if(239==e)i.exCreateDice++;else if(342==e)t.weak>0&&this.doEffect(12,6,2);else if(382==e){window.player.addRollCount();L=[];for(var I=0;I<window.player.cardList.length;I++)L.push(window.player.cardList[I].getComponent("Card"));n=Math.min(L.length,3);for(var B=0;B<n;B++){L[F=Math.floor(Math.random()*L.length)].discard(),L.splice(F,1)}}else if(391==e){this.doEffect(11,5*window.player.cardList.length,2);L=[];for(var q=0;q<window.player.cardList.length;q++)L.push(window.player.cardList[q].getComponent("Card"));for(var E=0;E<L.length;E++)L[E].discard(null,!0)}else if(392==e)window.player.delayCard.push(392);else if(393==e){for(var A=0;A<window.player.diceList.length;A++)window.player.legacyDice.push(window.player.diceList[A].getComponent("Dice").element),window.player.dicePool.put(window.player.diceList[A]);window.player.diceList=[],window.player.checkElement(),window.host.checkBtnRoll()}else if(394==e)window.player.delayCard.push(394);else if(395==e){L=[];for(var R=0;R<window.player.cardList.length;R++)L.push(window.player.cardList[R].getComponent("Card"));n=Math.min(L.length,2);for(var N=0;N<n;N++){var F;L[F=Math.floor(Math.random()*L.length)].discard(null,!0),L.splice(F,1),window.player.createExDice()}}else if(396==e)window.player.delayCard.push(396);else if(397==e)for(var M=0;M<2;M++)window.player.createExDice(),window.player.deck.push(224),window.player.deckArray&&window.player.deckArray.push(224);else if(398==e)this.doEffect(7,5*window.player.diceList.length,1);else if(399==e){L=[];for(var S=0;S<window.player.cardList.length;S++){var D=window.player.cardList[S].getComponent("Card");1==D.element&&L.push(D)}if(L.length>0){var P=L[Math.floor(Math.random()*L.length)];this.doCast(P.cfgId)}}else if(400==e){L=[];for(var O=0;O<window.player.cardList.length;O++){var H=window.player.cardList[O].getComponent("Card");2==H.element&&L.push(H)}if(L.length>0)L[Math.floor(Math.random()*L.length)].discard()}else if(401==e)i.doubleWind=!0;else if(402==e){L=[];for(var _=0;_<window.player.cardList.length;_++){var G=window.player.cardList[_].getComponent("Card");4==G.element&&L.push(G)}if(L.length>0)L[Math.floor(Math.random()*L.length)].discard(null,!0)}else if(403==e){if(U=window.player.deckArray)for(var z=0;z<U.length;z++)if(5==o.get("cfg_card",U[z]).element){window.player.patchCard(U[z],!0)&&U.splice(z,1);break}}else if(405==e)1==window.player.cardPlayedRound&&window.player.createExDice(1,!0);else if(406==e)window.player.diceList.length<=0&&window.player.createExDice(2,!0);else if(407==e){var U;if(U=window.player.deckArray)for(var W=0;W<U.length;W++){var Y=o.get("cfg_card",U[W]);if(11==Y.effect1||11==Y.effect2||11==Y.effect3){window.player.patchCard(U[W],!0)&&U.splice(W,1);break}}}else if(408==e)window.opponent.host.armor>0&&window.opponent.updateArmor(-window.opponent.host.armor);else if(409==e)if(0==window.player.index){for(var J=0;J<=0;){var j=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1,X=o.get("cfg_item",j);X.get<3&&(0==X.hero||4==X.hero)&&X.battle&&0==X.num&&(J=j)}window.player.equip.addEquip(J)}else{var K=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1;window.player.equip.addEquip(K)}else 410==e&&(0==window.player.index?this.doEffect(7,3*c.data.equip.length,1):this.doEffect(7,3*window.host.equipList.length,1))},doDiscard:function(e){383==e?this.doEffect(1,12,1):384==e?this.doEffect(2,12,1):385==e?this.doEffect(3,12,1):386==e?this.doEffect(11,12,2):387==e?this.doEffect(12,10,2):388==e?this.doEffect(9,8,1):389==e?this.doEffect(22,3,1):390==e&&this.doEffect(27,2,1)},doDelayEffect:function(e){392==e?null!=window.host.power&&this.doEffect(7,2*window.host.power,1):394==e?(window.player.buff.addBuff(104,3),window.player.buff.tempBuff[1]+=3):396==e&&(window.player.extraDice+=2)}};t.exports=a,cc._RF.pop()},{Config:"Config",Game:"Game"}],CardTavern:[function(e,t,i){"use strict";cc._RF.push(t,"a4f5bK9YrVNG5vdkkTG5T0R","CardTavern");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,bgFront:cc.Node,bgBack:cc.Node,bgBase:cc.Node,bgEmpty:cc.Node,txtDesc1:cc.RichText,txtDesc2:cc.RichText,txtRequire:cc.Label,mask:cc.Node,requirePrefab:cc.Prefab,requireNode:cc.Node,circleNode:cc.Node},init:function(e){this.cfgId=e,this.cfg=o.get("cfg_tavern",e),this.require=this.cfg.require,this.initInfo(),cc.loader.loadRes("Texture/UI/tavern/card"+(this.cfgId>=19?2:1),cc.SpriteFrame,function(e,t){this.bgFront.getComponent(cc.Sprite).spriteFrame=t,this.bgBack.getComponent(cc.Sprite).spriteFrame=t,this.bgEmpty.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.mask.active=!0,this.usable=!1},initInfo:function(){cc.loader.loadRes("Texture/UI/yahtzee/reward"+this.cfg.icon,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this));var e=c.analysisDesc(this.cfg.desc1);this.txtDesc1.string=this.txtDesc2.string=e,this.circleNode.removeAllChildren(),this.requireCircles=[];var t=this.cfg.require;if(this.requireNode.y=20,this.txtDesc1.node.height<30?this.requireNode.y-=10:this.txtDesc1.node.height<50&&(this.requireNode.y-=5),t>=100&&t<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][t-100];for(var i=[[0],[17,-17],[-30,-56,56,30],[35,0,-35],[52,17,-17,-52]][t-100],o=0;o<i.length;o++)this.createCircle(0,i[o])}else{this.txtRequire.string="",this.requireNode.y-=10;for(var a=t.split(";"),n=(i=[[0],[-29,29],[-52,0,52],[-78,-26,26,78]][a.length-1],0);n<a.length;n++){this.createCircle(parseInt(a[n]),i[n]).zIndex=4-n}}},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(e,this.cfgId>=19?-2:-1),i.position=cc.v2(t,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},checkRequire:function(){if(this.usable)return!0;var e=!1,t=window.player.elementList.concat();if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],c=102==this.require?2:1,o=[],a=0;a<6;a++)t[a]>=i[this.require-100]&&(c--,o.push(a+1)),102==this.require&&t[a]>=4&&(c-=2,o.push(a+1),o.push(a+1));if(c<=0&&(e=!0),102!=this.require){var n=0,s=this.requireCircles[0].getComponent("RequireRound").element;if(s)o.indexOf(s)<0&&(n=o.length>0?1:-1);else o.length>0&&(n=1);for(var r=0;r<this.requireCircles.length;r++){var h=this.requireCircles[r].getComponent("RequireRound");1==n?(h.refreshElement(o[0]),h.refreshSatisfy(!0)):-1==n&&h.hideElement()}}else{var d,l=[null,null],u=[0,0],f=this.requireCircles[0].getComponent("RequireRound").element,p=this.requireCircles[2].getComponent("RequireRound").element;if(f)(d=o.indexOf(f))>=0&&(l[0]=0,o.splice(d,1),u[0]=f);if(p)(d=o.indexOf(p))>=0&&(l[1]=0,o.splice(d,1),u[1]=f);for(var m=0;m<2;m++){if(null==l[m])(0==m?f:p)?o.length>0?(l[m]=1,u[m]=o[0],o.splice(0,1)):l[m]=-1:o.length>0?(l[m]=1,u[m]=o[0],o.splice(0,1)):l[m]=0}for(var g=0;g<this.requireCircles.length;g++){var y=this.requireCircles[g].getComponent("RequireRound"),v=g<2?0:1;1==l[v]?(y.refreshElement(u[v]),y.refreshSatisfy(!0)):-1==l[v]&&y.hideElement()}}}else{for(var w=[0,0,0,0,0,0],b=this.require.split(";"),C=0;C<b.length;C++)w[b[C]-1]++;e=!0;for(var x=0;x<6;x++)if(t[x]<w[x]){e=!1;break}for(var L=0;L<this.requireCircles.length;L++){var k=this.requireCircles[L].getComponent("RequireRound");t[k.element-1]>0?(k.refreshSatisfy(!0),t[k.element-1]--):k.refreshSatisfy(!1)}}return this.usable=e,e?(this.mask.active=!1,this.bingo(),cc.audioEngine.playEffect(window.sound.bingo)):this.mask.active=!0,e},bingo:function(){this.scheduleOnce(function(){this.bgFront.runAction(cc.scaleTo(.2,1,0)),this.bgBack.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.2,1,1),cc.scaleTo(.2,1,.8),cc.scaleTo(.2,1,1))),this.bgBase.runAction(cc.sequence(cc.scaleTo(.2,1,.1),cc.scaleTo(.2,1,1),cc.scaleTo(.2,1,.85),cc.scaleTo(.2,1,1)))}.bind(this),.1)},change:function(e){this.bgEmpty.active=!0,this.bgFront.stopAllActions(),this.bgBack.stopAllActions(),this.usable?(this.bgFront.scaleY=0,this.bgFront.runAction(cc.sequence(cc.delayTime(.75),cc.scaleTo(.15,1,1),cc.scaleTo(.15,1,.8),cc.scaleTo(.15,1,1))),this.bgBack.runAction(cc.scaleTo(.15,1,0))):(this.bgFront.runAction(cc.sequence(cc.scaleTo(.15,1,0),cc.delayTime(.6),cc.scaleTo(.15,1,1),cc.scaleTo(.15,1,.8),cc.scaleTo(.15,1,1))),this.bgBack.scaleY=0),this.bgEmpty.runAction(cc.sequence(cc.delayTime(.15),cc.sequence(cc.scaleTo(.15,1,1),cc.scaleTo(.15,1,0)).repeat(3))),this.bgBase.runAction(cc.sequence(cc.sequence(cc.scaleTo(.15,1,.1),cc.scaleTo(.15,1,1)).repeat(3),cc.scaleTo(.15,1,.85),cc.scaleTo(.15,1,1))),this.scheduleOnce(function(){this.cfgId=e,this.cfg=o.get("cfg_tavern",e),this.require=this.cfg.require,this.initInfo(),this.mask.active=!0,this.usable=!1}.bind(this),.15),this.scheduleOnce(function(){this.checkRequire()}.bind(this),1.2)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Card:[function(e,t,i){"use strict";cc._RF.push(t,"cfa35/uH59ANIsjw79G+feg","Card");var c=e("Game"),o=e("Config"),a=e("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,title:cc.Node,fires:dragonBones.ArmatureDisplay,nodeSilence:cc.Node,markSilence:cc.Node,markDelete:cc.Node,animationCursed:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,animationCounter:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(e,t,i){this.cfgId=e,this.index=t,this.buffId=i,this.pos=cc.v2(t%3,Math.floor(t/3)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(248*this.pos.x-248,99-210*this.pos.y-500*this.delta),this.node.zIndex=2-this.pos.y,this.btn.interactable=!1,this.node.opacity=1;var a=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,99-210*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*this.pos.y),a,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),this.cfg=o.get("cfg_card",e),this.element=this.cfg.element,this.initInfo(),this.mask.active=!0,this.btn.node.active=!0,this.nodeSilence.active=this.fires.node.active=this.animationCursed.active=this.animationDiscard.node.active=this.animationCounter.active=this.markDelete.active=!1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1,this.hasCopy=!1,this.unCost=!1,this.rate=1;var n=this.require=this.cfg.require;if(n>=100&&n<=107){this.rate=[1,1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][n-100]}else{this.rate=[1/6,1/36,1/216,1/1296,1/7776][n.split(";").length-1]}0==window.mainLayer.roundId&&4==c.data.heroId&&this.disCost(!0)},initInfo:function(){var e=[cc.color(97,29,31),cc.color(21,41,97),cc.color(9,76,47),cc.color(117,63,26),cc.color(137,106,23),cc.color(74,44,96),cc.color(73,73,73)],t=[cc.color(203,44,46),cc.color(22,104,224),cc.color(0,183,79),cc.color(230,121,30),cc.color(188,160,0),cc.color(169,80,228),cc.color(133,133,133)],i=[cc.color(205,48,39),cc.color(25,84,218),cc.color(0,158,64),cc.color(229,104,24),cc.color(184,144,0),cc.color(152,63,225),cc.color(119,119,119)];this.btn.node.color=e[this.element-1],this.title.color=t[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.initDesc(),this.circleNode.removeAllChildren(),this.requireCircles=[];var c=this.cfg.require;if(this.requireNode.y=2,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),c>=100&&c<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][c-100];for(var o=[[0],[17,-17],[-30,-56,56,30],[35,0,-35],[52,17,-17,-52]][c-100],a=0;a<o.length;a++)this.createCircle(0,o[a])}else{this.txtRequire.string="",this.requireNode.y-=10;for(var n=c.split(";"),s=(o=[[0],[-29,29],[-52,0,52],[-78,-26,26,78]][n.length-1],0);s<n.length;s++){this.createCircle(parseInt(n[s]),o[s]).zIndex=4-s}}},initWithCopy:function(e,t){this.cfgId=e,this.pos=t,this.isCopy=!0,this.isTemp=!0,this.cfg=o.get("cfg_card",e),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(e){this.usable=!1,this.btn.interactable=!1;var t=e?.3:0;this.scheduleOnce(function(){if(this.node.zIndex=0,0==window.mainLayer.roundId){var e=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{e=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var t=window.player.cardList.indexOf(this.node);t>=0&&(window.player.cardList.splice(t,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}.bind(this),t)},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},initBuff:function(){6==this.element&&window.opponent.equip.checkWithTrigger(172)&&(this.buffId=25);var e=this.buffId;this.burn=21==e,this.burn?(this.fires.node.active=!0,this.fires.playAnimation("play0",0),cc.audioEngine.playEffect(window.sound.burnSound)):this.fires.node.active=!1,this.silence=25==e,this.silence?(this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.nodeSilence.active=!0}.bind(this)))),this.markSilence.stopAllActions(),this.markSilence.y=130,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5))),cc.audioEngine.playEffect(window.sound.blackSound)):this.nodeSilence.active=!1},checkRequire:function(){var e=!1,t=window.player.elementList.concat();if(0==window.player.index&&4==c.data.heroId)e=this.element<7?t[this.element-1]>0:window.player.diceList.length>0;else if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],o=102==this.require?2:1,a=[],n=0;n<6;n++)t[n]>=i[this.require-100]&&(o--,a.push(n+1)),102==this.require&&t[n]>=4&&(o-=2,a.push(n+1),a.push(n+1));if(o<=0&&(e=!0),102!=this.require){var s=0,r=this.requireCircles[0].getComponent("RequireRound").element;if(r)a.indexOf(r)<0&&(s=a.length>0?1:-1);else a.length>0&&(s=1);for(var h=0;h<this.requireCircles.length;h++){var d=this.requireCircles[h].getComponent("RequireRound");1==s?(d.refreshElement(a[0]),d.refreshSatisfy(!0)):-1==s&&d.hideElement()}}else{var l,u=[null,null],f=[0,0],p=this.requireCircles[0].getComponent("RequireRound").element,m=this.requireCircles[2].getComponent("RequireRound").element;if(p)(l=a.indexOf(p))>=0&&(u[0]=0,a.splice(l,1),f[0]=p);if(m)(l=a.indexOf(m))>=0&&(u[1]=0,a.splice(l,1),f[1]=p);for(var g=0;g<2;g++){if(null==u[g])(0==g?p:m)?a.length>0?(u[g]=1,f[g]=a[0],a.splice(0,1)):u[g]=-1:a.length>0?(u[g]=1,f[g]=a[0],a.splice(0,1)):u[g]=0}for(var y=0;y<this.requireCircles.length;y++){var v=this.requireCircles[y].getComponent("RequireRound"),w=y<2?0:1;1==u[w]?(v.refreshElement(f[w]),v.refreshSatisfy(!0)):-1==u[w]&&v.hideElement()}}}else{for(var b=[0,0,0,0,0,0],C=this.require.split(";"),x=0;x<C.length;x++)b[C[x]-1]++;e=!0;for(var L=0;L<6;L++)if(t[L]<b[L]){e=!1;break}for(var k=0;k<this.requireCircles.length;k++){var T=this.requireCircles[k].getComponent("RequireRound");t[T.element-1]>0?(T.refreshSatisfy(!0),t[T.element-1]--):T.refreshSatisfy(!1)}}return this.unCost&&(e=!0),this.silence&&(e=!1),224==this.cfgId&&(e=!1),this.usable=e,e?(this.mask.active=!1,this.btn.interactable=!0):this.silence?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),e},doCast:function(){this.usable&&0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?(this.btn.node.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound),cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c")):this.silence?(this.markSilence.stopAllActions(),this.markSilence.y=90,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,15)),cc.delayTime(.5),cc.fadeOut(.5)))):(this.cast(),window.guide&&window.guide.close()))},cast:function(){if(0==window.mainLayer.roundId){if(this.cfgId>=205&&this.cfgId<=208&&!window.player.cardUsabled)return}else if(!window.player.cardUsabled)return;this.burn&&window.host.onHurt(3,1,21,0);var e=!1,t=!1;if(0==window.player.cardPlayedRound&&window.opponent.equip.trigger(127)?(t=!0,e=!0):window.player.buff.curse&&Math.random()<.5&&!window.player.equip.checkWithTrigger(107)&&(e=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.trigger(108)),this.btn.interactable=!1,window.player.cardUsabled=!1,e)this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1;var e=cc.instantiate(t?this.animationCounter:this.animationCursed);e.active=!0,e.parent=window.player.boxCard,e.position=this.node.position.add(cc.v2(10,-10)),e.zIndex=100,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("play0"),e.getComponent(dragonBones.ArmatureDisplay).on(dragonBones.EventObject.LOOP_COMPLETE,function(){e.destroy()}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(t?0:.1),cc.callFunc(function(){this.maskBlack.active=!1,this.endCast(),198!=this.cfgId&&376!=this.cfgId||1!=window.mainLayer.roundId||this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.5)}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(t?window.sound.counterSound:window.sound.curseSound),window.player.equip.luckyCard>0&&(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43)),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1));else{this.node.zIndex=200;var i=cc.spawn(cc.moveBy(.05,cc.v2(0,-20)),cc.scaleTo(.05,1)),o=cc.moveBy(.35,cc.v2(0,1100)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),i,o,cc.callFunc(function(){window.mainLayer.gameOver||(a.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var n=window.player.cardList.indexOf(this.node);n>=0&&(window.player.cardList.splice(n,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var s=0;s<3;s++)if(this.cfg["effect"+(s+1)]<10&&1==this.cfg["target"+(s+1)]){var r=1;8==this.cfg["effect"+(s+1)]&&(r=parseInt(this.cfg["num"+(s+1)].split(";")[1])),window.player.atkRound+=r}for(var h=0;h<window.player.cardList.length;h++){var d=window.player.cardList[h].getComponent("Card");(d.cfgId>=179&&d.cfgId<=186||d.cfgId>=209&&d.cfgId<=214||220==d.cfgId)&&d.initDesc(),232==d.cfgId&&Math.random()<.2&&window.opponent.buff.addBuff(23,1)}e||this.isCopy||(this.cfgId<163||this.cfgId>166)&&(3==this.element&&window.player.buff.doubleWind?(this.reuse(),window.player.buff.doubleWind=!1):233==this.cfgId&&window.opponent.buff.frail>0?this.reuse():window.player.buff.selfHarmCast>0&&this.cfg.effect1<10&&2==this.cfg.target1?(window.player.buff.selfHarmCast--,this.reuse()):window.player.buff.doubleCast>0?(window.player.buff.removeBuff(108,1),this.reuse()):window.player.equip.luckyCard>0?(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1)):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)&&167!=this.cfgId?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)?this.reuse():Math.random()<.3&&window.player.equip.checkWithTrigger(149)&&this.reuse()),this.isRemove&&this.doDelete(),this.isCopy||(window.player.cardPlayed++,window.player.cardPlayedRound++),0==window.player.index&&(4==c.data.heroId?(window.player.deleteDice(this.element),2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId))):2==c.data.heroId&&window.player.randomCard&&window.player.randomCard==this.node&&(window.player.randomCard=null))},endCast:function(){if(!this.isCopy){var e=window.player.equip;if(e.trigger(1),e.trigger(4),e.trigger(97),e.trigger(153),e.trigger(169),this.cfg.element<=6&&e.trigger(this.cfg.element+77),2==this.cfg.element&&e.trigger(157),window.opponent.equip.trigger(24),window.opponent.equip.trigger(166),window.player.cardPlayed%4==0&&window.opponent.equip.trigger(144),this.isRemove&&window.player.equip.trigger(183),0==window.player.index&&(2==c.data.heroId?2==c.data.difficulty?(window.player.rollCount++,window.player.roll()):window.player.addRollCount():4==c.data.heroId&&(window.player.suppleCard(),c.data.cardPlayed[this.cfgId]?c.data.cardPlayed[this.cfgId]++:c.data.cardPlayed[this.cfgId]=1)),window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.selfHarmCastMax>0&&window.player.buff.selfHarmCast<=0&&(window.player.buff.selfHarmCast=window.player.buff.selfHarmCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++,window.player.equip.elementPlayed[this.cfg.element-1]++,window.player.equip.trigger(184),window.player.equip.trigger(185),6==this.element&&window.player.buff.darkRedice>0)for(var t=0;t<window.player.buff.darkRedice;t++)window.player.createExDice(6,!0);window.player.buff.darkRedice=0,404==this.cfgId&&window.player.buff.darkRedice++}window.player.cardPool.put(this.node),window.player.cardUsabled=!0,1!=window.mainLayer.roundId||this.hasCopy||198!=this.cfgId&&376!=this.cfgId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.6),6==c.data.guide&&2==window.player.cardPlayedRound?window.mainLayer.showGuide(6):10==c.data.guide&&3==window.player.cardPlayedRound&&window.mainLayer.showGuide(10)},discard:function(e,t){this.btn.interactable=!1,this.btn.node.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.LOOP_COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(window.sound.discardSound);var i=window.player.cardList.indexOf(this.node);i>=0&&(window.player.cardList.splice(i,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll()),t?(this.markDelete.active=!0,this.markDelete.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5)))):4==c.data.heroId&&2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId)),e||t?t&&this.doDelete():(a.doDiscard(this.cfgId),window.player.equip.trigger(22),window.player.equip.trigger(182)),0==window.player.index&&4==c.data.heroId&&window.player.suppleCard()},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),window.player.equip.trigger(181),!this.isTemp){var e=window.player.deck.indexOf(this.cfgId);e>=0&&window.player.deck.splice(e,1)}},reuse:function(){var e=cc.instantiate(this.node);e.position=this.node.position,window.player.boxCard.addChild(e,this.node.zIndex-1),e.getComponent("Card").initWithCopy(this.cfgId,this.pos),this.hasCopy=!0,e.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){e.getComponent("Card").cast()}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},initDesc:function(){var e=c.analysisDesc(this.cfg.desc1);if(147==this.cfgId){for(var t=window.player.deck,i=0,a=0;a<t.length;a++){var n=o.get("cfg_card",t[a]);23!=n.effect1&&23!=n.effect2&&23!=n.effect3||i++}e+="<color=#CA9300>  (\u4e0a\u9650"+(20+4*i)+")</c>"}else if(this.cfgId>=179&&this.cfgId<=182){var s=[3,2,3,4];e+="<color=#CA9300>  (\u5f53\u524d"+((r=[1,6,6,10])[this.cfgId-179]+s[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var r=[8,13,15,21];s=[3,3,4,5],i=Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,3,4][this.cfgId-183]);e+="<color=#CA9300>  (\u5f53\u524d"+(r[this.cfgId-183]-s[this.cfgId-183]*i)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){e+="<color=#CA9300>  (\u5f53\u524d"+((r=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}else 220==this.cfgId?e+="<color=#CA9300>  (\u5f53\u524d"+(2*window.player.atkRound+1)+")</c>":238==this.cfgId&&(e+="<color=#CA9300>  (\u5f53\u524d"+(6+6*window.player.createDiceRound[4])+")</c>");this.txtDesc.string=e},disCost:function(e){e||(this.unCost=!0);for(var t=0;t<this.requireCircles.length;t++){var i=this.requireCircles[t].getComponent("RequireRound");i.disCost(),this.require>=100&&this.require<=105&&i.hideElement()}},discribeRandom:function(){this.txtTitle.string=this.txtTitle2.string=this.cfg.name+"*"}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Chess:[function(e,t,i){"use strict";cc._RF.push(t,"52ab21v1YlCW5nnj9YYUNmp","Chess");var c=e("Utils"),o=e("Game");cc.Class({extends:cc.Component,properties:{figureNode:cc.Node,figures:[cc.Node],waterNode:cc.Node,waterFigures:[cc.Node]},onLoad:function(){this.speed=800,this.distances=[0,100,80,120,100,160,160,100,100]},come:function(e,t){this.from=e,this.roomType=o.data.roomType,this.node.position=c.getDirectionVector(e,320);var i=c.getDirectionVector(e,this.distances[this.roomType]);this.node.runAction(cc.sequence(cc.moveTo(320/this.speed,i),cc.callFunc(t))),this.refreshDiration(e,1)},stay:function(e){this.from=e,this.roomType=o.data.roomType;this.node.position=c.getDirectionVector(e,[0,0,0,120,100,160,160,0,0][this.roomType]),this.refreshDiration(e,1)},leave:function(e,t){this.farward=e,this.callBack=t;var i=c.getDirectionVector(e,320);if(this.roomType<=2||this.roomType>=7)this.refreshDiration(e),this.node.runAction(cc.sequence(cc.moveTo(320/this.speed,i),cc.callFunc(t)));else{if(this.from==(e+2)%4)if(0==e||2==e){var o=Math.random()<.5?1:3;this.stepList=[o,e,e,4-o]}else this.stepList=[2,e,e,0];else this.stepList=[e,(this.from+2)%4];this.doStep()}},doStep:function(){if(this.stepList.length>0)this.walk(this.stepList.shift());else{this.refreshDiration(this.farward);var e=c.getDirectionVector(this.farward,320),t=e.sub(this.node.position).mag();this.node.runAction(cc.sequence(cc.moveTo(t/this.speed,e),cc.callFunc(this.callBack)))}},walk:function(e){var t=this.distances[this.roomType];this.refreshDiration(e),this.node.runAction(cc.sequence(cc.moveBy(t/this.speed*1.2,c.getDirectionVector(e,t)),cc.callFunc(function(){this.doStep()}.bind(this))))},refreshDiration:function(e,t){var i=t?(e+2)%4:e;this.refreshFace(i),0==e?this.node.zIndex--:2==e&&this.node.zIndex++},refreshFace:function(e){for(var t=0;t<4;t++)this.figures[t].active=e==t,2==this.roomType&&(this.waterFigures[t].active=e==t)},centerial:function(){var e=this.node.position.mag()/this.speed;this.node.runAction(cc.moveTo(e,cc.v2()))},update:function(){2==this.roomType&&(this.figureNode.active?this.node.position.mag()<140&&(this.figureNode.active=!1,this.waterNode.active=!0):this.waterNode.active&&this.node.position.mag()>140&&(this.figureNode.active=!0,this.waterNode.active=!1))}}),cc._RF.pop()},{Game:"Game",Utils:"Utils"}],Chest:[function(e,t,i){"use strict";cc._RF.push(t,"282832AcdZFNov+QpH9gQcZ","Chest");var c=e("Utils");cc.Class({extends:cc.Component,properties:{txtRequire:cc.RichText,btn:cc.Button},init:function(e){this.index=e,this.node.position=cc.v2(240*e-240,-500),this.btn.node.color=cc.Color.GRAY,this.node.opacity=1;var t=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.3),t,cc.moveBy(.05,cc.v2(0,-20)))),this.satisfied=[!1,!1,!1,!1,!1,!1],this.requireList=c.getDifferentRandomNum(4,6,1),this.refreshRequire()},refreshRequire:function(){this.usable=!0;for(var e="",t=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],i=0;i<this.requireList.length;i++){var c=this.requireList[i];this.satisfied[c-1]?e+="<color=#EBC82E>"+t[c-1]+"</c>":(e+="<color=#000000>"+t[c-1]+"</c>",this.usable=!1)}this.txtRequire.string=e,this.usable&&(this.btn.interactable=!0,this.btn.node.color=cc.Color.WHITE)},remove:function(){this.btn.interactable=!1;var e=cc.moveBy(.2,cc.v2(0,-500));this.node.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.1,cc.v2(0,20)),e,cc.callFunc(function(){this.node.destroy()}.bind(this)))),window.player.chestList[this.index]=null},checkRequire:function(){for(var e=window.player.elementList,t=0;t<6;t++)e[t]>0&&!this.satisfied[t]&&(this.satisfied[t]=!0);this.refreshRequire()},doCast:function(){this.remove();for(var e=0;e<6;e++)window.player.patchCard()}}),cc._RF.pop()},{Utils:"Utils"}],ChooseDiceLayer:[function(e,t,i){"use strict";cc._RF.push(t,"a7b85fk8JhBnoBwYoqOsmoi","ChooseDiceLayer"),cc.Class({extends:cc.Component,properties:{mask:cc.Node,diceNode:cc.Node,dice:cc.Prefab},onLoad:function(){window.chooseDiceLayer=this,this.mask.opacity=10,this.mask.runAction(cc.fadeTo(.2,120)),this.createDice()},createDice:function(){var e=[];for(window.player.buff.creatDiceFire>0&&(e.push(1),window.player.buff.creatDiceFire--);e.length<3;){var t=Math.floor(6*Math.random())+1;e.indexOf(t)<0&&e.push(t)}for(var i=0;i<3;i++){var c=cc.instantiate(this.dice);c.x=425,this.diceNode.addChild(c),c.getComponent("DiceChoose").init(e[i],i)}},close:function(){window.chooseDiceLayer=null,this.node.destroy()}}),cc._RF.pop()},{}],CompleteLayer:[function(e,t,i){"use strict";cc._RF.push(t,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var c=e("Game"),o=e("Utils"),a=e("Config");cc.Class({extends:cc.Component,properties:{markOccupation:cc.Sprite,txtName:cc.Label,txtDuration:cc.Label,heads:[cc.Sprite],txtTime:cc.Label,cardPrefab:cc.Prefab,cardNode:cc.Node,itemNode:cc.Node,btnRestart:cc.Node,itemPrefab:cc.Prefab},onLoad:function(){window.completeLayer=this;var e=new Date,t=e.getTime()-c.data.startTime;c.data.duration+=t,c.data.totalTime+=t,c.data.startTime=0,c.saveData(),this.txtDuration.string=o.timeFormat(c.data.duration,2);var i=function(e){return e<10?"0"+e:e};this.txtTime.string=e.getFullYear()+"-"+i(e.getMonth()+1)+"-"+i(e.getDate())+" "+i(e.getHours())+":"+i(e.getMinutes()),this.initMonster(),this.initDeck(),this.initEquip(),this.btnRestart.y-=280,this.btnRestart.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(0,280))));this.txtName.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1]+"("+["\u666e\u901a","\u56f0\u96be","\u9ad8\u624b","\u5927\u5e08","\u82e6\u75db"][c.data.difficulty-1]+")",cc.audioEngine.playEffect(window.sound.cheer),cc.audioEngine.playMusic(window.sound.bgmComplete,!0)},initMonster:function(){for(var e=this,t=[],i=0;i<c.data.monsterBeats.length;i++){var o=c.data.monsterBeats[i];a.get("cfg_monster",o).type>=2&&t.push(o)}for(var n=function(i){var c=e.heads[i];cc.loader.loadRes("Texture/monster/head/"+t[i],cc.SpriteFrame,function(e,t){c.spriteFrame=t}.bind(e))},s=0;s<t.length;s++)n(s)},initDeck:function(){if(this.deck=[],4==c.data.heroId){var e=[];for(var t in c.data.cardPlayed){var i=[t,c.data.cardPlayed[t]];e.push(i)}e.sort(function(e,t){return t[1]-e[1]});for(var o=Math.min(e.length,6),a=0;a<o;a++)this.deck.push(e[a][0])}else this.deck=c.data.deck;for(var n=0;n<this.deck.length;n++){var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(this.deck[n]),s.position=cc.v2(n%3*247-247,105-210*Math.floor(n/3)),this.cardNode.addChild(s),s.y-=1e3,s.runAction(cc.sequence(cc.delayTime(n<3?.2:0),cc.moveBy(.3,cc.v2(0,1e3))))}},initEquip:function(){for(var e=Math.max(Math.ceil(c.data.equip.length/2),6),t=600/(e-1),i=0;i<c.data.equip.length;i++){var o=c.data.equip[i],a=cc.instantiate(this.itemPrefab);a.getComponent("Item").init(o,null,!0),a.position=cc.v2(i%e*t-300,50-100*Math.floor(i/e)),this.itemNode.addChild(a)}this.itemNode.y-=480,this.itemNode.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.2,cc.v2(0,480))))},restart:function(){window.completeLayer=null,c.setDataToBase(),cc.director.loadScene("prepare")}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],Config:[function(e,t,i){"use strict";cc._RF.push(t,"e9b6cHrlOtILogPlENB3GXp","Config");var c={jsonTable:{},load:function(e){for(var t=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event","cfg_hero","cfg_tavern"],c=0,o=function(o){n="Config/"+i[o],cc.loader.loadRes(n,function(t,a){this.jsonTable[i[o]]=a.json,(c+=1)==i.length&&e()}.bind(t))},a=0;a<i.length;a++){var n;o(a)}},get:function(e,t){return this.jsonTable[e][t]}};t.exports=c,cc._RF.pop()},{}],Cover:[function(e,t,i){"use strict";cc._RF.push(t,"ae1236WRt5CIb6OKjZX1HCw","Cover");var c=e("Game");cc.Class({extends:cc.Component,properties:{sky:cc.Node,moon:cc.Node,shadow:cc.Node,smoke:cc.Node,rail2:cc.Node,house2:cc.Node,house1:cc.Node,bg:cc.Node,light:cc.Node,player:cc.Node,player2:cc.Node,table:cc.Node,spider:cc.Node,rail:cc.Node,tree:cc.Node,title:cc.Node,books:[cc.Node],btnStart:cc.Node,btnNew:cc.Node,btnContinue:cc.Node,mask:cc.Node,words:[cc.Node],soundPrefab:cc.Prefab},onLoad:function(){this.show=!1,this.rate=1,this.node.on(cc.Node.EventType.TOUCH_START,function(){this.rate=2}.bind(this)),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.rate=1}.bind(this));var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),this.doActions()},doActions:function(){this.correctedHeight=(cc.winSize.height/cc.winSize.width*750-1334)/2,this.images=[this.sky,this.moon,this.shadow,this.smoke,this.rail2,this.house2,this.house1,this.bg,this.light,this.player,this.player2,this.table,this.rail,this.tree,this.title],this.pathLength=[556,367,2068,1674,2164,2584,2701,2578,2526,2355,2912,2990,2659,3400,2536],this.tops=[224,557,978,885,892,1187,1290,0,574,-50,-230,-488,865,2358,470],this.speed=.4,this.speedUp=1,c.opening?(this.schedule(this.updateFrame,0),c.opening=!1,this.scheduleOnce(function(){cc.audioEngine.playMusic(window.sound.skySound,!1)}.bind(this),.5),this.scheduleOnce(function(){cc.audioEngine.playMusic(window.sound.coverSound,!0)}.bind(this),5)):(this.doReady(),cc.audioEngine.playMusic(window.sound.coverSound,!0))},updateFrame:function(){this.speed>1.2&&(this.speedUp=-1),this.speed+=.7/300*this.speedUp,this.speed=Math.max(.35,this.speed);for(var e=0;e<15;e++)this.images[e].y>=this.tops[e]-this.correctedHeight?(this.images[e].y=this.tops[e]-this.correctedHeight,9!=e||this.show||this.doBtns()):this.images[e].y+=(this.pathLength[e]-this.correctedHeight)/600*this.speed*this.rate},doBtns:function(){this.show=!0;for(var e=0;e<3;e++){this.books[e].runAction(cc.spawn(cc.fadeIn(.25),cc.moveBy(.25,cc.v2(20-20*e,50))))}var t=cc.sequence(cc.delayTime(.15),cc.moveBy(.3,cc.v2(0,30)),cc.delayTime(.15),cc.moveBy(.3,cc.v2(0,-30))).repeatForever();this.spider.runAction(cc.sequence(cc.moveBy(.2,cc.v2(0,-130-2*this.correctedHeight)),cc.callFunc(function(){this.spider.runAction(t)}.bind(this)))),this.scheduleOnce(function(){for(var e=0;e<3;e++)this.words[e].y-=40,this.words[e].runAction(cc.spawn(cc.fadeIn(.3),cc.moveBy(.3,cc.v2(0,40))));cc.audioEngine.playEffect(window.sound.bookSound)}.bind(this),.25),this.scheduleOnce(function(){c.data.startTime<=0||c.data.guide>=0?(this.btnStart.active=!0,this.btnStart.scale=.5,this.btnStart.runAction(cc.sequence(cc.scaleTo(.25,1.1),cc.scaleTo(.15,1)))):(this.btnNew.active=!0,this.btnNew.scale=.5,this.btnContinue.active=!0,this.btnContinue.scale=.5,this.btnNew.runAction(cc.sequence(cc.scaleTo(.25,1.1),cc.scaleTo(.15,1))),this.btnContinue.runAction(cc.sequence(cc.scaleTo(.25,1.1),cc.scaleTo(.15,1))))}.bind(this),.55)},doReady:function(){this.scheduleOnce(function(){for(var e=0;e<15;e++)this.images[e].y=this.tops[e]-this.correctedHeight;this.doBtns()}.bind(this),.01)},newGame:function(){this.mask.active=!0,c.setDataToBase(),c.data.totalTime<=0||c.data.guide>=0?(c.firstGuiding=!0,c.begin=!0,c.data.startTime=Date.now(),c.data.restartCount=999,cc.director.loadScene("helloworld")):cc.director.loadScene("prepare"),cc.audioEngine.playEffect(window.sound.finger)},continue:function(){this.mask.active=!0,cc.director.loadScene("helloworld"),cc.audioEngine.playEffect(window.sound.finger)},goGuide:function(){c.tempGuideData=JSON.parse(JSON.stringify(c.data)),this.mask.active=!0,c.setDataToBase(),c.data.guide=c.data.guideBag=0,c.begin=!0,cc.director.loadScene("helloworld"),cc.audioEngine.playEffect(window.sound.bookOpen)},clean:function(){c.setDataToBase(),c.data.guide=c.data.guideBag=0,c.data.totalTime=0}}),cc._RF.pop()},{Game:"Game"}],DiceChoose:[function(e,t,i){"use strict";cc._RF.push(t,"2f252xYsv5IdrGnewf/1jBc","DiceChoose");var c=e("Game");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.element=e,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var i=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=i[this.element-1],this.node.runAction(cc.moveTo(.2,cc.v2(110*t-110,0)))},choose:function(){if(5==c.data.difficulty){var e=Math.floor(10*Math.random())+21;if(21==e){for(var t=[],i=window.player.cardList,o=0;o<i.length;o++){var a=i[o].getComponent("Card");a.burn||a.silence||t.push(a)}if(t.length>0){var n=t[Math.floor(Math.random()*t.length)];n.buffId=21,n.initBuff()}else window.player.buff.addBuff(21,1)}else if(25==e){t=[];for(var s=window.player.cardList,r=0;r<s.length;r++){var h=s[r].getComponent("Card");h.silence||t.push(h)}if(t.length>0){var d=t[Math.floor(Math.random()*t.length)];d.buffId=25,d.initBuff()}else window.player.buff.addBuff(25,1)}else window.player.buff.addBuff(e,1)}for(var l=1+window.player.buff.exCreateDice,u=0;u<l;u++)window.player.createExDice(this.element,!0,!0);window.player.endRoll(),window.player.buff.exCreateDice=0,3==c.data.difficulty&&(window.player.diceCount+=l),window.player.createDiceRound[this.element-1]++;for(var f=0;f<window.player.cardList.length;f++){var p=window.player.cardList[f].getComponent("Card");238==p.cfgId&&p.initDesc()}window.chooseDiceLayer.close()}}),cc._RF.pop()},{Game:"Game"}],DiceTavern:[function(e,t,i){"use strict";cc._RF.push(t,"2a3b72qgEZPdL0PbR9yMWKz","DiceTavern"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,mask:cc.Node},onLoad:function(){this.holded=!1,this.element=0,this.mask.active=!1},roll:function(){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var e=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=e[this.element-1],this.node.y=-200,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20)),cc.moveTo(.1,cc.v2(this.node.x,0)))))},doHold:function(){this.hold()},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)}}),cc._RF.pop()},{}],DiceYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.id=e,this.index=t,this.player=0==t?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1},show:function(){this.abled=!1,this.holded=!1;var e=this.delta=0==this.index?1:-1;this.node.opacity=255,this.node.position=cc.v2(110*this.id-220,-320*e),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*e)),cc.moveBy(.1,cc.v2(0,-20*e))))},roll:function(e){this.abled=!0,this.holded=!1;var t=this.player.holdList.indexOf(this.node);if(t>=0&&this.player.holdList.splice(t,1),!e){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var i=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=i[this.element-1]}var c=50*Math.random()+150*this.id-325,o=(420*Math.random()+240)*this.delta,a=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(c,o)),cc.rotateTo(.2,a)))},toHold:function(){0==this.index&&this.doHold()},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var e=0;e<this.player.holdList.length;e++)this.player.holdList[e].runAction(cc.moveTo(.1,cc.v2(110*e-220,0)));this.player.txtBtn.string="\u6295\u63b7",cc.audioEngine.playEffect(window.sound.rollSound2)}else this.hold(),cc.audioEngine.playEffect(window.sound.holdSound)},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(e,t,i){"use strict";cc._RF.push(t,"24e6aDXOPZNaoyluEGeZSR/","Dice");var c=e("Game");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node,mask:cc.Node,markTemp:cc.Node,markBlind:cc.Node},init:function(e,t){this.id=e,this.holded=!1,this.element=0,this.mask.active=!1,this.temp=!1,this.isRemoved=!1,this.remembered=!1,this.buffList=t,this.markIce.active=this.markLock.active=this.markTemp.active=this.markBlind.active=!1,this.blind=t.indexOf(30)>=0,this.markBlind.active=this.blind},initBuff:function(e){e||(1==this.element&&window.opponent.equip.checkWithTrigger(171)?this.buffList.indexOf(22)<0&&this.buffList.indexOf(28)<0&&this.buffList.push(22):4==this.element&&window.opponent.equip.checkWithTrigger(173)&&this.buffList.indexOf(28)<0&&this.buffList.push(28));var t=this.buffList;this.freeze=t.indexOf(22)>=0,this.markIce.active=this.freeze,this.lock=t.indexOf(28)>=0,this.markLock.active=this.lock},roll:function(e){if(!this.isRemoved){this.element=e||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var t=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=t[this.element-1],this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=300*-this.delta,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20*this.delta)),cc.moveTo(.1,cc.v2(this.node.x,0)))))}},doHold:function(){c.data.guide>0&&c.data.guide<9||0!=window.mainLayer.roundId||this.freeze||this.lock||this.temp||window.player.diceUsabld&&(this.hold(),10==c.data.guide&&window.guide&&(window.guide.close(),window.host.checkBtnRoll()))},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)},remove:function(){this.isRemoved=!0,this.node.stopAllActions();var e=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.buffList=[],this.initBuff(!0),this.markBlind.active=!1},doTemp:function(){this.temp=!0,this.markTemp.active=!0;var e=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.markTemp.color=e[this.element-1]}}),cc._RF.pop()},{Game:"Game"}],DmgAnimation:[function(e,t,i){"use strict";cc._RF.push(t,"267b8j4vWVAPaVTrMCIVdTi","DmgAnimation");e("Utils");cc.Class({extends:cc.Component,properties:{atks:[dragonBones.ArmatureDisplay],heal:dragonBones.ArmatureDisplay,fireAtk:dragonBones.ArmatureDisplay,waterAtk:dragonBones.ArmatureDisplay,windAtk:dragonBones.ArmatureDisplay,earthAtk:dragonBones.ArmatureDisplay,lightAtk:dragonBones.ArmatureDisplay,darkAtk:dragonBones.ArmatureDisplay,armor:dragonBones.ArmatureDisplay,dodge:dragonBones.ArmatureDisplay,frail:dragonBones.ArmatureDisplay,weak:dragonBones.ArmatureDisplay,silence:dragonBones.ArmatureDisplay,poison:dragonBones.ArmatureDisplay,curse:dragonBones.ArmatureDisplay,lock:dragonBones.ArmatureDisplay,atkback:dragonBones.ArmatureDisplay,blind:dragonBones.ArmatureDisplay,undead:dragonBones.ArmatureDisplay,revive:dragonBones.ArmatureDisplay},init:function(e){this.index=e,this.host=0==e?window.mainLayer.hero:window.mainLayer.enemy,this.step=0},show:function(e){var t;if(e<=6){var i=[this.fireAtk,this.waterAtk,this.windAtk,this.earthAtk,this.lightAtk,this.darkAtk];t=i[e-1];i=[window.sound.fireSound,window.sound.iceSound,window.sound.windSound,window.sound.earthSound,window.sound.lightSound,window.sound.darkSound];cc.audioEngine.playEffect(i[e-1])}else if(e>=7&&e<=9)(t=this.atks[this.step%3]).node.rotation=360*Math.random(),cc.audioEngine.playEffect(window.sound.atkSound);else if(e<=16){i=[this.armor,this.heal,this.dodge,null,null,this.atkback];t=i[e-11];i=[window.sound.armorSound,window.sound.healSound,window.sound.dodgeSound,null,null,window.sound.atkSound];cc.audioEngine.playEffect(i[e-11])}else if(e>=21&&e<=30&&29!=e){i=[this.fireAtk,this.waterAtk,this.frail,this.weak,this.silence,this.poison,this.curse,this.lock,null,this.blind];t=i[e-21];i=[window.sound.fireSound,window.sound.iceSound,window.sound.frailSound,window.sound.weakSound,window.sound.silenceSound,window.sound.poisonSound,window.sound.curseSound,window.sound.lockSound,null,window.sound.blindSound];cc.audioEngine.playEffect(i[e-21])}else 201==e?(t=this.undead,cc.audioEngine.playEffect(window.sound.undeadSound)):202==e&&(t=this.revive,cc.audioEngine.playEffect(window.sound.reviveSound));t&&(t.node.active=!0,t.node.zIndex=this.step,t.playAnimation("play0"),t.on(dragonBones.EventObject.LOOP_COMPLETE,function(){t.node.active=!1}.bind(this))),this.host.doShake(e),this.step++}}),cc._RF.pop()},{Utils:"Utils"}],Door:[function(e,t,i){"use strict";cc._RF.push(t,"03087MNqj9O2qA5J4CBmWTy","Door");var c=e("Game");cc.Class({extends:cc.Component,properties:{light:cc.Node,image:cc.Sprite,btn:cc.Button,gate1:cc.Node,gate2:cc.Node,mask:cc.Node,stair:cc.Node,bossLight:cc.Node},init:function(e,t){this.type=e,this.index=t,cc.loader.loadRes("Texture/map/door/door"+e,cc.SpriteFrame,function(e,t){this.image.spriteFrame=t}.bind(this));var i=["tavern","battle","camp","treasure","event","shop","tavern","elite","boss"],o=c.data.roomType<=1||c.data.roomType>=7?"castle"+c.data.castle:i[c.data.roomType];cc.loader.loadRes("Texture/map/door/light/"+o,cc.SpriteFrame,function(e,i){this.light.getComponent(cc.Sprite).spriteFrame=i,this.mask.parent=window.room.node,this.mask.rotation=this.node.rotation;var c=[cc.v2(0,-15),cc.v2(-15,0),cc.v2(0,15),cc.v2(15,0)];this.mask.position=this.node.position.add(c[t])}.bind(this)),cc.loader.loadRes("Texture/map/door/gate/"+i[e]+"1",cc.SpriteFrame,function(e,t){this.gate1.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/map/door/gate/"+i[e]+"2",cc.SpriteFrame,function(e,t){this.gate2.getComponent(cc.Sprite).spriteFrame=t}.bind(this));var a=[null,null,cc.color(13,120,61),cc.color(234,162,59),cc.color(232,136,45),cc.color(251,230,180),cc.color(186,114,82)],n=[cc.color(93,135,192),cc.color(78,83,125),cc.color(203,158,115),cc.color(203,158,115)],s=a[c.data.roomType]||n[c.data.castle-1];this.mask.color=s},onEvent:function(){c.data.guide>0&&c.data.floor>=7||window.room.gotoDoor(this.index)},open:function(e){e?(this.gate1.runAction(cc.scaleTo(.3,.3,1)),this.gate2.runAction(cc.scaleTo(.3,.3,1)),this.light.runAction(cc.scaleTo(.3,1,1)),8==this.type&&(this.stair.active=!0,this.bossLight.active=!0,this.stair.opacity=0,this.stair.y=25,this.stair.runAction(cc.sequence(cc.delayTime(.1),cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.25,cc.v2(0,-40)),cc.moveBy(.05,cc.v2(0,5)))))))):8==this.type?(this.stair.active=!0,this.bossLight.active=!0,this.stair.y=-10,this.stair.runAction(cc.spawn(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.gate1.scaleX=.3,this.gate2.scaleX=.3,this.light.scaleX=1}.bind(this)),cc.fadeOut(.2)),cc.sequence(cc.moveBy(.05,cc.v2(0,-5)),cc.moveBy(.25,cc.v2(0,40)))))):(this.gate1.scaleX=.3,this.gate2.scaleX=.3,this.light.scaleX=1),this.btn.interactable=!0},close:function(e){this.btn.interactable=!1,e?(this.gate1.runAction(cc.scaleTo(.3,1,1)),this.gate2.runAction(cc.scaleTo(.3,1,1)),this.light.runAction(cc.scaleTo(.3,0,1))):(this.gate1.scaleX=1,this.gate2.scaleX=1,this.light.scaleX=0)}}),cc._RF.pop()},{Game:"Game"}],EditEndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){c.data.deck=c.editCfg.deckHero.split(";"),c.data.equip=c.editCfg.equip.split(";"),c.data.hp=c.data.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(e,t,i){"use strict";cc._RF.push(t,"463d3gvgvdIabmN6qTyXAVR","Edit");var c=e("Game");cc.Class({extends:cc.Component,properties:{editHpEnemy:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox,editId:cc.EditBox,editHpHero:cc.EditBox},onLoad:function(){c.editCfg&&(this.editHpEnemy.string=c.editCfg.hpEnemy,this.editDice.string=c.editCfg.dice,this.editDeckEnemy.string=c.editCfg.deckEnemy,this.editEquipEnemy.string=c.editCfg.equipEnemy,this.editDeckHero.string=c.editCfg.deckHero,this.editEquip.string=c.editCfg.equip,this.editHpHero.string=c.editCfg.hpHero),this.editId.string=c.data.heroId},goBattle:function(){c.editCfg={hpEnemy:this.editHpEnemy.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string,hpHero:this.editHpHero.string};var e=this.editDeckHero.string.split(";");if(4==parseInt(this.editId.string)){c.data.cardBag=[];for(var t=0;t<e.length;t++)c.data.cardBag.push(parseInt(e[t]))}else{c.data.deck=[];for(var i=0;i<e.length;i++)c.data.deck.push(parseInt(e[i]))}var o=this.editEquip.string.split(";");c.data.equip=[];for(var a=0;a<o.length;a++)c.data.equip.push(parseInt(o[a]));c.data.hp=c.data.hpMax=parseInt(c.editCfg.hpHero),c.data.heroId=parseInt(this.editId.string),c.data.level=7,cc.director.loadScene("mainLayer")},goBack:function(){cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{treasurePrefab:cc.Prefab,treasureNode:cc.Node,txtTitle:cc.Label,btnNext:cc.Node,btnOut:cc.Node,mask:cc.Node,cardChangePrefab:cc.Prefab},init:function(e){window.endLayer=this,this.isEscape=e;var t=cc.instantiate(this.treasurePrefab);t.getComponent("TreasureChest").init(0),this.treasureNode.addChild(t),this.chest=t.getComponent("TreasureChest"),this.player=window.mainLayer.hero.player,this.rewardList=[],this.initCopper(),this.initExp(),this.initHealth(),-1==this.player.equip.feather&&(c.data.itemEffect.feather=-1),-1==this.player.equip.reviveBook&&(c.data.itemEffect.reviveBook=-1),c.data.floorBeats[c.data.floor-1]=!0,c.data.monsterBeats.push(c.monsterId),this.chest.jumpIn(),this.scheduleOnce(function(){this.mask.runAction(cc.fadeTo(.3,180)),this.treasureNode.runAction(cc.sequence(cc.moveTo(.4,cc.v2(0,-120)),cc.delayTime(.1),cc.callFunc(function(){this.chest.openReward(this.rewardList),this.txtTitle.node.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))}.bind(this))))}.bind(this),1),this.scheduleOnce(function(){var e=4==c.data.castle||this.isEscape?this.btnOut:this.btnNext;e.active=!0,e.opacity=1,e.y-=50,e.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2)))}.bind(this),2+.2*this.rewardList.length)},initCopper:function(){var e=window.mainLayer.enemy.cfg.level,t=1;this.player.equip.check(73)&&(t+=.5),this.player.equip.check(90)&&(t-=.5);var i=Math.max([6,8,10,12,14,16,0][e-1]*t,1);this.isEscape&&(i=0),this.rewardList.push({type:1,value:i})},initExp:function(){var e=window.mainLayer.enemy.cfg.level,t=1==c.data.roomType?e:[3,9,15,27,37,55,100][e-1];this.isEscape&&(t=0),this.rewardList.push({type:2,value:t})},initHealth:function(){var e=0;this.player.equip.trigger(7)&&(e+=10),this.player.equip.trigger(8)&&(e+=20),e>0&&this.rewardList.push({type:3,value:e})},nextStep:function(){var e=!0;c.data.roomType>=7?(this.initEquip(),7==c.data.roomType&&(e=!1),this.scheduleOnce(function(){this.chest.openEquip(this.cfgIdList,e)}.bind(this),.2)):this.player.equip.check(26)?(e=!1,this.scheduleOnce(function(){this.chest.openBoard([{type:4,value:6}])}.bind(this),.2)):(this.initCards(),(1==c.data.heroId&&2==c.data.difficulty||4==c.data.heroId&&4==c.data.difficulty)&&(e=!1),this.scheduleOnce(function(){this.chest.openCard(this.cardList,e)}.bind(this),.2)),this.btnNext.getComponent(cc.Button).interactable=!1,this.btnNext.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,-50)),cc.fadeOut(.2))),this.txtTitle.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){c.data.roomType>=7?this.txtTitle.string=(e?"\u9009\u62e9":"")+"\u88c5\u5907\u5956\u52b1":this.player.equip.check(26)?this.txtTitle.string="\u5973\u738b\u4e4b\u5fc3\u5956\u52b1":this.txtTitle.string=(e?"\u9009\u62e9":"")+"\u5361\u724c\u5956\u52b1",this.txtTitle.node.y-=50}.bind(this)),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))),e||(this.btnOut.active=!0,this.btnOut.opacity=1,this.btnOut.y-=50,this.btnOut.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))))},initCards:function(){if(this.cardList=[],1==c.data.heroId&&2==c.data.difficulty){var e=(t=window.mainLayer.enemy.initialDeck)[Math.floor(Math.random()*t.length)];this.cardList.push(e)}else if(4==c.data.heroId&&4==c.data.difficulty){for(var t=window.mainLayer.enemy.initialDeck,i=0;i<2;i++)if(t.length>0){var a=Math.floor(Math.random()*t.length),n=t[a];t.splice(a,1),this.cardList.push(n)}}else{for(var s=0,r=[[.5,.4,.1],[.2,.5,.3],[0,.5,.5]],h=Math.random(),d=0,l=0;l<3;l++)if(h<(d+=r[c.data.castle-1][l])){s=l+1;break}for(var u=0;u<=0;){var f=c.getNewCardId(s),p=o.get("cfg_card",f).require;(c.data.castle>1||2==p.split(";").length||p<=102)&&(u=f)}this.cardList.push(u);for(var m=0;m<=0;){var g=c.getNewCardId(s),y=o.get("cfg_card",g).require;g!=u&&(c.data.castle>1||2==y.split(";").length||y<=102)&&(m=g)}this.cardList.push(m),9==c.data.guide&&(this.cardList=[9,10])}},initEquip:function(){for(var e=8==c.data.roomType?2:0,t=0,i=8==c.data.roomType?[[.4,.4,.2],[.3,.4,.3],[.2,.4,.4]]:[[.6,.3,.1],[.4,.3,.3],[.2,.4,.4]],o=Math.random(),a=0,n=0;n<3;n++)if(o<(a+=i[c.data.castle-1][n])){t=n+1;break}this.cfgIdList=[];var s=c.getNewItemId(e,t);if(this.cfgIdList.push(s),8==c.data.roomType){for(var r=0;r<=0;){var h=c.getNewItemId(e,t);h!=s&&(r=h)}this.cfgIdList.push(r)}},openCardChange:function(e){var t=cc.instantiate(this.cardChangePrefab);t.getComponent("CardChangeLayer").init(e),this.node.addChild(t,100)},close:function(){window.treasureChest=null,window.endLayer=null,c.data.hp=Math.min(window.mainLayer.hero.hp,c.data.hpMax),c.data.power=window.mainLayer.hero.power,cc.director.loadScene("helloworld",function(){4==c.data.castle&&window.homeLayer.openComplete()})}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndTavernLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2d083apwQNCHIRnqoFt5WSN","EndTavernLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{bg:cc.Node,mask:cc.Node,boxReward:cc.Node,rewardNode:cc.Node,rewardPrefab:cc.Prefab,btn:cc.Node,cardChangePrefab:cc.Prefab,losePrefab:cc.Prefab,emptyNode:cc.Node,lights:[cc.Node],shadow:cc.Node},init:function(e){this.rewards=e,this.abled=!1,this.getCardList=[],this.showReward(),this.mask.runAction(cc.fadeTo(.3,180)),this.bg.runAction(cc.sequence(cc.delayTime(.1),cc.moveTo(.2,cc.v2(0,-20)),cc.moveTo(.2,cc.v2(0,0)),cc.callFunc(function(){this.lights[0].active=this.lights[1].active=!0,this.shadow.active=!0}.bind(this)))),this.btn.opacity=1,this.btn.y-=50,this.btn.runAction(cc.sequence(cc.delayTime(1),cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2)),cc.callFunc(function(){this.abled=!0}.bind(this)))),cc.audioEngine.playEffect(window.sound.end)},showReward:function(){if(this.boxes=[],this.rewards.length<=0)this.checkResult(0);else for(var e=0;e<this.rewards.length;e++)this.checkResult(this.rewards[e])},checkResult:function(e){if(e>0){var t=cc.instantiate(this.boxReward);t.active=!0,t.y=8*this.boxes.length-92,t.zIndex=6-this.boxes.length,this.rewardNode.addChild(t),this.boxes.push(t);var i=o.get("cfg_tavern",e).rewardId,c=cc.instantiate(this.rewardPrefab);c.getComponent("Reward").init(i.split(";"),2),t.addChild(c),this.getCardList=this.getCardList.concat(c.getComponent("Reward").getCardList),""==c.getComponent("Reward").txtDesc.string?c.y=-18:c.y=-28}else this.boxReward.active=!0,this.emptyNode.active=!0},doNext:function(){this.abled&&(this.abled=!1,this.boxes.length<=1?this.doClose():(this.bg.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,30)),cc.moveBy(.15,cc.v2(0,-30)))),this.boxes[0].runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.2,cc.v2(0,-1e3)),cc.callFunc(function(){this.boxes.shift(),this.abled=!0}.bind(this))))))},doClose:function(){if(c.data.hp<=0){var e=cc.instantiate(this.losePrefab);this.node.addChild(e)}else if(this.getCardList.length>0){var t=cc.instantiate(this.cardChangePrefab);t.getComponent("CardChangeLayer").init(this.getCardList[0],this.getCardList[1],this.close.bind(this)),this.node.addChild(t,100)}else this.close()},close:function(){cc.director.loadScene("helloworld"),c.data.floorBeats[c.data.floor-1]=!0}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndYahtzeeLayer:[function(e,t,i){"use strict";cc._RF.push(t,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{figure:cc.Sprite,txtName:cc.Label,bats:cc.Node,dialog:cc.Node,txtDialog:cc.Node,rewardNode:cc.Node,rewardPrefab:cc.Prefab,btn:cc.Node,losePrefab:cc.Prefab,cardChangePrefab:cc.Prefab},init:function(e){this.result=e,this.eventId=c.data.eventIds[c.data.castle-1],this.cfg=o.get("cfg_event",this.eventId);var t=e>=0?1:2;this.rewardIds=this.cfg["reward"+t],this.txtName.string=this.cfg["name"+t],cc.loader.loadRes("Texture/npc/"+this.cfg["figure"+t],cc.SpriteFrame,function(e,t){this.figure.spriteFrame=t}.bind(this)),this.figure.node.scale=.8,this.figure.node.runAction(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.1,1))),this.bats.scale=.5,this.bats.opacity=0,this.bats.runAction(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1))),this.dialog.scale=0,this.dialog.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.2,1))),this.txtDialog.runAction(cc.sequence(cc.delayTime(.4),cc.fadeIn(.2))),this.btn.opacity=1,this.btn.y-=50,this.btn.runAction(cc.sequence(cc.delayTime(.4),cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2)))),this.checkResult(),1==t&&c.data.highRecord[4]++,cc.audioEngine.playEffect(window.sound.end)},checkResult:function(){var e=cc.instantiate(this.rewardPrefab);e.getComponent("Reward").init(this.rewardIds.split(";"),1),this.rewardNode.addChild(e),this.reward=e.getComponent("Reward")},doClose:function(){if(c.data.hp<=0){var e=cc.instantiate(this.losePrefab);this.node.addChild(e)}else{var t=this.reward.getCardList;if(t.length>0){var i=cc.instantiate(this.cardChangePrefab);i.getComponent("CardChangeLayer").init(t[0],t[1],this.close.bind(this)),this.node.addChild(i,100)}else this.close()}},close:function(){cc.director.loadScene("helloworld"),c.data.floorBeats[c.data.floor-1]=!0}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(e,t,i){"use strict";cc._RF.push(t,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,txtName:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,figure:cc.Node,figureNode:cc.Node,equipDesc:cc.RichText,centerNode:cc.Node,boxAnmation:dragonBones.ArmatureDisplay},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){if(c.editCfg)this.initEdit();else{if(this.cfgId=c.monsterId,this.cfg=o.get("cfg_monster",this.cfgId),this.hpMax=this.cfg.hp,3==c.data.difficulty?1!=c.data.heroId&&4!=c.data.heroId||(this.hpMax=1.1*this.hpMax):4==c.data.difficulty&&(this.hpMax=1.2*this.hpMax),c.data.equip.indexOf(91)>=0&&(this.hpMax=1.1*this.hpMax),1==c.data.roomType&&c.data.itemEffect.pen>0&&(this.hpMax=this.hpMax/2,c.data.itemEffect.pen--),this.hpMax=Math.floor(this.hpMax),10==c.data.guide)this.hpMax=32;else if(0==this.cfg.type)for(var e=0;e<c.data.monsterBeats.length;e++){var t=c.data.monsterBeats[e];t&&this.cfg.level==o.get("cfg_monster",t).level&&(this.hpMax+=5)}this.hp=this.hpMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,2==c.data.heroId&&4==c.data.difficulty&&this.diceCount++,this.cfg.item>0?this.equipList=[this.cfg.item]:this.equipList=[],this.txtName.string=this.cfg.name+"  Lv."+this.cfg.level,this.initDeck()}this.player.init(1),this.escapeRate=0,this.exRollCount=0,this.ai=this.getComponent("AI"),cc.loader.loadRes("Texture/monster/figure/"+this.cfgId,cc.SpriteFrame,function(e,t){this.figure.getComponent(cc.Sprite).spriteFrame=t,12==this.cfgId||17==this.cfgId||20==this.cfgId||33==this.cfgId||42==this.cfgId||45==this.cfgId||55==this.cfgId||62==this.cfgId||65==this.cfgId||76==this.cfgId||1==this.cfgId?(this.figureNode.scaleX=1.5,this.figureNode.scaleY=.6,this.figureNode.runAction(cc.sequence(cc.scaleTo(.4,.8,1.2),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))):(this.figureNode.y+=250,this.figureNode.scaleX=.8,this.figureNode.scaleY=1.2,this.figureNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,-250)),cc.scaleTo(.3,1.2,.8)),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))),this.scheduleOnce(function(){window.sound.monsterSound[this.cfgId-1]&&cc.audioEngine.playEffect(window.sound.monsterSound[this.cfgId-1])}.bind(this),.2)}.bind(this))},startRound:function(){if(!window.mainLayer.gameOver){var e=window.mainLayer.boxEnemyRound;e.active=!0,e.y=56,e.scale=.2,window.mainLayer.board.scale=1,e.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.25,1.05),cc.scaleTo(.1,1),cc.delayTime(.6),cc.moveTo(.3,cc.v2(0,-440)),cc.callFunc(function(){this.player.startRound(),this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5)}.bind(this)))),window.mainLayer.board.runAction(cc.sequence(cc.delayTime(1.35),cc.scaleTo(.3,.488,50/94)))}},endRound:function(){this.exRollCount=0,window.mainLayer.boxEnemyRound.runAction(cc.moveBy(.15,cc.v2(0,-105))),this.equip.check(126)&&(this.escapeRate+=.1,Math.random()<this.escapeRate&&this.escape())},onHurt:function(e,t,i,c){window.mainLayer.gameOver||(i=i||7,c=null!=c?c:1,this.player.onHurt(e,t,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.endRound(),window.mainLayer.showEnd(0),this.onLose()))},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onLose:function(){this.figure.runAction(cc.sequence(cc.delayTime(.4),cc.tintTo(.1,255,56,49),cc.tintTo(.1,255,255,255),cc.tintTo(.1,255,56,49),cc.tintTo(.1,255,255,255),cc.tintTo(.2,0,0,0))),this.centerNode.runAction(cc.sequence(cc.delayTime(.8),cc.scaleTo(.2,1.1),cc.spawn(cc.scaleTo(.3,.4),cc.fadeOut(.4),cc.moveBy(.3,cc.v2(0,-50))))),this.scheduleOnce(function(){this.boxAnmation.playAnimation("play0",1)}.bind(this),1.3)},initDeck:function(){if(0==this.cfg.card1)if(4==c.data.heroId){var e=Math.min(c.data.cardBag.length,6),t=c.data.cardBag.concat();this.deck=[];for(var i=0;i<e;i++){var o=Math.floor(t.length*Math.random()),a=t[o];this.deck.push(a),t.splice(o,1)}}else this.deck=c.data.deck.concat();else{this.deck=[];for(var n=0;n<6;n++){var s=this.cfg["card"+(n+1)];s>0&&this.deck.push(s)}}this.initialDeck=this.deck.concat()},initEdit:function(){this.cfgId=35,this.hp=this.hpMax=parseInt(c.editCfg.hpEnemy),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(c.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.equipList=""!=c.editCfg.equipEnemy?[c.editCfg.equipEnemy]:[],this.deck=[];for(var e=c.editCfg.deckEnemy.split(";"),t=0;t<e.length;t++)""!=e[t]&&this.deck.push(parseInt(e[t]))},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};t[e]&&(this.figure.color=cc.Color.WHITE.fromHEX("#"+t[e]),this.figure.stopAllActions(),this.figure.runAction(cc.sequence(cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(-15,-5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.08,cc.v2(-15,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){this.figure.position=cc.v2(0,0),this.figure.color=cc.Color.WHITE}.bind(this)))))},escape:function(){window.mainLayer.showEnd(0,!0)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(e,t,i){"use strict";cc._RF.push(t,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,mask:cc.Node,mezz:cc.Node,box:cc.Node,btnClose:cc.Node},onLoad:function(){window.equipLayer=this,this.box.opacity=0,this.mask.runAction(cc.fadeTo(.15,180)),this.box.runAction(cc.sequence(cc.delayTime(.01),cc.moveBy(0,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.fadeIn(0),cc.moveTo(.35,cc.v2(0,0)),cc.callFunc(function(){this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(-130,0)),cc.moveBy(.1,cc.v2(10,0))))}.bind(this)))),this.initItems(),cc.audioEngine.playEffect(window.sound.bagOpenSound);for(var e=0;e<5;e++){var t=cc.instantiate(this.mezz);t.position=cc.v2(0,-282-145*e),this.content.addChild(t)}},initItems:function(){for(var e=0;e<c.data.equip.length;e++){var t=cc.instantiate(this.itemPrefab);t.getComponent("ItemCollection").init(c.data.equip[e]),t.position=cc.v2(0,-65-145*e),this.content.addChild(t,e+1)}this.content.height=Math.max(145*c.data.equip.length+70,1160)},close:function(){this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(120,0)),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.bagCloseSound)}.bind(this)))),this.mask.runAction(cc.sequence(cc.delayTime(.3),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.25,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.equipLayer=null}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(e,t,i){"use strict";cc._RF.push(t,"a22ddJNtUJBS6PVq98jP/g9","Equip");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?c.data.equip.concat():this.host.equipList,this.boxEquip=this.host.boxEquip,this.abled=1==this.index||159!=this.opponent.host.equipList[0],this.swiftGlove=!1,this.luckDice=!1,this.luckFlag=!1,this.suckRemainder=0,this.armorRemainder=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0,this.feedBack=0,this.feather=0,this.reviveBook=0,this.wolfBlood=!1,this.elementPlayed=[0,0,0,0,0,0],this.initItems()},initItems:function(){if(this.itemList=[],0==this.index){for(var e=0;e<this.equipList.length;e++){if(this.equipList[e]>0)if(o.get("cfg_item",this.equipList[e]).battle){var t=!1;if(10==this.equipList[e]&&c.data.itemEffect.feather>0?(this.feather=1,t=!0):158==this.equipList[e]&&c.data.itemEffect.reviveBook>0?(this.reviveBook=1,t=!0):t=(74==this.equipList[e]&&c.data.itemEffect.pen,!0),t){var i=cc.instantiate(this.itemPrefab);i.getComponent("Item").init(this.equipList[e],this),this.boxEquip.addChild(i),this.itemList.push(i),this.abled||i.getComponent("Item").doDisabled()}}}for(var a=0;a<this.itemList.length;a++){var n=72;this.itemList.length>10&&(n=648/(this.itemList.length-1)),this.itemList[a].x=n*a-324}}else if(this.equipList.length>0){var s=o.get("cfg_item",this.equipList[0]);this.host.equipDesc.string="<color=#FEF64B>"+s.name+"\uff1a</c>"+c.analysisDesc(s.desc1);var r=cc.instantiate(this.itemPrefab);r.getComponent("Item").init(this.equipList[0],this),r.x=-this.host.equipDesc.node.width/2-25,r.scale=.65,this.boxEquip.addChild(r),this.itemList.push(r),r.getComponent("Item").boxNum.scale=1/.65,10==this.equipList[0]?this.feather=1:158==this.equipList[0]&&(this.reviveBook=1)}else this.boxEquip.active=!1},check:function(e){if(!this.abled)return!1;for(var t=0;t<this.equipList.length;t++)if(this.equipList[t]==e)return!0;return!1},checkWithTrigger:function(e){return!!this.check(e)&&(this.doTrigger(e),!0)},trigger:function(e){var t=!1;if(this.check(e))if(1==e)this.opponent.host.onHurt(1,2),t=!0;else if(2==e)this.player.cardList.length<=0&&(this.player.updateArmor(5),t=!0);else if(3==e)this.player.cardList.length<=0&&(this.host.onHeal(3),t=!0);else if(4==e)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),t=!0);else if(5==e)this.opponent.buff.addBuff(26,2),t=!0;else if(6==e)this.player.buff.addBuff(13,1),t=!0;else if(7==e)this.host.onHeal(10),t=!0;else if(8==e)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(20),t=!0);else if(9==e)this.opponent.host.onHurt(6,2),t=!0;else if(10==e)this.feather>0&&(this.player.anim.show(202),this.host.hp=Math.floor(.3*this.host.hpMax),t=!0,this.feather=-1);else if(11==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.player.updateArmor(-this.host.armor),t=!0);else if(e>=12&&e<=18){this.opponent.buff.addBuff(e+9,[3,2,1,2,1,4,1][e-12]),t=!0}else if(19==e)this.player.extraDice++,t=!0;else if(20==e)this.player.updateArmor(10),t=!0;else if(21==e)this.player.buff.addBuff(104,1);else if(22==e)this.opponent.host.onHurt(5,2),t=!0;else if(23==e){if(this.suckRemainder>=4){var i=Math.floor(this.suckRemainder/4);this.suckRemainder=this.suckRemainder%4,this.host.onHeal(i),t=!0}}else if(24==e)this.opponent.host.onHurt(2,2,1),t=!0;else if(25==e)this.host.hp==this.host.hpMax&&(this.player.extraDice++,t=!0);else if(27==e)this.host.armor<=0&&(this.player.updateArmor(5),t=!0);else if(30==e)3==this.player.round&&(this.player.extraDice++,t=!0);else if(37==e)this.player.buff.addBuff(105,2);else if(44==e)this.player.buff.addBuff(103,3),t=!0;else if(45==e)this.scheduleOnce(function(){this.player.createExDice()}.bind(this),.5),t=!0;else if(e>=48&&e<=53)this.scheduleOnce(function(){window.player.createExDice(e-47)}.bind(this),.5),t=!0;else if(57==e)this.player.cardList.length>0&&(this.player.extraDice++,t=!0);else if(59==e)this.player.cardList.length>0&&(this.player.updateArmor(3*this.player.cardList.length),t=!0);else if(60==e)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),t=!0);else if(61==e)this.host.onHeal(15),t=!0;else if(68==e)this.opponent.buff.addBuff(24,1),t=!0;else if(69==e)this.opponent.host.onHurt(10,2),t=!0;else if(70==e){var a=c.getRandomCardId();window.player.patchCard(a,!0),window.player.deck.push(a),t=!0}else if(75==e)this.host.hp<.3*this.host.hpMax?this.player.buff.atkAd3||(this.player.buff.addBuff(104,3),this.player.buff.atkAd3=!0):this.player.buff.atkAd3&&(this.buff.removeBuff(104,3),this.player.buff.atkAd3=!1);else if(82==e||83==e)this.host.onHeal(2),t=!0;else if(79==e||78==e)this.player.updateArmor(2),t=!0;else if(80==e||81==e)this.opponent.host.onHurt(2,2),t=!0;else if(84==e)this.player.buff.addBuff(27,1),t=!0;else if(86==e)this.host.onHurt(3,2,7,2),t=!0;else if(88==e){var n=4==c.data.heroId?c.data.cardBag:c.data.deck;if(n.length>0){t=!0;for(var s=o.get("cfg_card",n[0]).element,r=1;r<n.length;r++)if(o.get("cfg_card",n[r]).element!=s){t=!1;break}}}else if(93==e){if(1==this.player.round){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard(!0);for(a=0;a<=0;){var h=c.getRandomCardId();3==o.get("cfg_card",h).quality&&(a=h)}window.player.patchCard(a),t=!0}}else if(96==e)this.opponent.buff.addBuff(26,5),t=!0;else if(97==e)this.player.updateArmor(1),t=!0;else if(102==e)this.host.hp>this.host.hpMax&&(this.player.updateArmor(this.host.hp-this.host.hpMax),t=!0);else if(104==e)this.opponent.buff.addBuff(Math.floor(10*Math.random())+21,1),t=!0;else if(105==e)this.host.onHurt(2,2,7,2),t=!0;else if(108==e)Math.random()<.3&&(this.opponent.buff.addBuff(27,1),t=!0);else if(109==e)Math.random()<.3&&(this.player.buff.addBuff(13,1),t=!0);else if(110==e)this.host.onHurt(1,2,7,2),this.opponent.buff.addBuff(26,2),t=!0;else if(111==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),t=!0);else if(114==e)this.player.buff.addBuff(106,1);else if(115==e)this.luckDice||(this.luckDice=!0,this.player.addRollCount(),t=!0);else if(116==e)this.luckFlag||(this.luckFlag=!0,this.opponent.host.onHurt(6,2),t=!0);else if(118==e){for(var d=0,l=0;l<this.opponent.cardList.length;l++){this.opponent.cardList[l].getComponent("Card").burn&&d++}d>0&&(this.opponent.host.onHurt(6*d,2),t=!0)}else if(119==e)this.opponent.host.onHurt(5,2),t=!0;else if(121==e){for(var u=[],f=0;f<=this.player.buff.buffList.length;f++){var p=this.player.buff.buffList[f];p>=21&&p<=28&&u.push(p)}if(u.length>0){var m=u[Math.floor(Math.random()*u.length)];this.player.buff.removeBuff(m,this.player.buff.table[m]),t=!0}}else if(122==e)this.opponent.host.onHurt(1,2),t=!0;else if(123==e)this.host.hp>this.host.hpMax&&(this.opponent.host.onHurt(this.host.hp-this.host.hpMax,2),t=!0);else if(124==e)this.player.buff.addBuff(106,2);else if(126==e)c.updateCopper(-10),t=!0;else if(128==e){if(this.player.cardList.length>0&&this.opponent.deck.length>0){var g=Math.floor(Math.random()*this.player.cardList.length),y=(a=this.player.cardList[g].getComponent("Card").cfgId,Math.floor(Math.random()*this.opponent.deck.length)),v=this.opponent.deck[y];this.player.deck[g]=v,this.opponent.deck[y]=a,this.player.cardList[g].getComponent("Card").discard(!0),this.player.patchCard(v)}t=!0}else if(129==e)this.host.onHeal(3),t=!0;else if(138==e)this.opponent.buff.addBuff(29,1),t=!0;else if(142==e)this.player.diceCount++,t=!0;else if(143==e)this.player.updateArmor(this.host.hpMax-this.host.hp),t=!0;else if(144==e)this.opponent.buff.addBuff(27,1),t=!0;else if(145==e){if(1==this.player.round){if(this.opponent.equip.itemList.length>0){var w=this.opponent.equip.itemList[Math.floor(Math.random()*this.opponent.equip.itemList.length)].getComponent("Item");this.addEquip(w.cfgId),this.player.checkGameBegin()}t=!0}}else if(146==e)this.feedBack=8,this.refreshItemNum(146,8),t=!0;else if(147==e)this.player.buff.addBuff(104,1),t=!0;else if(148==e)this.opponent.host.onHurt(2*this.player.round,2,1),t=!0;else if(150==e)this.player.updateArmor(3),t=!0;else if(151==e)0==this.player.cardPlayedRound&&(this.player.extraDice+=2,t=!0);else if(152==e)null!=this.host.power&&(this.host.addPower(5),t=!0);else if(153==e)Math.random()<.1&&(this.player.patchCard(),t=!0);else if(155==e)this.opponent.host.armor>0&&(this.opponent.updateArmor(-this.opponent.host.armor),t=!0);else if(156==e)this.player.updateArmor(this.player.dmgRound),t=!0;else if(157==e)Math.random()<.3&&(this.player.patchCard(c.getRandomCardId(2)),t=!0);else if(158==e)this.reviveBook>0&&(this.player.anim.show(202),this.host.hp=this.host.hpMax,t=!0,this.reviveBook=-1);else if(160==e)!this.wolfBlood&&this.host.hp<this.host.hpMax/2&&(this.wolfBlood=!0,this.host.onHeal(Math.floor(this.host.hpMax/2)),this.player.buff.addBuff(107,1),1==this.player.index&&cc.loader.loadRes("Texture/monster/figure/999",cc.SpriteFrame,function(e,t){this.host.figure.getComponent(cc.Sprite).spriteFrame=t,this.host.figure.scale=.5,this.host.figure.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.1,1))),cc.audioEngine.playEffect(window.sound.wolfSound)}.bind(this)),t=!0);else if(161==e)this.opponent.buff.addBuff(30,3),t=!0;else if(162==e)this.host.power&&(this.opponent.host.onHurt(this.host.power,2),t=!0);else if(164==e)this.armorRemainder>=3&&(this.player.updateArmor(Math.floor(this.armorRemainder/3)),this.armorRemainder=this.armorRemainder%3,t=!0);else if(165==e){(x=Math.random())<1/3?this.opponent.host.onHurt(7,2):x<2/3?this.opponent.buff.addBuff(26,4):this.player.buff.addBuff(27,1),t=!0}else if(166==e){if(this.refreshItemNum(166,this.opponent.cardPlayed%5),this.opponent.cardPlayed%5==0){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}t=!0}}else if(168==e)this.host.armor>0&&(this.host.onHeal(Math.floor(this.host.armor/2)),t=!0);else if(169==e){if(this.player.cardList.length<=0){for(var b=0;b<6;b++)this.player.patchCard();this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),t=!0}}else if(170==e){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}t=!0}else if(174==e){if((d=this.player.cardList.length-this.player.cardAbledCount)>0){for(var C=0;C<d;C++)this.opponent.host.onHurt(3,2);t=!0}}else if(176==e)this.opponent.host.onHurt(3,2);else if(181==e)this.player.createExDice(),t=!0;else if(182==e)this.player.updateArmor(5),t=!0;else if(183==e){var x;(x=Math.random())<1/6?this.host.onHeal(6):x<2/6?this.player.updateArmor(6):x<.5?this.player.buff.addBuff(105,1):x<4/6?this.player.buff.addBuff(13,1):x<5/6?this.player.buff.addBuff(107,1):this.player.buff.addBuff(108,1),t=!0}else 184==e?this.elementPlayed[1]>=3&&(this.elementPlayed[1]-=3,this.player.createExDice(),t=!0):185==e?this.elementPlayed[2]>=3&&(this.elementPlayed[2]-=3,this.player.buff.addBuff(107,1),t=!0):t=!0;return t&&this.doTrigger(e),t},doTrigger:function(e){for(var t=0;t<this.itemList.length;t++){var i=this.itemList[t].getComponent("Item");if(i.cfgId==e&&!i.isRemoved){i.trigger();break}}},refreshItemNum:function(e,t){for(var i=0;i<this.itemList.length;i++){var c=this.itemList[i].getComponent("Item");if(c.cfgId==e){c.txtCount.string=t;break}}},doDisabled:function(e){for(var t=0;t<this.itemList.length;t++){var i=this.itemList[t].getComponent("Item");if(i.cfgId==e){i.doDisabled();break}}},addEquip:function(e){if(0==this.index){this.equipList.push(e);var t=cc.instantiate(this.itemPrefab);t.getComponent("Item").init(e,this),this.boxEquip.addChild(t),this.itemList.push(t);for(var i=0;i<this.itemList.length;i++){var a=72;this.itemList.length>10&&(a=648/(this.itemList.length-1)),this.itemList[i].x=a*i-324}}else{this.equipList[0]=e,this.itemList[0].getComponent("Item").refresh(e);var n=o.get("cfg_item",e);this.host.equipDesc.string="<color=#FEF64B>"+n.name+"\uff1a</c>"+c.analysisDesc(n.desc1),this.itemList[0].x=-this.host.equipDesc.node.width/2-25}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0d029pbdspBQZQHImTjZ76I","EventLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Node,boxes:[cc.Node],masks:[cc.Node],txtNames:[cc.Label],figures:[cc.Sprite],txtDescs:[cc.Label],txtResults:[cc.Node],txtInfo:cc.Node,btnLeave:cc.Node,btnPlay:cc.Node,book:cc.Node},onLoad:function(){var e=this;window.eventLayer=this,this.cfgId=c.data.eventIds[c.data.castle-1];for(var t=o.get("cfg_event",this.cfgId),i=function(i){e.txtNames[i].string=t["name"+(i+1)],e.txtDescs[i].string=t["result"+(i+1)];var c=e.figures[i];cc.loader.loadRes("Texture/npc/"+t["figure"+(i+1)],cc.SpriteFrame,function(e,t){c.spriteFrame=t}.bind(e))},a=0;a<2;a++)i(a);this.btnLeave.opacity=1,this.btnPlay.opacity=1,this.txtTitle.opacity=0,this.btnLeave.y-=100,this.btnPlay.y-=100,this.txtTitle.y-=50,this.book.scale=0,this.book.y+=265;for(a=0;a<2;a++)this.masks[a].active=!0,this.boxes[a].scale=.7,this.boxes[a].opacity=0,this.boxes[a].position=cc.v2(200*a-100,-25);this.txtTitle.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50)))),this.book.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,1),cc.moveBy(.2,cc.v2(0,-265))),cc.callFunc(function(){for(var e=this,t=function(t){var i=t;e.boxes[i].runAction(cc.sequence(cc.delayTime(.2*i),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,cc.v2(326*i-163,112)),cc.scaleTo(.2,1)),cc.callFunc(function(){this.masks[i].runAction(cc.fadeOut(.2)),this.txtResults[i].runAction(cc.sequence(cc.delayTime(.1),cc.fadeIn(.2)))}.bind(e)),cc.delayTime(.2*i),cc.callFunc(function(){this.boxes[i].runAction(cc.sequence(cc.moveBy(.4,cc.v2(0,-5)),cc.moveBy(.8,cc.v2(0,10)),cc.moveBy(.4,cc.v2(0,-5))).repeatForever())}.bind(e))))},i=0;i<2;i++)t(i)}.bind(this)))),this.txtInfo.runAction(cc.sequence(cc.delayTime(.8),cc.fadeIn(.2),cc.callFunc(function(){this.btnLeave.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,100)))),this.btnPlay.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,100))))}.bind(this)))),c.data.guide>0&&(this.btnLeave.active=!1,this.btnPlay.x=0)},onBattle:function(){window.homeLayer=null,window.eventLayer=null,cc.director.loadScene("yahtzee")},close:function(){this.node.destroy(),c.data.floorBeats[c.data.floor-1]=!0,window.eventLayer=null,window.room.initAlter(),window.room.ready()}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(e,t,i){"use strict";cc._RF.push(t,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.id=e,0==e?cc.loader.loadRes("Texture/UI/map/fort_home1",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)):8==e?cc.loader.loadRes("Texture/UI/map/fort_boss1",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/UI/map/fort_room"+(1==t?3:1),cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this))},show:function(){0==this.id?cc.loader.loadRes("Texture/UI/map/fort_home2",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)):8==this.id?cc.loader.loadRes("Texture/UI/map/fort_boss2",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/UI/map/fort_room2",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this))},hide:function(){0==this.id?cc.loader.loadRes("Texture/UI/map/fort_home1",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)):8==this.id?cc.loader.loadRes("Texture/UI/map/fort_boss1",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/UI/map/fort_room3",cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this))}}),cc._RF.pop()},{}],Game:[function(e,t,i){"use strict";cc._RF.push(t,"f5308O6zsVOxr+EKRsyR7ba","Game");var c=e("Config"),o={opening:!0,version:0,firstGuiding:!1,getData:function(e){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(t){cc.log("getStorageSuccess:"+t.data),void 0!=t.data?(o.data=JSON.parse(t.data),this.checkCompatible(),e()):(this.setDataToBase(),e())}.bind(this),fail:function(){this.setDataToBase(),e()}.bind(this)});else{var t=cc.sys.localStorage.getItem("dice");void 0!=t?(o.data=JSON.parse(t),this.checkCompatible()):this.setDataToBase(),e()}},setDataToBase:function(){var e=0,t=0,i=0;o.data&&(e=o.data.guide,t=o.data.guide,i=o.data.totalTime),o.data={heroId:1,difficulty:1,deck:[],cardBag:[],equip:[],hp:35,hpMax:35,power:0,powerMax:20,heroPos:2,exp:0,level:1,castle:1,floor:1,roomType:0,copper:99,debuff:0,shopIds:[],eventIds:[],monsterList:[],historyPath:[],historyChoose:[0],floorBeats:[],specialRoomIds:[],monsterBeats:[],monsterUnbeats:[],itemEffect:{feather:0,vase:0,flagon:0,pen:0,vip1:!1,vip2:!1,reviveBook:0},startTime:0,duration:0,face:1,restartCount:0,cardPlayed:{},guide:e,guideBag:t,totalTime:i,score:0,highRecord:[0,0,0,0,0]},o.saveData()},saveData:function(){o.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(o.data),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(o.data))},checkCompatible:function(){o.data.totalTime||(o.data.totalTime=0),o.data.duration||(o.data.duration=0),o.data.score||(o.data.score=0),o.data.highRecord||(o.data.highRecord=[0,0,0,0,0])},updateCopper:function(e){o.data.copper+=e,o.data.copper=Math.max(o.data.copper,0),e>0&&(o.data.highRecord[0]+=e)},getItem:function(e){if(o.data.equip.push(e),10==e)o.data.itemEffect.feather=1;else if(28==e)o.data.itemEffect.vase=2;else if(29==e)o.data.itemEffect.flagon=2;else if(40==e)o.data.hpMax+=5,o.data.hp+=5;else if(41==e)o.data.hpMax+=10,o.data.hp+=10;else if(46==e)o.data.itemEffect.vip1=!0;else if(47==e)o.data.itemEffect.vip2=!0;else if(71==e)o.updateCopper(50);else if(72==e)o.updateCopper(50),o.data.hpMax+=10,o.data.hp+=10;else if(74==e)o.data.itemEffect.pen+=2;else if(84==e)for(var t=0;t<3;t++)o.getItem(o.getNewItemId(0));else if(87==e)for(var i=0;i<2;i++)o.getItem(o.getNewItemId(0,2));else 92==e?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hp,o.data.hpMax)):95==e?(o.data.hpMax+=10,o.data.hp=o.data.hpMax):96==e?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hp,o.data.hpMax)):105==e?(o.data.hpMax+=20,o.data.hp+=20):106==e?o.data.powerMax+=10:158==e&&(o.data.itemEffect.reviveBook=1);94!=e&&o.data.equip.indexOf(94)>=0&&(o.data.hpMax+=5,o.data.hp+=5),window.homeLayer&&window.homeLayer.refreshHeroData(),o.data.highRecord[2]++},getCard:function(e){var t=5==o.data.heroId?4:2==o.data.heroId&&3==o.data.difficulty?5:6;4!=o.data.heroId&&o.data.deck.length<t?o.data.deck.push(e):(o.data.cardBag.push(e),o.newCard=!0,window.homeLayer&&window.homeLayer.refreshHeroData()),o.data.highRecord[1]++},getNewItemId:function(e,t,i){for(var a=0;a<=0;){var n=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_item).length)+1,s=c.get("cfg_item",n);if(o.data.equip.indexOf(n)<0&&(0==e&&s.get<=1||1==e&&0==s.get||2==e&&3!=s.get)){var r=0;t?s.quality==t&&(r=n):r=n,i?s.hero==o.data.heroId&&(a=r):s.hero!=o.data.heroId&&0!=s.hero||(a=r)}}return a},getNewCardId:function(e,t){for(var i=0;i<=0;){var c=o.getRandomCardId(null,t?2:1,e);o.data.deck.indexOf(c)<0&&o.data.cardBag.indexOf(c)<0&&(i=c)}return i},getRandomCardId:function(e,t,i){for(var a=0;a<=0;){var n=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_card).length)+1,s=c.get("cfg_card",n);s.hero!=o.data.heroId&&0!=s.hero||(3==t?s.get<=1:s.get==(t||1))&&(4!=o.data.heroId||s.element<7)&&(e?s.element==e&&(a=n):i?s.quality==i&&(a=n):a=n)}return a},getNewMonsterId:function(e,t){for(var i=0,a=0;i<=0;){var n=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_monster).length)+1;o.data.monsterBeats.indexOf(n)<0&&c.get("cfg_monster",n).level==e&&c.get("cfg_monster",n).type==t&&(i=n),o.data.monsterUnbeats.indexOf(n)>=0&&a<500&&(i=0,a++)}return i},deleteItem:function(){var e=Math.floor(Math.random()*o.data.equip.length),t=o.data.equip[e];return o.data.equip.splice(e,1),10==t?o.data.itemEffect.feather=0:28==t?o.data.itemEffect.vase=0:29==t?o.data.itemEffect.flagon=0:40==t?(o.data.hpMax=Math.max(o.data.hpMax-5,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):41==t?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):46==t?o.data.itemEffect.vip1=!1:47==t?o.data.itemEffect.vip2=!1:72==t?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):74==t?o.data.itemEffect.pen=0:92==t?o.data.hpMax+=20:95==t?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):96==t?o.data.hpMax+=10:105==t?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):106==t?(o.data.powerMax-=10,o.data.power=Math.min(o.data.powerMax,o.data.power)):158==t&&(o.data.itemEffect.reviveBook=0),t},analysisDesc:function(e,t){for(var i="",c=0,o="",a={1:"fire",2:"water",3:"wind",4:"earth",5:"light",6:"dark",7:"atk",9:"suck",11:"armor",12:"heal",13:"dodge",14:"power",15:"heart",16:"atkback",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind"},n={1:"FF3924",2:"1668E0",3:"00B74F",4:"FF7F12",5:"FFEC27",6:"A950E4",7:"FFFFFF",9:"FF3924",11:"2CB4FF",12:"60E800",13:"FFEC27",14:"FFEC27",15:"FF3924",16:"FF3924",21:"FF3924",22:"2CB4FF",23:"FF3924",24:"E6791E",25:"2CB4FF",26:"A950E4",27:"96969E",28:"EDB332",29:"FFEC27",30:"96969E"},s=0;s<e.length;s++)"#"==e[s]?0==c?(c=1,o="",i+="<img src='"):(i+=a[parseInt(o)],i+="'/>",c=0):"["==e[s]?(o="",0==c&&(c=2,i+="<color=#")):"]"==e[s]?""!=o?(i+=n[parseInt(o)],i+=">",c=-1):(c=0,i+="</c>"):c<=0?e[s]>="A"&&e[s]<="F"?i+=" <img src='dice"+(e[s].charCodeAt()-64)+"'/> ":i+=e[s]:o+=e[s];return i}};t.exports=o,cc._RF.pop()},{Config:"Config"}],Guide:[function(e,t,i){"use strict";cc._RF.push(t,"de3f2Q4A3JOtrWLJf8I4ofG","Guide");var c=e("Game");cc.Class({extends:cc.Component,properties:{mask:cc.Node,label:cc.Label,hand:cc.Node,btnNode:cc.Node,btnNode2:cc.Node,box:cc.Node},init:function(e){window.guide=this,this.id=e;var t=!1,i=!1;0==e?(this.hand.active=!1,this.btnNode.active=!0,t=!0,this.label.string="\u4eb2\u7231\u7684\u5192\u9669\u8005\uff0c\u662f\u5426\u9700\u8981\u6211\u6765\u5e2e\u52a9\u4f60\u4e86\u89e3\u4e00\u4e0b \u6e38\u620f\u73a9\u6cd5 \u5462\uff1f",this.btnNode.opacity=0,this.btnNode.y-=30,this.btnNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,30)),cc.fadeIn(.2))))):1==e?(this.hand.position=cc.v2(0,315),this.label.string="\u70b9\u51fb \u51fa\u53e3 \u8fdb\u5165\u4e0b\u4e00\u4e2a\u623f\u95f4\u3002"):2==e?(this.hand.rotation=180,this.hand.position=cc.v2(0,120),this.label.string="\u906d\u9047\u602a\u7269\uff0c\u70b9\u51fb\u8fdb\u5165\u6218\u6597\u3002"):3==e?(i=!0,this.hand.rotation=180,this.hand.position=cc.v2(0,-cc.winSize.height/2+310),this.label.string="\u4e0b\u65b9\u662f\u4f60\u63b7\u51fa\u6765\u7684\u5143\u7d20\u9ab0\u5b50\u3002"):4==e?(i=!0,this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u4e0a\u9762\u662f\u4f60\u643a\u5e26\u7684\u5143\u7d20\u6280\u80fd\u5361\u724c\u3002"):5==e?(this.hand.position=cc.v2(-248,-cc.winSize.height/2+600),this.label.string="\u70b9\u4eae\u5361\u724c\u6240\u9700\u5143\u7d20\uff0c\u5373\u53ef\u4f7f\u7528\u5361\u724c\u3002\u70b9\u51fb\u91ca\u653e\u5361\u724c\u6280\u80fd!"):6==e?(this.hand.position=cc.v2(310,-cc.winSize.height/2+760),this.label.string="\u672a\u70b9\u4eae\u7684\u5361\u724c\u4e0d\u80fd\u4f7f\u7528\uff0c\u600e\u4e48\u529e\u5462\uff1f\u70b9\u51fb \u91cd\u63b7 \u6309\u94ae\uff0c\u53ef\u4ee5\u91cd\u65b0\u6295\u51fa\u9ab0\u5b50\u3002",window.host.checkBtnRoll()):7==e?(this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u8fd0\u6c14\u4e0d\u9519\uff01\u6210\u529f\u70b9\u4eae\u5361\u724c\uff0c\u70b9\u51fb\u91ca\u653e\uff01"):8==e?(this.hand.rotation=180,this.hand.position=cc.v2(290,-cc.winSize.height/2+180),this.label.string="\u5b8c\u7f8e\uff01\u624b\u724c\u5168\u90e8\u6253\u5b8c\uff0c\u70b9\u51fb \u56de\u5408\u7ed3\u675f\u3002\u4e0b\u56de\u5408\u770b\u4f60\u7684\u8868\u73b0\uff01"):10==e?(this.hand.rotation=180,this.hand.position=cc.v2(-110,-cc.winSize.height/2+310),this.label.string="\u70b9\u51fb\u9ab0\u5b50 \u53ef\u9501\u5b9a/\u89e3\u9501\uff0c\u5728\u91cd\u63b7\u9ab0\u5b50\u65f6\u88ab\u4fdd\u7559\uff0c\u9002\u5408\u70b9\u4eae\u591a\u9700\u6c42\u5361\u724c\u3002"):11==e?(this.hand.rotation=180,this.hand.position=cc.v2(-280,-cc.winSize.height/2+230),this.label.string="\u70b9\u51fb \u6548\u679c\u56fe\u6807 \u53ef\u67e5\u770b\u6548\u679c\u8be6\u7ec6\u8bf4\u660e\u3002"):12==e?(this.hand.rotation=180,this.hand.position=cc.v2(130,-cc.winSize.height/2+180),this.label.string="\u53d7\u5230\u4f24\u5bb3\u53ef\u83b7\u5f97\u6012\u6c14\u3002\u6d88\u8017\u4e00\u5b9a\u6012\u6c14\uff0c\u53ef\u91ca\u653e\u6012\u6c14\u6280\u80fd\uff0c\u70b9\u51fb\u91ca\u653e\u3002"):20==e?(i=!0,this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u63b7\u51fa\u7684\u9ab0\u5b50\u5143\u7d20\u7b26\u5408\u5b9d\u7bb1\u5f00\u542f\u6761\u4ef6\uff0c\u5373\u53ef\u6fc0\u6d3b\u5b9d\u7bb1\u3002"):21==e?(i=!0,this.hand.rotation=180,this.hand.position=cc.v2(160,-cc.winSize.height/2+130),this.label.string="\u4e24\u4e2a\u5c0f\u6280\u80fd 2\u90091 \u91ca\u653e\uff0c\u53ef\u5e2e\u52a9\u4f60\u83b7\u5f97\u66f4\u591a\u5956\u52b1\u3002"):22==e?(i=!0,this.hand.rotation=180,this.hand.position=cc.v2(290,-cc.winSize.height/2+130),this.label.string="\u89c9\u5f97\u6ee1\u610f\u4e86\u968f\u65f6\u53ef\u4ee5\u9886\u53d6\u5956\u52b1\u79bb\u5f00\uff0c\u4e0d\u8981\u592a\u8d2a\u5fc3\u54af\u3002"):23==e?(i=!0,this.hand.active=!1,this.label.string="\u63a5\u4e0b\u6765\u5c31\u770b\u4f60\u7684\u5566\u3002"):24==e?(this.hand.active=!1,this.btnNode2.active=!0,t=!0,this.label.string="\u57fa\u7840\u4ecb\u7ecd\u5b8c\u6210!\r\n\u6b63\u5f0f\u7684\u5192\u9669\u8fd8\u6709\u66f4\u591a\u7cbe\u5f69\u5185\u5bb9!\r\n\u63a5\u4e0b\u6765\u4f60\u60f3..."):30==e?(this.hand.rotation=180,this.hand.position=cc.v2(312,-cc.winSize.height/2+110),this.label.string="\u83b7\u5f97\u65b0\u7684\u5361\u724c\u540e\uff0c\u53ef\u8fdb\u5165\u5361\u5305\u66f4\u6362\u51fa\u6218\u5361\u724c\u3002"):31==e&&(i=!0,this.hand.position=cc.v2(0,cc.winSize.height/2-400),this.label.string="\u70b9\u51fb\u5df2\u51fa\u6218\u5361\u724c\u53ef\u653e\u56de\u5361\u5305\uff0c\u70b9\u51fb\u5361\u5305\u4e2d\u7684\u724c\u53ef\u66f4\u6362\u4e3a\u51fa\u6218\u5361\u724c\u3002"),this.box.opacity=0,this.box.y-=30,this.label.node.opacity=0,this.label.node.y-=30,this.box.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,30)),cc.fadeIn(.2))),this.label.node.runAction(cc.sequence(cc.delayTime(.1),cc.spawn(cc.moveBy(.2,cc.v2(0,30)),cc.fadeIn(.2)),cc.callFunc(function(){i?this.mask.once(cc.Node.EventType.TOUCH_START,this.close,this):t||(this.mask.active=!1)}.bind(this)))),180==this.hand.rotation?this.hand.runAction(cc.sequence(cc.spawn(cc.moveBy(.3,cc.v2(0,-20)),cc.scaleTo(.3,1,.9)),cc.moveBy(.3,cc.v2(0,20)),cc.scaleTo(.3,1,1)).repeatForever()):this.hand.runAction(cc.sequence(cc.spawn(cc.moveBy(.3,cc.v2(0,20)),cc.scaleTo(.3,1,.9)),cc.moveBy(.3,cc.v2(0,-20)),cc.scaleTo(.3,1,1)).repeatForever())},close:function(){this.id<30&&(c.data.guide=this.id+1),this.node.destroy(),window.guide=null,0==this.id?window.homeLayer.showGuide(this.id+1):3==this.id||4==this.id||6==this.id||7==this.id?window.mainLayer.showGuide(this.id+1):20==this.id||21==this.id||22==this.id?window.tavernLayer.showGuide(this.id+1):31==this.id&&(c.data.guideBag=-1)},startGuide:function(){c.data.guide=0,this.close(),window.homeLayer.initPath(),window.homeLayer.refreshPath(),c.data.floorQuests[0]=[[1],[3],[1],[4],[7],[6],[8]],c.data.deck=[67,1,2]},skip:function(){c.firstGuiding?(c.firstGuiding=!1,c.data.guide=-1,this.node.destroy(),window.guide=null,window.homeLayer.initPath(),window.homeLayer.refreshPath()):(c.tempGuideData&&(c.data=c.tempGuideData),cc.director.loadScene("cover"))},reguide:function(){this.close(),c.setDataToBase(),c.data.guide=0,c.begin=!0,cc.director.loadScene("helloworld")},goBattle:function(){this.close(),c.setDataToBase(),c.data.guide=-1,cc.director.loadScene("prepare")}}),cc._RF.pop()},{Game:"Game"}],HelloWorld:[function(e,t,i){"use strict";cc._RF.push(t,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var c=e("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,roomPrefab:cc.Prefab,stripHp:cc.ProgressBar,txtHp:cc.Label,stripExp:cc.ProgressBar,head:cc.Sprite,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,markRed:cc.Node,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,bag2Prefab:cc.Prefab,equipPrefab:cc.Prefab,completePrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab,btnEquip:cc.Node,btnDeck:cc.Node,mask:cc.Node,chessPrefab:cc.Prefab,fortPrefab:cc.Prefab,boxFort:cc.Node,cardChangePrefab:cc.Prefab,cardDeletePrefab:cc.Prefab,soundPrefab:cc.Prefab,guidePrefab:cc.Prefab,btnEdit:cc.Node,layerNode:cc.Node},onLoad:function(){window.homeLayer=this;var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmMap[c.data.castle-1],!0),this.boxFort.active=!1,0!=c.data.guide&&this.initPath(),c.data.historyChoose.length<=1&&this.initGameConfig(),this.hero=cc.instantiate(this.chessPrefab),this.bg.addChild(this.hero),this.createRoom(),this.refreshHeroData(),c.data.levelUp&&this.scheduleOnce(this.openLvUp,.3),this.status=0,this.mask.active=!0,this.mask.zIndex=1e3,this.mask.width=this.mask.height=100,this.doMask(),c.data.deck.length+c.data.cardBag.length>=7&&0==c.data.guideBag&&this.showGuide(30),this.btnEdit.runAction(cc.sequence(cc.delayTime(1),cc.moveBy(.3,cc.v2(0,-80)))),this.mask.zIndex=100},createRoom:function(){var e=cc.instantiate(this.roomPrefab);this.bg.addChild(e),this.room=e,this.hero.parent=e,this.hero.zIndex=10,c.begin?(e.getComponent("Room").init(!1),c.begin=!1):e.getComponent("Room").init(!1)},changeRoom:function(e){var t=cc.instantiate(this.roomPrefab);this.bg.addChild(t),t.getComponent("Room").init(!0);var i=cc.v2();0==e?(t.position=cc.v2(0,1450),i=cc.v2(0,-1450)):1==e?(t.position=cc.v2(1080,0),i=cc.v2(-1080,0)):2==e?(t.position=cc.v2(0,-1450),i=cc.v2(0,1450)):3==e&&(t.position=cc.v2(-1080,0),i=cc.v2(1080,0));var c=this.room;c.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.hero.parent=t,this.hero.zIndex=10,c.destroy()}.bind(this)))),t.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.room=t,t.getComponent("Room").initHero()}.bind(this))))},openAlter:function(){if(2==c.data.roomType){if(!window.campLayer){var e=cc.instantiate(this.campPrefab);this.node.addChild(e)}}else if(3==c.data.roomType)window.treasureLayer||this.openTreasure();else if(4==c.data.roomType){if(!window.eventLayer){var t=cc.instantiate(this.eventPrefab);this.node.addChild(t)}}else if(5==c.data.roomType){if(!window.shopLayer){var i=cc.instantiate(this.shopPrefab);this.layerNode.addChild(i)}}else 6==c.data.roomType&&(cc.director.loadScene("tavern"),window.homeLayer=null)},refreshHeroData:function(){this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax;var e=[5,15,21,39,47,73,150][c.data.level-1];this.stripExp.progress=c.data.exp/e;this.txtName.string=["\u65e0\u754f\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9884\u8a00\u8005","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtLevel.string="Lv."+c.data.level,this.txtCopper.string=c.data.copper,cc.loader.loadRes("Texture/hero/head/"+c.data.heroId,cc.SpriteFrame,function(e,t){this.head.spriteFrame=t}.bind(this)),this.markRed.active=c.newCard},openMap:function(){this.scheduleOnce(function(){var e=cc.instantiate(this.mapPrefab);this.node.addChild(e)}.bind(this),.2)},openCardBag:function(){if(c.data.guide<0||c.data.guide>2){var e=cc.instantiate(4==c.data.heroId?this.bag2Prefab:this.bagPrefab);this.node.addChild(e)}},openEquip:function(){if(c.data.guide<0||c.data.guide>2){var e=cc.instantiate(this.equipPrefab);this.node.addChild(e)}},openTreasure:function(){var e=cc.instantiate(this.treasurePrefab);e.getComponent("TreasureLayer").init(),this.node.addChild(e)},openLvUp:function(){var e=cc.instantiate(this.lvUpPrefab);this.node.addChild(e)},openComplete:function(){var e=cc.instantiate(this.completePrefab);this.node.addChild(e)},initDeck:function(){if(4==c.data.heroId)c.data.cardBag=[1,2,3,4,5,6];else{var e=5==c.data.heroId?2:3;if(c.data.deck.length+c.data.cardBag.length<=e)for(;c.data.deck.length+c.data.cardBag.length<e;){var t=c.getNewCardId(null,!0);c.getCard(t)}}},initGameConfig:function(){this.initDeck(),c.data.eventIds=[];for(var e=0;e<30;e++){var t=Math.floor(Math.random()*(c.data.eventIds.length+1));c.data.eventIds.splice(t,0,e+1)}c.data.specialRoomIds=[3,4];for(var i=[[2,6,5],[2,3,4,6,5],[2,3,4,6]],o=0;o<3;o++)for(var a=i[o],n=a.length-1;n>=0;n--){var s=Math.floor(Math.random()*a.length);c.data.specialRoomIds.push(a[s]),a.splice(s,1)}c.data.specialRoomIds.push(5),c.data.floorQuests=[[],[],[],[[8],[-1]]];for(var r=0;r<3;r++)for(var h=0;h<13;h++)this.initFloorConfig(r,h)},initFloorConfig:function(e,t){var i=[];if(0==t)i=[1];else if(4==t)i=[7,7];else if(11==t)i=[8];else if(12==t)i=[0];else if(2==t||5==t||7==t||9==t)i=Math.random()<.4?[1,1,1]:[1,1];else{var o=c.data.specialRoomIds.shift();i=Math.random()<.3?[o,1,1]:[o,1]}c.data.floorQuests[e].push(i)},gotoEdit:function(){cc.director.loadScene("edit")},goBattle:function(){this.status=2,this.mask.active=!0,this.doMask()},doMask:function(){var e=Math.floor(6*Math.random())+1,t=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254)];this.mask.getChildren()[0].color=t[e-1],cc.loader.loadRes("Texture/UI/mask_element"+e,cc.SpriteFrame,function(e,t){this.mask.getComponent(cc.Mask).spriteFrame=t,this.schedule(this.updateMask,0)}.bind(this)),2==this.status&&(c.maskElement=e)},updateMask:function(){0==this.status?(this.mask.width+=120,this.mask.height+=120,this.mask.width>=3e3&&this.mask.height>=3e3&&(this.unschedule(this.updateMask),this.mask.active=!1,this.status)):2==this.status&&(this.mask.width-=120,this.mask.height-=120,this.mask.width<=100&&(this.mask.width=this.mask.height=100,this.unschedule(this.updateMask),window.homeLayer=null,cc.director.loadScene("mainLayer")))},initPath:function(){this.boxFort.active=!0,this.boxFort.removeAllChildren(),this.pathList=[];for(var e=4==c.data.castle?2:c.data.guide>0?8:13,t=0;t<e;t++){var i=cc.instantiate(this.fortPrefab);i.x=-(e-1)/2*34+34*t,this.boxFort.addChild(i),this.pathList.push(i),0==t?(i.x-=10,i.getComponent("Fort").init(0,1)):t==e-1?(i.x+=10,i.getComponent("Fort").init(8,1)):t<=c.data.historyChoose.length-2?i.getComponent("Fort").init(1,1):i.getComponent("Fort").init(1,0)}},refreshPath:function(){this.pathList&&(this.pathList[c.data.floor-1].getComponent("Fort").show(),c.data.floor>1&&this.pathList[c.data.floor-2].getComponent("Fort").hide())},getCard:function(e){if(1==c.data.heroId&&3==c.data.difficulty)if(c.data.deck.length<6)c.getCard(e);else{var t=cc.instantiate(this.cardChangePrefab);t.getComponent("CardChangeLayer").init(e),this.node.addChild(t,100)}else c.getCard(e)},openDelete:function(){var e=cc.instantiate(this.cardDeletePrefab);this.node.addChild(e,100)},showGuide:function(e){this.scheduleOnce(function(){if(!window.guide){var t=cc.instantiate(this.guidePrefab);t.getComponent("Guide").init(e),this.node.addChild(t)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],Hero:[function(e,t,i){"use strict";var c;function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}cc._RF.push(t,"7311fX1RYNN1bDgBGcTZsee","Hero");var a=e("Game");cc.Class({extends:cc.Component,properties:(c={stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,skillPrefab:cc.Prefab,head:cc.Node,skillNode:cc.Node},o(c,"head",cc.Sprite),o(c,"btnRoll",cc.Button),o(c,"imageShadow",cc.Node),o(c,"txtRollCount",cc.Label),o(c,"diceAnimation",dragonBones.ArmatureDisplay),c),onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip"),cc.loader.loadRes("Texture/hero/head/"+a.data.heroId,cc.SpriteFrame,function(e,t){this.head.spriteFrame=t}.bind(this))},init:function(){this.btnEnd=window.mainLayer.btnEnd,this.initDeck(),this.diceCount=5,3==a.data.heroId&&(3==a.data.difficulty?this.diceCount=2:this.diceCount=4),this.player.init(0),this.hpMax=a.data.hpMax,this.hp=a.data.hp,this.power=a.data.power,10==a.data.guide&&(this.power=3),this.powerMax=a.data.powerMax,this.armor=0,this.rollabled=!0,this.round=0,this.refreshStrip(),this.initSkills()},startRound:function(e){if(!window.mainLayer.gameOver){if(e)window.mainLayer.txtRound.string="\u989d\u5916\u56de\u5408";else{if(this.round++,this.round>15)return void window.mainLayer.showEnd(1);window.mainLayer.txtRound.string=this.round>=15?"\u6700\u7ec8\u56de\u5408":"\u7b2c"+this.round+"\u56de\u5408"}var t=window.mainLayer.boxHeroRound;t.y=8,t.scale=.2,t.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.scaleTo(.25,1.05),cc.scaleTo(.1,1),cc.delayTime(.6),cc.spawn(cc.moveBy(.3,cc.v2(0,300)),cc.fadeOut(.3)),cc.callFunc(function(){this.player.startRound(),this.scheduleOnce(function(){this.btnEnd.runAction(cc.moveTo(.2,cc.v2(285,138))),this.btnEnd.getComponent(cc.Button).interactable=!0,11==a.data.guide?window.mainLayer.showGuide(11):12==a.data.guide&&(this.power<10&&this.addPower(10-this.power),window.mainLayer.showGuide(12))}.bind(this),.5)}.bind(this))))}},endRound:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").abled=!0;this.checkSkills(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(485,138))),this.btnEnd.getComponent(cc.Button).interactable=!1,this.player.totalRollCount=this.player.rollCount,this.player.rollCount=0,this.checkBtnRoll()},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},roll:function(){this.rollabled&&(this.diceAnimation.playAnimation("play1"),this.rollabled=!1,this.scheduleOnce(function(){this.rollabled=!0,this.btnRoll.interactable?(this.diceAnimation.playAnimation("play0"),this.imageShadow.active=!1):(this.diceAnimation.node.active=!1,this.imageShadow.active=!0)}.bind(this),.5),3==a.data.heroId?window.mainLayer.chooseDice():this.player.roll())},onHurt:function(e,t,i,c){if(!window.mainLayer.gameOver){var o=this.hp;if(i=i||7,c=null!=c?c:1,this.player.onHurt(e,t,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),o>this.hp){var a=o-this.hp;this.equip.checkWithTrigger(163)&&(a*=2),this.addPower(a)}}},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(e){e>0&&this.player.opponent.equip.checkWithTrigger(178)||(this.power+=e,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.checkSkills())},initSkills:function(){this.btnSkills=[];for(var e=0;e<2;e++){var t=cc.instantiate(this.skillPrefab);t.position=cc.v2(0==e?-58:58,-42),t.getComponent("Skill").init(e),this.skillNode.addChild(t),this.btnSkills.push(t)}},checkSkills:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").check()},checkBtnRoll:function(e){var t=!1;if(this.player.rollCount>0&&this.player.diceList.length>0)if(this.player.cardList.length>0)t=!0;else if(this.player.chestList)for(var i=0;i<3;i++)if(this.player.chestList[i]){t=!0;break}(a.data.guide>0&&a.data.guide<6||10==a.data.guide)&&(t=!1),t?(this.btnRoll.interactable=!0,this.imageShadow.active=!1,this.diceAnimation.node.active||(this.diceAnimation.node.active=!0,this.diceAnimation.playAnimation("play0"))):(this.btnRoll.interactable=!1,"play0"==this.diceAnimation.animationName&&(this.diceAnimation.node.active=!1,this.imageShadow.active=!0)),this.player.rollCount>0?"0"==this.txtRollCount.string?(this.txtRollCount.string=this.player.rollCount,this.txtRollCount.node.runAction(cc.scaleTo(.2,1))):this.txtRollCount.string-this.player.rollCount!=0&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=this.player.rollCount}.bind(this)),cc.scaleTo(.2,1))):"0"!=this.txtRollCount.string&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=0}.bind(this))))},initDeck:function(){if(4==a.data.heroId){if(this.deck=a.data.cardBag.concat(),3==a.data.difficulty)for(var e=0;e<a.data.level;e++)this.deck.push(224)}else this.deck=a.data.deck.concat()},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};t[e]&&(this.head.color=cc.Color.WHITE.fromHEX("#"+t[e]),window.mainLayer.camera.stopAllActions(),window.mainLayer.camera.runAction(cc.sequence(cc.moveTo(.05,cc.v2(5,5)),cc.moveTo(.1,cc.v2(-5,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){window.mainLayer.camera.position=cc.v2(0,0),this.head.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Game:"Game"}],ItemCollection:[function(e,t,i){"use strict";cc._RF.push(t,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.RichText,icon:cc.Sprite,boxHead:cc.Sprite},init:function(e){var t=o.get("cfg_item",e),i=[cc.color(85,229,255),cc.color(255,128,242),cc.color(255,154,73)];this.txtName.string=t.name;var a=c.analysisDesc(t.desc1),n=-1;10==e?n=c.data.itemEffect.feather>0?1:0:28==e?n=c.data.itemEffect.vase:29==e?n=c.data.itemEffect.flagon:74==e?n=c.data.itemEffect.pen:158==e&&(n=c.data.itemEffect.reviveBook>0?1:0),n>=0&&(a+="<color=#EBC82E>  (\u5269\u4f59\u6b21\u6570"+n+")</c>"),this.txtDesc.string=a,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][t.quality-1],this.txtQuality.node.color=i[t.quality-1],cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+t.quality,cc.SpriteFrame,function(e,t){this.boxHead.spriteFrame=t}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ItemCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,icon:cc.Sprite,bg:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,btn:cc.Button,mask:cc.Node,txtChosen:cc.Node,markDelete:cc.Node,txtEmpty:cc.Node,nail:cc.Node},init:function(e,t){if(e<=0)this.btn.node.active=!1,this.markDelete.active=!0,this.txtEmpty.active=!0;else{var i=o.get("cfg_item",e);this.cfgId=e,this.txtName.string=i.name,this.txtDesc.string=c.analysisDesc(i.desc1),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_item"+i.quality,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this)),this.btn.interactable=t}},runOut:function(e,t){this.mask.active=!0,this.node.opacity=0,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*t),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,e),cc.scaleTo(.2,1)),cc.callFunc(function(){this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},enableChoosen:function(){this.btn.interactable=!0,this.txtChosen.active=!0,this.txtChosen.opacity=0,this.txtChosen.y-=50,this.txtChosen.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))},hideBox:function(){cc.loader.loadRes("Texture/UI/box_icon"+cfg.quality,cc.SpriteFrame,function(e,t){this.boxIcon.spriteFrame=t}.bind(this)),this.bg.node.active=!1},choose:function(){window.treasureChest?window.treasureChest.chooseEquip(this.cfgId):window.levelUpLayer&&window.levelUpLayer.choose(this.cfgId)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Item:[function(e,t,i){"use strict";cc._RF.push(t,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,iconBtn:cc.Button,boxNum:cc.Node,txtCount:cc.Label,tip:cc.Node,txtDesc:cc.RichText,box:cc.Node,bg:cc.Sprite},init:function(e,t,i){this.cfgId=e,this.cfg=o.get("cfg_item",e),this.equip=t,cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),43!=e&&146!=e&&166!=e||(this.boxNum.active=!0),i&&(this.boxNum.active=!1,cc.loader.loadRes("Texture/UI/box_icon"+this.cfg.quality,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this))),this.layer=window.mainLayer||window.completeLayer},trigger:function(){this.action&&this.icon.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.5),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,1==this.cfg.num&&this.doDisabled()}.bind(this))),this.icon.node.runAction(this.action)},doDisabled:function(){this.iconBtn.enableAutoGrayEffect=!0},openTip:function(){if(!this.equip||1!=this.equip.index){if(this.layer.equipTip){if(this.layer.equipTip==this)return void this.hideTip();this.layer.equipTip.hideTip()}this.tip.active=!0,this.layer.equipTip=this;this.txtDesc.string="<color=#"+["5CC7FF","C262FF","FF9231"][this.cfg.quality-1]+">"+this.cfg.name+"\uff1a</c>"+c.analysisDesc(this.cfg.desc1),this.node.x<-220?this.box.x=-220-this.node.x:this.node.x>220&&(this.box.x=220-this.node.x),this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.tip.active=!1,this.layer.equipTip=null},refresh:function(e){this.cfgId=e,this.cfg=o.get("cfg_item",e),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),43!=e&&146!=e&&166!=e||(this.boxNum.active=!0),this.iconBtn.enableAutoGrayEffect=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LevelUpLayer:[function(e,t,i){"use strict";cc._RF.push(t,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{box:cc.Node,cover:cc.Node,txtLevel:cc.Label,mask:cc.Node,boxSkill:cc.Node,iconSkill:cc.Sprite,txtSkillName:cc.Label,txtSkillDesc:cc.Label,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,hand:cc.Node,hand1:cc.Node,hand2:cc.Node,boxNode:cc.Node,coverNode:cc.Node,bg:cc.Node},onLoad:function(){window.levelUpLayer=this,this.type=3,3==c.data.level?this.initSkill():5==c.data.level||7==c.data.level?(this.type=2,this.initItems()):(this.type=1,this.initCards()),this.txtLevel.string=c.data.level,cc.audioEngine.playEffect(window.sound.levelUpSound),this.doActions()},doActions:function(){this.hand1.x+=200,this.hand2.x+=200,this.bg.y-=1200,this.bg.runAction(cc.sequence(cc.moveBy(.4,cc.v2(0,1200)),cc.callFunc(function(){this.bg.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever()),this.hand1.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(-200,0)))),this.hand2.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(-200,0))))}.bind(this)))),this.mask.runAction(cc.fadeTo(.4,180)),this.coverNode.runAction(cc.sequence(cc.delayTime(1.3),cc.moveBy(.1,cc.v2(0,10)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.2,cc.v2(0,140)),cc.moveBy(.3,cc.v2(40,600)))),this.cover.runAction(cc.sequence(cc.delayTime(1.3),cc.rotateTo(.1,-.5),cc.rotateTo(.1,1),cc.rotateTo(.2,-5),cc.rotateTo(.3,5)))},initCards:function(){this.itemIdList=[],this.items=[];var e=c.getNewCardId();this.itemIdList.push(e);for(var t=0;t<=0;){var i=c.getNewCardId();i!=e&&(t=i)}this.itemIdList.push(t);for(var o=0;o<2;o++){var a=cc.instantiate(this.cardPrefab);a.getComponent("CardCollection").init(this.itemIdList[o],3),a.getComponent("CardCollection").txtChosen.active=!0,a.position=cc.v2(0==o?-140:140,-60),this.box.addChild(a),this.items.push(a)}},initItems:function(){this.itemIdList=[],this.items=[];var e=c.getNewItemId(0,null,!0);this.itemIdList.push(e);for(var t=0;t<=0;){var i=c.getNewItemId(0,null,!0);i!=e&&(t=i)}this.itemIdList.push(t);for(var o=0;o<2;o++){var a=cc.instantiate(this.itemPrefab);a.getComponent("ItemCommodity").init(this.itemIdList[o],!0),a.getComponent("ItemCommodity").txtChosen.active=!0,a.position=cc.v2(0==o?-140:140,-55),this.box.addChild(a),this.items.push(a)}},initSkill:function(){this.boxSkill.active=!0;var e=o.get("cfg_hero",c.data.heroId);this.txtSkillName.string=e.skill2,this.txtSkillDesc.string=e.skillDesc2,cc.loader.loadRes("Texture/hero/skill/"+2*c.data.heroId,cc.SpriteFrame,function(e,t){this.iconSkill.spriteFrame=t}.bind(this)),this.scheduleOnce(function(){this.mask.on(cc.Node.EventType.TOUCH_START,this.close,this)}.bind(this),.5)},choose:function(e){1==this.type?window.homeLayer.getCard(e):c.getItem(e);for(var t=0,i=0;i<this.itemIdList.length;i++)if(e==this.itemIdList[i]){t=i;break}var o=this.items[t],a=this.items[1-t];a.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){a.destroy()}.bind(this)))),o.runAction(cc.moveTo(.2,cc.v2(0,o.y)));for(var n=0;n<this.items.length;n++)1==this.type?this.items[n].getComponent("CardCollection").txtChosen.runAction(cc.fadeOut(.2)):2==this.type&&this.items[n].getComponent("ItemCommodity").txtChosen.runAction(cc.fadeOut(.2));cc.audioEngine.playEffect(window.sound.selectSound),this.scheduleOnce(this.close,1.3)},close:function(){this.cover.runAction(cc.rotateTo(.3,0)),this.coverNode.runAction(cc.sequence(cc.moveBy(.3,cc.v2(-40,-770)),cc.delayTime(.1),cc.callFunc(function(){this.hand1.runAction(cc.moveBy(.2,cc.v2(200,0))),this.hand2.runAction(cc.moveBy(.2,cc.v2(200,0))),this.bg.runAction(cc.moveBy(.5,cc.v2(0,-1200))),this.mask.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){window.levelUpLayer=null,c.data.levelUp=!1,this.node.destroy()}.bind(this))))}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LoseLayer:[function(e,t,i){"use strict";cc._RF.push(t,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,btnRestart:cc.Node,btnQuit:cc.Node,txtCount:cc.Label},onLoad:function(){this.title.y+=350,this.title.runAction(cc.moveBy(.2,cc.v2(0,-350))),this.btnRestart.opacity=1,this.btnQuit.opacity=1,this.btnRestart.y-=150,this.btnQuit.y-=150,this.btnRestart.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnQuit.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.scheduleOnce(function(){this.txtCount.string=c.data.restartCount>100?"":"\u5269\u4f59\u6b21\u6570 "+c.data.restartCount}.bind(this),.4),c.data.restartCount<=0&&(this.btnRestart.getComponent(cc.Button).interactable=!1),cc.audioEngine.playEffect(window.sound.lose)},restart:function(){var e=JSON.parse(JSON.stringify(c.data));c.data=c.tempData,c.data.historyPath=e.historyPath,c.data.historyChoose=e.historyChoose,c.data.monsterList=e.monsterList,c.data.restartCount--,cc.director.loadScene("helloworld")},quit:function(){c.setDataToBase(),cc.director.loadScene("cover")}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(e,t,i){"use strict";cc._RF.push(t,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{heroPrefab:cc.Prefab,enemyPrefab:cc.Prefab,enemyNode:cc.Node,endPrefab:cc.Prefab,losePrefab:cc.Prefab,editEndPrefab:cc.Prefab,boxCardHero:cc.Node,boxDiceHero:cc.Node,boxCardEnemy:cc.Node,boxDiceEnemy:cc.Node,board:cc.Node,camera:cc.Node,bg:cc.Sprite,mask:cc.Node,chooseDiceLayer:cc.Prefab,soundPrefab:cc.Prefab,guidePrefab:cc.Prefab,btnEdit:cc.Node,btnEnd:cc.Node,boxHeroRound:cc.Node,boxEnemyRound:cc.Node,txtRound:cc.Label},onLoad:function(){window.mainLayer=this,this.gameOver=!1,cc.loader.loadRes("Texture/scene/castle"+c.data.castle,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this)),this.bg.node.on(cc.Node.EventType.TOUCH_START,this.hideTip,this),this.mask.active=!0,this.mask.zIndex=1e3,this.doMask();var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),8==c.data.roomType?cc.audioEngine.playMusic(window.sound.bgmBoss[c.data.castle-1],!0):cc.audioEngine.playMusic(window.sound.bgmBattle[c.data.castle-1],!0),this.btnEdit.runAction(cc.sequence(cc.delayTime(1),cc.moveBy(.3,cc.v2(0,-80))))},start:function(){var e=cc.instantiate(this.heroPrefab);e.position=cc.v2(0,84-cc.winSize.height/2),this.node.addChild(e),this.hero=e.getComponent("Hero");var t=cc.instantiate(this.enemyPrefab);t.position=cc.v2(0,cc.winSize.height/2-330),this.enemyNode.addChild(t),this.enemy=t.getComponent("Enemy"),this.enemy.init(),this.hero.init(),this.roundId=1,this.scheduleOnce(function(){this.enemy.equip.checkWithTrigger(141)&&!this.hero.equip.checkWithTrigger(141)&&(this.roundId=0),this.doRound()}.bind(this),.7)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.host.startRound()},showEnd:function(e,t){if(!this.gameOver)if(this.gameOver=!0,c.editCfg){var i=cc.instantiate(this.editEndPrefab);this.node.addChild(i)}else this.scheduleOnce(function(){if(0==e)this.scheduleOnce(function(){var e=cc.instantiate(this.endPrefab);e.getComponent("EndLayer").init(t),this.node.addChild(e)}.bind(this),.8),1==c.data.roomType?c.data.score+=10:7==c.data.roomType?c.data.score+=30:8==c.data.roomType&&(c.data.score+=50);else{c.data.monsterUnbeats.push(c.monsterId);var i=cc.instantiate(this.losePrefab);this.node.addChild(i)}}.bind(this),.5)},endRound:function(){c.data.guide>0&&c.data.guide<8||10==c.data.guide||(this.hero.player.endRound(),window.guide&&window.guide.close())},chooseDice:function(){var e=cc.instantiate(this.chooseDiceLayer);this.node.addChild(e,100)},hideTip:function(){this.equipTip&&this.equipTip.hideTip(),this.buffTip&&this.buffTip.hideTip()},doMask:function(){var e;c.maskElement?(e=c.maskElement,c.maskElement=null):e=Math.floor(6*Math.random())+1;var t=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254)];this.mask.getChildren()[0].color=t[e-1],cc.loader.loadRes("Texture/UI/mask_element"+e,cc.SpriteFrame,function(e,t){this.mask.getComponent(cc.Mask).spriteFrame=t,this.schedule(this.updateMask,0)}.bind(this))},updateMask:function(){this.mask.width+=120,this.mask.height+=120,this.mask.width>=3e3&&this.mask.height>=3e3&&(this.unschedule(this.updateMask),this.mask.active=!1)},showGuide:function(e){this.scheduleOnce(function(){if(!window.guide){var t=cc.instantiate(this.guidePrefab);t.getComponent("Guide").init(e),this.node.addChild(t)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2be16dXDepLLbZP42Rqq+om","MapLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{mask:cc.Node,view:cc.Node,top:cc.Node,bottom:cc.Node,box:cc.Node,maskList:[cc.Node],dice:dragonBones.ArmatureDisplay},onLoad:function(){window.mapLayer=this,this.box.opacity=1,this.mask.opacity=1,this.mask.runAction(cc.sequence(cc.fadeTo(.2,180),cc.callFunc(function(){this.openMap()}.bind(this))));for(var e=0;e<4;e++)e<c.data.castle-1&&(this.maskList[e].active=!1);this.scheduleOnce(this.roll,.5),cc.audioEngine.playEffect(window.sound.bagOpenSound)},openMap:function(){this.box.opacity=255,this.winHeight=cc.winSize.height/cc.winSize.width*750,this.bottom.y=-this.winHeight/2+275,this.bottom.runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.05,cc.v2(0,-150)),cc.moveBy(.1,cc.v2(0,-50)),cc.moveBy(.1,cc.v2(0,15)))),this.top.y=-this.winHeight/2+380,this.top.runAction(cc.sequence(cc.delayTime(.05),cc.moveTo(.3,cc.v2(0,this.winHeight/2-39)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.1,cc.v2(0,-10)))),this.view.height=50,this.view.y=(this.bottom.y+this.top.y)/2-30,this.frame=0,this.schedule(this.updateFrame,0)},updateFrame:function(){this.frame++,this.view.height=this.top.y-this.bottom.y-15,this.view.y=(this.bottom.y+this.top.y)/2-30},roll:function(){var e=[cc.v2(10,-430),cc.v2(-50,-135),cc.v2(-25,125),cc.v2(-65,390)];this.dice.node.position=e[c.data.castle-1],c.data.castle%2==0&&(this.dice.node.scaleX=-1),this.dice.playAnimation("play0",1),this.dice.on(dragonBones.EventObject.LOOP_COMPLETE,function(){this.maskList[c.data.castle-1].runAction(cc.fadeOut(.5))}.bind(this)),this.scheduleOnce(this.close,2.5)},close:function(){this.bottom.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveBy(.1,cc.v2(0,50)),cc.moveTo(.1,cc.v2(0,-this.winHeight/2+280)))),this.top.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,10)),cc.moveBy(.1,cc.v2(0,-20)),cc.moveTo(.2,cc.v2(0,-this.winHeight/2+385)))),this.mask.runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.15,cc.v2(0,-400)),cc.callFunc(function(){this.node.destroy(),window.mapLayer=null}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(e,t,i){"use strict";cc._RF.push(t,"52880hyyK1GjLw1tAGJFFaD","Opening");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.login()},login:function(){o.load(function(){c.getData(function(){cc.director.loadScene("cover")}.bind(this))}.bind(this))},loadRes:function(){}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerTavern:[function(e,t,i){"use strict";cc._RF.push(t,"f1734zLgkZCHperU+957PgJ","PlayerTavern");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,btnRoll:cc.Button,boxCard:cc.Node,boxDice:cc.Node,txtRollCount:cc.Label,imageShadow:cc.Node,diceAnimation:dragonBones.ArmatureDisplay},onLoad:function(){window.player=this,this.rollabled=!0,this.initCards(),this.scheduleOnce(this.startRound,.5)},startRound:function(){this.rollCount=2,this.initDices(),c.data.guide>0&&window.tavernLayer.showGuide(20)},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];for(var e=0;e<5;e++){var t=cc.instantiate(this.dicePrefab);t.position=cc.v2(110*e-220,-200),this.boxDice.addChild(t),this.diceList.push(t)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[],this.deck=this.getRandomCards();for(var e=0;e<6;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardTavern").init(this.deck[e]),t.position=cc.v2(e%3*218-216,84-203*Math.floor(e/3)),this.boxCard.addChild(t,100),this.cardList.push(t)}},getRandomCards:function(e){for(var t=[],i=0;t.length<6;){for(var c=0,a=Math.random(),n=0,s=t.length<4?1:19,r=t.length<4?18:30,h=s;h<=r;h++){if(a<(n+=o.get("cfg_tavern",h).rate)){c=h;break}}t.indexOf(c)<0&&(!e||e.indexOf(c)<0)&&(c>=9&&c<=11||15==c?i<2&&(t.push(c),i++):t.push(c))}return t},doRoll:function(){this.rollabled&&(this.diceAnimation.playAnimation("play1"),this.rollabled=!1,this.scheduleOnce(function(){this.rollabled=!0,this.btnRoll.interactable?(this.diceAnimation.playAnimation("play0"),this.imageShadow.active=!1):(this.diceAnimation.node.active=!1,this.imageShadow.active=!0)}.bind(this),.5),this.roll())},roll:function(e){for(var t=0;t<this.diceList.length;t++){var i=this.diceList[t].getComponent("DiceTavern");1==e?i.roll():i.holded||i.roll()}this.endRoll(e),e?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound)},endRoll:function(e){e?this.scheduleOnce(function(){this.checkElement(),this.checkBtnRoll()}.bind(this),.2):(this.checkElement(),this.rollCount--,this.checkBtnRoll())},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var e=0;e<this.diceList.length;e++){var t=this.diceList[e].getComponent("DiceTavern");this.elementList[t.element-1]++}this.cardAbledCount=this.checkCardsRequire()},checkCardsRequire:function(){for(var e=0,t=0;t<this.cardList.length;t++){this.cardList[t].getComponent("CardTavern").checkRequire()&&e++}return e},addRollCount:function(){this.rollCount++,this.checkBtnRoll()},checkBtnRoll:function(){this.rollCount>0?(this.btnRoll.interactable=!0,this.imageShadow.active=!1,this.diceAnimation.node.active||(this.diceAnimation.node.active=!0,this.diceAnimation.playAnimation("play0")),"0"==this.txtRollCount.string?(this.txtRollCount.string=this.rollCount,this.txtRollCount.node.runAction(cc.scaleTo(.2,1))):this.txtRollCount.string-this.rollCount!=0&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=this.rollCount}.bind(this)),cc.scaleTo(.2,1)))):(this.btnRoll.interactable=!1,"play0"==this.diceAnimation.animationName&&(this.diceAnimation.node.active=!1,this.imageShadow.active=!0),"0"!=this.txtRollCount.string&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=0}.bind(this)))))},changeAllCards:function(){var e=this.deck.concat();this.deck=this.getRandomCards(e);for(var t=0;t<6;t++){this.cardList[t].getComponent("CardTavern").change(this.deck[t])}this.checkCardsRequire(),this.checkBtnRoll()},checkRewards:function(){for(var e=[],t=0;t<this.cardList.length;t++){var i=this.cardList[t].getComponent("CardTavern");i.usable&&e.push(i.cfgId)}return e}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Sprite]},init:function(e){this.index=e,this.win=0,this.diceList=[];for(var t=0;t<5;t++){var i=cc.instantiate(this.dicePrefab);i.getComponent("DiceYahtzee").init(t,e),i.opacity=0,this.boxDice.addChild(i),this.diceList.push(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){for(var e=0;e<5;e++)this.diceList[e].getComponent("DiceYahtzee").show();this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check(),cc.audioEngine.playEffect(window.sound.rollSound2)}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.hold(),t.abled=!1}cc.audioEngine.playEffect(window.sound.holdSound)}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){e[this.diceList[t].getComponent("DiceYahtzee").element-1]++}e.sort(function(e,t){return t-e}),5==e[0]?this.score=7:4==e[0]?this.score=6:3==e[0]?2==e[1]?this.score=5:this.score=4:2==e[0]?2==e[1]?this.score=3:this.score=1:this.score=2},doWin:function(){var e=window.yahtzeeLayer.crowns[this.index];e.node.active=!0,e.playAnimation("play0",1),this.win<=0&&e.on(dragonBones.EventObject.COMPLETE,function(){"play0"==e.animationName?e.node.runAction(cc.sequence(cc.moveTo(.4,cc.v2(130+60*this.win,0==this.index?-557:548)),cc.callFunc(function(){e.playAnimation("play1",1),cc.loader.loadRes("Texture/battle/mark_crown1",cc.SpriteFrame,function(e,t){this.crowns[this.win].spriteFrame=t,this.win++}.bind(this)),cc.audioEngine.playEffect(window.sound.bingo)}.bind(this)))):"play1"==e.animationName&&(e.node.position=cc.v2(0,-30),e.node.active=!1)}.bind(this))}}),cc._RF.pop()},{}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"ba4f5YaUElBy61UWqBofsfz","Player");var c=e("Game"),o=e("Utils"),a=e("Config"),n=e("CardManager");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,chestPrefab:cc.Prefab,dmgAnimation:cc.Prefab},init:function(e){this.index=e,0==e?(this.host=this.getComponent("Hero"),this.opponent=window.mainLayer.enemy.player,this.boxCard=window.mainLayer.boxCardHero,this.boxDice=window.mainLayer.boxDiceHero):(this.host=this.getComponent("Enemy"),this.opponent=window.mainLayer.hero.player,this.boxCard=window.mainLayer.boxCardEnemy,this.boxDice=window.mainLayer.boxDiceEnemy),this.cardPool=new cc.NodePool;for(var t=0;t<6;t++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var o=0;o<5;o++){var a=cc.instantiate(this.dicePrefab);this.dicePool.put(a)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.atkPlayed=0,this.atkRound=0,this.dmgRound=0,this.diceUsabld=!0,this.cardUsabled=!0,this.elementList=[0,0,0,0,0,0],this.createDiceRound=[0,0,0,0,0,0],this.delayCard=[],this.legacyDice=[],this.deck=this.host.deck,0==this.index&&(3==c.data.heroId&&4==c.data.difficulty?this.bag=c.data.cardBag.concat():4==c.data.heroId&&2==c.data.difficulty&&(this.cemetery=[]));var n=cc.instantiate(this.dmgAnimation);this.node.addChild(n),0==this.index?(n.scale=.8,n.position=cc.v2(-302,33)):n.position=cc.v2(0,this.host.figureNode.y+this.host.figure.height/2),this.anim=n.getComponent("DmgAnimation"),this.anim.init(e)},start:function(){this.equip=this.getComponent("Equip"),this.equip.init(),this.buff=this.getComponent("Buff"),this.buff.init(),this.diceCount=this.host.diceCount;for(var e=[85,86,89,90,91,92],t=0;t<e.length;t++)this.equip.checkWithTrigger(e[t])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++,this.scheduleOnce(function(){this.checkGameBegin(),0==this.index&&c.data.debuff>0&&this.host.onHurt(5*c.data.debuff,1,7,2)}.bind(this),1),0==this.index&&3==c.data.heroId&&2==c.data.difficulty&&(this.totalRollCount=this.equip.checkWithTrigger(58)?7:6)},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,0==this.index?2==c.data.heroId?this.rollCount=1:3==c.data.heroId&&(2==c.data.difficulty?this.rollCount=this.totalRollCount:3==c.data.difficulty&&this.rollCount--):(this.rollCount+=this.host.exRollCount,2==c.data.heroId&&4==c.data.difficulty&&this.rollCount++),this.checkStart(),0==this.index&&(this.diceUsabld=!1,this.cardUsabled=!1,4==c.data.heroId?(2!=c.data.difficulty||this.round<=1)&&(this.deckArray=this.deck.concat(),this.deckArray.sort(function(e,t){return.5-Math.random()})):5==c.data.heroId&&(this.chestList=[null,null,null],this.createChest())),this.initCards(),this.initDices()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var e=this.diceCount+this.extraDice,t=o.getDifferentRandomNum(e,e-1,0),i=Math.min(this.buff.lock,e),a=t.splice(0,i);this.buff.removeBuff(28,i);var n=0,s=[];this.equip.checkWithTrigger(63)||(n=Math.min(this.buff.freeze,e-i),s=t.splice(0,n),this.buff.removeBuff(22,n));var r=t.concat(s),h=Math.min(this.buff.blind,e-i),d=r.splice(0,h);this.buff.removeBuff(30,h);for(var l=0;l<e;l++){for(var u=[],f=0;f<a.length;f++)if(l==a[f]){u.push(28);break}if(0==u.length){for(var p=0;p<s.length;p++)if(l==s[p]){u.push(22);break}for(var m=0;m<d.length;m++)if(l==d[m]){u.push(30);break}}var g=null;g=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab);var y=0;y=e<=6?-(e-1)/2*110+110*l:640/(e-1)*l-320,g.position=cc.v2(y,0==window.mainLayer.roundId?-200:700),g.getComponent("Dice").init(l,u),this.boxDice.addChild(g),this.diceList.push(g),3==c.data.heroId&&3==c.data.difficulty&&(g.getComponent("Dice").remembered=!0)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),this.cardList.length>3?.5:.3)},initCards:function(){this.cardList=[];var e=this.deck;0==this.index&&4==c.data.heroId&&(e=this.deckArray);for(var t=Math.min(e.length,6),i=this.equip.checkWithTrigger(66)?0:this.buff.silence,o=this.equip.checkWithTrigger(62)?0:this.buff.burn,n=0;n<t;n++){var s=null,r=a.get("cfg_card",e[n]).element;this.buff.silenceDark&&6==r?s=25:Math.random()<i/(t-n)?(s=25,i--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==r?s=21:Math.random()<o/(t-n)&&(s=21,o--,this.buff.removeBuff(21,1)),this.drawCard(e[n],s)}0==this.index&&4==c.data.heroId&&this.deckArray.splice(0,t)},drawCard:function(e,t,i){var c=this.getEmptyIndex();if(!(c<0||window.mainLayer.gameOver)){var o=null;return(o=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(e,c,t,0),o.getComponent("Card").isTemp=i,this.boxCard.addChild(o,100+c%3),this.cardList.push(o),cc.audioEngine.playEffect(window.sound.drawSound),o}},patchCard:function(e,t,i){var o=this.buff,n=null;e=e||c.getRandomCardId();var s=a.get("cfg_card",e).element;o.silenceDark&&6==s?n=25:o.silence>0&&!this.equip.checkWithTrigger(66)?(n=25,o.removeBuff(25,1)):o.burnIce&&2==s?n=21:o.burn>0&&!this.equip.checkWithTrigger(62)&&(n=21,o.removeBuff(21,1));var r=this.drawCard(e,n,!t);if(r)return r.getComponent("Card").initBuff(),i&&r.getComponent("Card").disCost(),this.checkCardsRequire(),this.host.checkBtnRoll&&this.host.checkBtnRoll(),this.equip.trigger(119),r},suppleCard:function(){if(!(this.deckArray.length<=0)){var e=this.deckArray[0];this.patchCard(e,!0)&&this.deckArray.shift()}},roll:function(e,t){var i=void 0;3==c.data.guide?i=[2,2,5,6,2]:6==c.data.guide?i=[4,1,4,6,5]:7==c.data.guide?i=[3,2,1,3,6]:10==c.data.guide?i=[1,c.guideChoose+3,1,2,5]:11==c.data.guide&&1==this.index&&(i=[4,2,5,6]);for(var o=0;o<this.diceList.length;o++){var a=this.diceList[o].getComponent("Dice");i?a.roll(i[o]):1==e?0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.lastDices&&this.lastDices[o]?a.roll(this.lastDices[o]):a.roll():a.freeze||a.lock||a.temp||(t?(a.holded&&a.hold(),a.roll(t)):a.holded||a.roll(),a.initBuff())}this.endRoll(e),e?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound),window.guide&&6==c.data.guide&&window.guide.close()},endRoll:function(e){if(e)this.scheduleOnce(function(){this.refreshCardBuff(),this.checkElement(),0==this.index&&3==c.data.heroId&&2==c.data.difficulty||this.rollCount--,3==c.data.guide&&window.mainLayer.showGuide(3);for(var e=0;e<this.legacyDice.length;e++)this.createExDice(this.legacyDice[e],!0);this.legacyDice=[]}.bind(this),.2);else{this.checkElement();for(var t=0,i=0;i<6;i++)this.elementList[i]>0&&t++;if(t>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.rollCount--,this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),this.opponent.equip.trigger(176),0==this.index)if(2==c.data.heroId){if(3==c.data.difficulty);else if(5==c.data.difficulty){for(var o=[],a=0;a<this.diceList.length;a++){var n=this.diceList[a].getComponent("Dice");n.blind||n.lock||o.push(n)}if(o.length>0){var s=o[Math.floor(Math.random()*o.length)];s.buffList.push(30),s.blind=!0,s.markBlind.active=!0}else window.player.buff.addBuff(30,1)}}else 4==c.data.heroId&&5==c.data.difficulty&&Math.random()<.5&&this.buff.addBuff(27,1)}},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var e=0;e<this.diceList.length;e++){var t=this.diceList[e].getComponent("Dice");t.lock||this.elementList[t.element-1]++}if(this.cardAbledCount=this.checkCardsRequire(),this.chestList)for(var i=0;i<3;i++)this.chestList[i]&&this.chestList[i].getComponent("Chest").checkRequire()},refreshCardBuff:function(){for(var e=0;e<this.cardList.length;e++)this.cardList[e].getComponent("Card").initBuff();this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2),this.opponent.equip.trigger(170)},refreshDiceBuff:function(){for(var e=0;e<this.diceList.length;e++)this.diceList[e].getComponent("Dice").initBuff();if(this.checkElement(),1==this.index&&1==c.data.heroId&&4==c.data.difficulty&&this.cardList.length<6){var t=c.getRandomCardId(null,3);this.patchCard(t)}else 0==this.index&&2==c.data.heroId&&3==c.data.difficulty&&(this.cardList.length>=6&&this.cardList[5].getComponent("Card").discard(!0),this.randomCard=this.patchCard(),this.randomCard.getComponent("Card").discribeRandom());for(var i=0,o=0;o<6;o++)this.elementList[o]>0&&i++;i>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.cardAbledCount<=0&&this.equip.trigger(45);for(var a=48;a<=53;a++)this.equip.trigger(a);this.equip.trigger(93),this.equip.trigger(128),this.equip.trigger(174),this.host.checkBtnRoll&&(this.host.checkBtnRoll(!0),this.diceUsabld=!0,this.cardUsabled=!0)},createExDice:function(e,t,i){var o=[];this.buff.lock>0?(o.push(28),this.buff.removeBuff(28,1)):(this.buff.freeze>0&&!this.equip.checkWithTrigger(63)&&(o.push(22),this.buff.removeBuff(22,1)),this.buff.blind>0&&(o.push(30),this.buff.removeBuff(30,1)));var a=null;a=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab),this.diceList.length<=5?a.x=this.diceList.length/2*110:a.x=320,a.getComponent("Dice").init(this.diceList.length-1,o),this.boxDice.addChild(a),this.diceList.push(a),a.getComponent("Dice").roll(e),a.getComponent("Dice").initBuff(),e&&!t&&a.getComponent("Dice").doTemp(),3==c.data.heroId&&3==c.data.difficulty&&i&&(a.getComponent("Dice").remembered=!0);for(var n=0;n<this.diceList.length;n++){var s=this.diceList[n];s.stopAllActions(),s.opacity=255;var r=0;r=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*n:640/(this.diceList.length-1)*n-320,s.runAction(cc.moveTo(.2,cc.v2(r,0)))}this.checkElement(),this.extraDice++},endRound:function(){for(var e=this.cardList.length-1;e>=0;e--){if(0==this.index)if(3==c.data.heroId&&4==c.data.difficulty){if(this.bag.length>0){var t=this.deck.indexOf(this.cardList[e].getComponent("Card").cfgId);if(t>=0){var i=Math.floor(Math.random()*this.bag.length),o=this.bag.splice(i,1);this.deck.splice(t,1,o),this.bag.push(this.cardList[e].getComponent("Card").cfgId)}}}else 4==c.data.heroId&&2==c.data.difficulty&&this.deckArray.unshift(this.cardList[e].getComponent("Card").cfgId);this.cardList[e].getComponent("Card").remove(!0)}this.lastDices=[];for(var a=0;a<this.diceList.length;a++)0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.diceList[a].getComponent("Dice").remembered&&this.lastDices.push(this.diceList[a].getComponent("Dice").element),this.diceList[a].getComponent("Dice").remove();if(0==this.index&&4==c.data.heroId&&2==c.data.difficulty&&(this.deckArray=this.deckArray.concat(this.cemetery),this.cemetery=[]),this.chestList)for(var n=0;n<3;n++)this.chestList[n]&&this.chestList[n].getComponent("Chest").remove();this.host.endRound(),this.scheduleOnce(function(){window.mainLayer.gameOver||(this.buff.exRound>0?(this.host.startRound(!0),this.buff.removeBuff(101,1)):window.mainLayer.doRound())}.bind(this),.5),this.extraDice=0,this.settleBuff(),this.settleEquip()},checkCardsRequire:function(){for(var e=0,t=0;t<this.cardList.length;t++){this.cardList[t].getComponent("Card").checkRequire()&&e++}return e},checkGameBegin:function(){for(var e=[6,12,13,14,15,16,17,18,19,20,21,30,37,44,86,91,96,114,124],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),c.data.roomType>=7&&this.equip.trigger(61)},checkStart:function(){this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]);for(var e=[5,9,25,30,84,105,111,121,126,129,142,143,145,146,147,152,155,160,162,165,168],t=0;t<e.length;t++)this.equip.trigger(e[t]);if(this.dmgRound=0,this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var i=this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?2:1);this.host.onHurt(i,1,26,0),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.removeBuff(102,1),this.buff.table[23]>0&&this.buff.removeBuff(23,1);for(var c=0;c<this.delayCard.length;c++)n.doDelayEffect(this.delayCard[c]);this.delayCard=[]},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.removeBuff(29,this.buff.table[29]),this.buff.removeBuff(30,this.buff.table[30]),this.buff.table[24]>0&&this.buff.removeBuff(24,1);for(var e=0;e<4;e++)this.buff.removeBuff(103+e,this.buff.tempBuff[e]),this.buff.tempBuff[e]=0;this.buff.multiCast=this.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1,this.buff.selfHarmCast=this.buff.selfHarmCastMax=0,this.buff.doubleWind=!1,this.buff.darkRedice=0},settleEquip:function(){for(var e=[2,3,27,57,59,60,104,110,138,148,150,151,156,161,11],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.opponent.equip.trigger(118),this.equip.doDisabled(139),this.equip.doDisabled(140),this.cardPlayedRound=0,this.atkRound=0,this.dmgRound=0,this.createDiceRound=[0,0,0,0,0,0],this.equip.swiftGlove=!1,this.equip.luckDice=!1,this.equip.luckFlag=!1,this.equip.suckRemainder=0,this.equip.armorRemainder=0,this.equip.elementPlayed=[0,0,0,0,0,0]},onHurt:function(e,t,i,o){if(1==o){if(i<=6){this.equip.checkWithTrigger(130)&&(e*=.5);this.equip.checkWithTrigger([133,132,135,134,137,136][i-1])&&(e*=2)}else this.equip.checkWithTrigger(131)&&(e*=.5);if(this.buff.frail>0&&0==t&&!this.equip.checkWithTrigger(64)){var a=.4;this.opponent.equip.checkWithTrigger(54)&&(a+=.2),this.equip.checkWithTrigger(56)&&(a-=.2),this.equip.checkWithTrigger(113)&&(a*=2),this.opponent.equip.checkWithTrigger(113)&&(a*=2),e*=a+1}this.host.hp<.3*this.host.hpMax&&this.opponent.equip.checkWithTrigger(154)&&(e*=2),e=Math.round(e),e+=this.opponent.buff.atkAdd,this.opponent.equip.checkWithTrigger(21),this.opponent.equip.checkWithTrigger(147),this.opponent.host.hp<.3*this.opponent.host.hpMax&&this.opponent.equip.checkWithTrigger(75),i<=6?0==this.round&&this.equip.checkWithTrigger(139)?e=0:this.equip.checkWithTrigger(i+131)&&(e=0):0==this.round&&this.equip.checkWithTrigger(140)&&(e=0),e>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),e=1),e>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),e=1),e>0&&this.buff.hurtReduce>0&&(e=Math.max(0,e-this.buff.hurtReduce),this.equip.checkWithTrigger(114),this.equip.checkWithTrigger(124)),e>4&&this.equip.checkWithTrigger(125)&&(e=4);var n=!1;if(e>=this.host.hp+this.host.armor&&(this.host.hp%2==1&&this.equip.checkWithTrigger(179)||this.equip.checkWithTrigger(180)||0==this.index&&c.data.guide>0)&&(n=!0,e=0),9==i&&e>0&&this.opponent.host.onHeal(e),this.opponent.equip.suckRemainder+=e,this.opponent.equip.trigger(23),this.opponent.equip.armorRemainder+=e,this.opponent.equip.trigger(164),this.equip.feedBack>0&e>0){var s=0;this.equip.feedBack>e?(s=e,this.equip.feedBack-=e,e=0):(s=this.equip.feedBack,e-=this.equip.feedBack,this.equip.feedBack=0),this.equip.checkWithTrigger(146),this.equip.refreshItemNum(146,this.equip.feedBack),this.opponent.host.onHurt(s,2,16)}this.buff.atkBack>0&&0==t&&e>0&&this.opponent.host.onHurt(this.buff.atkBack,1,16)}if(this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(e=0),e>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(e,2,16),1==o&&(this.opponent.dmgRound+=e),n?this.assertHpChange("MISS",2):this.assertHpChange("-"+e,0),this.anim.show(i),this.host.armor>0){if(this.host.armor>=e)return void this.updateArmor(-e);e-=this.host.armor,this.updateArmor(-this.armor)}this.host.hp-=e,this.host.hp<=0&&this.buff.undead>0&&(this.anim.show(201),this.host.hp=1),1==o&&e>0&&this.equip.checkWithTrigger(175)&&this.updateArmor(e),this.host.hp<=0&&this.equip.trigger(10),this.host.hp<=0&&this.equip.trigger(158),this.equip.trigger(75),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},updateArmor:function(e){var t=this.host.armor;this.host.armor+=e,this.host.armor>0?(this.host.boxArmor.active=!0,this.host.txtArmor.string=this.host.armor,this.host.stripHp.node.color=cc.color(26,52,65),this.host.barHp.color=cc.color(92,215,255)):(this.host.armor=0,this.host.boxArmor.active=!1,this.host.stripHp.node.color=cc.color(105,37,26),this.host.barHp.color=cc.color(255,56,49)),e>0?this.anim.show(11):t>this.host.armor&&this.equip.checkWithTrigger(167)&&this.opponent.host.onHurt(t-this.host.armor,2)},onHeal:function(e){if(this.equip.checkWithTrigger(122)){var t=Math.min(e,this.host.hpMax-this.host.hp);this.opponent.host.onHurt(t,2)}this.host.hp+=e,this.equip.trigger(102),this.equip.trigger(123),this.anim.show(12),this.equip.trigger(75)},assertHpChange:function(e,t){this.showQueue.push([e,t]),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var e=this.showQueue[0],t=e[0],i=e[1],c=[cc.Color.WHITE,cc.color(139,255,70),cc.color(255,40,40),cc.color(60,247,255)],o=cc.instantiate(this.host.txtNum);o.getComponent(cc.Label).string=t,o.color=c[i],o.position=this.host.txtNum.position,this.node.addChild(o),o.scale=0;var a=cc.spawn(cc.moveBy(.1,cc.v2(30,10)),cc.scaleTo(.1,1.1));a=cc.spawn(cc.moveBy(.05,cc.v2(0,0==this.index?0:-10)),cc.scaleTo(.05,1));o.runAction(cc.sequence(a,a,cc.moveBy(.05,cc.v2(13+10*Math.random(),3+5*Math.random())),cc.moveBy(.1,cc.v2(3+10*Math.random(),-3-10*Math.random())),cc.fadeOut(.5),cc.callFunc(function(){o.destroy()}.bind(this)))),o.runAction(cc.sequence(cc.delayTime(.15),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this)))),"MISS"==t&&cc.audioEngine.playEffect(window.sound.missSound)},getEmptyIndex:function(){for(var e=0;e<6;e++){var t=!1;if(this.chestList&&this.chestList[e%3]&&(t=!0),!t)for(var i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==e){t=!0;break}}if(!t)return e}return-1},addRollCount:function(){if(0==this.index&&2==c.data.heroId){var e=2==c.data.difficulty?0:1;if(this.rollCount>=e)return}this.rollCount++,this.host.checkBtnRoll&&this.host.checkBtnRoll()},deleteDice:function(e){for(var t=[],i=0;i<this.diceList.length;i++){var c=this.diceList[i].getComponent("Dice");if(!c.lock)if(7==e)t.push(this.diceList[i]);else if(c.element==e){this.dicePool.put(this.diceList[i]),this.diceList.splice(i,1);break}}if(7==e&&t.length>0){var o=t[Math.floor(Math.random()*t.length)],a=this.diceList.indexOf(o);a>=0&&(this.dicePool.put(this.diceList[a]),this.diceList.splice(a,1))}for(var n=0;n<this.diceList.length;n++){var s=this.diceList[n];s.stopAllActions(),s.opacity=255;var r=0;r=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*n:640/(this.diceList.length-1)*n-320,s.runAction(cc.moveTo(.2,cc.v2(r,0)))}this.checkElement(),this.host.checkBtnRoll()},createChest:function(e){for(var t=-1,i=2;i>=0;i--)if(!this.chestList[i]){t=i;break}if(t>=0){var c=cc.instantiate(this.chestPrefab);c.getComponent("Chest").init(t),this.boxCard.addChild(c,100),this.chestList[t]=c,e&&c.getComponent("Chest").checkRequire()}}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game",Utils:"Utils"}],PrepareLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c0348borGFFHIk076MyCFu2","PrepareLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{btnCharacters:[cc.Button],txtName:cc.Label,txtDesc:cc.Label,txtSkillNames:[cc.Label],txtSkillDescs:[cc.Label],iconSkills:[cc.Sprite],boxInfo:cc.Node,boxUpon:cc.Node,hand:cc.Node,seals:[cc.Node],btnBack:cc.Button,boxCharacter:cc.Node,boxDifficulty:cc.Node,txtTitle:cc.Label,title:cc.Node,txtDifficulty:cc.Label,txtDifficultyDesc:cc.Label,btnDifficulty:[cc.Button],iconDifficulty:[cc.Sprite],figure:cc.Sprite,iconColoreds:[cc.Node],soundPrefab:cc.Prefab},onLoad:function(){this.heroId=1,this.difficultyId=1,this.status=1,this.refreshInfo();var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmPrepare,!0)},refreshInfo:function(){var e=this,t=["#20944C","#5e379d","#F14033","#3570D3"],i=o.get("cfg_hero",this.heroId);this.txtName.string=i.name,this.txtName.node.color=cc.Color.WHITE.fromHEX(t[this.heroId-1]),this.txtName.getComponent(cc.LabelOutline).color=cc.Color.WHITE.fromHEX(t[this.heroId-1]),this.txtDesc.string=i.desc,cc.loader.loadRes("Texture/hero/figure/"+this.heroId,cc.SpriteFrame,function(e,t){this.figure.spriteFrame=t}.bind(this));for(var c=function(t){var c=e.iconSkills[t];cc.loader.loadRes("Texture/hero/skill/"+(2*(e.heroId-1)+t+1),cc.SpriteFrame,function(e,t){c.spriteFrame=t}.bind(e)),e.txtSkillNames[t].string=i["skill"+(t+1)],e.txtSkillDescs[t].string=i["skillDesc"+(t+1)]},a=0;a<2;a++)c(a)},selectCharacter:function(e,t){this.btnCharacters[this.heroId-1].interactable=!0,this.heroId=parseInt(t)+1,this.btnCharacters[this.heroId-1].interactable=!1,cc.audioEngine.playEffect(window.sound.paper2);var i=cc.instantiate(this.boxInfo);this.boxUpon.addChild(i),i.runAction(cc.sequence(cc.spawn(cc.rotateBy(.5,40),cc.moveBy(.5,cc.v2(-770,600)).easing(cc.easeIn(3))),cc.callFunc(function(){i.destroy(),this.hand.runAction(cc.moveTo(.3,cc.v2(-323,339)))}.bind(this)))),this.hand.zIndex=10,this.hand.stopAllActions(),this.hand.position=cc.v2(-323,339),this.hand.runAction(cc.moveTo(.4,cc.v2(-462,509)).easing(cc.easeIn(2))),this.refreshInfo()},goBack:function(){1==this.status?cc.director.loadScene("cover"):this.changeMode()},changeMode:function(){this.btnBack.node.zIndex=10,this.title.zIndex=10,this.btnBack.interactable=!1,1==this.status?(this.selectDifficulty(null,0,!0),this.txtTitle.string="\u9009\u62e9\u6a21\u5f0f",this.status=2,this.seals[0].active=!0,this.boxCharacter.zIndex=2,this.boxDifficulty.zIndex=1,this.boxDifficulty.rotation=0,this.boxDifficulty.position=cc.v2(360,198.5),this.boxCharacter.runAction(cc.sequence(cc.rotateTo(.4,-50),cc.rotateTo(.2,-35),cc.moveBy(.6,cc.v2(0,-600)),cc.callFunc(function(){this.btnBack.interactable=!0}.bind(this))))):(this.txtTitle.string="\u9009\u62e9\u89d2\u8272",this.status=1,this.seals[0].active=!1,this.boxCharacter.zIndex=1,this.boxDifficulty.zIndex=2,this.boxCharacter.rotation=0,this.boxCharacter.position=cc.v2(360,198.5),this.boxDifficulty.runAction(cc.sequence(cc.rotateTo(.4,-50),cc.rotateTo(.2,-35),cc.moveBy(.6,cc.v2(0,-600)),cc.callFunc(function(){this.btnBack.interactable=!0}.bind(this))))),cc.audioEngine.playEffect(window.sound.paper)},selectDifficulty:function(e,t,i){var c=this.btnDifficulty[this.difficultyId-1];c.interactable=!0,this.iconColoreds[this.difficultyId-1].active=!1,i?c.node.position=cc.v2(154*(this.difficultyId-1)-589,-42.5):c.node.runAction(cc.moveTo(.2,cc.v2(154*(this.difficultyId-1)-589,-42.5))),this.difficultyId=parseInt(t)+1;var o=this.btnDifficulty[t];o.interactable=!1,this.iconColoreds[t].active=!0,i?o.node.position=cc.v2(154*t-589,-67.5):o.node.runAction(cc.moveTo(.2,cc.v2(154*t-589,-67.5))),this.refreshDifficulty(),e&&cc.audioEngine.playEffect(window.sound.btn1)},refreshDifficulty:function(){var e=o.get("cfg_hero",this.heroId);this.txtDifficulty.string=["\u666e\u901a","\u9ad8\u624b","\u5927\u5e08","\u738b\u8005"][this.difficultyId-1]+"\u6a21\u5f0f",this.txtDifficultyDesc.string=e["difficulty"+this.difficultyId]},goBattle:function(){this.btnBack.interactable=!1,this.seals[1].active=!0,c.data.heroId=this.heroId,c.data.difficulty=this.difficultyId,c.data.startTime=Date.now(),c.data.restartCount=1==this.difficultyId?999:2==this.difficultyId?3:1,cc.audioEngine.playEffect(window.sound.btnStart),c.begin=!0,cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],RequireRound:[function(e,t,i){"use strict";cc._RF.push(t,"3a0eeaFa/FFsJmcvXZBEaHe","RequireRound"),cc.Class({extends:cc.Component,properties:{circle:cc.Sprite,sprite:cc.Sprite},init:function(e,t){if(this.hide=!1,this.unCost=!1,this.satisfied=!1,e>0&&(this.element=e,this.refreshElement()),t>0){var i=[cc.color(97,29,31),cc.color(21,41,97),cc.color(9,76,47),cc.color(117,63,26),cc.color(137,106,23),cc.color(74,44,96),cc.color(73,73,73)];this.node.color=i[t-1]}else this.node.color=-2==t?cc.color(133,42,35):cc.color(114,79,60)},refreshElement:function(e){e&&(this.element=e),cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.unCost||(this.sprite.node.active=!0,this.sprite.spriteFrame=t)}.bind(this))},refreshSatisfy:function(e){if(this.satisfied=e,this.satisfied&&!this.unCost&&this.element){var t=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254)];this.sprite.node.color=t[this.element-1]}else this.sprite.node.color=cc.color(157,157,157)},hideElement:function(){this.element=null,this.sprite.node.active=!1},disCost:function(){this.unCost=!0,cc.loader.loadRes("Texture/battle/image_requireLine2",cc.SpriteFrame,function(e,t){this.circle.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/battle/unelement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.node.active&&(this.sprite.spriteFrame=t,this.sprite.node.color=cc.Color.WHITE)}.bind(this)),this.refreshSatisfy(!0)}}),cc._RF.pop()},{}],Reward:[function(e,t,i){"use strict";cc._RF.push(t,"6c1e8bWcJdJ5L93heyAlzGO","Reward");var c=e("Game");cc.Class({extends:cc.Component,properties:{txtDesc:cc.Label,markChange:cc.Node,changeNode:cc.Node,settleBoardPrefab:cc.Prefab,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab},init:function(e,t){this.type=t;var i=e.length;this.getCardList=[];for(var c=0;c<i;c++)this.checkReward(e[c],1==i?0:2*c-1);this.txtDesc.node.color=1==t?cc.color(255,234,0):cc.color(255,248,217)},checkReward:function(e,t){var i;if(e<=3)i=this.getCard(e);else if(4==e)i=this.getCard();else if(5==e)i=this.copyCard();else if(e<=8)i=this.getItem(e-5);else if(9==e)i=this.getItem();else if(e<=16){var c=[20,50,88,100,188,Math.floor(99*Math.random())+1,-1];i=this.getCopper(c[e-10])}else if(e<=19){i=this.getHp([10,-2,-1][e-17])}else if(e<=22){i=this.getHpMax([5,10,15][e-20])}else if(23==e)this.changeCard();else if(e<=25)i=this.deleteCard(e-24);else if(26==e)this.changeItem();else if(27==e)i=this.deleteItem();else if(e<=31){i=this.loseCopper([20,50,100,-1][e-28])}else if(e<=33){i=this.loseHp([10,-2][e-32])}else if(e<=35){i=this.loseHpMax([5,10][e-34])}else 36==e?i=this.getDebuff():37==e&&(i=this.getItem(null,73));i&&(i.x=166*t)},getCard:function(e,t){var i=t||c.getNewCardId(e),o=cc.instantiate(this.cardPrefab);return o.getComponent("CardCollection").init(i),o.getComponent("CardCollection").nail.active=2==this.type,this.node.addChild(o),1==this.type&&o.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){o.getComponent("CardCollection").showTip()}.bind(this)))),1==c.data.heroId&&3==c.data.difficulty&&c.data.deck.length>=6?this.getCardList.push(i):c.getCard(i),o},copyCard:function(){this.txtDesc.string="\u83b7\u5f97\u590d\u5236\u7684\u5361\u724c";var e=c.data.deck[Math.floor(Math.random()*c.data.deck.length)];return 4==c.data.heroId&&(e=c.data.cardBag[Math.floor(Math.random()*c.data.cardBag.length)]),this.getCard(null,e)},getItem:function(e,t){var i=t||c.getNewItemId(0,e);c.getItem(i);var o=cc.instantiate(this.itemPrefab);return o.getComponent("ItemCommodity").init(i),o.getComponent("ItemCommodity").nail.active=2==this.type,this.node.addChild(o),o},getCopper:function(e){var t=cc.instantiate(this.settleBoardPrefab);return t.getComponent("SettleBoard").init(1,e),t.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(t),t},getHp:function(e){var t=cc.instantiate(this.settleBoardPrefab);return t.getComponent("SettleBoard").init(3,e),t.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(t),t},getHpMax:function(e){var t=cc.instantiate(this.settleBoardPrefab);return t.getComponent("SettleBoard").init(4,e),t.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(t),t},changeCard:function(){this.txtDesc.string="\u53d8\u6362\u80cc\u5305\u4e2d\u7684\u5361\u724c";var e=Math.floor(Math.random()*c.data.cardBag.length),t=c.data.cardBag[e];if(t){c.data.cardBag.splice(e,1),this.markChange.active=!0;var i=c.getNewCardId();c.getCard(i);var o=cc.instantiate(this.cardPrefab);o.getComponent("CardCollection").init(t),o.x=-166,this.changeNode.addChild(o),o.getComponent("CardCollection").markDelete.active=!0,o.getComponent("CardCollection").nail.active=2==this.type;var a=cc.instantiate(this.cardPrefab);a.getComponent("CardCollection").init(i),a.x=166,this.changeNode.addChild(a),a.getComponent("CardCollection").nail.active=2==this.type,1==this.type&&a.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){a.getComponent("CardCollection").showTip()}.bind(this))))}else{var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(-1),this.changeNode.addChild(n)}},deleteCard:function(e){var t=[];if(0==e?(t=c.data.deck,this.txtDesc.string="\u5931\u53bb\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u5361\u724c"):(t=c.data.cardBag,this.txtDesc.string="\u5931\u53bb\u80cc\u5305\u4e2d\u7684\u5361\u724c"),t.length>0){var i=Math.floor(Math.random()*t.length),o=t[i];t.splice(i,1);var a=cc.instantiate(this.cardPrefab);return a.getComponent("CardCollection").init(o),a.getComponent("CardCollection").markDelete.active=!0,a.getComponent("CardCollection").nail.active=2==this.type,this.node.addChild(a),a}var n=cc.instantiate(this.cardPrefab);return n.getComponent("CardCollection").init(-2),this.node.addChild(n),n},changeItem:function(){if(this.txtDesc.string="\u53d8\u6362\u5df2\u6709\u7684\u88c5\u5907",c.data.equip.length>0){this.markChange.active=!0;var e=c.deleteItem(),t=c.getNewItemId(0);c.getItem(t);var i=cc.instantiate(this.itemPrefab);i.getComponent("ItemCommodity").init(e),i.x=-166,this.changeNode.addChild(i),i.getComponent("ItemCommodity").markDelete.active=!0,i.getComponent("ItemCommodity").nail.active=2==this.type;var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(t),o.x=166,this.changeNode.addChild(o),o.getComponent("ItemCommodity").nail.active=2==this.type}else{var a=cc.instantiate(this.itemPrefab);a.getComponent("ItemCommodity").init(-1),this.changeNode.addChild(a)}},deleteItem:function(){if(this.txtDesc.string="\u5931\u53bb\u5df2\u6709\u7684\u88c5\u5907",c.data.equip.length>0){var e=c.deleteItem(),t=cc.instantiate(this.itemPrefab);return t.getComponent("ItemCommodity").init(e),this.node.addChild(t),t.getComponent("ItemCommodity").markDelete.active=!0,t.getComponent("ItemCommodity").nail.active=2==this.type,t}var i=cc.instantiate(this.itemPrefab);return i.getComponent("ItemCommodity").init(-2),this.node.addChild(i),i},loseCopper:function(e){var t=cc.instantiate(this.settleBoardPrefab);return t.getComponent("SettleBoard").init(5,e),t.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(t),t},loseHp:function(e){var t=cc.instantiate(this.settleBoardPrefab);return t.getComponent("SettleBoard").init(6,e),t.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(t),t},loseHpMax:function(e){var t=cc.instantiate(this.settleBoardPrefab);return t.getComponent("SettleBoard").init(7,e),t.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(t),t},getDebuff:function(){var e=cc.instantiate(this.settleBoardPrefab);return e.getComponent("SettleBoard").init(8,-1),e.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(e),e}}),cc._RF.pop()},{Game:"Game"}],Room:[function(e,t,i){"use strict";cc._RF.push(t,"20286qrg/RMq6rq0m6qk3EY","Room");var c=e("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Sprite,circle:cc.Sprite,doorPrefab:cc.Prefab,btnCamp:cc.Node,btnNpc:cc.Node,npcFigure:cc.Sprite,btnTreasure:cc.Node,btnShop:cc.Node,btnTavern:cc.Node,monsterNode:cc.Node,monsterFigure:cc.Sprite,decoration:cc.Node,boxTip:cc.Node,imageBox:cc.Sprite,crystal:cc.Node,carpet:cc.Sprite,shopKeeper:[cc.Node],tavernKeeper:[cc.Node],crystalShadow:cc.Node,crystalBase:cc.Node,star:cc.Node,starNode:cc.Node},init:function(e){if(window.room=this,this.pos=c.data.heroPos,this.abled=!1,this.isNewRoom=e,e||c.begin){this.initFloorConfig();var t=(new Date).getTime(),i=t-c.data.startTime;c.data.duration+=i,c.data.totalTime+=i,c.data.startTime=t,c.data.floor>1&&(c.data.score+=5)}else this.typeList=c.data.historyPath[c.data.floor-1];this.initDoors(),this.initRoom(),this.initTouchEvents(),e||this.initHero(),this.initMap()},initHero:function(){this.hero=window.homeLayer.hero.getComponent("Chess"),window.homeLayer.refreshPath(),this.isNewRoom?(this.hero.come(this.pos,function(){0==c.data.roomType&&this.scheduleOnce(this.ready,.2),this.doors[this.pos].close(!0),2==c.data.guide&&window.homeLayer.showGuide(2)}.bind(this)),this.checkEquip(),this.doors[this.pos].open(!1)):(this.scheduleOnce(this.ready,.5),this.doors[this.pos]&&this.doors[this.pos].close(!1),c.begin?(this.hero.stay(0),c.data.guide>=0?window.homeLayer.showGuide(0):window.homeLayer.openMap()):this.hero.stay(this.pos))},initDoors:function(){this.doors=[];for(var e=[cc.v2(0,315),cc.v2(315,0),cc.v2(0,-315),cc.v2(-315,0)],t=0;t<4;t++){var i=this.typeList[t];if(-2==i&&(i=c.data.roomType),i>=0){var o=cc.instantiate(this.doorPrefab);o.getComponent("Door").init(i,t),o.rotation=90*t,o.position=e[t],o.zIndex=20,this.node.addChild(o),this.doors[t]=o.getComponent("Door")}}},initRoom:function(){1==c.data.roomType||c.data.roomType>=7?this.isNewRoom&&(this.monsterNode.active=!0,this.monsterNode.zIndex=10,2==c.data.guide?c.monsterId=3:9==c.data.guide&&(c.data.guide++,c.monsterId=1),cc.loader.loadRes("Texture/monster/figure/"+c.monsterId,cc.SpriteFrame,function(e,t){this.monsterFigure&&(this.monsterFigure.spriteFrame=t)}.bind(this)),this.monsterNode.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())):c.data.roomType>0&&this.initAlter()},gotoDoor:function(e){e!=this.pos&&this.abled&&(this.abled=!1,c.tempData=JSON.parse(JSON.stringify(c.data)),c.data.heroPos=(parseInt(e)+2)%4,c.data.floor++,c.data.floor>13&&(c.data.floor=1,c.data.castle++,c.data.historyPath=[],c.data.historyChoose=[0],c.data.floorBeats=[],c.data.monsterList=[]),this.hero.leave(e,function(){if(window.homeLayer.changeRoom(e),1==c.data.floor){window.homeLayer.openMap();for(var t=window.homeLayer.pathList,i=0;i<t.length;i++)t[i].destroy();window.homeLayer.initPath()}}.bind(this)),c.data.roomType=this.typeList[e],c.data.historyChoose[c.data.floor-1]=c.data.roomType,(1==c.data.roomType||c.data.roomType>=7)&&(c.monsterId=this.checkMonster()),window.guide&&window.guide.close())},initTouchEvents:function(){this.bg.node.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this);for(var e=0;e<4;e++)this.doors[e]&&this.doors[e].node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this);this.btnTreasure.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnCamp.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnNpc.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnShop.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnTavern.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnTreasure.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnCamp.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnNpc.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnShop.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnTavern.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this)},touchEvent:function(e){var t=e.touch._startPoint,i=e.touch._point.sub(t);if(this.abled&&i.mag()>60){var c=0;c=Math.abs(i.x)>Math.abs(i.y)?i.x>0?1:3:i.y>0?0:2;for(var o=0;o<4;o++)if(this.doors[o]&&this.doors[o].index==c){this.doors[o].btn.interactable&&this.doors[o].onEvent();break}}},initAlter:function(){if(2==c.data.roomType)if(this.btnCamp.active=!0,c.data.floorBeats[c.data.floor-1])this.crystal.active=!1,this.crystalBase.active=!1,this.crystalShadow.active=!1,this.starNode.active=!1;else{this.crystal.active=!0,this.crystal.runAction(cc.sequence(cc.moveBy(.7,cc.v2(0,25)),cc.moveBy(.7,cc.v2(0,-25))).repeatForever()),this.crystalShadow.runAction(cc.sequence(cc.moveBy(.7,cc.v2(0,-25)),cc.moveBy(.7,cc.v2(0,25))).repeatForever());for(var e=0;e<30;e++){var t=cc.instantiate(this.star);t.x=250*Math.random()-125;var i=Math.sqrt(Math.pow(125,2)-Math.pow(t.x,2));t.y=Math.random()*i*2-i,t.opacity=255*Math.random(),this.starNode.addChild(t);var o=3*Math.random()+.5;t.runAction(cc.sequence(cc.fadeIn(o),cc.fadeOut(o)).repeatForever())}}else 3==c.data.roomType?(this.btnTreasure.active=!0,this.btnTreasure.zIndex=10,c.data.floorBeats[c.data.floor-1]?(this.imageBox.node.y=-75,this.imageBox.node.scale=1,this.imageBox.node.stopAllActions(),cc.loader.loadRes("Texture/map/alter/treasure2",cc.SpriteFrame,function(e,t){this.imageBox.spriteFrame=t}.bind(this))):this.imageBox.node.runAction(cc.sequence(cc.delayTime(.8),cc.scaleTo(.05,1.1,.9),cc.spawn(cc.scaleTo(.25,.95,1.05),cc.moveBy(.25,cc.v2(0,30))),cc.spawn(cc.scaleTo(.25,1.1,.9),cc.moveBy(.25,cc.v2(0,-30))),cc.scaleTo(.05,1,1)).repeatForever())):4==c.data.roomType?(this.btnNpc.active=!0,this.btnNpc.zIndex=10,c.data.floorBeats[c.data.floor-1]&&cc.loader.loadRes("Texture/map/alter/book2",cc.SpriteFrame,function(e,t){this.npcFigure.spriteFrame=t}.bind(this))):5==c.data.roomType?(this.btnShop.active=!0,this.btnShop.zIndex=10,this.shopKeeper[0].runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0)).repeatForever()),this.shopKeeper[1].runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0)).repeatForever())):6==c.data.roomType&&(this.btnTavern.active=!0,this.btnTavern.zIndex=10,this.tavernKeeper[0].runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0)).repeatForever()),this.tavernKeeper[1].runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0)).repeatForever()),c.data.guide>0&&c.data.guide<20?c.data.guide=20:24==c.data.guide&&window.homeLayer.showGuide(24))},openAlter:function(){5!=c.data.roomType&&c.data.floorBeats[c.data.floor-1]?6!=c.data.roomType||this.boxTip.active||(this.boxTip.active=!0,this.boxTip.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){this.boxTip.active=!1}.bind(this))))):window.homeLayer.openAlter()},ready:function(e){this.abled=!0;for(var t=0;t<4;t++)this.doors[t]&&t!=this.pos&&this.doors[t].open(!0);c.saveData()},goBattle:function(){window.homeLayer.goBattle(),window.guide&&window.guide.close()},checkEquip:function(){3==c.data.roomType&&c.data.equip.indexOf(42)>=0&&c.updateCopper(50)},initFloorConfig:function(){if(c.data.historyPath[c.data.floor-1]&&c.data.historyPath[c.data.floor-1].indexOf(-2)==this.pos)this.typeList=c.data.historyPath[c.data.floor-1];else{var e=c.data.floorQuests[c.data.castle-1][c.data.floor-1].concat();if(1==e.length)this.typeList=[-1,-1,-1,-1],c.begin||(this.typeList[this.pos]=-2),this.typeList[(this.pos+2)%4]=e[0];else{for(;e.length<3;)e.splice(Math.floor(Math.random()*(e.length+1)),0,-1);e.splice(this.pos,0,-2),this.typeList=e}c.data.historyPath[c.data.floor-1]=this.typeList,5==c.data.roomType&&this.initShopCfg()}},initShopCfg:function(e){var t=[0,0,0];if(e)for(var i=0;i<3;i++){var o=c.data.shopIds[i+6];o&&o<0&&(t[i]=-o)}c.data.shopIds=[];for(var a=[],n=[],s=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];a.length<3;){for(var r=0,h=Math.random(),d=0,l=0;l<3;l++)if(h<(d+=s[c.data.castle-1][l])){r=l+1;break}for(var u=c.getNewCardId(r),f=!1,p=0;p<a.length;p++)if(u==a[p]){f=!0;break}f||a.push(u)}for(s=[[.4,.3,.3],[.3,.4,.3],[.2,.4,.4]];n.length<3;){for(var m=0,g=Math.random(),y=0,v=0;v<3;v++)if(g<(y+=s[c.data.castle-1][v])){m=v+1;break}for(var w=c.getNewItemId(1,m),b=!1,C=0;C<n.length;C++)if(w==n[C]){b=!0;break}b||n.push(w)}c.data.shopIds=a.concat(n,t)},checkMonster:function(){if(c.data.monsterList[c.data.floor-1]||(c.data.monsterList[c.data.floor-1]=[0,0,0,0]),!c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]){var e=2*(c.data.castle-1)+(c.data.floor<=6?1:2),t=7==c.data.roomType?1:8==c.data.roomType?2:0;4==c.data.castle&&(t=3),c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]=c.getNewMonsterId(e,t)}return c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]},initMap:function(){var e=this;cc.loader.loadRes("Texture/scene/map"+c.data.castle,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this));var t=[null,null,"camp","treasure","event","shop","tavern"][c.data.roomType];cc.loader.loadRes("Texture/map/floor/"+(t||"castle"+c.data.castle),cc.SpriteFrame,function(e,t){this.circle.spriteFrame=t}.bind(this)),t||cc.loader.loadRes("Texture/map/floor/carpet"+c.data.castle+(4==c.data.castle?"":Math.floor(3*Math.random()+1)),cc.SpriteFrame,function(e,t){this.carpet.spriteFrame=t}.bind(this));for(var i=0;i<4;i++)for(var o=0;o<5;){var a=0;a=i%2==0?155*-Math.random()-220:155*Math.random()+220;var n=0,s=cc.winSize.height/cc.winSize.width*750;n=i<2?Math.random()*(s/2-130)+130:-Math.random()*(s/2-130)-130,cc.v2(a,n).mag()>=410&&function(){var t=cc.instantiate(e.decoration);t.scaleX=Math.random()<.5?1:-1,t.position=cc.v2(a,n),e.bg.node.addChild(t),o++,cc.loader.loadRes("Texture/map/decoration/"+Math.floor(29*Math.random()+1),cc.SpriteFrame,function(e,i){t&&(t.getComponent(cc.Sprite).spriteFrame=i)}.bind(e))}()}}}),cc._RF.pop()},{Game:"Game"}],SettleBoard:[function(e,t,i){"use strict";cc._RF.push(t,"7d135XUjf5JtqfAq8hhMcbl","SettleBoard");var c=e("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,txtName:cc.Label,txtCount:cc.Label,mark:cc.Sprite,mask:cc.Node,nail:cc.Node},init:function(e,t){this.type=e,this.value=t;this.title.color=cc.Color.WHITE.fromHEX(["#ED9E21","#21C151","#FF413A","#FF413A","#50668f","#50668f","#50668f","#50668f"][e-1]);this.txtName.string=["\u83b7\u5f97\u91d1\u5e01","\u83b7\u5f97\u7ecf\u9a8c","\u751f\u547d\u56de\u590d","\u989d\u5916\u751f\u547d","\u5931\u53bb\u91d1\u5e01","\u5931\u53bb\u751f\u547d","\u751f\u547d\u6700\u5927\u503c","\u6028\u5ff5"][e-1],cc.loader.loadRes("Texture/UI/yahtzee/reward"+e,cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)),t>=0?this.txtCount.string=(e<=4?"+":"-")+this.value:(1==e?(this.value=c.data.copper,this.txtCount.string="\u91d1\u5e01\u6570\u91cf\u7ffb\u500d"):3==e?-1==t?(this.value=c.data.hpMax,this.txtCount.string="\u56de\u590d\u5168\u90e8\u751f\u547d"):-2==t&&(this.value=Math.floor(.3*c.data.hpMax),this.txtCount.string="\u56de\u590d30%\u6700\u5927\u751f\u547d"):5==e?(this.value=Math.floor(c.data.copper/2),this.txtCount.string="\u91d1\u5e01\u6570\u91cf\u51cf\u534a"):6==e&&(this.value=Math.floor(.3*c.data.hpMax),this.txtCount.string="30%\u6700\u5927\u751f\u547d"),8==e&&(this.txtCount.string="\u6218\u6597\u5f00\u59cb\u65f6\u751f\u547d-3")),this.getReward()},runOut:function(e,t){this.mask.active=!0,this.node.opacity=0,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*t),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,e),cc.scaleTo(.2,1)),cc.callFunc(function(){this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},getReward:function(){if(1==this.type)c.updateCopper(this.value);else if(2==this.type){c.data.exp+=this.value;var e=[5,15,21,39,47,73,150][c.data.level-1];c.data.exp>=e&&(c.data.exp-=e,c.data.level++,c.data.hpMax+=10,c.data.hp=window.mainLayer.hero.hp=c.data.hpMax,c.data.levelUp=!0)}else 3==this.type?c.data.hp=Math.min(c.data.hp+this.value,c.data.hpMax):4==this.type?(c.data.hpMax+=this.value,c.data.hp+=this.value):5==this.type?c.updateCopper(-this.value):6==this.type?c.data.hp-=this.value:7==this.type?(c.data.hpMax-=this.value,c.data.hp=Math.min(c.data.hp,c.data.hpMax)):8==this.type&&c.data.debuff++}}),cc._RF.pop()},{Game:"Game"}],SettleCard:[function(e,t,i){"use strict";cc._RF.push(t,"30a7fQ+EPRM5ZqgNv4W+srK","SettleCard");var c=e("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,txtName:cc.Label,txtCount:cc.Label,mark:cc.Sprite,mask:cc.Node,numNode:cc.Node,strip:cc.ProgressBar,bar:cc.Node,txtNum:cc.Label,copperNode:cc.Node,txtCopper:cc.Label},init:function(e,t){this.type=e,this.value=t;this.title.color=cc.Color.WHITE.fromHEX(["#ED9E21","#21C151","#FF413A"][e-1]);this.txtName.string=["\u91d1 \u5e01","\u7ecf \u9a8c","\u751f\u547d\u56de\u590d"][e-1],cc.loader.loadRes("Texture/UI/yahtzee/reward"+e,cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)),this.txtCount.string="+"+this.value},runOut:function(e,t){this.mask.active=!0,this.node.opacity=0,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*t),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,e),cc.scaleTo(.2,1)),cc.callFunc(function(){this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},showStrip:function(){if(1==this.type)this.copperNode.active=!0,this.txtCopper.string=c.data.copper,this.copper=c.data.copper,this.getReward();else{if(this.strip.node.active=!0,this.bar.color=2==this.type?cc.color(0,247,98):cc.color(255,56,49),2==this.type){var e=[5,15,21,39,47,73,150][c.data.level-1];this.strip.progress=c.data.exp/e,this.txtNum.string=c.data.exp+"/"+e,this.exp=c.data.exp,this.expMax=e}else this.strip.progress=c.data.hp/c.data.hpMax,this.txtNum.string=c.data.hp+"/"+c.data.hpMax,this.hp=c.data.hp;if(this.getReward(),this.overload=0,2==this.type){e=[5,15,21,39,47,73,150][c.data.level-1];this.targetProgress=c.data.exp/e,this.targetProgress<this.strip.progress&&this.overload++}else this.targetProgress=c.data.hp/c.data.hpMax}this.numNode.opacity=0,this.numNode.y-=50,this.numNode.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))),cc.callFunc(function(){this.schedule(this.updateProgress,0),this.schedule(this.updateNum,1/30)}.bind(this))))},getReward:function(){if(1==this.type)c.updateCopper(this.value);else if(2==this.type){c.data.exp+=this.value;var e=[5,15,21,39,47,73,150][c.data.level-1];c.data.exp>=e&&(c.data.exp-=e,c.data.level++,c.data.hpMax+=10,c.data.hp=window.mainLayer.hero.hp=c.data.hpMax,c.data.levelUp=!0)}else 3==this.type?c.data.hp=Math.min(c.data.hp+this.value,c.data.hpMax):4==this.type&&(c.data.hpMax+=this.value,c.data.hp+=this.value)},updateNum:function(){if(1==this.type)this.copper<c.data.copper&&(this.copper++,this.txtCopper.string=this.copper);else if(2==this.type){var e=[5,15,21,39,47,73,150][c.data.level-1];(this.expMax<e||this.exp<c.data.exp)&&(this.exp++,this.txtNum.string=this.exp+"/"+this.expMax,this.exp>=this.expMax&&(this.exp=0,this.expMax=e))}},updateProgress:function(){this.type>1&&(this.overload>0||this.strip.progress<this.targetProgress)&&(this.strip.progress+=.01,this.strip.progress>=1&&2==this.type&&(this.strip.progress=0,this.overload--,this.txtNum.string=this.exp+"/"+this.expMax))}}),cc._RF.pop()},{Game:"Game"}],ShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"47158KpbiJMF46lKbQmGdRL","ShopItem");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,txtCost:cc.Label,boxDiscount:cc.Node,txtDiscount:cc.Label,iconNode:cc.Node,markDelete:cc.Node,markPotion:cc.Node,markRrefresh:cc.Node,txtPotion:cc.Label},init:function(e,t,i){this.cfgId=e,this.type=t;var a=void 0;if(0==t)(a=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),this.cost=3*o.get("cfg_card",e).value,a.y=8;else if(1==t)(a=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(e),this.cost=6*o.get("cfg_item",e).value,a.y=30;else if(2==t)if(this.markPotion.active=!0,c.data.hp>=c.data.hpMax)this.txtPotion.string="\u751f\u547d\u5df2\u6ee1",this.cost=0;else{var n=c.data.hpMax-c.data.hp;this.cost=Math.min(2*n,2*Math.floor(c.data.copper/2))}else 3==t?(this.markRrefresh.active=!0,this.cost=30*(e+1)):4==t&&(this.markDelete.active=!0,this.cost=50*(e+1));a&&(this.iconNode.addChild(a),this.item=a),i&&(this.boxDiscount.active=!0,0==t?(this.cost=Math.ceil(.5*this.cost),this.txtDiscount.string="5\u6298"):(this.boxDiscount.y+=50,this.cost=Math.ceil(.7*this.cost),this.txtDiscount.string="7\u6298"),this.txtCost.node.color=cc.Color.BLACK.fromHEX("#3EFFE6"),this.txtCost.getComponent(cc.LabelOutline).color=cc.Color.BLACK.fromHEX("#3EFFE6")),this.txtCost.string=this.cost,this.refreshCostColor()},buy:function(){if(c.data.copper>=this.cost&&this.cost>0){if(c.updateCopper(-this.cost),0==this.type?window.homeLayer.getCard(this.cfgId):1==this.type?c.getItem(this.cfgId):2==this.type?c.data.hp+=this.cost/2:3==this.type?window.shopLayer.refreshItem():4==this.type&&window.homeLayer.openDelete(),this.type<2){var e=c.data.shopIds.indexOf(this.cfgId,3*this.type);c.data.shopIds[e]=0}else{e=4+this.type;c.data.shopIds[e]=-(c.data.shopIds[e]+1)}this.node.destroy(),window.homeLayer.refreshHeroData(),cc.audioEngine.playEffect(window.sound.buy);e=window.shopLayer.shopItems.indexOf(this);window.shopLayer.shopItems.splice(e,1);for(var t=0;t<window.shopLayer.shopItems.length;t++)window.shopLayer.shopItems[t].refreshCostColor()}else this.iconNode.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound)},refreshCostColor:function(){(c.data.copper<this.cost||this.cost<=0)&&(this.txtCost.node.color=this.txtCost.getComponent(cc.LabelOutline).color=cc.Color.BLACK.fromHEX("#F72837"))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(e,t,i){"use strict";cc._RF.push(t,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{boxs:[cc.Node],shopItemPrefab:cc.Prefab,curtain:cc.Node,title:cc.Node},onLoad:function(){window.shopLayer=this,this.shopItems=[],this.initCards(),this.initEquip(),this.initOthers(),this.curtain.runAction(cc.moveTo(.15,cc.v2(0,-17))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.moveTo(.25,cc.v2(9,-35)))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.skewTo(.2,2,0),cc.skewTo(.2,-2,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,0,0))),cc.audioEngine.playEffect(window.sound.shopOpen)},initCards:function(){for(var e=0;e<3;e++){var t=c.data.shopIds[e];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,0,c.data.itemEffect.vip2),i.position=cc.v2(e%3*245-245,0),this.boxs[0].addChild(i),this.shopItems.push(i.getComponent("ShopItem"))}}this.boxs[0].x=-750,this.boxs[0].y+=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[0].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0))))},initEquip:function(){for(var e=0;e<3;e++){var t=c.data.shopIds[e+3];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,1,c.data.itemEffect.vip1),i.position=cc.v2(e%3*245-245,0),this.boxs[1].addChild(i),this.shopItems.push(i.getComponent("ShopItem"))}}this.boxs[1].x=750,this.boxs[1].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0))))},initOthers:function(){var e=c.data.shopIds[6];if(e>=0){var t=cc.instantiate(this.shopItemPrefab);t.getComponent("ShopItem").init(e,2),t.position=cc.v2(-245,0),this.boxs[2].addChild(t),this.shopItems.push(t.getComponent("ShopItem"))}if(4==c.data.heroId){var i=c.data.shopIds[8];if(i>=0){var o=cc.instantiate(this.shopItemPrefab);o.getComponent("ShopItem").init(i,4),this.boxs[2].addChild(o),this.shopItems.push(o.getComponent("ShopItem"))}}var a=c.data.shopIds[7];if(a>=0){var n=cc.instantiate(this.shopItemPrefab);n.getComponent("ShopItem").init(a,3),n.position=cc.v2(4==c.data.heroId?245:0,0),this.boxs[2].addChild(n),this.shopItems.push(n.getComponent("ShopItem"))}this.boxs[2].x=-750,this.boxs[2].y-=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[2].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.2,cc.v2(750,0))))},close:function(){this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0)))),this.boxs[0].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0)))),this.title.runAction(cc.moveTo(.2,cc.v2(9,230))),this.curtain.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.1,cc.v2(0,43)))),this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4),window.shopLayer=null,window.room.ready(),cc.audioEngine.playEffect(window.sound.shopClose)},refreshItem:function(){this.boxs[0].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.moveBy(.2,cc.v2(750,0))),this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.scheduleOnce(function(){for(var e=0;e<this.shopItems.length;e++)this.shopItems[e].node.destroy();this.shopItems=[],window.room.initShopCfg(!0),this.initCards(),this.initEquip(),this.initOthers()}.bind(this),.2)}}),cc._RF.pop()},{Game:"Game"}],SkillManager:[function(e,t,i){"use strict";cc._RF.push(t,"f9b8a6FzCFFt4zg92Jc9Ljj","SkillManager");var c=e("Game"),o={doCast:function(e){var t=window.mainLayer.hero,i=window.mainLayer.enemy;if(1==c.data.heroId)0==e?i.onHurt(5,4):1==e&&t.buff.addBuff(107,1);else if(2==c.data.heroId){if(0==e){for(var o=[],a=t.player.cardList.length-1;a>=0;a--){var n=t.player.cardList[a].getComponent("Card");n.unCost||n.isCopy||n.silence||o.push(a)}if(o.length>0){var s=Math.floor(o.length*Math.random());t.player.cardList[o[s]].getComponent("Card").disCost(),o.splice(s,1)}t.player.checkCardsRequire()}else if(1==e)for(var r=t.player.cardList.length,h=0;h<6-r;h++)t.player.patchCard()}else if(3==c.data.heroId){if(0==e)t.player.rollCount++,t.player.roll();else if(1==e)for(var d=0;d<6;d++)t.player.elementList[d]>0&&i.buff.addBuff(21+d,t.player.elementList[d])}else if(4==c.data.heroId){if(0==e){for(var l=t.player.cardList.length,u=[],f=l-1;f>=0;f--){var p=t.player.cardList[f].getComponent("Card");u.push(p.cfgId),p.discard(!0)}for(var m=Math.min(t.player.deckArray.length,l),g=0;g<m;g++)t.player.suppleCard();for(var y=0;y<u.length;y++)t.player.deckArray.push(u[y]);if(t.player.deckArray.sort(function(){return.5-Math.random()}),m<l)for(var v=0;v<l-m;v++)t.player.suppleCard();t.scheduleOnce(function(){window.mainLayer.hero.checkBtnRoll(!0)},.3)}else if(1==e){for(var w=0;w<2;w++)t.player.createExDice();window.mainLayer.hero.checkBtnRoll(!0)}}else if(5==c.data.heroId)if(0==e)t.player.createExDice();else if(1==e){for(var b=t.player.cardList.length-1;b>=0;b--)t.player.cardList[b].getComponent("Card").discard();t.player.cardList=[],t.player.createChest(!0)}}};t.exports=o,cc._RF.pop()},{Game:"Game"}],Skill:[function(e,t,i){"use strict";cc._RF.push(t,"84424zovvVHiZ6bvX7VE49L","Skill");var c=e("Game"),o=e("SkillManager");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,btn:cc.Button,mask:cc.Node},init:function(e){this.index=e,this.unlock=!0,this.abled=!0,this.cost=10*(e+1),1==e&&c.data.level<3&&(this.unlock=!1),this.unlock?cc.loader.loadRes("Texture/hero/skill/"+(2*c.data.heroId-1+e),cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)):cc.loader.loadRes("Texture/battle/mark_skill",cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),this.check()},check:function(){window.mainLayer.gameOver?this.btn.interactable=!1:this.unlock?177==window.mainLayer.enemy.equipList[0]?this.btn.interactable=!1:this.abled&&window.mainLayer.hero.power>=this.cost?this.btn.interactable=!0:this.btn.interactable=!1:this.btn.interactable=!1,this.btn.interactable?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=this.unlock)},doSkill:function(){c.data.guide>0&&c.data.guide<12||0==window.mainLayer.roundId&&(this.abled=!1,window.mainLayer.hero.addPower(-this.cost),o.doCast(this.index),window.guide&&(window.guide.close(),c.data.guide=13))}}),cc._RF.pop()},{Game:"Game",SkillManager:"SkillManager"}],Sound:[function(e,t,i){"use strict";cc._RF.push(t,"77726IJdzpF843mufBZFnYQ","Sound"),cc.Class({extends:cc.Component,properties:{btn1:{type:cc.AudioClip,default:null},btn2:{type:cc.AudioClip,default:null},btnStart:{type:cc.AudioClip,default:null},selectSound:{type:cc.AudioClip,default:null},levelUpSound:{type:cc.AudioClip,default:null},endRound:{type:cc.AudioClip,default:null},copperSound:{type:cc.AudioClip,default:null},blackSound:{type:cc.AudioClip,default:null},delete:{type:cc.AudioClip,default:null},shopOpen:{type:cc.AudioClip,default:null},shopClose:{type:cc.AudioClip,default:null},buy:{type:cc.AudioClip,default:null},skySound:{type:cc.AudioClip,default:null},coverSound:{type:cc.AudioClip,default:null},bookSound:{type:cc.AudioClip,default:null},finger:{type:cc.AudioClip,default:null},bookOpen:{type:cc.AudioClip,default:null},paper:{type:cc.AudioClip,default:null},paper2:{type:cc.AudioClip,default:null},fireSound:{type:cc.AudioClip,default:null},iceSound:{type:cc.AudioClip,default:null},windSound:{type:cc.AudioClip,default:null},earthSound:{type:cc.AudioClip,default:null},lightSound:{type:cc.AudioClip,default:null},darkSound:{type:cc.AudioClip,default:null},atkSound:{type:cc.AudioClip,default:null},armorSound:{type:cc.AudioClip,default:null},healSound:{type:cc.AudioClip,default:null},dodgeSound:{type:cc.AudioClip,default:null},frailSound:{type:cc.AudioClip,default:null},weakSound:{type:cc.AudioClip,default:null},silenceSound:{type:cc.AudioClip,default:null},poisonSound:{type:cc.AudioClip,default:null},curseSound:{type:cc.AudioClip,default:null},lockSound:{type:cc.AudioClip,default:null},blindSound:{type:cc.AudioClip,default:null},reviveSound:{type:cc.AudioClip,default:null},undeadSound:{type:cc.AudioClip,default:null},burnSound:{type:cc.AudioClip,default:null},counterSound:{type:cc.AudioClip,default:null},errorSound:{type:cc.AudioClip,default:null},discardSound:{type:cc.AudioClip,default:null},missSound:{type:cc.AudioClip,default:null},bagOpenSound:{type:cc.AudioClip,default:null},bagCloseSound:{type:cc.AudioClip,default:null},rollSound:{type:cc.AudioClip,default:null},rollSound2:{type:cc.AudioClip,default:null},holdSound:{type:cc.AudioClip,default:null},drawSound:{type:cc.AudioClip,default:null},treasureSound:{type:cc.AudioClip,default:null},win:{type:cc.AudioClip,default:null},reward:{type:cc.AudioClip,default:null},lose:{type:cc.AudioClip,default:null},bingo:{type:cc.AudioClip,default:null},end:{type:cc.AudioClip,default:null},cheer:{type:cc.AudioClip,default:null},bgmTavetn:{type:cc.AudioClip,default:null},bgmPrepare:{type:cc.AudioClip,default:null},bgmYahtzee:{type:cc.AudioClip,default:null},bgmMap:{type:[cc.AudioClip],default:[]},bgmBattle:{type:[cc.AudioClip],default:[]},bgmBoss:{type:[cc.AudioClip],default:[]},bgmBossBig:{type:cc.AudioClip,default:null},bgmComplete:{type:cc.AudioClip,default:null},monsterSound:{type:[cc.AudioClip],default:[]},wolfSound:{type:cc.AudioClip,default:null}}}),cc._RF.pop()},{}],TavernLayer:[function(e,t,i){"use strict";cc._RF.push(t,"f73f9BbTilOdoWM2Ad26x3Z","TavernLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{cover:cc.Node,arms:[cc.Node],hands:[cc.Node],figure:cc.Node,pipe:cc.Node,mouth:cc.Node,fire:cc.Node,smoke:dragonBones.ArmatureDisplay,btnEnd:cc.Node,dialog:cc.Node,txtDialog:cc.Label,endPrefab:cc.Prefab,mask:cc.Node,stripHp:cc.ProgressBar,txtHp:cc.Label,stripEnergy:cc.ProgressBar,txtEnergy:cc.Label,txtCopper:cc.Label,btnSkills:[cc.Button],maskSkills:[cc.Node],iconSkills:[cc.Button],numSkills:[cc.Node],labelSkills:[cc.Node],soundPrefab:cc.Prefab,guidePrefab:cc.Prefab},onLoad:function(){window.tavernLayer=this,this.gameOver=!0,this.mask.active=!0,this.mask.zIndex=1e3,this.doMask(),this.doStart(),this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax,this.txtCopper.string=c.data.copper;var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmTavetn,!0)},doStart:function(){for(var e=0;e<2;e++)this.arms[e].y+=70,this.hands[e].y+=70,this.arms[e].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.4,cc.v2(0,-70)))),this.hands[e].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.4,cc.v2(0,-70))));this.cover.runAction(cc.sequence(cc.delayTime(1),cc.moveBy(.3,cc.v2(0,-480)))),this.btnEnd.runAction(cc.sequence(cc.delayTime(1),cc.moveBy(.15,cc.v2(0,45)),cc.callFunc(function(){this.gameOver=!1}.bind(this)))),this.figure.runAction(cc.sequence(cc.scaleTo(.4,.997,1.003),cc.scaleTo(.8,1.003,.997),cc.scaleTo(.3,1,1)).repeatForever()),this.mouth.runAction(cc.sequence(cc.delayTime(3),cc.moveBy(.15,cc.v2(0,10)),cc.moveBy(.15,cc.v2(0,-10)),cc.delayTime(.5)).repeatForever()),this.pipe.runAction(cc.sequence(cc.delayTime(3),cc.rotateBy(.2,-5),cc.rotateBy(.4,10),cc.rotateBy(.2,-5)).repeatForever()),this.fire.runAction(cc.sequence(cc.delayTime(3.2),cc.fadeIn(.3),cc.fadeOut(.3),cc.delayTime(3.8)).repeatForever()),this.smoke.node.runAction(cc.sequence(cc.delayTime(7),cc.callFunc(function(){this.smoke.playAnimation("play0",1)}.bind(this)),cc.delayTime(.6)).repeatForever())},doSkill:function(e,t){if(!this.gameOver){0==t?window.player.addRollCount():1==t&&window.player.changeAllCards(),this.stripEnergy.progress=0,this.txtEnergy.string="0/10";for(var i=0;i<2;i++)this.btnSkills[i].interactable=!1,this.maskSkills[i].active=!0,this.iconSkills[i].enableAutoGrayEffect=!0,this.numSkills[i].active=!1,this.labelSkills[i].color=cc.Color.WHITE.fromHEX("#3f2331")}},showEnd:function(e){var t=cc.instantiate(this.endPrefab);t.getComponent("EndTavernLayer").init(e),this.node.addChild(t)},checkRewards:function(){if(!this.gameOver){this.gameOver=!0,this.cover.runAction(cc.moveBy(.3,cc.v2(0,480))),this.btnEnd.runAction(cc.moveBy(.15,cc.v2(0,-45))),this.dialog.active=!0,this.dialog.scale=0,this.dialog.runAction(cc.scaleTo(.2,1)),this.txtDialog.node.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(.2)));var e=window.player.checkRewards();this.scheduleOnce(function(){this.showEnd(e)}.bind(this),1);this.txtDialog.string=["\u4e0b\u6b21\u518d\u6765","\u4e0d\u7b97\u592a\u5dee","\u8868\u73b0\u4e0d\u9519\uff01","\u592a\u5389\u5bb3\u4e86\uff01","\u5e74\u5ea6\u6700\u4f73\uff01","\u4e0d\u53ef\u601d\u8bae\uff01\uff01","\u5e78\u8fd0\u4e4b\u795e\uff01\uff01"][e.length],c.data.highRecord[3]=Math.max(c.data.highRecord[3],e.length)}},doMask:function(){var e;c.maskElement?(e=c.maskElement,c.maskElement=null):e=Math.floor(6*Math.random())+1;var t=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254)];this.mask.getChildren()[0].color=t[e-1],cc.loader.loadRes("Texture/UI/mask_element"+e,cc.SpriteFrame,function(e,t){this.mask.getComponent(cc.Mask).spriteFrame=t,this.schedule(this.updateMask,0)}.bind(this))},updateMask:function(){this.mask.width+=120,this.mask.height+=120,this.mask.width>=3e3&&this.mask.height>=3e3&&(this.unschedule(this.updateMask),this.mask.active=!1)},showGuide:function(e){this.scheduleOnce(function(){if(!window.guide){var t=cc.instantiate(this.guidePrefab);t.getComponent("Guide").init(e),this.node.addChild(t)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],TreasureChest:[function(e,t,i){"use strict";cc._RF.push(t,"6533fKzUy5Bxpam9JTZSSr8","TreasureChest");var c=e("Game");cc.Class({extends:cc.Component,properties:{top:cc.Node,bottom:cc.Node,light:cc.Node,animation:dragonBones.ArmatureDisplay,settleCardPrefab:cc.Prefab,settleBoardPrefab:cc.Prefab,rewardNode:cc.Node,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab},init:function(e){window.treasureChest=this,this.status=0},jumpIn:function(){this.node.scale=.4,this.node.runAction(cc.sequence(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.scaleTo(.2,.8,1.1)),cc.spawn(cc.moveBy(.2,cc.v2(0,-50)),cc.scaleTo(.2,1.02,.98)),cc.scaleTo(.05,1,1)))},open:function(){var e=this,t=0;if(1==this.status){for(var i=function(t){var i=e.settleList[t].node;i.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){i.destroy()}.bind(e))))},c=0;c<this.settleList.length;c++)i(c);this.top.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveTo(.1,cc.v2(4,13)),cc.scaleTo(.1,1)))),t=.3}this.node.runAction(cc.sequence(cc.delayTime(t),cc.scaleTo(.1,.8),cc.scaleTo(.1,1),cc.callFunc(function(){this.top.runAction(cc.spawn(cc.moveTo(.1,cc.v2(4,40)),cc.scaleTo(.1,1,.8))),this.light.active=!0,this.animation.playAnimation("play0",1),this.status=1}.bind(this))))},openReward:function(e){this.open(),this.scheduleOnce(function(){this.doReward(e),this.scheduleOnce(function(){for(var e=0;e<this.settleList.length;e++)this.settleList[e].showStrip()}.bind(this),.2*e.length)}.bind(this),.2)},doReward:function(e){var t=e.length;this.settleList=[];for(var i=0;i<t;i++){var c=cc.instantiate(this.settleCardPrefab);c.getComponent("SettleCard").init(e[i].type,e[i].value),c.position=cc.v2(t>2?120*i-120:120*i-60,50),this.rewardNode.addChild(c),c.getComponent("SettleCard").runOut(cc.v2(t>2?220*i-220:300*i-150,300),i),this.settleList.push(c.getComponent("SettleCard"))}},openCard:function(e,t){this.itemList=[];var i=0==this.status?.2:.5;this.open(),this.scheduleOnce(function(){this.itemList=[];for(var i=e.length,c=0;c<i;c++){var o=cc.instantiate(this.cardPrefab);o.getComponent("CardCollection").init(e[c],t?3:null),o.position=cc.v2(i>1?200*c-100:0,50),this.rewardNode.addChild(o),o.getComponent("CardCollection").runOut(cc.v2(i>1?320*c-160:0,300),c),this.itemList.push(o)}this.scheduleOnce(function(){for(var e=0;e<this.itemList.length;e++)t?this.itemList[e].getComponent("CardCollection").enableChoosen():this.itemList[e].getComponent("CardCollection").showTip()}.bind(this),.2*i+.2)}.bind(this),i)},chooseCard:function(e){this.getCard(e);for(var t=0,i=0;i<this.itemList.length;i++)if(e==this.itemList[i].getComponent("CardCollection").cfgId){t=i;break}var o=this.itemList[t],a=this.itemList[1-t];a.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){a.destroy()}.bind(this)))),o.runAction(cc.moveTo(.2,cc.v2(0,300))),9==c.data.guide&&(c.guideChoose=parseInt(t));for(var n=0;n<this.itemList.length;n++)this.itemList[n].getComponent("CardCollection").hideTip();window.endLayer.btnOut.active=!0,window.endLayer.btnOut.opacity=1,window.endLayer.btnOut.y-=50,window.endLayer.btnOut.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),cc.audioEngine.playEffect(window.sound.selectSound)},getCard:function(e){1==c.data.heroId&&3==c.data.difficulty?c.data.deck.length<6?c.getCard(e):window.endLayer.openCardChange(e):c.getCard(e)},openEquip:function(e,t){this.itemList=[];var i=0==this.status?.2:.5;this.open(),this.scheduleOnce(function(){this.itemList=[];for(var i=e.length,c=0;c<i;c++){var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(e[c],t),o.position=cc.v2(i>1?200*c-100:0,50),this.rewardNode.addChild(o),o.getComponent("ItemCommodity").runOut(cc.v2(i>1?320*c-160:0,300),c),this.itemList.push(o)}this.scheduleOnce(function(){for(var e=0;e<this.itemList.length;e++)t&&this.itemList[e].getComponent("ItemCommodity").enableChoosen()}.bind(this),.2*i+.2)}.bind(this),i)},chooseEquip:function(e){c.getItem(e);for(var t=0,i=0;i<this.itemList.length;i++)if(e==this.itemList[i].getComponent("ItemCommodity").cfgId){t=i;break}var o=this.itemList[t],a=this.itemList[1-t];a.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){a.destroy()}.bind(this)))),o.runAction(cc.moveTo(.2,cc.v2(0,300)));for(var n=0;n<this.itemList.length;n++)this.itemList[n].getComponent("ItemCommodity").txtChosen.runAction(cc.fadeOut(.2));window.endLayer.btnOut.active=!0,window.endLayer.btnOut.opacity=1,window.endLayer.btnOut.y-=50,window.endLayer.btnOut.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),cc.audioEngine.playEffect(window.sound.selectSound)},openBoard:function(e){var t=0==this.status?.2:.5;this.open(),this.scheduleOnce(function(){for(var t=e.length,i=0;i<t;i++){var c=cc.instantiate(this.settleBoardPrefab);c.getComponent("SettleBoard").init(e[i].type,e[i].value),c.position=cc.v2(t>1?200*i-100:0,50),this.rewardNode.addChild(c),c.getComponent("SettleBoard").runOut(cc.v2(t>1?320*i-160:0,300),i)}}.bind(this),t)}}),cc._RF.pop()},{Game:"Game"}],TreasureLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{treasurePrefab:cc.Prefab,btnGets:[cc.Node],btnClose:cc.Node,boxNode:cc.Node,btnNode:cc.Node,mask:cc.Node},init:function(){window.treasureLayer=this;for(var e=0,t=[[.6,.3,.1],[.4,.3,.3],[.2,.4,.4]],i=Math.random(),o=0,a=0;a<3;a++)if(i<(o+=t[c.data.castle-1][a])){e=a+1;break}5==c.data.roomType?e++:c.data.itemEffect.vase>0&&(c.data.itemEffect.vase--,e++),e=Math.min(e,3),this.cfgIdList=[];var n=1;c.data.itemEffect.flagon>0&&(c.data.itemEffect.flagon--,n=2);var s=c.getNewItemId(0,e);if(this.cfgIdList.push(s),2==n){for(var r=0;r<=0;){var h=c.getNewItemId(0,e);h!=s&&(r=h)}this.cfgIdList.push(r)}9==c.data.guide&&(this.cfgIdList=[180]),this.initItem(),this.btnNode.active=!1,this.scheduleOnce(function(){this.btnNode.active=!0,this.btnNode.opacity=10,this.btnNode.y-=150,this.btnNode.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))}.bind(this),.8)},initItem:function(){var e;(this.itemList=[],this.gotList=[],1==this.cfgIdList.length)?((e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),this.boxNode.addChild(e),this.itemList.push(e)):((e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),e.position=cc.v2(180,0),this.boxNode.addChild(e),this.itemList.push(e),(e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[1]),e.position=cc.v2(-180,0),this.boxNode.addChild(e),this.itemList.push(e),this.btnGets[1].active=!0,this.btnGets[0].position=cc.v2(180,30),this.btnClose.position=cc.v2(0,-100))},onGet:function(e,t){c.getItem(this.cfgIdList[t]),this.gotList.push(this.itemList[t]),this.btnGets[t].active=!1,this.gotList.length>=this.cfgIdList.length&&this.close()},onGiveUp:function(){this.close()},close:function(){c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.room.ready(),window.treasureLayer=null;for(var e=0;e<this.itemList.length;e++)this.itemList[e].opacity=1;if(this.gotList.length>0){this.mask.runAction(cc.fadeOut(.2)),this.btnNode.active=!1;for(var t=0;t<this.gotList.length;t++)this.gotList[t].getComponent("Treasure").got();this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4)}else this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Treasure:[function(e,t,i){"use strict";cc._RF.push(t,"ab4bd76AwVKk6GKzcwjcSfb","Treasure");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,icon:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,infoNode:cc.Node,mask:cc.Node,anmation:cc.Node},init:function(e){var t=o.get("cfg_item",e);this.txtName.string=t.name;this.txtName.node.color=cc.Color.BLACK.fromHEX(["#31BEFF","#B689FF","#FF7F18"][t.quality-1]),this.txtDesc.string=c.analysisDesc(t.desc1),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+t.quality,cc.SpriteFrame,function(e,t){this.boxIcon.spriteFrame=t}.bind(this)),this.doAction()},doAction:function(){this.mask.opacity=this.infoNode.opacity=this.boxIcon.node.opacity=1;var e=cc.spawn(cc.moveTo(.4,cc.v2(0,173)),cc.sequence(cc.scaleTo(.2,.8,1.1),cc.scaleTo(.2,1)));this.mask.runAction(cc.sequence(cc.delayTime(.5),cc.fadeIn(0),e,cc.fadeOut(.3))),this.boxIcon.node.runAction(cc.sequence(cc.delayTime(.9),cc.fadeIn(0))),this.infoNode.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.3))),cc.audioEngine.playEffect(window.sound.treasureSound)},got:function(){this.node.opacity=255,this.anmation.active=!1,this.infoNode.active=!1;var e=cc.winSize.height/cc.winSize.width*750;this.boxIcon.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveTo(.3,cc.v2(211-this.node.x,-e/2-80+115+33-70))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Utils:[function(e,t,i){"use strict";cc._RF.push(t,"85bfaYPayFNlrAFvtzNUMAc","Utils");var c={numberFormat:function(e){return e/1e13>=1?Math.floor(e/1e12)+"T":e/1e10>=1?Math.floor(e/1e9)+"B":e/1e7>=1?Math.floor(e/1e6)+"M":e/1e4>=1?Math.floor(e/1e3)+"K":e},timeFormat:function(e,t){var i=Math.round(e/1e3),c=i%60,o=t>1?Math.floor(i/60)%60:Math.floor(i/60),a=3==t?Math.floor(i/3600)%24:Math.floor(i/3600),n=Math.floor(i/86400),s=function(e){return e<10?"0"+e:e};return 1==t?s(o)+":"+s(c):2==t?s(a)+":"+s(o)+":"+s(c):n+"\u5929"+a+"\u65f6"+o+"\u5206"},getDifferentRandomNum:function(e,t,i){t=t||1,i=i||0;for(var c=[];c.length<e;){for(var o=Math.floor(Math.random()*(t-i+1))+i,a=!1,n=0;n<c.length;n++)if(c[n]-o==0){a=!0;break}a||c.push(o)}return c},createImage:function(e,t){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var e=new cc.Texture2D;e.initWithElement(i),e.handleLoadedTexture(),t.spriteFrame=new cc.SpriteFrame(e)}catch(e){cc.log(e),t.node.active=!1}},i.src=e}catch(e){cc.log(e),t.node.active=!1}else try{cc.loader.load({url:e,type:"jpg"},function(e,i){t.spriteFrame=new cc.SpriteFrame(i)})}catch(e){cc.log(e),t.node.active=!1}},substring:function(e,t){if(e.replace(/[\u4e00-\u9fa5]/g,"**").length<=t)return e;for(var i=0,c="",o=0;o<e.length&&(/[\u4e00-\u9fa5]/.test(e[o])?i+=2:i+=1,!(i>t));o++)c+=e[o];return c},getMd5Url:function(e){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(e)):cc.url.raw(e)},numToStr:function(e,t){t=t||1;for(var i=""+e,c=1;c<=t;c++)e<Math.pow(10,c)&&(i="0"+i);return i},getDirectionVector:function(e,t){return[cc.v2(0,1),cc.v2(1,0),cc.v2(0,-1),cc.v2(-1,0)][e].mul(t)}};t.exports=c,cc._RF.pop()},{}],Yahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee");var c=e("Game");cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label,boxDesc:cc.Node,soundPrefab:cc.Prefab,btnGuide:cc.Node,guide:cc.Node,mask:cc.Node,head:cc.Sprite,reelNode:cc.Node,reels:[cc.Node],content:cc.Node,hole:cc.Node,flag:cc.Sprite,txtFlag:cc.Label,crowns:[dragonBones.ArmatureDisplay]},onLoad:function(){window.yahtzeeLayer=this,this.descOpen=!0,cc.loader.loadRes("Texture/hero/head/"+c.data.heroId,cc.SpriteFrame,function(e,t){this.head.spriteFrame=t}.bind(this)),this.heroNode.rotation-=90,this.heroNode.y-=350,this.enemyNode.rotation+=90,this.enemyNode.y+=350;var e=cc.instantiate(this.soundPrefab);this.node.addChild(e),window.sound=e.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmYahtzee,!0)},start:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),this.btnGuide.active=!0,c.data.guide>0?this.openGuide():this.beginGame()},beginGame:function(){this.roundId=1,this.hostId=0,this.heroNode.runAction(cc.spawn(cc.moveBy(.3,cc.v2(0,350)),cc.rotateBy(.3,90))),this.enemyNode.runAction(cc.spawn(cc.moveBy(.3,cc.v2(0,-350)),cc.rotateBy(.3,-90))),this.doRound(),this.scheduleOnce(function(){this.openDesc()}.bind(this),1.2)},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,0==this.hostId?window.player.startRound():this.scheduleOnce(function(){this.reelNode.active=!0,this.reelNode.scale=.5,this.reelNode.y=-30,this.reels[1].runAction(cc.sequence(cc.scaleTo(.4,212/70,1),cc.delayTime(.5),cc.scaleTo(.4,1))),this.reels[0].runAction(cc.sequence(cc.moveBy(.4,cc.v2(-71,0)),cc.delayTime(.5),cc.moveBy(.4,cc.v2(71,0)))),this.reels[2].runAction(cc.sequence(cc.moveBy(.4,cc.v2(71,0)),cc.delayTime(.5),cc.moveBy(.4,cc.v2(-71,0)))),this.content.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(.2),cc.delayTime(.5),cc.fadeOut(.2))),this.reelNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(.8),cc.spawn(cc.scaleTo(.2,0),cc.moveBy(.2,cc.v2(0,-80))),cc.callFunc(function(){window.player.startRound()}.bind(this))))}.bind(this),.3)},endRound:function(){for(var e=0;e<5;e++){this.hero.diceList[e].runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,300)),cc.delayTime(1.8),cc.fadeOut(.2)))}for(var t=0;t<5;t++){this.enemy.diceList[t].runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-300)),cc.delayTime(1.8),cc.fadeOut(.2)))}this.result=0,this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.result=1:this.hero.score<this.enemy.score&&(this.result=-1);this.txtFlag.string=["\u5931\u8d25","\u5e73\u624b","\u83b7\u80dc"][this.result+1],cc.loader.loadRes("Texture/UI/yahtzee/flag"+(this.result<0?2:1),cc.SpriteFrame,function(e,t){this.flag.spriteFrame=t}.bind(this)),this.scheduleOnce(function(){this.hole.active=!0,this.hole.opacity=255,this.hole.runAction(cc.sequence(cc.scaleTo(0,.5,1),cc.scaleTo(.2,1),cc.delayTime(1.4),cc.fadeOut(.2))),this.flag.node.y+=400,this.flag.node.scaleX=.5,this.flag.node.runAction(cc.sequence(cc.spawn(cc.moveBy(.15,cc.v2(0,-400)),cc.scaleTo(.15,1.2,.8)),cc.scaleTo(.1,1,1)))}.bind(this),.5),this.scheduleOnce(function(){this.result>0?this.hero.doWin():this.result<0?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),.9),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2.5)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(e){var t=cc.instantiate(this.endPrefab);t.getComponent("EndYahtzeeLayer").init(e),this.node.addChild(t)},openDesc:function(){this.boxDesc.stopAllActions(),this.descOpen?(this.descOpen=!1,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-428,93)))):(this.descOpen=!0,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-279,93))))},openGuide:function(){this.mask.active=!0,this.mask.opacity=1,this.mask.runAction(cc.fadeTo(.2,180)),this.btnGuide.active=!1,this.guide.active=!0,this.guide.scale=.1,this.guide.rotation=-30,this.guide.position=this.btnGuide.position,this.guide.runAction(cc.spawn(cc.moveTo(.2,cc.v2(0,0)),cc.scaleTo(.2,1),cc.rotateTo(.2,0)))},closeGuide:function(){this.mask.runAction(cc.fadeOut(.2)),this.guide.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,this.btnGuide.position),cc.scaleTo(.2,.1),cc.rotateTo(.2,-30)),cc.callFunc(function(){this.guide.active=!1,this.mask.active=!1,this.btnGuide.active=!0,13==c.data.guide&&(c.data.guide++,this.beginGame())}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardBagMageLayer","CardChangeLayer","CardCollection","CardDeleteLayer","CardManager","CardTavern","Chess","Chest","ChooseDiceLayer","CompleteLayer","Config","Cover","Dice","DiceChoose","DiceTavern","DiceYahtzee","DmgAnimation","Door","Edit","EditEndLayer","EndLayer","EndTavernLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","Guide","HelloWorld","Hero","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerTavern","PlayerYahtzee","PrepareLayer","RequireRound","Reward","Room","SettleBoard","SettleCard","ShopItem","ShopLayer","Skill","SkillManager","Sound","TavernLayer","Treasure","TreasureChest","TreasureLayer","Utils","Yahtzee"]);