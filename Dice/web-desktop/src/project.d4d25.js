window.__require=function e(t,i,c){function o(n,r){if(!i[n]){if(!t[n]){var a=n.split("/");if(a=a[a.length-1],!t[a]){var h="function"==typeof __require&&__require;if(!r&&h)return h(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+n+"'")}}var d=i[n]={exports:{}};t[n][0].call(d.exports,function(e){return o(t[n][1][e]||e)},d,d.exports,e,t,i,c)}return i[n].exports}for(var s="function"==typeof __require&&__require,n=0;n<c.length;n++)o(c[n]);return o}({AIYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){var i=this.player.diceList[t].getComponent("DiceYahtzee");e[i.element-1]++}for(var c=-1,o=-1,s=0;s<6;s++)e[s]>(e[c]||0)&&(c=s);for(var n=0;n<6;n++)n!=c&&e[n]>(e[o]||0)&&(o=n);this.scheduleOnce(function(){e[c]>1?e[c]==e[o]?this.hold(c,o):this.hold(c):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(e,t){for(var i=0,c=0;c<5;c++){var o=this.player.diceList[c].getComponent("DiceYahtzee");o.holded?o.element!=e+1&&null!=t&&o.element!=t+1&&(o.doHold(),i++):(o.element==e+1||null!=t&&o.element==t+1)&&(o.doHold(),i++)}var s=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),s)}}),cc._RF.pop()},{}],AI:[function(e,t,i){"use strict";cc._RF.push(t,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy"),this.castList=[]},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var e=1,t=100,i=null,c=0;c<this.cards.length;c++){var o=this.cards[c].getComponent("Card");o.usable&&(o.cfg.priority<t||o.cfg.priority==t&&o.rate>e)&&(e=o.rate,t=o.cfg.priority,i=o)}i?i.cast():this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.8):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.6)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var e=[0,0,0,0,0,0],t=0;t<this.cards.length;t++){var i=this.cards[t].getComponent("Card");(m=i.require.split(";")).length>1&&e[m[0]-1]++;for(var c=["A","B","C","D","E","F"],o=0;o<6;o++)if(i.cfg.desc.indexOf(c[o])>=0){e[o]++;break}}for(var s=!1,n=0;n<6;n++)if(e[n]>0){s=!0;break}for(var r=[],a=0;a<this.cards.length;a++){var h=this.cards[a].getComponent("Card"),d=[0,0,0,0,0,0];if(h.require>=101&&h.require<=105){for(var l=0,f=0,p=0;p<6;p++)(!s||e[p]>0)&&this.player.elementList[p]>l&&(l=this.player.elementList[p],f=p+1);if(d=[-100,-100,-100,-100,-100,-100],l>=s||2){d[f-1]=[2,3,3,4,5][h.require-101]-l}}else{var u=[0,0,0,0,0,0];if(106==h.require||107==h.require)u=[1,1,1,1,1,1];else for(var m=h.require.split(";"),g=0;g<m.length;g++)u[m[g]-1]++;for(var v=["A","B","C","D","E","F"],y=0;y<6;y++){var w=u[y];h.cfg.desc.indexOf(v[y])>=0&&(w=this.player.elementList[y]+1),d[y]=w-this.player.elementList[y]}}r.push(d)}for(var b=100,C=0,x=0,L=1,k=0;k<r.length;k++){for(var q=r[k],I=0,T=0,B=0;B<q.length;B++)I+=q[B]<-10?0:Math.abs(q[B]),T+=q[B];(I<b||I==b&&T>C||I==b&&T==C&&this.cards[k].getComponent("Card").rate<L)&&(b=I,C=T,x=k,L=this.cards[k].getComponent("Card").rate)}for(var F=r[x],R=0;R<6;R++)if(0!=F[R]){var N=F[R]+this.player.elementList[R]-this.player.holdList[R];if(N>0)for(var M=0;M<this.dices.length;M++){var E=this.dices[M].getComponent("Dice");if(E.element==R+1&&!(E.holded||E.lock||E.freeze||E.temp)&&(E.hold(),0==--N))break}else if(N<0)for(var A=0;A<this.dices.length;A++){var D=this.dices[A].getComponent("Dice");if(D.element==R+1&&D.holded&&!D.lock&&!D.freeze&&!D.temp&&(D.hold(),0==++N))break}}this.player.roll();for(var P=!1,S=0;S<this.dices.length;S++){var H=this.dices[S].getComponent("Dice");if(!(H.holded||H.lock||H.freeze||H.temp)){P=!0;break}}this.scheduleOnce(function(){P?this.check():this.player.endRound()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var e=0;e<this.player.cardList.length;e++){var t=this.player.cardList[e].getComponent("Card");t.silence||t.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(t)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var c=this.player.diceList[i];c.lock||this.dices.push(c)}},insertAndCast:function(e){}}),cc._RF.pop()},{}],Buff:[function(e,t,i){"use strict";cc._RF.push(t,"76faa8y1jVIcqDL176r9ktK","Buff"),cc.Class({extends:cc.Component,properties:{buffBox:cc.Node,txtBuff:cc.RichText},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.multiCast=0,this.multiCastMax=0,this.selfHarmCast=0,this.selfHarmCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.burnIce=!1,this.silenceDark=!1,this.table={};for(var e=[13,21,22,23,24,25,26,27,28,101,102,103,104,105,106,107,108],t=0;t<e.length;t++)this.table[e[t]]=0;this.quote(),this.refreshBuff()},addBuff:function(e,t){if(!(t<=0)){if(13==e)this.player.anim.show(13);else if(e>=21&&e<=28){if(this.immunity>0)return this.removeBuff(105,1),this.player.equip.doTrigger(37),void this.player.assertHpChange("MISS",3);if(e<=26){if(this.opponent.equip.checkWithTrigger(e+10))t+=26==e?2:1;23==e&&this.opponent.equip.trigger(68)}this.player.anim.show(e)}this.table[e]+=t,this.quote();for(var i=!1,c=0;c<this.buffList.length;c++)if(this.buffList[c]==e){i=!0;break}i||this.buffList.push(e),this.refreshBuff()}},removeBuff:function(e,t){if(!(t<=0)){if(this.table[e]-=t,this.table[e]<=0){this.table[e]=0;var i=this.buffList.indexOf(e);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28],this.exRound=this.table[101],this.undead=this.table[102],this.atkBack=this.table[103],this.atkAdd=this.table[104],this.immunity=this.table[105],this.hurtReduce=this.table[106],this.doubleDmg=this.table[107],this.doubleCast=this.table[108]},refreshBuff:function(){var e="",t={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",101:"\u989d\u5916\u56de\u5408",102:"\u4e0d\u6b7b",103:"\u53cd\u4f24",104:"\u4f24\u5bb3\u63d0\u5347",105:"\u514d\u75ab",106:"\u53d7\u4f24\u964d\u4f4e",107:"\u53cc\u500d\u4f24\u5bb3",108:"\u91cd\u590d\u884c\u52a8"},i={13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",101:"FFF830",102:"FF5567",103:"FF5567",104:"FFF830",105:"42EBFF",106:"FF5567",107:"F15162",108:"E2BD6D"};if(1==this.buffList.length){var c=this.buffList[0];e+="<img src='"+this.getBuffImg(c)+"'/>",e+="<color="+i[c]+">"+t[c]+this.table[c]+"</c>"}else for(var o=0;o<this.buffList.length;o++){var s=this.buffList[o];e+="<img src='"+this.getBuffImg(s)+"'/>",e+="<color="+i[s]+">"+this.table[s]+"</c>  "}if(this.player.host.txtBuff.string=e,this.buffBox.active){e="";for(var n=0;n<this.buffList.length;n++){var r=this.buffList[n];e+="<img src='"+this.getBuffImg(r)+"'/>",e+="<color="+i[r]+">"+t[r]+this.table[r]+"</c>  ",(n+1)%3==0&&this.buffList.length>n+1&&(e+="\r\n")}this.txtBuff.string=e,this.buffBox.height=44+30*Math.floor((this.buffList.length-1)/3)}},getBuffImg:function(e){var t={13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",101:"exRound",102:"undead",103:"atkback",104:"atkAdd",105:"immunity",106:"hurtReduce",107:"doubleDmg",108:"doubleAction"}[e];if(23==e){var i=0;(this.opponent.equip.check(54)||this.opponent.equip.check(113)||this.player.equip.check(113))&&i++,this.player.equip.check(56)&&i--,i>0?t="frailPlus":i<0&&(t="frailMinus")}else 24==e&&this.opponent.equip.check(55)&&(t="weakPlus");return t},openBuffList:function(){if(!(this.buffList.length<=1)){if(window.mainLayer.buffTip){if(window.mainLayer.buffTip==this)return void this.hideTip();window.mainLayer.buffTip.hideTip()}this.buffBox.active=!0,this.refreshBuff(),window.mainLayer.buffTip=this,this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.buffBox.active=!1,window.mainLayer.buffTip=null}}),cc._RF.pop()},{}],CampLayer:[function(e,t,i){"use strict";cc._RF.push(t,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{txtHeal:cc.Label,txtCopper:cc.Label,btnHeal:cc.Node,btnCopper:cc.Node},onLoad:function(){var e=1;c.equip.indexOf(39)>=0&&(e+=.5),c.equip.indexOf(89)>=0&&(e-=.5),this.hp=Math.floor(.35*c.hpMax*e),this.copper=7*(c.castle+3),this.txtHeal.string="\u751f\u547d+"+this.hp,e>1?this.txtHeal.node.color=cc.color(255,230,62):e<1&&(this.txtHeal.node.color=cc.color(49,248,255)),this.txtCopper.string="\u91d1\u5e01+"+this.copper,this.btnHeal.opacity=0,this.btnCopper.opacity=0,this.btnHeal.y-=150,this.btnCopper.y-=150,this.btnHeal.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnCopper.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))},onHeal:function(){c.hp=Math.min(c.hp+this.hp,c.hpMax),this.close()},onCopper:function(){c.copper+=this.copper,this.close()},close:function(){this.node.destroy(),window.homeLayer.refreshHeroData(),c.floorBeats[c.floor-1]=!0,window.room.initAlter()}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,chestPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node,mask:cc.Node},onLoad:function(){window.bagLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var e=0;window.equipLayer?(e=.15,window.equipLayer.close()):window.mapLayer&&(e=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initDeck(),this.initBag(),c.newCard&&(c.newCard=!1,window.homeLayer.refreshHeroData())},initDeck:function(){this.deck=[];for(var e=2==c.heroId?2:3,t=0;t<c.deck.length;t++){var i=cc.instantiate(this.cardPrefab);i.getComponent("CardCollection").init(c.deck[t],0),i.position=cc.v2(t%e*247-247,104-210*Math.floor(t/e)),this.boxDeck.addChild(i),this.deck[t]=i}if(2==c.heroId){var o=cc.instantiate(this.chestPrefab);o.position=cc.v2(240,0),this.boxDeck.addChild(o)}},initBag:function(){c.cardBag.sort(function(e,t){return o.get("cfg_card",e).element==o.get("cfg_card",t).element?e-t:o.get("cfg_card",e).element-o.get("cfg_card",t).element}),this.bagList=[];for(var e=0;e<c.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(c.cardBag[e],1),t.position=cc.v2(e%3*247-247,-120-210*Math.floor(e/3)),this.content.addChild(t),this.bagList.push(t)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+530,this.content.height=Math.max(210*Math.ceil(c.cardBag.length/3)+20,this.contentHeight)},equip:function(e){for(var t=-1,i=2==c.heroId?4:6,o=0;o<i;o++)if(null==this.deck[o]){t=o;break}if(t>=0){e.parent=this.boxDeck;var s=2==c.heroId?2:3;e.position=cc.v2(t%s*247-247,104-210*Math.floor(t/s)),e.getComponent("CardCollection").colletType=0;var n=e.getComponent("CardCollection").cfgId;this.deck[t]=e;var r=c.cardBag.indexOf(n);c.cardBag.splice(r,1);r=this.bagList.indexOf(e);this.bagList.splice(r,1),this.refreshBag()}},unEquip:function(e){var t=this.deck.indexOf(e);this.deck[t]=null;for(var i=c.cardBag.length,s=e.getComponent("CardCollection").cfgId,n=0;n<c.cardBag.length;n++)if(o.get("cfg_card",s).element<o.get("cfg_card",c.cardBag[n]).element||o.get("cfg_card",s).element==o.get("cfg_card",c.cardBag[n]).element&&s<c.cardBag[n]){i=n;break}c.cardBag.splice(i,0,s),this.bagList.splice(i,0,e),e.parent=this.content,e.position=cc.v2(i%3*247-247,-120-210*Math.floor(i/3)),e.getComponent("CardCollection").colletType=1,this.refreshBag()},refreshBag:function(){for(var e=0;e<this.bagList.length;e++)this.bagList[e].runAction(cc.moveTo(.15,cc.v2(e%3*247-247,-120-210*Math.floor(e/3))));this.content.height=Math.max(210*Math.ceil(c.cardBag.length/3)+20,this.contentHeight)},close:function(){c.deck=[];for(var e=0;e<6;e++)null!=this.deck[e]&&c.deck.push(this.deck[e].getComponent("CardCollection").cfgId);this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null,window.homeLayer.btnDeck.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardCollection:[function(e,t,i){"use strict";cc._RF.push(t,"a28bfVp4ABL54sr47isHV8F","CardCollection");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,btn:cc.Button,box:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,markDelete:cc.Node},init:function(e,t){this.cfgId=e,this.cfg=o.get("cfg_card",e);var i=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],s=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],n=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.element=this.cfg.element,this.btn.node.color=i[this.element-1],this.box.color=s[this.element-1],this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=n[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.txtDesc.string=c.analysisDesc(this.cfg.desc1);var r=this.cfg.require;if(r>=101&&r<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][r-101];for(var a=[[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][r-101],h=0;h<a.length;h++)this.createCircle(0,a[h])}else{this.requireNode.y-=8;for(var d=r.split(";"),l=(a=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][d.length-1],0);l<d.length;l++)this.createCircle(parseInt(d[l]),a[l])}null!=t&&(this.btn.interactable=!0,this.colletType=t)},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.requireNode.addChild(i),e>0&&i.getComponent("RequireRound").refreshSatisfy(!0)},changeCollectType:function(){0==this.colletType?window.bagLayer.unEquip(this.node):window.bagLayer.equip(this.node)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardManager:[function(e,t,i){"use strict";cc._RF.push(t,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var c=e("Game"),o=e("Config"),s={doCast:function(e,t){this.cfgId=e;var i=o.get("cfg_card",e);if(this.desc=i.desc,this.card=t,(1==i.target1||1==i.target2||1==i.target3)&&(window.player.atkPlayed++,window.opponent.buff.dodge>0))return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("MISS",2),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(e)},doEffect:function(e,t,i){var c=null,o=(c=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,s=window.player.buff,n=0,r=1;if((t+="")<0){for(var a=["A","B","C","D","E","F"],h=0,d=0;d<6;d++)if(this.desc.indexOf(a[d])>=0){h=d;break}n=window.player.elementList[h]*Math.abs(parseInt(t))}else{var l=t.split(";");if(8==e)n=parseInt(l[0]),r=parseInt(l[1]);else if(1==l.length)n=parseInt(t);else{var f=parseInt(l[0]),p=parseInt(l[1]);n=window.player.equip.checkWithTrigger(120)?p:Math.floor(Math.random()*(p-f+1))+f}}if(e<10){if(1==i&&(n*=Math.pow(2,s.doubleDmg),s.removeBuff(107,s.doubleDmg)),s.weak>0&&!window.player.equip.checkWithTrigger(65)){var u=.7;window.opponent.equip.checkWithTrigger(55)&&(u=.5),n=Math.floor(n*u)}1==window.player.atkPlayed&&window.player.equip.checkWithTrigger(100)&&(n*=2);for(var m=0;m<r;m++)c.onHurt(n,0,e)}else 11==e?c.updateArmor(n):12==e?c.onHeal(n):14==e?c.addPower&&c.addPower(n):(13==e||e>=21)&&o.addBuff(e,n)},doSpecial:function(e){var t=window.opponent.buff,i=window.player.buff;if(132==e)this.doEffect(11,window.host.armor,2);else if(133==e)this.doEffect(7,window.host.armor,1);else if(134==e)this.doEffect(7,2*window.host.armor,1),this.doEffect(11,-window.host.armor,2);else if(135==e)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==e)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==e)this.doEffect(7,Math.floor(window.host.hp/2),1);else if(138==e)i.addBuff(102,2);else if(139==e)i.addBuff(101,1);else if(140==e)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==e)window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==e)window.host.power&&(this.doEffect(11,2*window.host.power,2),window.host.addPower(-window.host.power));else if(143==e)window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==e)this.doEffect(7,2*t.poison,1);else if(145==e)this.doEffect(7,4*t.poison,1);else if(146==e)t.addBuff(26,t.poison);else if(147==e){var o=t.frail>0?20:10;this.doEffect(3,o,1)}else if(148==e){o=t.weak>0?20:10;this.doEffect(4,o,1)}else if(149==e)t.poison>0&&this.doEffect(26,1,1);else if(150==e){o=t.burn>0?20:10;this.doEffect(1,o,1)}else if(151==e)t.freeze>0&&this.doEffect(22,1,1);else if(152==e)t.silence>0&&this.doEffect(25,1,1);else if(e>=153&&e<=158){var s=[2,3,5,0,1,4][e-153];window.player.elementList[s]>=[2,2,2,3,3,3][e-153]&&this.doEffect(s+21,[1,1,2,2,2,1][e-153],1)}else if(e>=159&&e<=162)t.addBuff(Math.floor(8*Math.random())+21,162==e?2:1);else if(e>=163&&e<=166)this.doEffect(108,1,2);else if(167==e)i.multiCast++,i.multiCastMax++;else if(e>=168&&e<=171)this.doEffect(107,1,2);else if(172==e)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-t.freeze,1);else if(173==e)this.doEffect(21,window.opponent.deck.length-t.burn,1);else if(174==e)this.doEffect(7,6*t.burn,1);else if(175==e)this.doEffect(7,6*t.freeze,1);else if(176==e)this.doEffect(7,6*t.silence,1);else if(177==e)this.doEffect(7,4*t.frail,1);else if(178==e)this.doEffect(7,4*t.weak,1);else if(e>=179&&e<=182){o=(n=[1,6,6,10])[e-179]+(r=[3,2,3,4])[e-179]*(i.iteraList[e-179]-1);this.doEffect(7,o,1)}else if(e>=183&&e<=186){var n=[8,13,15,21],r=[3,3,4,5],a=Math.min(i.iteraList[e-179]-1,[2,4,3,4][e-183]);o=n[e-183]-r[e-183]*a;this.doEffect(7,o,1)}else if(187==e)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==e)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==e)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==e)this.doEffect(1,10+3*i.elementRoundCasted[0],1);else if(191==e)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==e)this.doEffect(3,10+3*i.elementRoundCasted[2],1);else if(193==e){if((a=Math.min(window.opponent.deck.length,6))>0){var h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.opponent.deck.splice(h,1),window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(194==e){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(195==e){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d)}}else if(196==e){var l=c.getRandomCardId(2);window.player.patchCard(l,!0),window.player.deck.push(l)}else if(197==e){l=c.getRandomCardId(2);var f=window.player.patchCard(l,null,!0)}else if(198==e){var p=function(){var e=window.player.patchCard();2==e.getComponent("Card").element&&window.player.cardList.length<6?e.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){p()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&(window.mainLayer.gameOver||window.mainLayer.enemy.ai.check())}.bind(this),.8)}.bind(this);p()}else if(199==e)window.player.diceCount++,window.player.host.txtDice.string="\xd7"+window.player.diceCount,window.player.createExDice();else if(200==e)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==e){for(var u=21;u<=28;u++)i.removeBuff(u,i.table[u]);for(var m=0;m<window.player.cardList.length;m++)window.player.cardList[m].getComponent("Card").clear();for(var g=0;g<window.player.diceList.length;g++)window.player.diceList[g].getComponent("Dice").clear();window.player.checkElement()}else if(202==e){for(var v=0,y=21;y<=28;y++)t.table[y]>0&&v++;this.doEffect(7,5*v,1)}else if(203==e)window.player.rollCount++,0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll();else if(204==e)window.player.rollCount++,window.player.roll();else if(205==e){if(window.player.cardList.length>0){h=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[h].getComponent("Card").discard(),this.doEffect(7,12,1)}}else if(206==e||207==e){if(window.player.cardList.length>0){h=Math.floor(Math.random()*window.player.cardList.length);(f=window.player.cardList[h].getComponent("Card")).remove(),f.doDelete(),this.doEffect(7,206==e?20:30,1)}}else if(208==e){this.doEffect(7,5*window.player.cardList.length,1);for(var w=window.player.cardList.length-1;w>=0;w--)window.player.cardList[w].getComponent("Card").discard();window.player.cardList=[]}else if(e>=209&&e<=214){n=214==e?2:1;this.doEffect(e-209+21,n+i.iteraList2[e-209]-1,1)}else if(215==e)window.opponent.buff.burnIce=!0;else if(216==e)window.opponent.buff.silenceDark=!0;else if(217==e)c.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(218==e){l=c.getRandomCardId(2);window.player.patchCard(l)}else 219==e?window.player.patchCard():220==e?this.doEffect(3,2*window.player.atkRound-1,1):221==e?(i.selfHarmCast++,i.selfHarmCastMax++):222==e&&(window.host.hpMax+=20,window.host.hp+=20,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax)}};t.exports=s,cc._RF.pop()},{Config:"Config",Game:"Game"}],Card:[function(e,t,i){"use strict";cc._RF.push(t,"cfa35/uH59ANIsjw79G+feg","Card");var c=e("Game"),o=e("Config"),s=e("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,box:cc.Node,fires:dragonBones.ArmatureDisplay,nodeSilence:cc.Node,markSilence:cc.Node,animationCursed:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(e,t,i){this.cfgId=e,this.index=t,this.buffId=i,this.pos=cc.v2(t%3,Math.floor(t/3)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(248*this.pos.x-248,95-206*this.pos.y-500*this.delta),this.node.opacity=0;var c=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-206*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(0==window.mainLayer.roundId?1-this.pos.y:this.pos.y)),c,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),this.cfg=o.get("cfg_card",e),this.element=this.cfg.element,this.initInfo(),this.mask.active=!0,this.btn.node.active=!0,this.nodeSilence.active=this.fires.node.active=this.animationCursed.active=this.animationDiscard.node.active=!1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1,this.hasCopy=!1,this.unCost=!1,this.rate=1;var s=this.require=this.cfg.require;if(s>=101&&s<=107){this.rate=[1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][s-101]}else{this.rate=[1/6,1/36,1/216,1/1296,1/7776][s.split(";").length-1]}},initInfo:function(){var e=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],t=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],i=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.btn.node.color=e[this.element-1],this.box.color=t[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.initDesc(),this.circleNode.removeAllChildren(),this.requireCircles=[];var c=this.cfg.require;if(this.requireNode.y=0,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),c>=101&&c<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][c-101];for(var o=[[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][c-101],s=0;s<o.length;s++)this.createCircle(0,o[s])}else{this.txtRequire.string="",this.requireNode.y-=8;for(var n=c.split(";"),r=(o=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][n.length-1],0);r<n.length;r++){this.createCircle(parseInt(n[r]),o[r]).zIndex=4-r}}},initWithCopy:function(e,t){this.cfgId=e,this.pos=t,this.isCopy=!0,this.isTemp=!0,this.cfg=o.get("cfg_card",e),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(){if(this.btn.interactable=!1,0==window.mainLayer.roundId){var e=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{e=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var t=window.player.cardList.indexOf(this.node);t>=0&&(window.player.cardList.splice(t,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},initBuff:function(){var e=this.buffId;this.burn=21==e,this.burn?(this.fires.node.active=!0,this.fires.playAnimation("play0",0)):this.fires.node.active=!1,this.silence=25==e,this.silence?(this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.nodeSilence.active=!0}.bind(this)))),this.titles[1].active=!1,this.markSilence.stopAllActions(),this.markSilence.y=130,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5)))):(this.nodeSilence.active=!1,this.titles[1].active=3==this.cfg.quality)},checkRequire:function(){var e=!1,t=window.player.elementList.concat();if(this.require>=101&&this.require<=105){for(var i=[2,2,3,4,5],c=102==this.require?2:1,o=[],s=0;s<6;s++)t[s]>=i[this.require-101]&&(c--,o.push(s+1)),102==this.require&&t[s]>=4&&(c-=2,o.push(s+1),o.push(s+1));if(c<=0&&(e=!0),102!=this.require){var n=0,r=this.requireCircles[0].getComponent("RequireRound").element;if(r)o.indexOf(r)<0&&(n=o.length>0?1:-1);else o.length>0&&(n=1);for(var a=0;a<this.requireCircles.length;a++){var h=this.requireCircles[a].getComponent("RequireRound");1==n?(h.refreshElement(o[0]),h.refreshSatisfy(!0)):-1==n&&h.hideElement()}}else{var d,l=[null,null],f=[0,0],p=this.requireCircles[0].getComponent("RequireRound").element,u=this.requireCircles[2].getComponent("RequireRound").element;if(p)(d=o.indexOf(p))>=0&&(l[0]=0,o.splice(d,1),f[0]=p);if(u)(d=o.indexOf(u))>=0&&(l[1]=0,o.splice(d,1),f[1]=p);for(var m=0;m<2;m++){if(null==l[m])(0==m?p:u)?o.length>0?(l[m]=1,f[m]=o[0],o.splice(0,1)):l[m]=-1:o.length>0?(l[m]=1,f[m]=o[0],o.splice(0,1)):l[m]=0}for(var g=0;g<this.requireCircles.length;g++){var v=this.requireCircles[g].getComponent("RequireRound"),y=g<2?0:1;1==l[y]?(v.refreshElement(f[y]),v.refreshSatisfy(!0)):-1==l[y]&&v.hideElement()}}}else{for(var w=[0,0,0,0,0,0],b=this.require.split(";"),C=0;C<b.length;C++)w[b[C]-1]++;e=!0;for(var x=0;x<6;x++)if(t[x]<w[x]){e=!1;break}for(var L=0;L<this.requireCircles.length;L++){var k=this.requireCircles[L].getComponent("RequireRound");t[k.element-1]>0?(k.refreshSatisfy(!0),t[k.element-1]--):k.refreshSatisfy(!1)}}return this.unCost&&(e=!0),this.silence&&(e=!1),this.usable=e,e?(this.mask.active=!1,this.btn.interactable=!0):this.silence?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),e},doCast:function(){0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c"):this.silence?(this.markSilence.stopAllActions(),this.markSilence.y=90,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,15)),cc.delayTime(.5),cc.fadeOut(.5)))):this.cast())},cast:function(){if(0==window.mainLayer.roundId){if(this.cfgId>=205&&this.cfgId<=208&&!window.player.cardUsabled)return}else if(!window.player.cardUsabled)return;this.burn&&window.host.onHurt(3,1,21);var e=!1,t=window.opponent.equip.check(107)?.8:.5;if(window.player.buff.curse&&Math.random()<t&&(e=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.trigger(108)),this.btn.interactable=!1,window.player.cardUsabled=!1,e)this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1;var e=cc.instantiate(this.animationCursed);e.active=!0,e.parent=window.player.boxCard,e.position=this.node.position.add(cc.v2(10,-10)),e.zIndex=100,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("play0"),e.getComponent(dragonBones.ArmatureDisplay).on(dragonBones.EventObject.COMPLETE,function(){e.destroy()}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1,this.endCast(),198==this.cfgId&&1==window.mainLayer.roundId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.5)}.bind(this))))}.bind(this))));else{var i=cc.spawn(cc.moveBy(.05,cc.v2(0,-20)),cc.scaleTo(.05,1)),c=cc.moveBy(.35,cc.v2(0,1100)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),i,c,cc.callFunc(function(){window.mainLayer.gameOver||(s.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var o=window.player.cardList.indexOf(this.node);o>=0&&(window.player.cardList.splice(o,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var n=0;n<3;n++)if(this.cfg["effect"+(n+1)]<10&&1==this.cfg["target"+(n+1)]){var r=1;8==this.cfg["effect"+(n+1)]&&(r=parseInt(this.cfg["num"+(n+1)].split(";")[1])),window.player.atkRound+=r}for(var a=0;a<window.player.cardList.length;a++){var h=window.player.cardList[a].getComponent("Card");(h.cfgId>=179&&h.cfgId<=186||h.cfgId>=209&&h.cfgId<=214||220==h.cfgId)&&h.initDesc()}e||this.isCopy||(this.cfgId<163||this.cfgId>166)&&(window.player.buff.selfHarmCast>0&&this.cfg.effect1<10&&2==this.cfg.target1?(window.player.buff.selfHarmCast--,this.reuse()):window.player.buff.doubleCast>0?(window.player.buff.removeBuff(108,1),this.reuse()):window.player.equip.luckyCard>0?(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1)):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)&&167!=this.cfgId?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)&&this.reuse()),this.isRemove&&this.doDelete()},endCast:function(){if(!this.isCopy){window.player.cardPlayed++,window.player.cardPlayedRound++;var e=window.player.equip;e.trigger(1),e.trigger(4),e.trigger(97),this.cfg.element<=6&&e.trigger(this.cfg.element+77),window.opponent.equip.trigger(24)}window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.selfHarmCastMax>0&&window.player.buff.selfHarmCast<=0&&(window.player.buff.selfHarmCast=window.player.buff.selfHarmCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++,window.player.cardPool.put(this.node),window.player.cardUsabled=!0,1!=window.mainLayer.roundId||this.hasCopy||198!=this.cfgId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.6)},discard:function(){this.btn.interactable=!1,this.btn.node.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this))));var e=window.player.cardList.indexOf(this.node);e>=0&&(window.player.cardList.splice(e,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll()),window.player.equip.trigger(22)},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),!this.isTemp){var e=window.player.deck.indexOf(this.cfgId);e>=0&&window.player.deck.splice(e,1)}},reuse:function(){var e=cc.instantiate(this.node);e.position=this.node.position,window.player.boxCard.addChild(e,this.node.zIndex-1),e.getComponent("Card").initWithCopy(this.cfgId,this.pos),this.hasCopy=!0,e.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){e.getComponent("Card").cast()}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},initDesc:function(){var e=c.analysisDesc(this.cfg.desc1);if(this.cfgId>=179&&this.cfgId<=182){var t=[3,2,3,4];e+="<color=#EBC82E>  (\u5f53\u524d"+((i=[1,6,6,10])[this.cfgId-179]+t[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var i=[8,13,15,21],o=(t=[3,3,4,5],Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,3,4][this.cfgId-183]));e+="<color=#EBC82E>  (\u5f53\u524d"+(i[this.cfgId-183]-t[this.cfgId-183]*o)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){e+="<color=#EBC82E>  (\u5f53\u524d"+((i=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}else 220==this.cfgId&&(e+="<color=#EBC82E>  (\u5f53\u524d"+(2*window.player.atkRound+1)+")</c>");this.txtDesc.string=e},disCost:function(){this.unCost=!0;for(var e=0;e<this.requireCircles.length;e++){var t=this.requireCircles[e].getComponent("RequireRound");t.disCost(),this.require>=101&&this.require<=105&&t.hideElement()}}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Chest:[function(e,t,i){"use strict";cc._RF.push(t,"282832AcdZFNov+QpH9gQcZ","Chest");var c=e("Utils");cc.Class({extends:cc.Component,properties:{txtRequire:cc.RichText,btn:cc.Button},init:function(e){this.index=e,this.node.position=cc.v2(240*e-240,-500),this.btn.node.color=cc.Color.GRAY,this.node.opacity=0;var t=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.3),t,cc.moveBy(.05,cc.v2(0,-20)))),this.satisfied=[!1,!1,!1,!1,!1,!1],this.requireList=c.getDifferentRandomNum(4,6,1),this.refreshRequire()},refreshRequire:function(){this.usable=!0;for(var e="",t=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],i=0;i<this.requireList.length;i++){var c=this.requireList[i];this.satisfied[c-1]?e+="<color=#EBC82E>"+t[c-1]+"</c>":(e+="<color=#000000>"+t[c-1]+"</c>",this.usable=!1)}this.txtRequire.string=e,this.usable&&(this.btn.interactable=!0,this.btn.node.color=cc.Color.WHITE)},remove:function(){this.btn.interactable=!1;var e=cc.moveBy(.2,cc.v2(0,-500));this.node.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.1,cc.v2(0,20)),e,cc.callFunc(function(){this.node.destroy()}.bind(this)))),window.player.chestList[this.index]=null},checkRequire:function(){for(var e=window.player.elementList,t=0;t<6;t++)e[t]>0&&!this.satisfied[t]&&(this.satisfied[t]=!0);this.refreshRequire()},doCast:function(){this.remove();for(var e=0;e<6;e++)window.player.patchCard()}}),cc._RF.pop()},{Utils:"Utils"}],CompleteLayer:[function(e,t,i){"use strict";cc._RF.push(t,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){c.setDataToBase(),cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],Config:[function(e,t,i){"use strict";cc._RF.push(t,"e9b6cHrlOtILogPlENB3GXp","Config");var c={jsonTable:{},load:function(e){for(var t=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event","cfg_hero"],c=0,o=function(o){n="Config/"+i[o],cc.loader.loadRes(n,function(t,s){this.jsonTable[i[o]]=s.json,(c+=1)==i.length&&e()}.bind(t))},s=0;s<i.length;s++){var n;o(s)}},get:function(e,t){return this.jsonTable[e][t]}};t.exports=c,cc._RF.pop()},{}],DiceYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.id=e,this.index=t,this.player=0==t?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1,this.holded=!1;var i=this.delta=0==this.index?1:-1;this.node.position=cc.v2(110*e-220,-320*i),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*i)),cc.moveBy(.1,cc.v2(0,-20*i))))},roll:function(e){this.abled=!0,this.holded=!1;var t=this.player.holdList.indexOf(this.node);if(t>=0&&this.player.holdList.splice(t,1),!e){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var i=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=i[this.element-1]}var c=50*Math.random()+150*this.id-325,o=(460*Math.random()+240)*this.delta,s=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(c,o)),cc.rotateTo(.2,s)))},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var e=0;e<this.player.holdList.length;e++)this.player.holdList[e].runAction(cc.moveTo(.1,cc.v2(110*e-220,0)));this.player.txtBtn.string="\u6295\u63b7"}else this.hold()},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(e,t,i){"use strict";cc._RF.push(t,"24e6aDXOPZNaoyluEGeZSR/","Dice"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node,mask:cc.Node,markTemp:cc.Node},init:function(e,t){this.id=e,this.holded=!1,this.element=0,this.mask.active=!1,this.temp=!1,this.buffId=t,this.markIce.active=this.markIce.markLock=this.markTemp.active=!1},initBuff:function(){var e=this.buffId;this.freeze=22==e,this.markIce.active=this.freeze,this.lock=28==e,this.markLock.active=this.lock},roll:function(e){this.element=e||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=t[this.element-1],this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=200*-this.delta,this.node.opacity=0,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20*this.delta)),cc.moveTo(.1,cc.v2(this.node.x,0)))))},doHold:function(){0!=window.mainLayer.roundId||this.freeze||this.lock||this.temp||window.player.diceUsabld&&this.hold()},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)},remove:function(){var e=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},doTemp:function(){this.temp=!0,this.markTemp.active=!0;var e=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.markTemp.color=e[this.element-1]}}),cc._RF.pop()},{}],DmgAnimation:[function(e,t,i){"use strict";cc._RF.push(t,"267b8j4vWVAPaVTrMCIVdTi","DmgAnimation");e("Utils");cc.Class({extends:cc.Component,properties:{atks:[dragonBones.ArmatureDisplay],heal:dragonBones.ArmatureDisplay,fireAtk:dragonBones.ArmatureDisplay,waterAtk:dragonBones.ArmatureDisplay,windAtk:dragonBones.ArmatureDisplay,earthAtk:dragonBones.ArmatureDisplay,lightAtk:dragonBones.ArmatureDisplay,darkAtk:dragonBones.ArmatureDisplay,armor:dragonBones.ArmatureDisplay,dodge:dragonBones.ArmatureDisplay,frail:dragonBones.ArmatureDisplay,weak:dragonBones.ArmatureDisplay,silence:dragonBones.ArmatureDisplay,poison:dragonBones.ArmatureDisplay,curse:dragonBones.ArmatureDisplay,lock:dragonBones.ArmatureDisplay,atkback:dragonBones.ArmatureDisplay,undead:dragonBones.ArmatureDisplay,revive:dragonBones.ArmatureDisplay,fireSound:{type:cc.AudioClip,default:null},iceSound:{type:cc.AudioClip,default:null},windSound:{type:cc.AudioClip,default:null},earthSound:{type:cc.AudioClip,default:null}},init:function(e){this.index=e,this.host=0==e?window.mainLayer.hero:window.mainLayer.enemy,this.step=0},show:function(e){var t;if(e<=6){var i=[this.fireAtk,this.waterAtk,this.windAtk,this.earthAtk,this.lightAtk,this.darkAtk];if(t=i[e-1],e<=4){i=[this.fireSound,this.iceSound,this.windSound,this.earthSound];cc.audioEngine.playEffect(i[e-1])}}else if(e>=7&&e<=9)(t=this.atks[this.step%3]).node.rotation=360*Math.random();else if(e<=13){i=[this.armor,this.heal,this.dodge];t=i[e-11]}else if(e>=21&&e<=29){i=[this.fireAtk,this.waterAtk,this.frail,this.weak,this.silence,this.poison,this.curse,this.lock,this.atkback];t=i[e-21]}else 201==e?t=this.undead:202==e&&(t=this.revive);t.node.active=!0,t.node.zIndex=this.step,t.playAnimation("play0"),t.on(dragonBones.EventObject.COMPLETE,function(){t.node.active=!1}.bind(this)),this.host.doShake(e),this.step++}}),cc._RF.pop()},{Utils:"Utils"}],Door:[function(e,t,i){"use strict";cc._RF.push(t,"03087MNqj9O2qA5J4CBmWTy","Door");var c=e("Game");cc.Class({extends:cc.Component,properties:{road:cc.Sprite,view:cc.Node,wall:cc.Node,image:cc.Sprite,btn:cc.Button},init:function(e,t){this.type=e,this.index=t;var i="road"+c.castle+(Math.floor(4*Math.random())+1);7==e?i="boss":0==e&&(i="empty"),cc.loader.loadRes("Texture/map/road/"+i,cc.SpriteFrame,function(i,c){this.road.spriteFrame=c,this.road.node.parent=window.room.node,this.road.node.rotation=this.node.rotation;var o=7==e||0==e?49:19,s=[cc.v2(0,-o),cc.v2(-o,0),cc.v2(0,o),cc.v2(o,0)];this.road.node.position=this.node.position.add(s[t])}.bind(this)),cc.loader.loadRes("Texture/map/door/door"+e,cc.SpriteFrame,function(e,t){this.image.spriteFrame=t}.bind(this))},onEvent:function(){window.room.gotoDoor(this.index)},close:function(e){this.btn.interactable=!1,this.view.active=!0,e&&(this.wall.y=130,this.wall.runAction(cc.moveTo(.2,cc.v2()))),7!=this.type&&0!=this.type||(this.road.getComponent(cc.Button).interactable=!1)}}),cc._RF.pop()},{Game:"Game"}],EditEndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){c.deck=c.editCfg.deckHero.split(";"),c.equip=c.editCfg.equip.split(";"),c.hp=c.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(e,t,i){"use strict";cc._RF.push(t,"463d3gvgvdIabmN6qTyXAVR","Edit");var c=e("Game");cc.Class({extends:cc.Component,properties:{editHpEnemy:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox,editId:cc.EditBox,editHpHero:cc.EditBox},onLoad:function(){c.editCfg&&(this.editHpEnemy.string=c.editCfg.hpEnemy,this.editDice.string=c.editCfg.dice,this.editDeckEnemy.string=c.editCfg.deckEnemy,this.editEquipEnemy.string=c.editCfg.equipEnemy,this.editDeckHero.string=c.editCfg.deckHero,this.editEquip.string=c.editCfg.equip,this.editHpHero.string=c.editCfg.hpHero),this.editId.string=c.heroId},goBattle:function(){c.editCfg={hpEnemy:this.editHpEnemy.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string,hpHero:this.editHpHero.string};var e=this.editDeckHero.string.split(";");c.deck=[];for(var t=0;t<e.length;t++)c.deck.push(parseInt(e[t]));var i=this.editEquip.string.split(";");c.equip=[];for(var o=0;o<i.length;o++)c.equip.push(parseInt(i[o]));c.hp=c.hpMax=parseInt(c.editCfg.hpHero),c.heroId=parseInt(this.editId.string),c.level=7,cc.director.loadScene("mainLayer")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,boxReward:cc.Node,boxCard:cc.Node,boxEquip:cc.Node,cardBtns:[cc.Node],equipBtns:[cc.Node],txtCopper:cc.Label,txtExp:cc.Label,txtHp:cc.Label,rewardNodes:[cc.Node],mask:cc.Node,endNode:cc.Node,txtNext:cc.Node,cardNodes:[cc.Node],equipNodes:[cc.Node],treasurePrefab:cc.Prefab},onLoad:function(){window.endLayer=this,this.step=0;var e=2,t=window.mainLayer.hero.player;1==c.roomType?t.equip.check(26)?(c.hpMax+=6,c.hp+=6,this.rewardNodes[2].active=!0,e++,this.step++):this.initCards():this.initEquip();var i=0;t.equip.trigger(7)&&(i+=6),t.equip.trigger(8)&&(i+=10),i>0&&(this.rewardNodes[3].active=!0,this.txtHp.string=i,e++);for(var o=[[30,-30],[50,0,-50],[60,20,-20,-60]][e-2],s=0;s<e;s++)this.rewardNodes[s].y=o[s]-20;this.initCopper(),this.initExp(),c.floorBeats[c.floor-1]=!0,c.monsterBeats.push(c.monsterId),this.mask.on(cc.Node.EventType.TOUCH_START,this.nextStep,this),this.boxReward.scale=.8,this.boxReward.runAction(cc.sequence(cc.scaleTo(.15,1.2),cc.scaleTo(.1,1),cc.callFunc(function(){this.step++,this.txtNext.active=!0}.bind(this))))},initCards:function(){this.boxCard.active=!0,this.boxCard.y-=cc.winSize.height/cc.winSize.width*750;for(var e=0,t=[[.5,.5,0],[.5,.5,0],[0,.5,.5]],i=Math.random(),s=0,n=0;n<3;n++)if(i<(s+=t[c.castle-1][n])){e=n+1;break}this.cardIdList=[];for(var r=0;r<=0;){var a=c.getNewCardId(e),h=o.get("cfg_card",a).require;(c.castle>1||2==h.split(";").length||h<=102)&&(r=a)}this.cardIdList.push(r);for(var d=0;d<=0;){var l=c.getNewCardId(e),f=o.get("cfg_card",l).require;l!=r&&(c.castle>1||2==f.split(";").length||f<=102)&&(d=l)}this.cardIdList.push(d);for(var p=0;p<2;p++){var u=cc.instantiate(this.cardPrefab);u.getComponent("CardCollection").init(this.cardIdList[p]),u.position=cc.v2(0,40),this.cardNodes[p].addChild(u)}},chooseCard:function(e,t){c.getCard(this.cardIdList[t]),this.cardNodes[1-t].destroy(),this.cardNodes[t].runAction(cc.moveTo(.2,cc.v2(0,0))),this.cardBtns[0].active=this.cardBtns[1].active=!1,this.step++,this.txtNext.active=!0},initCopper:function(){var e=window.mainLayer.enemy.cfg.level,t=1,i=window.mainLayer.hero.player;i.equip.check(73)&&(t+=.5),c.itemEffect.pen>0&&(t+=1,c.itemEffect.pen--),i.equip.check(90)&&(t-=.5);var o=Math.max([6,8,10,12,14,16,0][e-1]*t,1);this.txtCopper.string=o,c.copper+=o},initExp:function(){var e=window.mainLayer.enemy.cfg.level,t=1==c.roomType?e:[5,11,19,29,41,55,70][e-1];this.txtExp.string=t,c.exp+=t;var i=[7,15,25,37,51,67,150][c.level-1];c.exp>=i&&(c.exp-=i,c.level++,c.hpMax+=5,c.hp=window.mainLayer.hero.hp=c.hpMax,c.levelUp=!0)},initEquip:function(){this.boxEquip.active=!0,this.boxEquip.y-=cc.winSize.height/cc.winSize.width*750;for(var e=0,t=[[.5,.3,.2],[.2,.4,.4],[0,.5,.5]],i=Math.random(),o=0,s=0;s<3;s++)if(i<(o+=t[c.castle-1][s])){e=s+1;break}this.cfgIdList=[];var n=c.getNewItemId(2,e);if(this.cfgIdList.push(n),7==c.roomType){for(var r=0;r<=0;){var a=c.getNewItemId(2,e);a!=n&&(r=a)}this.cfgIdList.push(r)}},showEquip:function(){if(1==this.cfgIdList.length)(t=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),t.y=-120,this.boxEquip.addChild(t),c.getItem(this.cfgIdList[0]),this.equipNodes[0].active=!1,this.equipNodes[1].active=!1,this.scheduleOnce(function(){this.step++,this.txtNext.active=!0}.bind(this),1);else for(var e=0;e<2;e++){var t;(t=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[e]),t.y=-120,this.equipNodes[e].addChild(t),this.equipBtns[e].y-=150;var i=cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))));this.equipBtns[e].runAction(cc.sequence(cc.delayTime(.8),i))}},chooseEquip:function(e,t){c.getItem(this.cfgIdList[t]),this.equipNodes[1-t].destroy(),this.equipNodes[t].runAction(cc.moveTo(.2,cc.v2(0,0))),this.equipBtns[0].active=this.equipBtns[1].active=!1,this.step++,this.txtNext.active=!0},nextStep:function(){this.txtNext.active&&(1==this.step?(this.txtNext.active=!1,this.endNode.runAction(cc.sequence(cc.moveBy(.35,cc.v2(0,cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){c.roomType>=6&&this.showEquip()}.bind(this))))):2==this.step&&this.close())},close:function(){c.hp=Math.min(window.mainLayer.hero.hp,c.hpMax),c.power=window.mainLayer.hero.power,cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndYahtzeeLayer:[function(e,t,i){"use strict";cc._RF.push(t,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtName:cc.Label,cardPrefab:cc.Prefab,itemNode:cc.Node,txtItemName:cc.Label,txtItemDesc:cc.Label,itemChangeNode:cc.Node,txtChangeName1:cc.Label,txtChangeDesc1:cc.Label,txtChangeName2:cc.Label,txtChangeDesc2:cc.Label,losePrefab:cc.Prefab,txtChange:cc.Node,rewardNode:cc.Node},init:function(e){this.result=e;this.txtTitle.string=["\u4f60\u8f93\u4e86","\u5e73\u5c40","\u4f60\u8d62\u4e86","\u4f60\u79bb\u5f00\u4e86"][e+1],this.checkResult()},checkResult:function(){var e=c.eventId,t="";if(0==this.result||1==this.result)if(1==e)t="\u6062\u590d\u5168\u90e8\u751f\u547d",c.hp=c.hpMax;else if(2==e||14==e)t="\u989d\u5916\u751f\u547d +15",c.hpMax+=15,c.hp+=15;else if(3==e)this.getItem(3);else if(4==e)t="\u91d1\u5e01 +50",c.copper+=50;else if(5==e||6==e)this.getItem(2);else if(7==e)t="\u91d1\u5e01 -30",c.copper=Math.max(c.copper-30,0),this.getItem(3),this.rewardNode.y-=130;else if(8==e)t="\u751f\u547d\u4e0a\u9650 +10, \u6062\u590d\u5168\u90e8\u751f\u547d",c.hpMax+=10,c.hp=c.hpMax;else if(9==e||17==e)this.getItem();else if(10==e)t="\u91d1\u5e01\u7ffb\u500d",c.copper*=2;else if(11==e){t="\u590d\u5236\u5361\u724c";var i=c.deck[Math.floor(Math.random()*c.deck.length)];this.getCard(null,i),this.rewardNode.y-=130}else if(12==e||16==e)t="\u91d1\u5e01 +100",c.copper+=100;else if(13==e){this.getCard(3).x-=200,this.getCard(3).x+=200}else 15==e&&(t="\u751f\u547d +30",c.hp=Math.min(c.hp+30,c.hpMax));else-1==this.result?1==e?(t="\u751f\u547d +10",c.hp=Math.min(c.hp+10,c.hpMax)):2==e||12==e?(t="\u751f\u547d\u4e0a\u9650 -5",c.hpMax=Math.max(c.hpMax-5,1),c.hp=Math.min(c.hp,c.hpMax)):3==e?this.changeItem():4==e||9==e?this.getCard():5==e?(t="\u91d1\u5e01 +20",c.copper+=20):6==e||11==e?this.changeCard():7==e?(t="\u91d1\u5e01 -30",c.copper=Math.max(c.copper-30,0),this.getItem(2),this.rewardNode.y-=130):8==e||10==e?(t="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",c.copper=Math.ceil(c.copper/2)):13==e?this.deleteCard(0):14==e?(t="\u751f\u547d\u4e0a\u9650 -10",c.hpMax=Math.max(c.hpMax-10,1),c.hp=Math.min(c.hp,c.hpMax)):15==e?(t="\u6028\u5ff5\uff1a\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59313\u751f\u547d",c.debuff++):16==e?(t="\u751f\u547d -10",this.loseHp(10)):17==e&&(t="\u91d1\u5e01 -30",c.copper=Math.max(c.copper-30,0),this.getCard(),this.rewardNode.y-=130):2==this.result&&(2==e||15==e?(t="\u751f\u547d -10",this.loseHp(10)):7==e?(t="\u91d1\u5e01 -30",c.copper=Math.max(c.copper-30,0),this.getItem(1),this.rewardNode.y-=130):12==e?(t="\u91d1\u5e01 -20",c.copper=Math.max(c.copper-20,0)):13==e?(this.deleteCard(1,0),this.deleteCard(1,1)):16==e&&(t="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",c.copper=Math.ceil(c.copper/2)));this.txtName.string=t,window.homeLayer&&window.homeLayer.refreshHeroData()},close:function(){window.homeLayer?this.node.destroy():(cc.director.loadScene("helloworld"),c.floorBeats[c.floor-1]=!0)},getCard:function(e,t){var i=t||c.getNewCardId(e),o=cc.instantiate(this.cardPrefab);return o.getComponent("CardCollection").init(i),this.rewardNode.addChild(o),c.getCard(i),o},getItem:function(e){var t=c.getNewItemId(0,e);this.itemNode.active=!0,this.txtItemName.string=o.get("cfg_item",t).name,this.txtItemDesc.string=o.get("cfg_item",t).desc,c.getItem(t)},loseHp:function(e){if(c.hp-=e,c.hp<=0){c.hp+=e;var t=cc.instantiate(this.losePrefab);this.node.addChild(t)}},changeCard:function(){if(c.deck.length+c.cardBag.length>0){var e;this.txtChange.active=!0;var t=Math.floor(Math.random()*(c.deck.length+c.cardBag.length));t<c.deck.length?(e=c.deck[t],c.deck.splice(t,1)):(e=c.cardBag[t-c.deck.length],c.cardBag.splice(t-c.deck.length,1));var i,o=c.getNewCardId();c.getCard(o),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),i.x-=200,this.rewardNode.addChild(i),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(o),i.x+=200,this.rewardNode.addChild(i)}else this.txtName.string="\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362"},changeItem:function(){if(c.equip.length>0){var e=Math.floor(Math.random()*c.equip.length),t=c.equip[e];c.equip.splice(e,1);var i=c.getNewItemId(0);c.getItem(i),this.itemChangeNode.active=!0,this.txtChangeName1.string=o.get("cfg_item",t).name,this.txtChangeDesc1.string=o.get("cfg_item",t).desc,this.txtChangeName2.string=o.get("cfg_item",i).name,this.txtChangeDesc2.string=o.get("cfg_item",i).desc}else this.txtName.string="\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362"},deleteCard:function(e,t){var i=0==e?c.deck:c.cardBag;if(i.length>0){var o=Math.floor(Math.random()*i.length),s=i[o];i.splice(o,1);var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(s),n.getComponent("CardCollection").markDelete.active=!0,null!=t&&(n.x=400*t-200),this.rewardNode.addChild(n)}else this.txtName.string="\u53ef\u79fb\u9664\u5361\u724c\u4e0d\u8db3",this.rewardNode.y-=130}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(e,t,i){"use strict";cc._RF.push(t,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,boxBuff:cc.Node,txtName:cc.Label,txtLevel:cc.Label,txtDice:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,figure:cc.Node,figureNode:cc.Node,equipDesc:cc.RichText,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){c.editCfg?this.initEdit():(this.cfgId=c.monsterId,this.cfg=o.get("cfg_monster",this.cfgId),this.hp=this.hpMax=this.cfg.hp,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,this.equipList=this.cfg.item>0?[this.cfg.item]:[],this.txtName.string=this.cfg.name,this.txtLevel.string="Lv."+this.cfg.level,this.initDeck()),this.player.init(1),this.ai=this.getComponent("AI"),this.board=window.mainLayer.board,cc.loader.loadRes("Texture/monster/"+this.cfgId,cc.SpriteFrame,function(e,t){this.figure.getComponent(cc.Sprite).spriteFrame=t,this.figureNode.y+=250,this.figureNode.scaleX=.8,this.figureNode.scaleY=1.2,this.figureNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,-250)),cc.scaleTo(.3,1.2,.8)),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))}.bind(this))},startRound:function(){this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5),this.board.y=-497,this.board.runAction(cc.sequence(cc.delayTime(.5),cc.moveTo(.15,cc.v2(0,-377))))},endRound:function(){this.board.runAction(cc.moveTo(.15,cc.v2(0,-497)))},onHurt:function(e,t,i){window.mainLayer.gameOver||(i=i||7,this.player.onHurt(e,t,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(0)))},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},updateArmor:function(e){this.armor+=e,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor,this.stripHp.node.color=cc.color(24,136,176),this.barHp.color=cc.color(92,214,255)):(this.armor=0,this.boxArmor.active=!1,this.stripHp.node.color=cc.color(172,45,56),this.barHp.color=cc.color(252,94,108)),e>0&&this.player.anim.show(11)},initDeck:function(){if(0==this.cfg.card1)this.deck=window.mainLayer.hero.deck.concat();else{this.deck=[];for(var e=0;e<6;e++){var t=this.cfg["card"+(e+1)];t>0&&this.deck.push(t)}}},initEdit:function(){this.cfgId=50,this.hp=this.hpMax=parseInt(c.editCfg.hpEnemy),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(c.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.deck=c.editCfg.deckEnemy.split(";"),this.equipList=""!=c.editCfg.equipEnemy?[c.editCfg.equipEnemy]:[]},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"9C434A"};t[e]&&(this.figure.color=cc.Color.WHITE.fromHEX("#"+t[e]),this.figure.stopAllActions(),this.figure.runAction(cc.sequence(cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(-15,-5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.08,cc.v2(-15,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){this.figure.position=cc.v2(0,0),this.figure.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(e,t,i){"use strict";cc._RF.push(t,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,mask:cc.Node},onLoad:function(){window.equipLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var e=0;window.bagLayer?(e=.15,window.bagLayer.close()):window.mapLayer&&(e=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initItems()},initItems:function(){for(var e=0;e<c.equip.length;e++){var t=cc.instantiate(this.itemPrefab);t.getComponent("ItemCollection").init(c.equip[e]),t.position=cc.v2(-20,-70-124*e),this.content.addChild(t)}this.content.height=Math.max(124*c.equip.length+20,cc.winSize.height/cc.winSize.width*750-1334+870)},close:function(){this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.equipLayer=null,window.homeLayer.btnEquip.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(e,t,i){"use strict";cc._RF.push(t,"a22ddJNtUJBS6PVq98jP/g9","Equip");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?c.equip:this.host.equipList,this.boxEquip=this.host.boxEquip,this.initItems(),this.swiftGlove=!1,this.suckRemainder=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0},initItems:function(){if(this.itemList=[],0==this.index){for(var e=0;e<this.equipList.length;e++){if(this.equipList[e]>0)if(o.get("cfg_item",this.equipList[e]).battle&&(10!=this.equipList[e]||c.itemEffect.feather>0)){var t=cc.instantiate(this.itemPrefab);t.getComponent("Item").init(this.equipList[e],this),this.boxEquip.addChild(t),this.itemList.push(t)}}for(var i=0;i<this.itemList.length;i++){var s=72;this.itemList.length>10&&(s=648/(this.itemList.length-1)),this.itemList[i].x=s*i-324}}else if(this.equipList.length>0){var n=cc.instantiate(this.itemPrefab);n.getComponent("Item").init(this.equipList[0],this),n.x=-240,n.scale=.5,this.boxEquip.addChild(n),this.itemList.push(n);var r=o.get("cfg_item",this.equipList[0]);this.host.equipDesc.string="<color=#FEF64B>"+r.name+"\uff1a</c>"+c.analysisDesc(r.desc1)}else this.boxEquip.active=!1},check:function(e){for(var t=0;t<this.equipList.length;t++)if(this.equipList[t]==e)return!0;return!1},checkWithTrigger:function(e){return!!this.check(e)&&(this.doTrigger(e),!0)},trigger:function(e){var t=!1;if(this.check(e))if(1==e)this.opponent.host.onHurt(1,2),t=!0;else if(2==e)this.player.cardList.length<=0&&(this.host.updateArmor(3),t=!0);else if(3==e)this.player.cardList.length<=0&&(this.host.onHeal(2),t=!0);else if(4==e)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.btnRoll&&this.host.checkBtnRoll(!0),t=!0);else if(5==e)this.opponent.buff.addBuff(26,2),t=!0;else if(6==e)this.player.buff.addBuff(13,1),t=!0;else if(7==e)this.host.onHeal(6),t=!0;else if(8==e)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(10),t=!0);else if(9==e)this.opponent.host.onHurt(6,2),t=!0;else if(10==e)c.itemEffect.feather>0&&(this.player.anim.show(202),this.host.hp=Math.floor(.3*this.host.hpMax),t=!0,c.itemEffect.feather=-1);else if(11==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.host.updateArmor(-this.host.armor),t=!0);else if(e>=12&&e<=18){this.opponent.buff.addBuff(e+9,[3,3,2,2,2,4,2][e-12]),t=!0}else if(19==e)this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0;else if(20==e)this.host.updateArmor(8),t=!0;else if(21==e)this.player.buff.addBuff(104,1);else if(22==e)this.opponent.host.onHurt(5,2),t=!0;else if(23==e)this.suckRemainder>=4&&(this.host.onHeal(Math.floor(this.suckRemainder/4)),this.suckRemainder=this.suckRemainder%4,t=!0);else if(24==e)this.opponent.host.onHurt(2,2,1),t=!0;else if(25==e)this.host.hp==this.host.hpMax&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(27==e)this.host.armor<=0&&(this.host.updateArmor(3),t=!0);else if(30==e)3==this.player.round&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(37==e)this.player.buff.addBuff(105,2);else if(44==e)this.player.buff.addBuff(103,3),t=!0;else if(45==e)this.scheduleOnce(function(){this.player.createExDice()}.bind(this),.5),t=!0;else if(e>=48&&e<=53)this.scheduleOnce(function(){window.player.createExDice(e-47)}.bind(this),.5),t=!0;else if(57==e)this.player.cardList.length>0&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(59==e)this.player.cardList.length>0&&(this.host.updateArmor(3*this.player.cardList.length),t=!0);else if(60==e)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),t=!0);else if(61==e)this.host.onHeal(15),t=!0;else if(68==e)this.opponent.buff.addBuff(24,1),t=!0;else if(69==e)this.opponent.host.onHurt(10,2),t=!0;else if(70==e)this.player.patchCard(),t=!0;else if(82==e||83==e)this.host.onHeal(2),t=!0;else if(79==e||78==e)this.host.updateArmor(2),t=!0;else if(80==e||81==e)this.opponent.host.onHurt(2,2),t=!0;else if(84==e)this.player.buff.addBuff(27,1),t=!0;else if(86==e)this.host.onHurt(2,2),t=!0;else if(88==e){if(c.deck.length>0){t=!0;for(var i=o.get("cfg_card",c.deck[0]).element,s=1;s<c.deck.length;s++)if(o.get("cfg_card",c.deck[s]).element!=i){t=!1;break}}}else if(91==e)this.player.buff.addBuff(21,2),t=!0;else if(93==e)1==this.player.round&&(this.scheduleOnce(function(){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard();for(var e=0;e<=0;){var t=c.getRandomCardId();3==o.get("cfg_card",t).quality&&(e=t)}window.player.patchCard(e)}.bind(this),.5),t=!0);else if(96==e)this.opponent.buff.addBuff(26,5),t=!0;else if(97==e)this.host.updateArmor(1),t=!0;else if(102==e)this.host.hp>this.host.hpMax&&(this.host.updateArmor(this.host.hp-this.host.hpMax),t=!0);else if(104==e)this.opponent.buff.addBuff(Math.floor(8*Math.random())+21,1),t=!0;else if(105==e)this.host.onHurt(1,2),t=!0;else if(108==e)this.opponent.host.onHurt(5,2,6),t=!0;else if(109==e)this.opponent.host.onHurt(5,2),t=!0;else if(110==e)this.host.onHurt(1,2),this.opponent.buff.addBuff(26,2),t=!0;else if(111==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),t=!0);else if(114==e)this.player.buff.addBuff(106,1);else if(115==e)this.player.rollCount++,0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll(),t=!0;else if(116==e)this.opponent.host.onHurt(6,2),t=!0;else if(118==e){for(var n=0,r=0;r<this.opponent.cardList.length;r++){this.opponent.cardList[r].getComponent("Card").burn&&n++}n>0&&(this.opponent.host.onHurt(6*n,2),t=!0)}else if(119==e)this.opponent.host.onHurt(5,2),t=!0;else if(121==e){for(var a=[],h=0;h<=this.player.buff.buffList.length;h++){var d=this.player.buff.buffList[h];d>=21&&d<=28&&a.push(d)}if(a.length>0){var l=a[Math.floor(Math.random()*a.length)];this.player.buff.removeBuff(l,this.player.buff.table[l]),t=!0}}else 122==e?(this.opponent.host.onHurt(5,2),t=!0):123==e?this.host.hp>this.host.hpMax&&(this.opponent.host.onHurt(this.host.hp-this.host.hpMax,2),t=!0):t=!0;return t&&this.doTrigger(e),t},doTrigger:function(e){for(var t=0;t<this.itemList.length;t++){var i=this.itemList[t].getComponent("Item");if(i.cfgId==e&&!i.isRemoved){i.trigger();break}}},refreshItemNum:function(e,t){for(var i=0;i<this.itemList.length;i++){var c=this.itemList[i].getComponent("Item");if(c.cfgId==e){c.txtCount.string=t;break}}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0d029pbdspBQZQHImTjZ76I","EventLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{figure:cc.Sprite,txtName:cc.Label,txtDesc:cc.Label,txtResults:[cc.Label],endPrefab:cc.Prefab,btnLeave:cc.Node,btnPlay:cc.Node},onLoad:function(){this.cfgId=c.eventId;var e=o.get("cfg_event",this.cfgId);this.txtName.string=e.name,this.txtDesc.string=e.desc,cc.loader.loadRes("Texture/npc/figure/"+this.cfgId,cc.SpriteFrame,function(e,t){this.figure.spriteFrame=t}.bind(this));for(var t=0;t<3;t++)this.txtResults[t].string=e["result"+(t+1)];this.btnLeave.opacity=0,this.btnPlay.opacity=0,this.btnLeave.y-=150,this.btnPlay.y-=150,this.btnLeave.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnPlay.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))},onBattle:function(){window.homeLayer=null,cc.director.loadScene("yahtzee")},onLeave:function(){if("\u65e0"!=o.get("cfg_event",this.cfgId).result3){var e=cc.instantiate(this.endPrefab);e.getComponent("EndYahtzeeLayer").init(2),window.homeLayer.node.addChild(e)}this.close()},close:function(){this.node.destroy(),c.floorBeats[c.floor-1]=!0}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(e,t,i){"use strict";cc._RF.push(t,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{box:cc.Sprite,mark:cc.Sprite,markCurrent:cc.Node},init:function(e,t,i){i&&(cc.loader.loadRes("Texture/UI/map/box_fort1",cc.SpriteFrame,function(e,t){this.box.spriteFrame=t}.bind(this)),this.markCurrent.active=!0,this.markCurrent.runAction(cc.sequence(cc.moveBy(.35,cc.v2(0,10)),cc.moveBy(.35,cc.v2(0,-10))).repeatForever())),0==t?cc.loader.loadRes("Texture/UI/map/image_fort0"+e,cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)):(cc.loader.loadRes(e>0?"Texture/UI/map/image_fort"+e:"Texture/UI/map/box_fort2",cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)),i||(this.mark.node.scale=.8))}}),cc._RF.pop()},{}],Game:[function(e,t,i){"use strict";cc._RF.push(t,"f5308O6zsVOxr+EKRsyR7ba","Game");var c=e("Config"),o={version:0,getData:function(e){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(t){cc.log("getStorageSuccess:"+t.data),void 0!=t.data?(o.syncFromStorage(JSON.parse(t.data)),e()):(this.setDataToBase(),e())}.bind(this),fail:function(){this.setDataToBase(),e()}.bind(this)});else{var t=cc.sys.localStorage.getItem("dice");void 0!=t?o.syncFromStorage(JSON.parse(t)):this.setDataToBase(),e()}},setDataToBase:function(){o.heroId=1,o.difficulty=1,o.deck=[],o.cardBag=[],o.equip=[],o.hp=o.hpMax=40,o.power=0,o.powerMax=20,o.heroPos=2,o.exp=0,o.level=1,o.character=1,o.castle=1,o.floor=1,o.roomType=0,o.copper=50,o.debuff=0,o.shopIds=[],o.eventIds=[],o.monsterList=[],o.historyPath=[],o.historyChoose=[0],o.floorBeats=[],o.specialRoomIds=[],o.monsterBeats=[],o.discountCard=o.discountItem=-1,o.itemEffect={feather:0,vase:0,flagon:0,pen:0,vip1:!1,vip2:!1},o.saveData()},syncFromStorage:function(e){for(var t=["deck","cardBag","equip","hp","hpMax","power","powerMax","heroPos","stayRoom","newRoom","level","floor","castle","roomType","copper","debuff","shopIds","eventIds","floorCfg","historyPath","historyChoose","discountCard","discountItem","itemEffect","specialRoomIds","exp","monsterBeats"],i=0;i<t.length;i++)o[t[i]]=e[t[i]]},saveData:function(){o.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(o),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(o))},getItem:function(e){if(71==e)o.copper+=30;else if(87==e)for(var t=0;t<2;t++)o.getItem(o.getNewItemId(0,2));else o.equip.push(e);if(10==e)o.itemEffect.feather=1;else if(28==e)o.itemEffect.vase+=2;else if(29==e)o.itemEffect.flagon+=2;else if(40==e)o.hpMax+=5,o.hp+=5;else if(41==e)o.hpMax+=10,o.hp+=10;else if(46==e)o.itemEffect.vip1=!0;else if(47==e)o.itemEffect.vip2=!0;else if(72==e)o.copper+=50,o.hpMax+=10,o.hp+=10;else if(74==e)o.itemEffect.pen+=3;else if(84==e)for(var i=0;i<3;i++)o.getItem(o.getNewItemId(0));else 92==e?(o.hpMax=Math.max(o.hpMax-8,1),o.hp=Math.min(o.hp,o.hpMax)):95==e?(o.hpMax+=10,o.hp=o.hpMax):96==e?(o.hpMax=Math.max(o.hpMax-10,1),o.hp=Math.min(o.hp,o.hpMax)):105==e?(o.hpMax+=20,o.hp+=20):106==e&&(o.powerMax+=10);94!=e&&o.equip.indexOf(94)>=0&&(o.hpMax+=5,o.hp+=5),window.homeLayer&&window.homeLayer.refreshHeroData()},getCard:function(e){var t=2==o.heroId?4:6;o.deck.length<t?o.deck.push(e):(o.cardBag.push(e),o.newCard=!0,window.homeLayer&&window.homeLayer.refreshHeroData())},getNewItemId:function(e,t,i){for(var s=0;s<=0;){var n=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_item).length)+1;if(o.equip.indexOf(n)<0&&(0==e&&c.get("cfg_item",n).get<=1||1==e&&0==c.get("cfg_item",n).get||2==e)){var r=c.get("cfg_item",n),a=0;t?r.quality==t&&(a=n):a=n,i?r.hero==o.heroId&&(s=a):0==r.hero&&(s=a)}}return s},getNewCardId:function(e,t,i){for(var s=0;s<=0;){var n=o.getRandomCardId(null,t);if(o.deck.indexOf(n)<0&&o.cardBag.indexOf(n)<0){var r=c.get("cfg_card",n),a=0;e?r.quality==e&&(a=n):a=n,i?r.hero==o.heroId&&(s=a):0==r.only&&(s=a)}}return s},getRandomCardId:function(e,t){for(var i=0;i<=0;){var o=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_card).length)+1;c.get("cfg_card",o).get==(t?2:1)&&(e?c.get("cfg_card",o).element==e&&(i=o):i=o)}return i},getNewMonsterId:function(e,t){for(var i=0;i<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_monster).length)+1;o.monsterBeats.indexOf(s)<0&&c.get("cfg_monster",s).level==e&&c.get("cfg_monster",s).type==t&&(i=s)}return i},analysisDesc:function(e,t){for(var i="",c=0,o="",s={1:"fire",2:"water",3:"wind",4:"earth",5:"light",6:"dark",7:t?"atk2":"atk",9:"suck",11:"armor",12:"heal",13:"dodge",14:"power",15:"heart",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"atkback"},n={1:"FF3832",2:"2CB4FF",3:"00F776",4:"FF9652",5:"FFFB4B",6:"BF7FE4",7:t||"FFFFFF",9:"FF5567",11:"42EBFF",12:"98F700",13:"FFF830",14:"FFFB4B",15:"FF5567",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FF5567"},r=0;r<e.length;r++)"#"==e[r]?0==c?(c=1,o="",i+="<img src='"):(i+=s[parseInt(o)],i+="'/>",c=0):"["==e[r]?(o="",0==c&&(c=2,i+="<color=#")):"]"==e[r]?""!=o?(i+=n[parseInt(o)],i+=">",c=-1):(c=0,i+="</c>"):c<=0?e[r]>="A"&&e[r]<="F"?i+=" <img src='dice"+(e[r].charCodeAt()-64)+"'/> ":i+=e[r]:o+=e[r];return i}};t.exports=o,cc._RF.pop()},{Config:"Config"}],HelloWorld:[function(e,t,i){"use strict";cc._RF.push(t,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var c=e("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,hero:cc.Node,txtFloor:cc.Label,roomPrefab:cc.Prefab,stripHp:cc.ProgressBar,txtHp:cc.Label,stripExp:cc.ProgressBar,txtExp:cc.Label,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,txtEquipCount:cc.Label,markRed:cc.Node,layerNode:cc.Node,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,equipPrefab:cc.Prefab,completePrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab,btnMap:cc.Node,btnEquip:cc.Node,btnDeck:cc.Node,mask:cc.Node},onLoad:function(){window.homeLayer=this,1==c.floor&&1==c.castle&&this.initGameConfig(),this.createRoom(),this.refreshHeroData(),c.levelUp&&this.scheduleOnce(this.openLvUp,.3),this.status=0,this.mask.active=!0,this.mask.zIndex=1e3,this.mask.width=this.mask.height=100,this.schedule(this.updateMask,0)},createRoom:function(){var e=cc.instantiate(this.roomPrefab);this.bg.addChild(e),this.room=e,this.hero.parent=e,this.hero.zIndex=10,1==c.floor&&1==c.castle?(e.getComponent("Room").init(!0),e.getComponent("Room").initHero()):e.getComponent("Room").init(!1)},changeRoom:function(e){var t=cc.instantiate(this.roomPrefab);this.bg.addChild(t),t.getComponent("Room").init(!0);var i=cc.v2();0==e?(t.position=cc.v2(0,1450),i=cc.v2(0,-1450)):1==e?(t.position=cc.v2(1080,0),i=cc.v2(-1080,0)):2==e?(t.position=cc.v2(0,-1450),i=cc.v2(0,1450)):3==e&&(t.position=cc.v2(-1080,0),i=cc.v2(1080,0));var c=this.room;c.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.hero.parent=t,this.hero.zIndex=10,c.destroy()}.bind(this)))),t.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.room=t,t.getComponent("Room").initHero()}.bind(this))))},openAlter:function(){if(2==c.roomType){var e=cc.instantiate(this.campPrefab);this.node.addChild(e)}else if(3==c.roomType||c.roomType>=6){var t=cc.instantiate(this.treasurePrefab);t.getComponent("TreasureLayer").init(7==c.roomType),this.node.addChild(t)}else if(4==c.roomType){var i=cc.instantiate(this.eventPrefab);this.node.addChild(i)}else if(5==c.roomType){var o=cc.instantiate(this.shopPrefab);this.layerNode.addChild(o)}},refreshHeroData:function(){this.txtHp.string=c.hp+"/"+c.hpMax,this.stripHp.progress=c.hp/c.hpMax;var e=[7,15,25,37,51,67,150][c.level-1];this.txtExp.string=c.exp+"/"+e,this.stripExp.progress=c.exp/e,this.txtLevel.string="Lv."+c.level,this.txtCopper.string=c.copper,this.txtEquipCount.string=c.equip.length,this.markRed.active=c.newCard},openMap:function(){if(window.mapLayer)window.mapLayer.mask.opacity>=180&&window.mapLayer.close();else{var e=cc.instantiate(this.mapPrefab);this.layerNode.addChild(e)}},openCardBag:function(){if(window.bagLayer)window.bagLayer.mask.active&&window.bagLayer.close();else{var e=cc.instantiate(this.bagPrefab);this.layerNode.addChild(e)}},openEquip:function(){if(window.equipLayer)window.equipLayer.mask.active&&window.equipLayer.close();else{var e=cc.instantiate(this.equipPrefab);this.layerNode.addChild(e)}},openLvUp:function(){var e=cc.instantiate(this.lvUpPrefab);this.node.addChild(e)},openComplete:function(){var e=cc.instantiate(this.completePrefab);this.node.addChild(e)},initDeck:function(){var e=2==c.heroId?2:3;if(c.deck.length+c.cardBag.length<=e)for(;c.deck.length<e;){var t=c.getNewCardId(null,!0);c.getCard(t)}},initGameConfig:function(){this.initDeck(),c.eventIds=[];for(var e=0;e<17;e++){var t=Math.floor(Math.random()*(c.eventIds.length+1));c.eventIds.splice(t,0,e+1)}c.specialRoomIds=[3,4];for(var i=[[2,4,5],[2,3,4,4,5],[2,3,4,4]],o=0;o<3;o++)for(var s=i[o],n=s.length-1;n>=0;n--){var r=Math.floor(Math.random()*s.length);c.specialRoomIds.push(s[r]),s.splice(r,1)}c.specialRoomIds.push(5),c.floorQuests=[[],[],[]];for(var a=0;a<3;a++)for(var h=0;h<13;h++)this.initFloorConfig(a,h)},initFloorConfig:function(e,t){var i=[];if(0==t)i=[1];else if(4==t)i=[6,6];else if(10==t)i=[7];else if(11==t)i=e<2?[0]:[7];else if(12==t){if(e<2)return;i=[0]}else if(2==t||6==t||8==t)i=Math.random()<.4?[1,1,1]:[1,1];else{var o=c.specialRoomIds.shift();i=Math.random()<.3?[o,1,1]:[o,1]}c.floorQuests[e].push(i)},gotoEdit:function(){cc.director.loadScene("edit")},goBattle:function(){this.status=2,this.mask.active=!0,this.schedule(this.updateMask,0)},updateMask:function(){0==this.status?(this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1,this.status)):2==this.status&&(this.mask.width-=60,this.mask.height-=60,this.mask.width<=100&&(this.mask.width=this.mask.height=100,this.unschedule(this.updateMask),window.homeLayer=null,cc.director.loadScene("mainLayer")))}}),cc._RF.pop()},{Game:"Game"}],Hero:[function(e,t,i){"use strict";cc._RF.push(t,"7311fX1RYNN1bDgBGcTZsee","Hero");var c=e("Game");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,skillPrefab:cc.Prefab,head:cc.Node,skillNode:cc.Node,txtDice:cc.Label,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){this.btnEnd=window.mainLayer.btnEnd,this.btnRoll=window.mainLayer.btnRoll,this.txtRollCount=window.mainLayer.txtRollCount,this.deck=c.deck.concat(),this.player.init(0),this.hpMax=c.hpMax,this.hp=c.hp,this.power=c.power,this.powerMax=c.powerMax,this.armor=0,this.rollabled=!0,this.refreshStrip(),this.initSkills()},startRound:function(){this.btnEnd.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.2,cc.v2(-275,140))))},endRound:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").abled=!0;this.checkSkills(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-475,140))),this.player.rollCount=0,this.checkBtnRoll()},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onHurt:function(e,t,i){if(!window.mainLayer.gameOver){var c=this.hp;i=i||7,this.player.onHurt(e,t,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),c>this.hp&&this.addPower(c-this.hp)}},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(e){this.power+=e,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.checkSkills()},updateArmor:function(e){this.armor+=e,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor,this.stripHp.node.color=cc.color(24,136,176),this.barHp.color=cc.color(92,214,255)):(this.armor=0,this.boxArmor.active=!1,this.stripHp.node.color=cc.color(172,45,56),this.barHp.color=cc.color(252,94,108)),e>0&&this.player.anim.show(11)},initSkills:function(){this.btnSkills=[];for(var e=0;e<2;e++){var t=cc.instantiate(this.skillPrefab);t.position=cc.v2(0==e?127:285,31),t.getComponent("Skill").init(e),this.skillNode.addChild(t),this.btnSkills.push(t)}},checkSkills:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").check()},checkBtnRoll:function(e){var t=!1;if(this.player.rollCount>0)if(this.player.cardList.length>0)t=!0;else if(this.player.chestList)for(var i=0;i<3;i++)if(this.player.chestList[i]){t=!0;break}t!=this.rollabled?(this.rollabled=t,t?this.btnRoll.runAction(cc.moveTo(.15,cc.v2(310,140))):this.btnRoll.runAction(cc.moveTo(.15,cc.v2(425,140)))):t&&e&&this.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(425,140)),cc.moveTo(.15,cc.v2(310,140)))),this.txtRollCount.string=this.player.rollCount},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"9C434A"};t[e]&&(this.head.color=cc.Color.WHITE.fromHEX("#"+t[e]),window.mainLayer.camera.stopAllActions(),window.mainLayer.camera.runAction(cc.sequence(cc.moveTo(.05,cc.v2(5,5)),cc.moveTo(.1,cc.v2(-5,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){window.mainLayer.camera.position=cc.v2(0,0),this.head.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Game:"Game"}],ItemCollection:[function(e,t,i){"use strict";cc._RF.push(t,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.RichText,icon:cc.Sprite,boxHead:cc.Sprite},init:function(e){var t=o.get("cfg_item",e),i=[cc.color(85,229,255),cc.color(255,128,242),cc.color(255,154,73)];this.txtName.string=t.name;var s=c.analysisDesc(t.desc1),n=-1;10==e?n=c.itemEffect.feather>0?1:0:28==e?n=c.itemEffect.vase:29==e?n=c.itemEffect.flagon:74==e&&(n=c.itemEffect.pen),n>=0&&(s+="<color=#EBC82E>  (\u5269\u4f59\u6b21\u6570"+n+")</c>"),this.txtDesc.string=s,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][t.quality-1],this.txtQuality.node.color=i[t.quality-1],cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+t.quality,cc.SpriteFrame,function(e,t){this.boxHead.spriteFrame=t}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ItemCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtName2:cc.Label,icon:cc.Sprite,bg:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite},init:function(e){var t=o.get("cfg_item",e);this.txtName.string=this.txtName2.string=t.name,this.txtDesc.string=c.analysisDesc(t.desc1),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_item"+t.quality,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+t.quality,cc.SpriteFrame,function(e,t){this.boxIcon.spriteFrame=t}.bind(this))},hideBox:function(){this.bg.node.active=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Item:[function(e,t,i){"use strict";cc._RF.push(t,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,iconBtn:cc.Button,boxNum:cc.Node,txtCount:cc.Label,tip:cc.Node,txtDesc:cc.RichText,box:cc.Node},init:function(e,t){this.cfgId=e,this.cfg=o.get("cfg_item",e),this.equip=t,cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),43==e&&(this.boxNum.active=!0)},trigger:function(){this.action&&this.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.5),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,1==this.cfg.num&&this.doDisabled()}.bind(this))),this.icon.node.runAction(this.action)},doDisabled:function(){this.iconBtn.enableAutoGrayEffect=!0},openTip:function(){if(1!=this.equip.index){if(window.mainLayer.equipTip){if(window.mainLayer.equipTip==this)return void this.hideTip();window.mainLayer.equipTip.hideTip()}this.tip.active=!0,window.mainLayer.equipTip=this;this.txtDesc.string="<color=#"+["5CC7FF","C262FF","FF9231"][this.cfg.quality-1]+">"+this.cfg.name+"\uff1a</c>"+c.analysisDesc(this.cfg.desc1),this.node.x<-220?this.box.x=-220-this.node.x:this.node.x>220&&(this.box.x=220-this.node.x),this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.tip.active=!1,window.mainLayer.equipTip=null}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LevelUpLayer:[function(e,t,i){"use strict";cc._RF.push(t,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,boxSkill:cc.Node,iconSkill:cc.Sprite,txtSkill:cc.Label,boxCard:cc.Node,btns:[cc.Node],txtLevel:cc.Label,shine:cc.Node,boxReward:cc.Node,txtNext:cc.Node,mask:cc.Node,bg:cc.Node,bgNode:cc.Node,boxMax:cc.Node},onLoad:function(){this.type=3,3==c.level?this.initSkill():5==c.level||7==c.level?(this.type=2,this.initItems()):(this.type=1,this.initCards()),this.txtLevel.string=c.level,this.boxReward.opacity=0,this.shine.opacity=0,this.bg.height=400,this.step=0,this.schedule(this.updateFrame,0),this.shine.runAction(cc.rotateBy(5,360).repeatForever()),this.shine.runAction(cc.fadeIn(.5))},updateFrame:function(){if(0==this.step)this.bg.height+=30,this.bg.height>846&&this.step++;else if(this.bg.height-=3,this.bg.height<=826){this.unschedule(this.updateFrame),this.boxReward.opacity=255;for(var e=0;e<2;e++)this.btns[e].opacity=0,this.btns[e].y-=100,this.btns[e].runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,110)),cc.moveBy(.1,cc.v2(0,-10)))))}},initCards:function(){this.boxCard.active=!0,this.itemIdList=[],this.items=[];var e=c.getNewCardId(null,!1,!0);this.itemIdList.push(e);for(var t=0;t<=0;){var i=c.getNewCardId(null,!1,!0);i!=e&&(t=i)}this.itemIdList.push(t);for(var o=0;o<2;o++){var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(this.itemIdList[o]),s.position=cc.v2(0==o?-170:170,45),this.boxCard.addChild(s),this.items.push(s)}},initItems:function(){this.boxCard.active=!0,this.itemIdList=[],this.items=[];var e=c.getNewItemId(0,null,!0);this.itemIdList.push(e);for(var t=0;t<=0;){var i=c.getNewItemId(0,null,!0);i!=e&&(t=i)}this.itemIdList.push(t);for(var o=0;o<2;o++){var s=cc.instantiate(this.itemPrefab);s.getComponent("ItemCommodity").init(this.itemIdList[o]),s.position=cc.v2(0==o?-170:170,45),this.boxCard.addChild(s),this.items.push(s)}},initSkill:function(){this.boxSkill.active=!0;this.txtSkill.string=["\u53cc\u6253","\u5927\u6ee1\u8d2f"][c.heroId-1],cc.loader.loadRes("Texture/hero/skill/"+2*c.heroId,cc.SpriteFrame,function(e,t){this.iconSkill.spriteFrame=t}.bind(this)),this.txtNext.active=!0,this.mask.on(cc.Node.EventType.TOUCH_START,this.close,this)},choose:function(e,t){1==this.type?c.getCard(this.itemIdList[t]):c.getItem(this.itemIdList[t]),this.close(t)},close:function(e){if(c.levelUp=!1,3==this.type)this.node.destroy();else{this.mask.runAction(cc.fadeOut(.2)),this.bgNode.active=!1,this.boxMax.active=!1,this.btns[0].active=this.btns[1].active=!1,this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4);var t=cc.winSize.height/cc.winSize.width*750;this.items[1-e].active=!1,1==this.type?this.items[e].runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.spawn(cc.moveTo(.3,cc.v2(312,-t/2-80+115+33+120-30)),cc.scaleTo(.3,.4)))):(this.items[e].getComponent("ItemCommodity").hideBox(),this.items[e].runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveTo(.3,cc.v2(211,-t/2-80+115+33+120-30-35)))))}}}),cc._RF.pop()},{Game:"Game"}],LoseLayer:[function(e,t,i){"use strict";cc._RF.push(t,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){if(c.floor>1){c.floor--;var e=c.historyPath[c.floor-1].indexOf(-2);e>=0&&(c.heroPos=e),c.floor>1?c.roomType=c.historyChoose[c.floor-1]:c.roomType=0,-1==c.itemEffect.feather&&(c.itemEffect.feather=1)}cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(e,t,i){"use strict";cc._RF.push(t,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{heroPrefab:cc.Prefab,enemyPrefab:cc.Prefab,enemyNode:cc.Node,endPrefab:cc.Prefab,losePrefab:cc.Prefab,editEndPrefab:cc.Prefab,btnEnd:cc.Node,btnRoll:cc.Node,boxCardHero:cc.Node,boxDiceHero:cc.Node,boxCardEnemy:cc.Node,boxDiceEnemy:cc.Node,board:cc.Node,camera:cc.Node,txtRollCount:cc.Label,bg:cc.Sprite,mask:cc.Node},onLoad:function(){window.mainLayer=this,this.gameOver=!1,cc.loader.loadRes("Texture/scene/castle"+c.castle,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this)),this.bg.node.on(cc.Node.EventType.TOUCH_START,this.hideTip,this),this.mask.active=!0,this.mask.zIndex=1e3,this.schedule(this.updateMask,0)},start:function(){var e=cc.instantiate(this.heroPrefab);e.position=cc.v2(0,115-cc.winSize.height/2),this.node.addChild(e),this.hero=e.getComponent("Hero");var t=cc.instantiate(this.enemyPrefab);t.position=cc.v2(0,cc.winSize.height/2-300),this.enemyNode.addChild(t),this.enemy=t.getComponent("Enemy"),this.hero.init(),this.enemy.init(),this.roundId=1,this.scheduleOnce(function(){this.doRound()}.bind(this),.5)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.player.startRound()},showEnd:function(e){if(this.gameOver=!0,c.editCfg){var t=cc.instantiate(this.editEndPrefab);this.node.addChild(t)}else this.scheduleOnce(function(){if(0==e){var t=cc.instantiate(this.endPrefab);this.node.addChild(t)}else{var i=cc.instantiate(this.losePrefab);this.node.addChild(i)}}.bind(this),.5)},roll:function(){this.hero.player.roll()},endRound:function(){this.hero.player.endRound()},hideTip:function(){this.equipTip&&this.equipTip.hideTip(),this.buffTip&&this.buffTip.hideTip()},updateMask:function(){this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1)}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2be16dXDepLLbZP42Rqq+om","MapLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{scroll:cc.ScrollView,content:cc.Node,fortPrefab:cc.Prefab,mask:cc.Node,markBoss:cc.Node,lineNode:cc.Node,line:cc.Node,txtTitle:cc.Label,view:cc.Node,top:cc.Node,bottom:cc.Node,box:cc.Node,btnBack:cc.Node},onLoad:function(){window.mapLayer=this;this.txtTitle.string="\u53e4\u5821"+["\u4e00","\u4e8c","\u4e09"][c.castle-1]+"\u5c42",window.bagLayer?window.bagLayer.close():window.equipLayer&&window.equipLayer.close(),this.box.opacity=0,this.mask.opacity=0,this.mask.runAction(cc.sequence(cc.fadeTo(.2,180),cc.callFunc(function(){this.openMap()}.bind(this)))),this.drawMap()},openMap:function(){this.box.opacity=255,this.winHeight=cc.winSize.height/cc.winSize.width*750,this.bottom.y=-this.winHeight/2+330,this.bottom.runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.05,cc.v2(0,-150)),cc.moveBy(.1,cc.v2(0,-50)),cc.moveBy(.1,cc.v2(0,15)))),this.top.y=-this.winHeight/2+435,this.top.runAction(cc.sequence(cc.delayTime(.05),cc.moveTo(.3,cc.v2(0,this.winHeight/2-129)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.1,cc.v2(0,-10)))),this.view.height=50,this.view.y=(this.bottom.y+this.top.y)/2-9,this.btnBack.opacity=0,this.btnBack.y-=200,this.btnBack.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,200)),cc.fadeIn(.1)))),this.frame=0,this.schedule(this.updateFrame,0)},updateFrame:function(){this.frame++,this.view.height=this.top.y-this.bottom.y-65,this.view.y=(this.bottom.y+this.top.y)/2-9},drawMap:function(){var e=cc.instantiate(this.fortPrefab);e.getComponent("Fort").init(0,1,1==c.floor),e.position=cc.v2(0,66),this.content.addChild(e);var t=0,i=c.historyPath.length;i>=12&&(this.markBoss.active=!1,i=12);for(var o=0;o<i;o++){for(var s=c.historyPath[o],n=0,r=0;r<4;r++)if(null!=c.historyChoose[o+1]){if(s[r]==c.historyChoose[o+1]){n=r;break}}else if(s[r]>0){n=r;break}var a=s[n];if(a>0&&(11!=c.historyPath.length||10!=o)){for(var h=[-1,0,1],d=[],l=0;l<3;l++){var f=t+h[l],p=o<7?4:10-o;f>=-p&&f<=p&&d.push(f)}var u=d[Math.floor(Math.random()*d.length)];o<c.historyPath.length-1&&this.createLine(t,u,o),t=u;var m=cc.instantiate(this.fortPrefab);m.getComponent("Fort").init(a,o==c.historyPath.length-1?2:1,o==c.floor-2),m.position=cc.v2(70*t,198+132*o),this.content.addChild(m);for(var g=[-1,1],v=2;v>=0;v--){var y=g[v]+t;(y<-4||y>4)&&g.splice(v,1)}for(var w=0;w<4;w++){var b=s[w];if(w!=n&&b>0){var C=Math.floor(Math.random()*g.length),x=g[C],L=t+x;g.splice(C,1);var k=cc.instantiate(this.fortPrefab);if(k.getComponent("Fort").init(b,o==c.historyPath.length-1?2:0),k.position=cc.v2(70*L,198+132*o),this.content.addChild(k),-1==x||1==x){var q=2*x+t;q>=-4&&q<=4&&g.push(2*x)}}}}}var I=0;c.historyPath.length>=9?I=1:c.historyPath.length>4&&(I=(c.historyPath.length-4)/5),this.scroll.scrollToPercentVertical(I,.3)},createLine:function(e,t,i){var c=cc.instantiate(this.line);c.position=cc.v2(70*e,66+132*i),this.lineNode.addChild(c);var o=0,s=1;e==t?(o=Math.floor(2*Math.random())+1,s=Math.random()<.5?1:-1):(o=Math.floor(3*Math.random())+3,s=t>e?1:-1),cc.loader.loadRes("Texture/UI/map/image_load"+o,cc.SpriteFrame,function(e,t){c&&(c.scaleX=s,c.x-=10*s,c.getComponent(cc.Sprite).spriteFrame=t)}.bind(this))},close:function(){this.btnBack.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,-300)),cc.fadeIn(.3))),this.bottom.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveBy(.1,cc.v2(0,50)),cc.moveTo(.1,cc.v2(0,-this.winHeight/2+280)))),this.top.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,10)),cc.moveBy(.1,cc.v2(0,-20)),cc.moveTo(.2,cc.v2(0,-this.winHeight/2+385)))),this.mask.runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.15,cc.v2(0,-400)),cc.callFunc(function(){this.node.destroy(),window.mapLayer=null,window.homeLayer.btnMap.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(e,t,i){"use strict";cc._RF.push(t,"52880hyyK1GjLw1tAGJFFaD","Opening");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{endPrefab:cc.Prefab},onLoad:function(){this.login()},login:function(){o.load(function(){c.setDataToBase(),this.loadRes(),this.gotoMain()}.bind(this))},gotoMain:function(){cc.director.loadScene("prepare")},loadRes:function(){}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Sprite]},init:function(e){this.index=e,this.win=0,this.dicePool=new cc.NodePool;for(var t=0;t<5;t++){var i=cc.instantiate(this.dicePrefab);this.dicePool.put(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){this.diceList=[];for(var e=0;e<5;e++){var t=this.dicePool.get();t.getComponent("DiceYahtzee").init(e,this.index),this.boxDice.addChild(t),this.diceList.push(t)}this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check()}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.hold(),t.abled=!1}}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){e[this.diceList[t].getComponent("DiceYahtzee").element-1]++}e.sort(function(e,t){return t-e}),5==e[0]?this.score=7:4==e[0]?this.score=6:3==e[0]?2==e[1]?this.score=5:this.score=4:2==e[0]?2==e[1]?this.score=3:this.score=1:this.score=2},doWin:function(){cc.loader.loadRes("Texture/battle/mark_crown1",cc.SpriteFrame,function(e,t){this.crowns[this.win].spriteFrame=t,this.win++}.bind(this))}}),cc._RF.pop()},{}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"ba4f5YaUElBy61UWqBofsfz","Player");var c=e("Game"),o=e("Utils"),s=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,chestPrefab:cc.Prefab,dmgAnimation:cc.Prefab},init:function(e){this.index=e,0==e?(this.host=this.getComponent("Hero"),this.opponent=window.mainLayer.enemy.player,this.boxCard=window.mainLayer.boxCardHero,this.boxDice=window.mainLayer.boxDiceHero):(this.host=this.getComponent("Enemy"),this.opponent=window.mainLayer.hero.player,this.boxCard=window.mainLayer.boxCardEnemy,this.boxDice=window.mainLayer.boxDiceEnemy),this.buff=this.getComponent("Buff"),this.buff.init(),this.equip=this.getComponent("Equip"),this.equip.init(),this.cardPool=new cc.NodePool;for(var t=0;t<6;t++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var c=0;c<5;c++){var o=cc.instantiate(this.dicePrefab);this.dicePool.put(o)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.atkPlayed=0,this.atkRound=0,this.diceUsabld=!0,this.cardUsabled=!0,this.deck=this.host.deck,this.diceCount=0==e?5:this.host.diceCount;for(var s=[85,86,89,90,91,92],n=0;n<s.length;n++)this.equip.checkWithTrigger(s[n])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++,this.host.txtDice.string="\xd7"+this.diceCount;var r=cc.instantiate(this.dmgAnimation);this.node.addChild(r),0==this.index?(r.scale=.8,r.position=cc.v2(-302,33)):r.position=cc.v2(0,this.host.figureNode.y+this.host.figure.height/2),this.anim=r.getComponent("DmgAnimation"),this.anim.init(e)},start:function(){this.checkGameBegin()},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,this.checkStart(),0==this.index&&(this.diceUsabld=!1,this.cardUsabled=!1,2==c.heroId&&(this.chestList=[null,null,null],this.createChest())),this.initCards(),this.initDices(),window.mainLayer.gameOver||this.host.startRound()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var e=this.diceCount+this.extraDice,t=o.getDifferentRandomNum(e,e-1,0),i=Math.min(this.buff.lock,e),c=t.splice(0,i);this.buff.removeBuff(28,i);var s=0,n=[];this.equip.checkWithTrigger(63)||(s=Math.min(this.buff.freeze,e-i),n=t.splice(0,s),this.buff.removeBuff(22,s));for(var r=0;r<e;r++){for(var a=null,h=0;h<c.length;h++)if(r==c[h]){a=28;break}if(!a)for(var d=0;d<n.length;d++)if(r==n[d]){a=22;break}var l=null;l=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab);var f=0;f=e<=6?-(e-1)/2*110+110*r:640/(e-1)*r-320,l.position=cc.v2(f,0==window.mainLayer.roundId?-120:600),l.getComponent("Dice").init(r,a),this.boxDice.addChild(l),this.diceList.push(l)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[];for(var e=Math.min(this.deck.length,6),t=this.equip.checkWithTrigger(66)?0:this.buff.silence,i=this.equip.checkWithTrigger(62)?0:this.buff.burn,c=0;c<e;c++){var o=null,n=s.get("cfg_card",this.deck[c]).element;this.buff.silenceDark&&6==n?o=25:Math.random()<t/(e-c)?(o=25,t--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==n?o=21:Math.random()<i/(e-c)&&(o=21,i--,this.buff.removeBuff(21,1)),this.drawCard(this.deck[c],o)}},drawCard:function(e,t,i){var c=this.getEmptyIndex();if(!(c<0)){var o=null;return(o=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(e,c,t,0),o.getComponent("Card").isTemp=i,this.boxCard.addChild(o,100),this.cardList.push(o),o}},patchCard:function(e,t,i){var o=this.buff,n=null;e=e||c.getRandomCardId();var r=s.get("cfg_card",e).element;o.silenceDark&&6==r?n=25:o.silence>0&&!this.equip.checkWithTrigger(66)?(n=25,o.removeBuff(25,1)):o.burnIce&&2==r?n=21:o.burn>0&&!this.equip.checkWithTrigger(62)&&(n=21,o.removeBuff(21,1));var a=this.drawCard(e,n,!t);return i&&a.getComponent("Card").disCost(),this.checkCardsRequire(),0==this.index&&this.host.checkBtnRoll(),this.equip.trigger(119),a},roll:function(e,t){for(var i=0;i<this.diceList.length;i++){var c=this.diceList[i].getComponent("Dice");1==e?c.roll():c.freeze||c.lock||c.temp||(t?(c.holded&&c.hold(),c.roll(t)):c.holded||c.roll())}if(e)this.scheduleOnce(function(){this.refreshCardBuff(),this.checkElement(),this.rollCount--}.bind(this),.2);else{this.checkElement();for(var o=0,s=0;s<6;s++)this.elementList[s]>0&&o++;o>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.rollCount--,0==window.mainLayer.roundId&&this.host.checkBtnRoll(!0)}},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var e=0;e<this.diceList.length;e++){var t=this.diceList[e].getComponent("Dice");t.lock||this.elementList[t.element-1]++}if(this.cardAbledCount=this.checkCardsRequire(),this.chestList)for(var i=0;i<3;i++)this.chestList[i]&&this.chestList[i].getComponent("Chest").checkRequire()},refreshCardBuff:function(){for(var e=0;e<this.cardList.length;e++)this.cardList[e].getComponent("Card").initBuff();this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2)},refreshDiceBuff:function(){for(var e=0;e<this.diceList.length;e++)this.diceList[e].getComponent("Dice").initBuff();this.checkElement();for(var t=0,i=0;i<6;i++)this.elementList[i]>0&&t++;t>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.cardAbledCount<=0&&this.equip.trigger(45);for(var c=48;c<=53;c++)this.equip.trigger(c);this.equip.trigger(93),0==window.mainLayer.roundId&&(this.host.checkBtnRoll(!0),this.diceUsabld=!0,this.cardUsabled=!0)},createExDice:function(e){var t=null;this.buff.lock>0?(t=28,this.buff.removeBuff(28,1)):this.buff.freeze>0&&!this.equip.checkWithTrigger(63)&&(t=22,this.buff.removeBuff(22,1));var i=null;i=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab),this.diceList.length<=5?i.x=this.diceList.length/2*110:i.x=320,i.getComponent("Dice").init(this.diceList.length-1,t),this.boxDice.addChild(i),this.diceList.push(i),i.getComponent("Dice").roll(e),e&&i.getComponent("Dice").doTemp();for(var c=0;c<this.diceList.length;c++){var o=this.diceList[c];o.stopAllActions(),o.opacity=255;var s=0;s=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*c:640/(this.diceList.length-1)*c-320,o.runAction(cc.moveTo(.2,cc.v2(s,0)))}this.checkElement(),this.extraDice++,this.host.txtExDice.string="(+"+this.extraDice+")"},endRound:function(){this.scheduleOnce(function(){for(var e=this.cardList.length-1;e>=0;e--)this.cardList[e].getComponent("Card").remove()}.bind(this),.3);for(var e=0;e<this.diceList.length;e++)this.diceList[e].getComponent("Dice").remove();if(this.chestList)for(var t=0;t<3;t++)this.chestList[t]&&this.chestList[t].getComponent("Chest").remove();this.host.endRound(),this.scheduleOnce(function(){this.buff.exRound>0?(this.startRound(),this.buff.removeBuff(101,1)):window.mainLayer.doRound()}.bind(this),.5),this.extraDice=0,this.host.txtExDice.string="",this.settleBuff(),this.settleEquip()},checkCardsRequire:function(){for(var e=0,t=0;t<this.cardList.length;t++){this.cardList[t].getComponent("Card").checkRequire()&&e++}return e},checkGameBegin:function(){for(var e=[6,12,13,14,15,16,17,18,19,20,21,30,37,44,86,91,96,114],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),7==c.roomType&&this.equip.trigger(61),0==this.index&&c.debuff>0&&this.onHurt(3*c.debuff,1,7)},checkStart:function(){this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]);for(var e=[5,9,25,84,105,111,121],t=0;t<e.length;t++)this.equip.trigger(e[t]);if(this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var i=this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?2:1);this.host.onHurt(i,1,26),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.removeBuff(102,1)},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.table[23]>0&&this.buff.removeBuff(23,1),this.buff.table[24]>0&&this.buff.removeBuff(24,1),this.buff.multiCast=this.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1},settleEquip:function(){for(var e=[2,3,27,11,57,59,60,104,110],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.opponent.equip.trigger(118),this.cardPlayedRound=0,this.atkRound=0,this.equip.swiftGlove=!1,this.equip.suckRemainder=0},onHurt:function(e,t,i){if(this.buff.frail>0&&0==t&&!this.equip.checkWithTrigger(64)){var c=.5;this.opponent.equip.checkWithTrigger(54)&&(c+=.25),this.equip.checkWithTrigger(56)&&(c-=.25),this.equip.checkWithTrigger(113)&&(c*=2),this.opponent.equip.checkWithTrigger(113)&&(c*=2),e=Math.floor(e*(c+1))}if(this.opponent.equip.checkWithTrigger(21)&&(e+=1),this.opponent.host.hp<10&&this.opponent.equip.checkWithTrigger(75)&&(e+=3),this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(e=0),e>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),e=1),e>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),e=1),e>0&&this.equip.checkWithTrigger(114)&&e--,9==i&&e>0&&this.opponent.host.onHeal(e),this.opponent.equip.suckRemainder+=e,this.opponent.equip.trigger(23),this.buff.atkBack>0&&0==t&&e>0&&this.opponent.host.onHurt(this.buff.atkBack,1,29),e>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(e,2,29),this.assertHpChange("-"+e,0),this.anim.show(i),this.host.armor>0){if(this.host.armor>=e)return void this.host.updateArmor(-e);e-=this.host.armor,this.host.updateArmor(-this.armor)}this.host.hp-=e,this.host.hp<=0&&this.buff.undead>0&&(this.anim.show(201),this.host.hp=1),this.host.hp<=0&&this.equip.trigger(10),this.equip.check(75)&&this.host.hp<.3*this.host.hpMax&&this.buff.atkAdd<3&&this.buff.addBuff(104,3),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},onHeal:function(e){if(this.equip.checkWithTrigger(122)){var t=Math.min(e,this.host.hpMax-this.host.hp);this.opponent.host.onHurt(t,2)}this.host.hp+=e,this.equip.trigger(102),this.equip.trigger(123),this.anim.show(12),this.equip.check(75)&&this.host.hp>=.3*this.host.hpMax&&this.buff.atkAdd>=3&&this.buff.removeBuff(104,3)},assertHpChange:function(e,t){this.showQueue.push([e,t]),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var e=this.showQueue[0],t=e[0],i=e[1],c=[cc.Color.WHITE,cc.color(139,255,70),cc.color(255,40,40),cc.color(60,247,255)],o=cc.instantiate(this.host.txtNum);o.getComponent(cc.Label).string=t,o.color=c[i],o.position=this.host.txtNum.position,this.node.addChild(o),o.scale=0;var s=cc.spawn(cc.moveBy(.1,cc.v2(30,10)),cc.scaleTo(.1,1.1));s=cc.spawn(cc.moveBy(.05,cc.v2(0,0==this.index?0:-10)),cc.scaleTo(.05,1));o.runAction(cc.sequence(s,s,cc.moveBy(.05,cc.v2(13+10*Math.random(),3+5*Math.random())),cc.moveBy(.1,cc.v2(3+10*Math.random(),-3-10*Math.random())),cc.fadeOut(.5),cc.callFunc(function(){o.destroy()}.bind(this)))),o.runAction(cc.sequence(cc.delayTime(.15),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this))))},getEmptyIndex:function(){for(var e=0;e<6;e++){var t=!1;if(this.chestList&&this.chestList[e%3]&&(t=!0),!t)for(var i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==e){t=!0;break}}if(!t)return e}return-1},createChest:function(e){for(var t=-1,i=2;i>=0;i--)if(!this.chestList[i]){t=i;break}if(t>=0){var c=cc.instantiate(this.chestPrefab);c.getComponent("Chest").init(t),this.boxCard.addChild(c,100),this.chestList[t]=c,e&&c.getComponent("Chest").checkRequire()}}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],PotionCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"85c55EVbbNKe72lZU+lcHho","PotionCommodity"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,txtName:cc.Label},init:function(e){cc.loader.loadRes("Texture/UI/image_potion"+e,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)),this.txtName.string="\u751f\u547d +"+10*e}}),cc._RF.pop()},{}],PrepareLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c0348borGFFHIk076MyCFu2","PrepareLayer");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{btns:[cc.Node],boxSelected:cc.Node,edges:[cc.Node],boxDesc:cc.Sprite,txtName:cc.Label,txtDesc:cc.Label,txtDifficulty:cc.Label,btnDifficulty:[cc.Node],markDifficulty:cc.Node,btnStart:cc.Button,tree:cc.Node,descNode:cc.Node,characterNode:cc.Node,figure:cc.Node,figureNode:cc.Node,mask:cc.Node},onLoad:function(){this.abled=!1,this.heroId=1,this.difficultyId=1,this.refreshInfo();for(var e=0;e<4;e++){var t=this.edges[e].position;this.edges[e].runAction(cc.sequence(cc.moveTo(.3,t.mul(1.1)),cc.moveTo(.3,t)).repeatForever())}this.tree.getComponent(cc.Widget).left=-300,this.characterNode.getComponent(cc.Widget).bottom=-135,this.descNode.getComponent(cc.Widget).bottom=-.08,this.figure.x+=550,this.btnStart.node.x+=200;for(var i=0;i<5;i++){this.btnDifficulty[i].x-=450;var c=i<2?.1:0;this.btnDifficulty[i].runAction(cc.sequence(cc.delayTime(c),cc.moveBy(.2,cc.v2(450,0))))}var o=cc.winSize.height/cc.winSize.width*750;this.btnStart.node.runAction(cc.moveBy(.2,cc.v2(-200,0))),this.characterNode.runAction(cc.moveBy(.2,cc.v2(0,154))),this.descNode.runAction(cc.sequence(cc.delayTime(.1),cc.moveTo(.2,cc.v2(0,.182*o-o/2)))),this.figure.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.15,cc.v2(-550,0)))),this.tree.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.15,cc.v2(300,0)),cc.callFunc(function(){this.tree.getComponent(cc.Widget).left=0,this.characterNode.getComponent(cc.Widget).bottom=19,this.descNode.getComponent(cc.Widget).bottom=.182,this.markDifficulty.active=!0,this.markDifficulty.runAction(cc.rotateBy(1.5,-360).repeatForever()),this.abled=!0}.bind(this)))),this.figure.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever()),this.mask.runAction(cc.sequence(cc.fadeTo(.5,127.5),cc.fadeIn(.5)).repeatForever())},goBattle:function(){c.heroId=this.heroId,c.difficulty=this.difficultyId,cc.director.loadScene("helloworld")},selectCharacter:function(e,t){t+1!=this.heroId&&this.abled&&(this.btns[this.heroId-1].scale=1,this.heroId=parseInt(t)+1,this.boxSelected.x=120*t-300,this.btns[t].scale=1.19,this.refreshInfo(),this.changeFigure())},refreshInfo:function(){var e=[cc.color(116,164,255),cc.color(255,84,80),cc.color(107,255,153),cc.color(255,247,121),cc.color(255,165,87),cc.color(182,93,255)];this.boxSelected.color=e[this.heroId-1];for(var t=0;t<4;t++)this.edges[t].color=e[this.heroId-1];var i=o.get("cfg_hero",this.heroId);this.txtName.string=i.name,this.txtDesc.string=i.desc,this.refreshDifficulty(),cc.loader.loadRes("Texture/UI/prepare/box_desc"+this.heroId,cc.SpriteFrame,function(e,t){this.boxDesc.spriteFrame=t}.bind(this)),this.btnStart.interactable=this.heroId<=1},selectDifficulty:function(e,t){t+1!=this.difficultyId&&(this.difficultyId=parseInt(t)+1,this.markDifficulty.position=this.btnDifficulty[t].position,this.refreshDifficulty())},refreshDifficulty:function(){var e=o.get("cfg_hero",this.heroId);this.txtDifficulty.string=e["difficulty"+this.difficultyId],cc.loader.loadRes(1==this.difficultyId?"Texture/nothing":"Texture/UI/prepare/mask"+this.difficultyId,cc.SpriteFrame,function(e,t){this.mask.getComponent(cc.Sprite).spriteFrame=t}.bind(this))},changeFigure:function(){this.abled=!1;var e=cc.instantiate(this.figure);e.opacity=0,e.position=cc.v2(650,-250),this.figureNode.addChild(e),e.runAction(cc.spawn(cc.moveBy(.2,cc.v2(-550,0)),cc.fadeIn(.2))),1==this.heroId?(e.color=cc.Color.WHITE,e.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever())):e.color=cc.Color.BLACK,this.figure.runAction(cc.sequence(cc.spawn(cc.moveBy(.2,cc.v2(-550,0)),cc.fadeOut(.2)),cc.callFunc(function(){this.figure.destroy(),this.figure=e,this.abled=!0}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],RequireRound:[function(e,t,i){"use strict";cc._RF.push(t,"3a0eeaFa/FFsJmcvXZBEaHe","RequireRound"),cc.Class({extends:cc.Component,properties:{circle:cc.Sprite,sprite:cc.Sprite},init:function(e,t){var i=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)];this.node.color=i[t-1],this.unCost=!1,this.satisfied=!1,e>0&&(this.element=e,this.refreshElement())},refreshElement:function(e){e&&(this.element=e),cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.node.active=!0,this.sprite.spriteFrame=t}.bind(this))},refreshSatisfy:function(e){if(this.satisfied=e,this.satisfied&&!this.unCost){var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=t[this.element-1]}else this.sprite.node.color=cc.color(255,255,255)},hideElement:function(){this.element=null,this.sprite.node.active=!1},disCost:function(){this.unCost=!0,cc.loader.loadRes("Texture/battle/image_requireLine2",cc.SpriteFrame,function(e,t){this.circle.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/battle/unelement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.node.active&&(this.sprite.spriteFrame=t)}.bind(this)),this.refreshSatisfy(!0)}}),cc._RF.pop()},{}],Room:[function(e,t,i){"use strict";cc._RF.push(t,"20286qrg/RMq6rq0m6qk3EY","Room");var c=e("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Sprite,circle:cc.Sprite,doorPrefab:cc.Prefab,btnCamp:cc.Node,btnNpc:cc.Node,npcFigure:cc.Sprite,btnTreasure:cc.Node,btnShop:cc.Node,monsterNode:cc.Node,monsterFigure:cc.Sprite,decoration:cc.Node,boxTip:cc.Node,imageBox:cc.Sprite,crystal:cc.Node},init:function(e){window.room=this,this.pos=c.heroPos,this.abled=!1,this.isNewRoom=e,e?this.initFloorConfig():this.typeList=c.historyPath[c.floor-1],this.initDoors(),this.initRoom(),e||this.initHero(),this.initMap(),this.initMonsterCfg()},initHero:function(){if(this.hero=window.homeLayer.hero,window.homeLayer.txtFloor.string=c.castle+"-"+c.floor,this.isNewRoom){var e=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)],t=[cc.v2(0,40),cc.v2(40,0),cc.v2(0,-40),cc.v2(-40,0)];this.hero.position=e[this.pos],this.hero.runAction(cc.sequence(cc.moveTo(.2,1==c.floor?cc.v2():t[this.pos]),cc.callFunc(function(){this.doors[this.pos].close(!0),1!=c.roomType&&c.roomType<6&&(this.abled=!0)}.bind(this)),cc.delayTime(.3),cc.callFunc(function(){(1==c.roomType||c.roomType>=6)&&window.homeLayer.goBattle()}.bind(this)))),this.checkEquip()}else this.abled=!0,this.doors[this.pos].close(!1)},initDoors:function(){this.doors=[];for(var e=[cc.v2(0,276),cc.v2(276,0),cc.v2(0,-276),cc.v2(-276,0)],t=0;t<4;t++){var i=this.typeList[t];if(-2==i&&(i=c.roomType),i>=0){var o=cc.instantiate(this.doorPrefab);o.getComponent("Door").init(i,t),o.rotation=90*t,o.position=e[t],o.zIndex=20,this.node.addChild(o),this.doors[t]=o.getComponent("Door")}}},initRoom:function(){1==c.roomType||c.roomType>=6?this.isNewRoom&&(this.monsterNode.active=!0,cc.loader.loadRes("Texture/monster/"+c.monsterId,cc.SpriteFrame,function(e,t){this.monsterFigure.spriteFrame=t}.bind(this)),this.monsterNode.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())):c.roomType>0&&this.initAlter()},gotoDoor:function(e){if(e!=this.pos&&this.abled){this.abled=!1;var t,i=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];if(c.heroPos=(parseInt(e)+2)%4,c.floor++,c.castle<3&&c.floor>12)c.floor=1,c.castle++,c.historyPath=[],c.historyChoose=[0],c.floorBeats=[],c.monsterList=[];else if(3==c.castle&&c.floor>13)return void window.homeLayer.openComplete();c.roomType=this.typeList[e],c.historyChoose[c.floor-1]=c.roomType,(1==c.roomType||c.roomType>=6)&&(c.monsterId=c.monsterList[c.floor-2][e]),t=cc.moveTo(.2,i[e]),this.hero.runAction(cc.sequence(t,cc.callFunc(function(){window.homeLayer.changeRoom(e)}.bind(this))))}},initAlter:function(){2==c.roomType?(this.btnCamp.active=!0,c.floorBeats[c.floor-1]?(this.crystal.active=!1,cc.loader.loadRes("Texture/map/alter/water2",cc.SpriteFrame,function(e,t){this.btnCamp.getComponent(cc.Sprite).spriteFrame=t}.bind(this))):this.crystal.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,20)),cc.moveBy(.5,0,-20)).repeatForever())):3==c.roomType?(this.btnTreasure.active=!0,c.floorBeats[c.floor-1]?(this.imageBox.node.rotation=0,this.imageBox.node.stopAllActions(),cc.loader.loadRes("Texture/map/alter/altar2",cc.SpriteFrame,function(e,t){this.btnTreasure.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/map/alter/treasure2",cc.SpriteFrame,function(e,t){this.imageBox.spriteFrame=t}.bind(this))):this.imageBox.node.runAction(cc.sequence(cc.rotateTo(.1,5),cc.rotateTo(.1,-5),cc.rotateTo(.1,5),cc.rotateTo(.1,-5),cc.rotateTo(.1,5),cc.rotateTo(.1,0),cc.delayTime(.3)).repeatForever())):4==c.roomType?(this.btnNpc.active=!0,cc.loader.loadRes("Texture/npc/alter/"+c.eventId,cc.SpriteFrame,function(e,t){this.npcFigure.spriteFrame=t}.bind(this)),this.btnNpc.stopAllActions(),this.btnNpc.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())):5==c.roomType&&(this.btnShop.active=!0)},openAlter:function(){5!=c.roomType&&c.floorBeats[c.floor-1]?4!=c.roomType||this.boxTip.active||(this.boxTip.active=!0,this.boxTip.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){this.boxTip.active=!1}.bind(this))))):window.homeLayer.openAlter()},checkEquip:function(){2==c.roomType&&c.equip.indexOf(38)>=0&&(c.hp=Math.min(c.hp+10,c.hpMax)),3==c.roomType&&c.equip.indexOf(42)>=0&&(c.copper+=30)},initFloorConfig:function(){if(c.historyPath[c.floor-1]&&c.historyPath[c.floor-1].indexOf(-2)==this.pos)this.typeList=c.historyPath[c.floor-1];else{var e=c.floorQuests[c.castle-1][c.floor-1].concat();if(1==e.length)this.typeList=[-1,-1,-1,-1],this.typeList[this.pos]=-2,this.typeList[(this.pos+2)%4]=e[0];else{for(;e.length<3;)e.splice(Math.floor(Math.random()*(e.length+1)),0,-1);e.splice(this.pos,0,-2),this.typeList=e}if(c.historyPath[c.floor-1]=this.typeList,4==c.roomType)c.eventIds.length>0?c.eventId=c.eventIds.shift():c.eventId=Math.floor(17*Math.random())+1;else if(5==c.roomType){for(var t=[],i=[],o=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];t.length<3;){for(var s=0,n=Math.random(),r=0,a=0;a<3;a++)if(n<(r+=o[c.castle-1][a])){s=a+1;break}for(var h=c.getNewCardId(s),d=!1,l=0;l<t.length;l++)if(h==t[l]){d=!0;break}d||t.push(h)}for(o=[[.4,.4,.2],[.3,.4,.3],[.2,.4,.4]];i.length<3;){for(var f=0,p=Math.random(),u=0,m=0;m<3;m++)if(p<(u+=o[c.castle-1][m])){f=m+1;break}for(var g=c.getNewItemId(1,f),v=!1,y=0;y<i.length;y++)if(g==i[y]){v=!0;break}v||i.push(g)}c.shopIds=t.concat(i,[1,2]),c.itemEffect.vip1&&(c.discountItem=Math.floor(3*Math.random())),c.itemEffect.vip2&&(c.discountCard=Math.floor(3*Math.random()))}}},initMonsterCfg:function(){if(!c.monsterList[c.floor-1]||this.pos!=c.monsterList[c.floor-1][4]){for(var e=[0,0,0,0,this.pos],t=2*(c.castle-1)+(c.floor<=5?1:2),i=0;i<4;i++){var o=this.typeList[i];if(1==o||o>=6){for(var s=0;s<=0;){var n=1==o?0:6==o?1:2;12==c.floor&&(t=7,n=3);var r=c.getNewMonsterId(t,n);e.indexOf(r)<0&&(s=r)}e[i]=s}}c.monsterList[c.floor-1]=e}},initMap:function(){var e=this;cc.loader.loadRes("Texture/scene/map"+c.castle,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/map/castle"+c.castle,cc.SpriteFrame,function(e,t){this.circle.spriteFrame=t}.bind(this));for(var t=0;t<4;t++)for(var i=0;i<5;){var o=0;o=t%2==0?155*-Math.random()-220:155*Math.random()+220;var s=0,n=cc.winSize.height/cc.winSize.width*750;s=t<2?Math.random()*(n/2-130)+130:-Math.random()*(n/2-130)-130,cc.v2(o,s).mag()>=410&&function(){var t=cc.instantiate(e.decoration);t.scaleX=Math.random()<.5?1:-1,t.position=cc.v2(o,s),e.bg.node.addChild(t),i++,cc.loader.loadRes("Texture/map/outside/"+Math.floor(19*Math.random()+1),cc.SpriteFrame,function(e,i){t&&(t.getComponent(cc.Sprite).spriteFrame=i)}.bind(e))}()}for(var r=Math.floor(5*Math.random()+1),a=0;a<r;){var h=180*Math.random(),d=180*Math.random();cc.v2(h,d).mag()<=180&&function(){var t=cc.instantiate(e.decoration);t.scaleX=Math.random()<.5?1:-1,t.position=cc.v2(h,d),e.circle.node.addChild(t),a++,cc.loader.loadRes("Texture/map/inside/"+Math.floor(10*Math.random()+1),cc.SpriteFrame,function(e,i){t&&(t.getComponent(cc.Sprite).spriteFrame=i)}.bind(e))}()}}}),cc._RF.pop()},{Game:"Game"}],ShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"47158KpbiJMF46lKbQmGdRL","ShopItem");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,potionPrefab:cc.Prefab,txtCost:cc.Label,txtDiscount:cc.Node,iconNode:cc.Node},init:function(e,t,i){this.cfgId=e,this.type=t;var c=void 0;0==t?((c=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),this.cost=3*o.get("cfg_card",e).value):1==t?((c=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(e),this.cost=6*o.get("cfg_item",e).value):((c=cc.instantiate(this.potionPrefab)).getComponent("PotionCommodity").init(e),this.cost=1==e?20:50),c.position=cc.v2(0,1==t?20:10),this.iconNode.addChild(c),this.item=c,i&&(this.txtDiscount.active=!0,this.cost=Math.ceil(.3*this.cost),this.txtCost.node.color=cc.Color.BLACK.fromHEX("#54EAD0"),this.txtCost.getComponent(cc.LabelOutline).color=cc.Color.BLACK.fromHEX("#54EAD0")),this.txtCost.string=this.cost},buy:function(){if(c.copper>=this.cost){c.copper-=this.cost,0==this.type?c.getCard(this.cfgId):1==this.type?c.getItem(this.cfgId):c.hp=Math.min(c.hp+10*this.cfgId,c.hpMax);var e=c.shopIds.indexOf(this.cfgId);c.shopIds[e]=0,this.node.destroy(),window.homeLayer.refreshHeroData()}else this.item.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0)))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(e,t,i){"use strict";cc._RF.push(t,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{boxs:[cc.Node],shopItemPrefab:cc.Prefab,curtain:cc.Node,title:cc.Node},onLoad:function(){window.shopLayer=this,this.initCards(),this.initEquip(),this.initPotions(),this.curtain.runAction(cc.moveTo(.15,cc.v2(0,-17))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.moveTo(.25,cc.v2(9,-35)))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.skewTo(.2,2,0),cc.skewTo(.2,-2,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,0,0)))},initCards:function(){for(var e=0;e<3;e++){var t=c.shopIds[e];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,0,e==c.discountCard),i.position=cc.v2(e%3*245-245,0),this.boxs[0].addChild(i)}}this.boxs[0].x=-750,this.boxs[0].y+=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[0].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0))))},initEquip:function(){for(var e=0;e<3;e++){var t=c.shopIds[e+3];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,1,e==c.discountItem),i.position=cc.v2(e%3*245-245,0),this.boxs[1].addChild(i)}}this.boxs[1].x=750,this.boxs[1].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0))))},initPotions:function(){for(var e=0;e<2;e++){var t=c.shopIds[e+6];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,2),i.position=cc.v2(e%3*245-245,0),this.boxs[2].addChild(i)}}this.boxs[2].x=-750,this.boxs[2].y-=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[2].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.2,cc.v2(750,0))))},close:function(){this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0)))),this.boxs[0].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0)))),this.title.runAction(cc.moveTo(.2,cc.v2(9,230))),this.curtain.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.1,cc.v2(0,43)))),this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4)}}),cc._RF.pop()},{Game:"Game"}],SkillManager:[function(e,t,i){"use strict";cc._RF.push(t,"f9b8a6FzCFFt4zg92Jc9Ljj","SkillManager");var c=e("Game"),o={doCast:function(e){var t=window.mainLayer.hero,i=window.mainLayer.enemy;if(1==c.heroId)0==e?i.onHurt(5,4):1==e&&t.buff.addBuff(107,1);else if(2==c.heroId)if(0==e)t.player.createExDice();else if(1==e){for(var o=t.player.cardList.length-1;o>=0;o--)t.player.cardList[o].getComponent("Card").discard();t.player.cardList=[],t.player.createChest(!0)}}};t.exports=o,cc._RF.pop()},{Game:"Game"}],Skill:[function(e,t,i){"use strict";cc._RF.push(t,"84424zovvVHiZ6bvX7VE49L","Skill");var c=e("Game"),o=e("SkillManager");cc.Class({extends:cc.Component,properties:{txtCost:cc.Label,icon:cc.Sprite,btn:cc.Button,txtName:cc.Label,mask:cc.Node},init:function(e){if(this.index=e,this.lock=!0,this.abled=!0,this.cost=10*(e+1),1==e&&c.level<3&&(this.lock=!1),this.lock){var t=[["\u8865\u5200","\u53cc\u6253"],["\u521b\u9020","\u5927\u6ee1\u8d2f"]][c.heroId-1];this.txtName.string=t[e],this.txtCost.string=this.cost,cc.loader.loadRes("Texture/hero/skill/"+(2*c.heroId-1+e),cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this))}else this.txtName.string="3\u7ea7\u89e3\u9501",cc.loader.loadRes("Texture/battle/mark_skill",cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this));this.check()},check:function(){this.lock&&this.abled&&window.mainLayer.hero.power>=this.cost?this.btn.interactable=!0:this.btn.interactable=!1,this.btn.interactable?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=this.lock)},doSkill:function(){0==window.mainLayer.roundId&&(this.abled=!1,window.mainLayer.hero.addPower(-this.cost),o.doCast(this.index))}}),cc._RF.pop()},{Game:"Game",SkillManager:"SkillManager"}],TreasureLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var c=e("Game");cc.Class({extends:cc.Component,properties:{treasurePrefab:cc.Prefab,btnGets:[cc.Node],btnClose:cc.Node,boxNode:cc.Node,btnNode:cc.Node,mask:cc.Node},init:function(){for(var e=0,t=[[.6,.3,.1],[.3,.4,.3],[.1,.4,.5]],i=Math.random(),o=0,s=0;s<3;s++)if(i<(o+=t[c.castle-1][s])){e=s+1;break}5==c.roomType?e++:c.itemEffect.vase>0&&(c.itemEffect.vase--,e++),e=Math.min(e,3),this.cfgIdList=[];var n=1;c.itemEffect.flagon>0&&(c.itemEffect.flagon--,n=2);var r=c.getNewItemId(0,e);if(this.cfgIdList.push(r),2==n){for(var a=0;a<=0;){var h=c.getNewItemId(0,e);h!=r&&(a=h)}this.cfgIdList.push(a)}this.initItem(),this.btnNode.opacity=0,this.btnNode.y-=150;var d=cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))));this.btnNode.runAction(cc.sequence(cc.delayTime(.8),d))},initItem:function(){var e;(this.itemList=[],this.gotList=[],1==this.cfgIdList.length)?((e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),this.boxNode.addChild(e),this.itemList.push(e)):((e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),e.position=cc.v2(180,0),this.boxNode.addChild(e),this.itemList.push(e),(e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[1]),e.position=cc.v2(-180,0),this.boxNode.addChild(e),this.itemList.push(e),this.btnGets[1].active=!0,this.btnGets[0].position=cc.v2(180,30),this.btnClose.position=cc.v2(0,-100))},onGet:function(e,t){c.getItem(this.cfgIdList[t]),this.gotList.push(this.itemList[t]),this.btnGets[t].active=!1,this.gotList.length>=this.cfgIdList.length&&this.close()},onGiveUp:function(){this.close()},close:function(){c.floorBeats[c.floor-1]=!0,window.room.initAlter();for(var e=0;e<this.itemList.length;e++)this.itemList[e].opacity=0;if(this.gotList.length>0){this.mask.runAction(cc.fadeOut(.2)),this.btnNode.active=!1;for(var t=0;t<this.gotList.length;t++)this.gotList[t].getComponent("Treasure").got();this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4)}else this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Treasure:[function(e,t,i){"use strict";cc._RF.push(t,"ab4bd76AwVKk6GKzcwjcSfb","Treasure");var c=e("Game"),o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,icon:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,infoNode:cc.Node,mask:cc.Node,anmation:cc.Node},init:function(e){var t=o.get("cfg_item",e);this.txtName.string=t.name;this.txtName.node.color=cc.Color.BLACK.fromHEX(["#31BEFF","#B689FF","#FF7F18"][t.quality-1]),this.txtDesc.string=c.analysisDesc(t.desc1),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+t.quality,cc.SpriteFrame,function(e,t){this.boxIcon.spriteFrame=t}.bind(this)),this.doAction()},doAction:function(){this.mask.opacity=this.infoNode.opacity=this.boxIcon.node.opacity=0;var e=cc.spawn(cc.moveTo(.4,cc.v2(0,173)),cc.sequence(cc.scaleTo(.2,.8,1.1),cc.scaleTo(.2,1)));this.mask.runAction(cc.sequence(cc.delayTime(.5),cc.fadeIn(0),e,cc.fadeOut(.3))),this.boxIcon.node.runAction(cc.sequence(cc.delayTime(.9),cc.fadeIn(0))),this.infoNode.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.3)))},got:function(){this.node.opacity=255,this.anmation.active=!1,this.infoNode.active=!1;var e=cc.winSize.height/cc.winSize.width*750;this.boxIcon.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveTo(.3,cc.v2(211-this.node.x,-e/2-80+115+33-70))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Utils:[function(e,t,i){"use strict";cc._RF.push(t,"85bfaYPayFNlrAFvtzNUMAc","Utils");var c={numberFormat:function(e){return e/1e13>=1?Math.floor(e/1e12)+"T":e/1e10>=1?Math.floor(e/1e9)+"B":e/1e7>=1?Math.floor(e/1e6)+"M":e/1e4>=1?Math.floor(e/1e3)+"K":e},timeFormat:function(e,t){var i=Math.round(e/1e3),c=i%60,o=t>1?Math.floor(i/60)%60:Math.floor(i/60),s=3==t?Math.floor(i/3600)%24:Math.floor(i/3600),n=Math.floor(i/86400),r=function(e){return e<10?"0"+e:e};return 1==t?r(o)+":"+r(c):2==t?r(s)+":"+r(o)+":"+r(c):n+"\u5929"+s+"\u65f6"+o+"\u5206"},getDifferentRandomNum:function(e,t,i){t=t||1,i=i||0;for(var c=[];c.length<e;){for(var o=Math.floor(Math.random()*(t-i+1))+i,s=!1,n=0;n<c.length;n++)if(c[n]-o==0){s=!0;break}s||c.push(o)}return c},createImage:function(e,t){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var e=new cc.Texture2D;e.initWithElement(i),e.handleLoadedTexture(),t.spriteFrame=new cc.SpriteFrame(e)}catch(e){cc.log(e),t.node.active=!1}},i.src=e}catch(e){cc.log(e),t.node.active=!1}else try{cc.loader.load({url:e,type:"jpg"},function(e,i){t.spriteFrame=new cc.SpriteFrame(i)})}catch(e){cc.log(e),t.node.active=!1}},substring:function(e,t){if(e.replace(/[\u4e00-\u9fa5]/g,"**").length<=t)return e;for(var i=0,c="",o=0;o<e.length&&(/[\u4e00-\u9fa5]/.test(e[o])?i+=2:i+=1,!(i>t));o++)c+=e[o];return c},getMd5Url:function(e){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(e)):cc.url.raw(e)},numToStr:function(e,t){t=t||1;for(var i=""+e,c=1;c<=t;c++)e<Math.pow(10,c)&&(i="0"+i);return i}};t.exports=c,cc._RF.pop()},{}],Yahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee"),cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label,boxDesc:cc.Node},onLoad:function(){window.yahtzeeLayer=this,this.descOpen=!0},start:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),this.roundId=1,this.hostId=0,this.doRound(),this.boxDesc.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(this.openDesc,this)))},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,window.player.startRound()},endRound:function(){for(var e=this,t=function(t){var i=e.hero.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,300)),cc.delayTime(1.5),cc.callFunc(function(){this.hero.dicePool.put(i)}.bind(e))))},i=0;i<5;i++)t(i);var c=function(t){var i=e.enemy.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-300)),cc.delayTime(1.5),cc.callFunc(function(){this.enemy.dicePool.put(i)}.bind(e))))};for(i=0;i<5;i++)c(i);this.scheduleOnce(function(){this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.hero.doWin():this.hero.score<this.enemy.score?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),1.5),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(e){var t=cc.instantiate(this.endPrefab);t.getComponent("EndYahtzeeLayer").init(e),this.node.addChild(t)},openDesc:function(){this.boxDesc.stopAllActions(),this.descOpen?(this.descOpen=!1,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-428,93)))):(this.descOpen=!0,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-279,93))))}}),cc._RF.pop()},{}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardCollection","CardManager","Chest","CompleteLayer","Config","Dice","DiceYahtzee","DmgAnimation","Door","Edit","EditEndLayer","EndLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","HelloWorld","Hero","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerYahtzee","PotionCommodity","PrepareLayer","RequireRound","Room","ShopItem","ShopLayer","Skill","SkillManager","Treasure","TreasureLayer","Utils","Yahtzee"]);