window.__require=function e(t,i,o){function s(r,c){if(!i[r]){if(!t[r]){var a=r.split("/");if(a=a[a.length-1],!t[a]){var h="function"==typeof __require&&__require;if(!c&&h)return h(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+r+"'")}}var d=i[r]={exports:{}};t[r][0].call(d.exports,function(e){return s(t[r][1][e]||e)},d,d.exports,e,t,i,o)}return i[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<o.length;r++)s(o[r]);return s}({AIYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){var i=this.player.diceList[t].getComponent("DiceYahtzee");e[i.element-1]++}for(var o=-1,s=-1,n=0;n<6;n++)e[n]>(e[o]||0)&&(o=n);for(var r=0;r<6;r++)r!=o&&e[r]>(e[s]||0)&&(s=r);this.scheduleOnce(function(){e[o]>1?e[o]==e[s]?this.hold(o,s):this.hold(o):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(e,t){for(var i=0,o=0;o<5;o++){var s=this.player.diceList[o].getComponent("DiceYahtzee");s.holded?s.element!=e+1&&null!=t&&s.element!=t+1&&(s.doHold(),i++):(s.element==e+1||null!=t&&s.element==t+1)&&(s.doHold(),i++)}var n=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),n)}}),cc._RF.pop()},{}],AI:[function(e,t,i){"use strict";cc._RF.push(t,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy")},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var e=1,t=100,i=null,o=0;o<this.cards.length;o++){var s=this.cards[o].getComponent("Card");s.usable&&(s.cfg.priority<t||s.cfg.priority==t&&s.rate>e)&&(e=s.rate,t=s.cfg.priority,i=s)}i?(i.cast(),198!=i.cfgId&&this.scheduleOnce(function(){this.checkCards()}.bind(this),.8)):this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.5):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.8)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var e=[0,0,0,0,0,0],t=0;t<this.cards.length;t++){var i=this.cards[t].getComponent("Card");(m=i.require.split(";")).length>1&&e[m[0]-1]++;for(var o=["A","B","C","D","E","F"],s=0;s<6;s++)if(i.cfg.desc.indexOf(o[s])>=0){e[s]++;break}}for(var n=!1,r=0;r<6;r++)if(e[r]>0){n=!0;break}for(var c=[],a=0;a<this.cards.length;a++){var h=this.cards[a].getComponent("Card"),d=[0,0,0,0,0,0];if(h.require>=101&&h.require<=105){for(var f=0,l=0,p=0;p<6;p++)(!n||e[p]>0)&&this.player.elementList[p]>f&&(f=this.player.elementList[p],l=p+1);if(d=[-100,-100,-100,-100,-100,-100],f>=n||2){d[l-1]=[2,3,3,4,5][h.require-101]-f}}else{var u=[0,0,0,0,0,0];if(106==h.require||107==h.require)u=[1,1,1,1,1,1];else for(var m=h.require.split(";"),g=0;g<m.length;g++)u[m[g]-1]++;for(var w=["A","B","C","D","E","F"],v=0;v<6;v++){var C=u[v];h.cfg.desc.indexOf(w[v])>=0&&(C=this.player.elementList[v]+1),d[v]=C-this.player.elementList[v]}}c.push(d)}for(var y=100,b=0,x=0,L=1,k=0;k<c.length;k++){for(var I=c[k],M=0,q=0,R=0;R<I.length;R++)M+=I[R]<-10?0:Math.abs(I[R]),q+=I[R];(M<y||M==y&&q>b||M==y&&q==b&&this.cards[k].getComponent("Card").rate<L)&&(y=M,b=q,x=k,L=this.cards[k].getComponent("Card").rate)}for(var E=c[x],P=0;P<6;P++)if(0!=E[P]){var B=E[P]+this.player.elementList[P]-this.player.holdList[P];if(B>0)for(var F=0;F<this.dices.length;F++){var _=this.dices[F].getComponent("Dice");if(_.element==P+1&&!_.holded&&!_.lock&&!_.freeze&&(_.hold(),0==--B))break}else if(B<0)for(var T=0;T<this.dices.length;T++){var D=this.dices[T].getComponent("Dice");if(D.element==P+1&&D.holded&&!D.lock&&!D.freeze&&(D.hold(),0==++B))break}}this.player.roll(),this.scheduleOnce(function(){this.check()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var e=0;e<this.player.cardList.length;e++){var t=this.player.cardList[e].getComponent("Card");t.silence||t.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(t)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var o=this.player.diceList[i];o.lock||this.dices.push(o)}}}),cc._RF.pop()},{}],Buff:[function(e,t,i){"use strict";cc._RF.push(t,"76faa8y1jVIcqDL176r9ktK","Buff"),cc.Class({extends:cc.Component,properties:{},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.doubleDmg=1,this.doubleCast=0,this.multiCast=0,this.multiCastMax=0,this.selfHarmCast=0,this.selfHarmCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.exRound=0,this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.undead=0,this.atkBack=0,this.burnIce=!1,this.silenceDark=!1,this.table={};for(var e=[13,21,22,23,24,25,26,27,28],t=0;t<e.length;t++)this.table[e[t]]=0;this.quote(),this.refreshBuff()},addBuff:function(e,t){if(!(t<=0)){if(e>=21&&this.player.equip.amulet>0)return this.player.equip.amulet--,void this.player.equip.doTrigger(37);if(e>=21&&e<=26){if(this.opponent.equip.checkWithTrigger(e+10))t+=26==e?2:1;23==e&&this.opponent.equip.trigger(68)}this.table[e]+=t,this.quote();for(var i=!1,o=0;o<this.buffList.length;o++)if(this.buffList[o]==e){i=!0;break}i||this.buffList.push(e),this.refreshBuff()}},removeBuff:function(e,t){if(!(t<=0)){if(this.table[e]-=t,this.table[e]<=0){this.table[e]=0;var i=this.buffList.indexOf(e);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28]},refreshBuff:function(){for(var e="",t={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522"},i={13:"#0AFF78",21:"#FF3C32",22:"#32B4FF",23:"#9AE9BD",24:"#FA9650",25:"#FFFFFF",26:"#682AA1",27:"#CB97FB",28:"#FFFF3C"},o=0;o<this.buffList.length;o++){var s=this.buffList[o],n=t[s]+this.table[s]+" ";e+="<color="+i[s]+">"+n+"</c>"}this.player.host.txtBuff.string=e}}),cc._RF.pop()},{}],CampLayer:[function(e,t,i){"use strict";cc._RF.push(t,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},onHeal:function(){var e=1;o.equip.indexOf(39)>=0&&(e+=.5),o.equip.indexOf(89)>=0&&(e-=.5);var t=Math.floor(.35*o.hpMax*e);o.hp=Math.min(o.hp+t,o.hpMax),this.close()},onCopper:function(){o.copper+=7*(o.castle+3),this.close()},close:function(){this.node.destroy(),window.homeLayer.refreshHeroData(),window.homeLayer.btnAlter.node.active=!1}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,chestPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node},onLoad:function(){window.bagLayer=this,this.initDeck(),this.initBag()},initDeck:function(){this.deck=[];for(var e=2==o.heroId?2:3,t=0;t<o.deck.length;t++){var i=cc.instantiate(this.cardPrefab);i.getComponent("CardCollection").init(o.deck[t],0),i.position=cc.v2(t%e*240-240,95-190*Math.floor(t/e)),this.boxDeck.addChild(i),this.deck[t]=i}if(2==o.heroId){var s=cc.instantiate(this.chestPrefab);s.position=cc.v2(240,0),this.boxDeck.addChild(s)}},initBag:function(){o.cardBag.sort(function(e,t){return s.get("cfg_card",e).element==s.get("cfg_card",t).element?e-t:s.get("cfg_card",e).element-s.get("cfg_card",t).element}),this.bagList=[];for(var e=0;e<o.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(o.cardBag[e],1),t.position=cc.v2(e%3*240-240,-95-190*Math.floor(e/3)),this.content.addChild(t),this.bagList.push(t)}this.content.height=Math.max(190*Math.ceil(o.cardBag.length/3),730)},equip:function(e){for(var t=-1,i=2==o.heroId?4:6,s=0;s<i;s++)if(null==this.deck[s]){t=s;break}if(t>=0){e.parent=this.boxDeck;var n=2==o.heroId?2:3;e.position=cc.v2(t%n*240-240,95-190*Math.floor(t/n)),e.getComponent("CardCollection").colletType=0;var r=e.getComponent("CardCollection").cfgId;this.deck[t]=e;var c=o.cardBag.indexOf(r);o.cardBag.splice(c,1);c=this.bagList.indexOf(e);this.bagList.splice(c,1),this.refreshBag()}},unEquip:function(e){var t=this.deck.indexOf(e);this.deck[t]=null;for(var i=o.cardBag.length,n=e.getComponent("CardCollection").cfgId,r=0;r<o.cardBag.length;r++)if(s.get("cfg_card",n).element<s.get("cfg_card",o.cardBag[r]).element||s.get("cfg_card",n).element==s.get("cfg_card",o.cardBag[r]).element&&n<o.cardBag[r]){i=r;break}o.cardBag.splice(i,0,n),this.bagList.splice(i,0,e),e.parent=this.content,e.position=cc.v2(i%3*240-240,-95-190*Math.floor(i/3)),e.getComponent("CardCollection").colletType=1,this.refreshBag()},refreshBag:function(){for(var e=0;e<this.bagList.length;e++)this.bagList[e].runAction(cc.moveTo(.15,cc.v2(e%3*240-240,-95-190*Math.floor(e/3))));this.content.height=Math.max(190*Math.ceil(o.cardBag.length/3),730)},close:function(){o.deck=[];for(var e=0;e<6;e++)null!=this.deck[e]&&o.deck.push(this.deck[e].getComponent("CardCollection").cfgId);this.node.destroy()}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardCollection:[function(e,t,i){"use strict";cc._RF.push(t,"a28bfVp4ABL54sr47isHV8F","CardCollection");var o=e("Config");cc.Class({extends:cc.Component,properties:{btn:cc.Button,txtTitle:cc.Label,txtDesc:cc.Label,txtRequire:cc.Label,markDelete:cc.Node},init:function(e,t){this.cfgId=e,this.cfg=o.get("cfg_card",e);var i=[cc.color(251,93,108),cc.color(123,200,254),cc.color(92,165,110),cc.color(150,80,50),cc.color(214,129,80),cc.color(179,149,235),cc.color(120,120,120)];this.btn.node.color=i[this.cfg.element-1],this.txtTitle.string=this.cfg.name,this.txtDesc.string=this.cfg.desc;var s=this.require=this.cfg.require;if(s>=101&&s<=107){var n=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c","5\u4e2a\u76f8\u540c","5\u79cd\u4e0d\u540c","6\u79cd\u4e0d\u540c"];this.txtRequire.string=n[s-101]}else{for(var r=s.split(";"),c="",a=(n=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],0);a<r.length;a++)c+=n[r[a]-1];this.txtRequire.string=c}null!=t&&(this.btn.interactable=!0,this.colletType=t)},changeCollectType:function(){0==this.colletType?window.bagLayer.unEquip(this.node):window.bagLayer.equip(this.node)}}),cc._RF.pop()},{Config:"Config"}],CardManager:[function(e,t,i){"use strict";cc._RF.push(t,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var o=e("Game"),s=e("Config"),n={doCast:function(e,t){this.cfgId=e;var i=s.get("cfg_card",e);if(this.desc=i.desc,this.card=t,window.opponent.buff.dodge>0&&(1==i.target1||1==i.target2||1==i.target3))return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("\u95ea\u907f"),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(e)},doEffect:function(e,t,i){var o=null,s=(o=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,n=window.player.buff,r=0,c=1;if((t+="")<0){for(var a=["A","B","C","D","E","F"],h=0,d=0;d<6;d++)if(this.desc.indexOf(a[d])>=0){h=d;break}r=window.player.elementList[h]*Math.abs(parseInt(t))}else{var f=t.split(";");if(8==e)r=parseInt(f[0]),c=parseInt(f[1]);else if(1==f.length)r=parseInt(t);else{var l=parseInt(f[0]),p=parseInt(f[1]);r=window.player.equip.checkWithTrigger(120)?p:Math.floor(Math.random()*(p-l+1))+l}}if(e<10){if(1==i&&(r*=n.doubleDmg,n.doubleDmg=1),n.weak>0&&!window.player.equip.checkWithTrigger(65)){var u=.5;u+=window.opponent.equip.checkWithTrigger(55)?.25:0,r=Math.floor(r*(1-u))}0==window.player.cardPlayed&&window.player.equip.checkWithTrigger(100)&&(r*=2);for(var m=0;m<c;m++)o.onHurt(r,0,e)}else 11==e?o.updateArmor(r):12==e?o.onHeal(r):14==e?o.addPower&&o.addPower(r):(13==e||e>=21)&&s.addBuff(e,r)},doSpecial:function(e){var t=window.opponent.buff,i=window.player.buff;if(132==e)this.doEffect(11,window.host.armor,2);else if(133==e)this.doEffect(7,window.host.armor,1);else if(134==e)this.doEffect(7,2*window.host.armor,1),this.doEffect(11,-window.host.armor,2);else if(135==e)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==e)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==e)this.doEffect(7,Math.floor(window.host.hp/2),1);else if(138==e)i.undead=2;else if(139==e)i.exRound++;else if(140==e)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==e)window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==e)window.host.power&&(this.doEffect(11,2*window.host.power,2),window.host.addPower(-window.host.power));else if(143==e)window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==e)this.doEffect(7,2*t.poison,1);else if(145==e)this.doEffect(7,4*t.poison,1);else if(146==e)t.addBuff(26,t.poison);else if(147==e){var s=t.frail>0?12:6;this.doEffect(3,s,1)}else if(148==e){s=t.weak>0?12:6;this.doEffect(4,s,1)}else if(149==e){s=t.poison>0?12:6;this.doEffect(6,s,1)}else if(150==e)t.burn>0&&this.doEffect(21,1,1);else if(151==e)t.freeze>0&&this.doEffect(22,1,1);else if(152==e)t.silence>0&&this.doEffect(25,1,1);else if(e>=153&&e<=158){var n=[2,3,5,0,1,4][e-153];window.player.elementList[n]>=[2,2,2,3,3,3][e-153]&&this.doEffect(n+21,[2,2,2,2,2,1][e-153],1)}else if(e>=159&&e<=162)t.addBuff(Math.floor(8*Math.random())+21,162==e?2:1);else if(e>=163&&e<=166)i.doubleCast++;else if(167==e)i.multiCast++,i.multiCastMax++;else if(e>=168&&e<=171)i.doubleDmg*=2;else if(172==e)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-t.freeze,1);else if(173==e)this.doEffect(21,window.opponent.deck.length-t.burn,1);else if(174==e)this.doEffect(7,6*t.burn,1);else if(175==e)this.doEffect(7,6*t.freeze,1);else if(176==e)this.doEffect(7,6*t.silence,1);else if(177==e)this.doEffect(7,4*t.frail,1);else if(178==e)this.doEffect(7,4*t.weak,1);else if(e>=179&&e<=182){s=(r=[1,6,6,10])[e-179]+(c=[3,2,2,4])[e-179]*(i.iteraList[e-179]-1);this.doEffect(7,s,1)}else if(e>=183&&e<=186){var r=[8,13,13,18],c=[3,3,3,4],a=Math.min(i.iteraList[e-179]-1,[2,4,4,4][e-183]);s=r[e-183]-c[e-183]*a;this.doEffect(7,s,1)}else if(187==e)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==e)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==e)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==e)this.doEffect(1,10+3*i.elementRoundCasted[0],1);else if(191==e)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==e)this.doEffect(3,10+3*i.elementRoundCasted[2],1);else if(193==e){if((a=Math.min(window.opponent.deck.length,6))>0){var h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.opponent.deck.splice(h,1),window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(194==e){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(195==e){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d)}}else if(196==e){var f=o.getRandomCardId(2);window.player.patchCard(f,!0),window.player.deck.push(f)}else if(197==e){f=o.getRandomCardId(2);(v=window.player.patchCard(f)).getComponent("Card").silence||v.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){v.getComponent("Card").cast()}.bind(this))))}else if(198==e){var l=function(){var e=window.player.patchCard();2==e.getComponent("Card").element&&window.player.cardList.length<6?e.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){l()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&window.mainLayer.enemy.ai.check()}.bind(this),.8)}.bind(this);l()}else if(199==e)window.player.diceCount++,window.player.createExDice();else if(200==e)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==e){for(var p=21;p<=28;p++)i.removeBuff(p,i.table[p]);for(var u=0;u<window.player.cardList.length;u++)window.player.cardList[u].getComponent("Card").clear();for(var m=0;m<window.player.diceList.length;m++)window.player.diceList[m].getComponent("Dice").clear();window.player.checkElement()}else if(202==e){for(var g=0,w=21;w<=28;w++)t.table[w]>0&&g++;this.doEffect(7,5*g,1)}else if(203==e)window.player.rollCount++,0==window.mainLayer.roundId&&window.player.rollCount<=1&&window.mainLayer.hero.btnRoll.runAction(cc.moveTo(.15,cc.v2(285,145)));else if(204==e)window.player.rollCount++,window.player.roll();else if(205==e){if(window.player.cardList.length>0){h=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[h].getComponent("Card").discard(),this.doEffect(7,12,1)}}else if(206==e||207==e){if(window.player.cardList.length>0){var v;h=Math.floor(Math.random()*window.player.cardList.length);(v=window.player.cardList[h].getComponent("Card")).remove(),v.doDelete(),this.doEffect(7,206==e?20:30,1)}}else if(208==e){this.doEffect(7,5*window.player.cardList.length,1);for(var C=window.player.cardList.length-1;C>=0;C--)window.player.cardList[C].getComponent("Card").discard();window.player.cardList=[]}else if(e>=209&&e<=214){r=214==e?2:1;this.doEffect(e-209+21,r+i.iteraList2[e-209]-1,1)}else if(215==e)window.opponent.buff.burnIce=!0;else if(216==e)window.opponent.buff.silenceDark=!0;else if(217==e)o.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(218==e){f=o.getRandomCardId(2);window.player.patchCard(f)}else 219==e?window.player.patchCard():220==e?this.doEffect(3,2*window.player.atkRound-1,1):221==e?(i.selfHarmCast++,i.selfHarmCastMax++):222==e&&(window.host.hpMax+=20,window.host.hp+=20,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax)}};t.exports=n,cc._RF.pop()},{Config:"Config",Game:"Game"}],Card:[function(e,t,i){"use strict";cc._RF.push(t,"cfa35/uH59ANIsjw79G+feg","Card");var o=e("Config"),s=e("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,fires:cc.Node,markSilence:cc.Node},init:function(e,t,i,s){this.cfgId=e,this.index=t,this.pos=cc.v2(t%3,Math.floor(t/3)),this.type=s,this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(240*this.pos.x-240,95-190*this.pos.y-500*this.delta),this.node.opacity=0;var n=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-190*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(0==window.mainLayer.roundId?1-this.pos.y:this.pos.y)),n,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),this.cfg=o.get("cfg_card",e),this.element=this.cfg.element;var r=[cc.color(251,93,108),cc.color(123,200,254),cc.color(92,165,110),cc.color(150,80,50),cc.color(214,129,80),cc.color(179,149,235),cc.color(120,120,120)];this.btn.node.color=r[this.element-1],this.txtTitle.string=this.cfg.name,this.initDesc(),this.mask.active=!0,this.rate=1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1;var c=this.require=this.cfg.require;if(c>=101&&c<=107){var a=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c","5\u4e2a\u76f8\u540c","5\u79cd\u4e0d\u540c","6\u79cd\u4e0d\u540c"];this.txtRequire.string=a[c-101];this.rate=[1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][c-101]}else{for(var h=c.split(";"),d="",f=(a=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],0);f<h.length;f++)d+=a[h[f]-1];this.txtRequire.string=d;this.rate=[1/6,1/36,1/216,1/1296,1/7776][h.length-1]}this.initBuff(i)},initWithCopy:function(e,t){this.cfgId=e,this.pos=t,this.isCopy=!0,this.isTemp=!0,this.cfg=o.get("cfg_card",e),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(){if(this.btn.interactable=!1,0==window.mainLayer.roundId){var e=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{e=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var t=window.player.cardList.indexOf(this.node);t>=0&&(window.player.cardList.splice(t,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())},initBuff:function(e){this.burn=21==e,this.fires.active=this.burn,this.silence=25==e,this.markSilence.active=this.silence},checkRequire:function(){var e=!1,t=window.player.elementList;if(this.require>=101&&this.require<=105){for(var i=[2,2,3,4,5],o=102==this.require?2:1,s=0;s<6;s++)t[s]>=i[this.require-101]&&o--,102==this.require&&t[s]>=4&&(o-=2);o<=0&&(e=!0)}else if(106==this.require||107==this.require){i=0;for(var n=0;n<6;n++)t[n]>0&&i++;i>=this.require-101&&(e=!0)}else{for(var r=[0,0,0,0,0,0],c=this.require.split(";"),a=0;a<c.length;a++)r[c[a]-1]++;e=!0;for(var h=0;h<6;h++)if(t[h]<r[h]){e=!1;break}}return this.silence&&(e=!1),this.usable=e,e?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),e},doCast:function(){1==this.type?(window.endLayer.select&&window.endLayer.select.unselect(),this.select()):0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c"):this.cast())},cast:function(){this.burn&&window.host.onHurt(3,1,21);var e=!1,t=window.opponent.equip.check(107)?.8:.5;if(window.player.buff.curse&&Math.random()<t&&(e=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.trigger(108)),this.btn.interactable=!1,e){var i=cc.instantiate(window.player.markCurse);i.active=!0,i.parent=window.player.boxCard,i.position=this.node.position,i.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){i.destroy()}.bind(this)))),this.endCast()}else{var o=cc.spawn(cc.moveBy(.05,cc.v2(0,-20)),cc.scaleTo(.05,1)),n=cc.moveBy(.35,cc.v2(0,1100)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),o,n,cc.callFunc(function(){window.mainLayer.gameOver||(s.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var r=window.player.cardList.indexOf(this.node);r>=0&&(window.player.cardList.splice(r,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var c=0;c<3;c++)if(this.cfg["effect"+(c+1)]<10&&1==this.cfg["target"+(c+1)]){var a=1;8==this.cfg["effect"+(c+1)]&&(a=parseInt(this.cfg["num"+(c+1)].split(";")[1])),window.player.atkRound+=a}for(var h=0;h<window.player.cardList.length;h++){var d=window.player.cardList[h].getComponent("Card");(d.cfgId>=179&&d.cfgId<=186||d.cfgId>=209&&d.cfgId<=214||220==d.cfgId)&&d.initDesc()}e||this.isCopy||(this.cfgId<163||this.cfgId>166)&&(window.player.buff.selfHarmCast>0&&this.cfg.effect1<10&&2==this.cfg.target1?(window.player.buff.selfHarmCast--,this.reuse()):window.player.buff.doubleCast>0?(window.player.buff.doubleCast--,this.reuse()):9==window.player.cardPlayed&&window.player.equip.luckyCard>0?(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)&&167!=this.cfgId?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)&&this.reuse()),this.isRemove&&this.doDelete()},endCast:function(){if(!this.isCopy){window.player.cardPlayed++,window.player.cardPlayedRound++;var e=window.player.equip;e.trigger(1),e.trigger(4),e.trigger(this.cfg.element+77),e.trigger(97),window.opponent.equip.trigger(24)}window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.selfHarmCastMax>0&&window.player.buff.selfHarmCast<=0&&(window.player.buff.selfHarmCast=window.player.buff.selfHarmCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++,window.player.cardPool.put(this.node)},discard:function(){this.remove(),window.player.equip.trigger(22)},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),!this.isTemp){var e=window.player.deck.indexOf(this.cfgId);e>=0&&window.player.deck.splice(e,1)}},reuse:function(){var e=cc.instantiate(this.node);e.position=this.node.position,window.player.boxCard.addChild(e,this.node.zIndex-1),e.getComponent("Card").initWithCopy(this.cfgId,this.pos),e.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){e.getComponent("Card").cast()}.bind(this))))},clear:function(){this.initBuff()},initDesc:function(){var e=this.cfg.desc;if(this.cfgId>=179&&this.cfgId<=182){var t=[3,2,2,4];e+="<color=#EBC82E>  (\u5f53\u524d"+((i=[1,6,6,10])[this.cfgId-179]+t[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var i=[8,13,13,18],o=(t=[3,3,3,4],Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,4,4][this.cfgId-183]));e+="<color=#EBC82E>  (\u5f53\u524d"+(i[this.cfgId-183]-t[this.cfgId-183]*o)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){e+="<color=#EBC82E>  (\u5f53\u524d"+((i=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}else 220==this.cfgId&&(e+="<color=#EBC82E>  (\u5f53\u524d"+(2*window.player.atkRound+1)+")</c>");this.txtDesc.string=e}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config"}],Chest:[function(e,t,i){"use strict";cc._RF.push(t,"282832AcdZFNov+QpH9gQcZ","Chest");var o=e("Utils");cc.Class({extends:cc.Component,properties:{txtRequire:cc.RichText,btn:cc.Button},init:function(e){this.index=e,this.node.position=cc.v2(240*e-240,-500),this.btn.node.color=cc.Color.GRAY,this.node.opacity=0;var t=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.3),t,cc.moveBy(.05,cc.v2(0,-20)))),this.satisfied=[!1,!1,!1,!1,!1,!1],this.requireList=o.getDifferentRandomNum(4,6,1),this.refreshRequire()},refreshRequire:function(){this.usable=!0;for(var e="",t=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],i=0;i<this.requireList.length;i++){var o=this.requireList[i];this.satisfied[o-1]?e+="<color=#EBC82E>"+t[o-1]+"</c>":(e+="<color=#000000>"+t[o-1]+"</c>",this.usable=!1)}this.txtRequire.string=e,this.usable&&(this.btn.interactable=!0,this.btn.node.color=cc.Color.WHITE)},remove:function(){this.btn.interactable=!1;var e=cc.moveBy(.2,cc.v2(0,-500));this.node.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.1,cc.v2(0,20)),e,cc.callFunc(function(){this.node.destroy()}.bind(this)))),window.player.chestList[this.index]=null},checkRequire:function(){for(var e=window.player.elementList,t=0;t<6;t++)e[t]>0&&!this.satisfied[t]&&(this.satisfied[t]=!0);this.refreshRequire()},doCast:function(){this.remove();for(var e=0;e<6;e++)window.player.patchCard()}}),cc._RF.pop()},{Utils:"Utils"}],CompleteLayer:[function(e,t,i){"use strict";cc._RF.push(t,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){o.setDataToBase(),cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],Config:[function(e,t,i){"use strict";cc._RF.push(t,"e9b6cHrlOtILogPlENB3GXp","Config");var o={jsonTable:{},load:function(e){for(var t=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event"],o=0,s=function(s){r="Config/"+i[s],cc.loader.loadRes(r,function(t,n){this.jsonTable[i[s]]=n.json,(o+=1)==i.length&&e()}.bind(t))},n=0;n<i.length;n++){var r;s(n)}},get:function(e,t){return this.jsonTable[e][t]}};t.exports=o,cc._RF.pop()},{}],CoverLayer:[function(e,t,i){"use strict";cc._RF.push(t,"8cf180RYjFDS416GS8jeF0h","CoverLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},gotoMain:function(e,t){t<=2&&(o.heroId=t,cc.director.loadScene("helloworld"))}}),cc._RF.pop()},{Game:"Game"}],DiceYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.id=e,this.index=t,this.player=0==t?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1,this.holded=!1;var i=this.delta=0==this.index?1:-1;this.node.position=cc.v2(110*e-220,-320*i),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*i)),cc.moveBy(.1,cc.v2(0,-20*i))))},roll:function(e){this.abled=!0,this.holded=!1;var t=this.player.holdList.indexOf(this.node);t>=0&&this.player.holdList.splice(t,1),e||(this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)));var i=50*Math.random()+150*this.id-325,o=(440*Math.random()+240)*this.delta,s=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(i,o)),cc.rotateTo(.2,s)))},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var e=0;e<this.player.holdList.length;e++)this.player.holdList[e].runAction(cc.moveTo(.1,cc.v2(110*e-220,0)));this.player.txtBtn.string="\u6295\u63b7"}else this.hold()},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(e,t,i){"use strict";cc._RF.push(t,"24e6aDXOPZNaoyluEGeZSR/","Dice"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node},init:function(e,t){this.id=e,this.holded=!1,this.element=0,this.node.color=cc.Color.WHITE,this.initBuff(t)},initBuff:function(e){this.freeze=22==e,this.markIce.active=this.freeze,this.lock=28==e,this.markLock.active=this.lock},roll:function(e){this.element=e||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=200*-this.delta,this.node.opacity=0,this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20*this.delta)),cc.moveTo(.1,cc.v2(this.node.x,0)))))},doHold:function(){0!=window.mainLayer.roundId||this.freeze||this.lock||this.hold()},hold:function(){this.holded?(this.holded=!1,this.node.color=cc.Color.WHITE,window.player.holdList[this.element-1]--):(this.holded=!0,this.node.color=cc.Color.GRAY,window.player.holdList[this.element-1]++)},remove:function(){var e=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.initBuff()}}),cc._RF.pop()},{}],EditEndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){o.deck=o.editCfg.deckHero.split(";"),o.equip=o.editCfg.equip.split(";"),o.hp=o.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(e,t,i){"use strict";cc._RF.push(t,"463d3gvgvdIabmN6qTyXAVR","Edit");var o=e("Game");cc.Class({extends:cc.Component,properties:{editHpEnemy:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox,editId:cc.EditBox,editHpHero:cc.EditBox},onLoad:function(){o.editCfg&&(this.editHpEnemy.string=o.editCfg.hpEnemy,this.editDice.string=o.editCfg.dice,this.editDeckEnemy.string=o.editCfg.deckEnemy,this.editEquipEnemy.string=o.editCfg.equipEnemy,this.editDeckHero.string=o.editCfg.deckHero,this.editEquip.string=o.editCfg.equip,this.editHpHero.string=o.editCfg.hpHero),this.editId.string=o.heroId},goBattle:function(){o.editCfg={hpEnemy:this.editHpEnemy.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string,hpHero:this.editHpHero.string},o.deck=this.editDeckHero.string.split(";"),o.equip=this.editEquip.string.split(";"),o.hp=o.hpMax=parseInt(o.editCfg.hpHero),o.heroId=parseInt(this.editId.string),o.level=7,cc.director.loadScene("mainLayer")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{btnClose:cc.Node,cardPrefab:cc.Prefab,txtReward:cc.Label,boxCard:cc.Node,btns:[cc.Node],txtCopper:cc.Label},onLoad:function(){window.endLayer=this,this.checkGameEnd(),window.mainLayer.hero.equip.check(26)?(o.hpMax+=6,o.hp+=6,this.txtReward.string="\u989d\u5916\u751f\u547d +6",this.boxCard.active=!1):this.initCards(),this.initCopper(),this.initExp(),o.monsterBeats.push(o.monsterId)},initCards:function(){this.btnClose.active=!1;for(var e=0,t=[[.5,.5,0],[.5,.5,0],[0,.5,.5]],i=Math.random(),n=0,r=0;r<3;r++)if(i<(n+=t[o.castle-1][r])){e=r+1;break}this.cardIdList=[],this.cards=[];for(var c=0;c<=0;){var a=o.getNewCardId(e),h=s.get("cfg_card",a).require;(o.castle>1||2==h.split(";").length||h<=102)&&(c=a)}this.cardIdList.push(c);for(var d=0;d<=0;){var f=o.getNewCardId(e),l=s.get("cfg_card",f).require;f!=c&&(o.castle>1||2==l.split(";").length||l<=102)&&(d=f)}this.cardIdList.push(d);for(var p=0;p<2;p++){var u=cc.instantiate(this.cardPrefab);u.getComponent("CardCollection").init(this.cardIdList[p]),u.position=cc.v2(0==p?-160:160,40),this.boxCard.addChild(u),this.cards.push(u)}},checkGameEnd:function(){var e=window.mainLayer.hero.player;e.equip.trigger(7),e.equip.trigger(8)},choose:function(e,t){o.getCard(this.cardIdList[t]),this.cards[1-t].destroy(),this.cards[t].runAction(cc.moveTo(.2,cc.v2(0,40))),this.btns[0].active=this.btns[1].active=!1,this.btnClose.active=!0},initCopper:function(){var e=window.mainLayer.enemy.cfg.level,t=1,i=window.mainLayer.hero.player;i.equip.check(73)&&(t+=.5),i.equip.check(74)&&(t+=1,o.itemEffect.pen--,o.itemEffect.pen<=0&&o.deleteItem(74)),i.equip.check(90)&&(t-=.5);var s=Math.max(Math.floor(e*t*4),1);this.txtCopper.string="\u91d1\u5e01 +"+s,o.copper+=s},initExp:function(){var e=window.mainLayer.enemy.cfg.level;o.exp+=e;var t=o.level<7?3*o.level:99;o.exp>=t&&(o.exp-=t,o.level++,o.hpMax+=5,o.hp=window.mainLayer.hero.hp=o.hpMax,o.levelUp=!0)},close:function(){o.hp=Math.min(window.mainLayer.hero.hp,o.hpMax),o.power=window.mainLayer.hero.power,cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndYahtzeeLayer:[function(e,t,i){"use strict";cc._RF.push(t,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtName:cc.Label,cardPrefab:cc.Prefab,itemNode:cc.Node,txtItemName:cc.Label,txtItemDesc:cc.Label,itemChangeNode:cc.Node,txtChangeName1:cc.Label,txtChangeDesc1:cc.Label,txtChangeName2:cc.Label,txtChangeDesc2:cc.Label,losePrefab:cc.Prefab,txtChange:cc.Node,rewardNode:cc.Node},init:function(e){this.result=e;this.txtTitle.string=["\u4f60\u8f93\u4e86","\u5e73\u5c40","\u4f60\u8d62\u4e86","\u4f60\u79bb\u5f00\u4e86"][e+1],this.checkResult()},checkResult:function(){var e=o.eventId,t="";if(0==this.result||1==this.result)if(1==e)t="\u6062\u590d\u5168\u90e8\u751f\u547d",o.hp=o.hpMax;else if(2==e||14==e)t="\u989d\u5916\u751f\u547d +15",o.hpMax+=15,o.hp+=15;else if(3==e)this.getItem(3);else if(4==e)t="\u91d1\u5e01 +50",o.copper+=50;else if(5==e||6==e)this.getItem(2);else if(7==e)t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(3),this.rewardNode.y-=130;else if(8==e)t="\u751f\u547d\u4e0a\u9650 +10, \u6062\u590d\u5168\u90e8\u751f\u547d",o.hpMax+=10,o.hp=o.hpMax;else if(9==e||17==e)this.getItem();else if(10==e)t="\u91d1\u5e01\u7ffb\u500d",o.copper*=2;else if(11==e){t="\u590d\u5236\u5361\u724c";var i=o.deck[Math.floor(Math.random()*o.deck.length)];this.getCard(null,i),this.rewardNode.y-=130}else if(12==e||16==e)t="\u91d1\u5e01 +100",o.copper+=100;else if(13==e){this.getCard(3).x-=200,this.getCard(3).x+=200}else 15==e&&(t="\u751f\u547d +30",o.hp=Math.min(o.hp+30,o.hpMax));else-1==this.result?1==e?(t="\u751f\u547d +10",o.hp=Math.min(o.hp+10,o.hpMax)):2==e||12==e?(t="\u751f\u547d\u4e0a\u9650 -5",o.hpMax=Math.max(o.hpMax-5,1),o.hp=Math.min(o.hp,o.hpMax)):3==e?this.changeItem():4==e||9==e?this.getCard():5==e?(t="\u91d1\u5e01 +20",o.copper+=20):6==e||11==e?this.changeCard():7==e?(t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(2),this.rewardNode.y-=130):8==e||10==e?(t="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",o.copper=Math.ceil(o.copper/2)):13==e?this.deleteCard(0):14==e?(t="\u751f\u547d\u4e0a\u9650 -10",o.hpMax=Math.max(o.hpMax-10,1),o.hp=Math.min(o.hp,o.hpMax)):15==e?(t="\u6028\u5ff5\uff1a\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59313\u751f\u547d",o.debuff++):16==e?(t="\u751f\u547d -10",this.loseHp(10)):17==e&&(t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getCard(),this.rewardNode.y-=130):2==this.result&&(2==e||15==e?(t="\u751f\u547d -10",this.loseHp(10)):7==e?(t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(1),this.rewardNode.y-=130):12==e?(t="\u91d1\u5e01 -20",o.copper=Math.max(o.copper-20,0)):13==e?(this.deleteCard(1,0),this.deleteCard(1,1)):16==e&&(t="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",o.copper=Math.ceil(o.copper/2)));this.txtName.string=t,window.homeLayer&&window.homeLayer.refreshHeroData()},close:function(){window.homeLayer?this.node.destroy():cc.director.loadScene("helloworld")},getCard:function(e,t){var i=t||o.getNewCardId(e),s=cc.instantiate(this.cardPrefab);return s.getComponent("CardCollection").init(i),this.rewardNode.addChild(s),o.getCard(i),s},getItem:function(e){var t=o.getNewItemId(0,e);this.itemNode.active=!0,this.txtItemName.string=s.get("cfg_item",t).name,this.txtItemDesc.string=s.get("cfg_item",t).desc,o.getItem(t)},loseHp:function(e){if(o.hp-=e,o.hp<=0){o.hp+=e;var t=cc.instantiate(this.losePrefab);this.node.addChild(t)}},changeCard:function(){if(o.deck.length+o.cardBag.length>0){var e;this.txtChange.active=!0;var t=Math.floor(Math.random()*(o.deck.length+o.cardBag.length));t<o.deck.length?(e=o.deck[t],o.deck.splice(t,1)):(e=o.cardBag[t-o.deck.length],o.cardBag.splice(t-o.deck.length,1));var i,s=o.getNewCardId();o.getCard(s),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),i.x-=200,this.rewardNode.addChild(i),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(s),i.x+=200,this.rewardNode.addChild(i)}else this.txtName.string="\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362"},changeItem:function(){if(o.equip.length>0){var e=Math.floor(Math.random()*o.equip.length),t=o.equip[e];o.equip.splice(e,1);var i=o.getNewItemId(0);o.getItem(i),this.itemChangeNode.active=!0,this.txtChangeName1.string=s.get("cfg_item",t).name,this.txtChangeDesc1.string=s.get("cfg_item",t).desc,this.txtChangeName2.string=s.get("cfg_item",i).name,this.txtChangeDesc2.string=s.get("cfg_item",i).desc}else this.txtName.string="\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362"},deleteCard:function(e,t){var i=0==e?o.deck:o.cardBag;if(i.length>0){var s=Math.floor(Math.random()*i.length),n=i[s];i.splice(s,1);var r=cc.instantiate(this.cardPrefab);r.getComponent("CardCollection").init(n),r.getComponent("CardCollection").markDelete.active=!0,null!=t&&(r.x=400*t-200),this.rewardNode.addChild(r)}else this.txtName.string="\u53ef\u79fb\u9664\u5361\u724c\u4e0d\u8db3",this.rewardNode.y-=130}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(e,t,i){"use strict";cc._RF.push(t,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,txtHp:cc.Label,boxBuff:cc.Node,txtName:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,figure:cc.Node},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){o.editCfg?this.initEdit():(this.cfgId=o.monsterId,this.cfg=s.get("cfg_monster",this.cfgId),this.hp=this.hpMax=this.cfg.hp,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,this.equipList=[this.cfg.item],this.txtName.string=this.cfg.name,this.initDeck()),this.player.init(1),this.ai=this.getComponent("AI")},startRound:function(){this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5)},onHurt:function(e,t,i){window.mainLayer.gameOver||(i=i||7,this.player.onHurt(e,t,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(0)))},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange(e),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},updateArmor:function(e){this.armor+=e,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor):(this.armor=0,this.boxArmor.active=!1)},initDeck:function(){if(0==this.cfg.card1)this.deck=window.mainLayer.hero.deck;else{this.deck=[];for(var e=0;e<6;e++){var t=this.cfg["card"+(e+1)];t>0&&this.deck.push(t)}}},initEdit:function(){this.hp=this.hpMax=parseInt(o.editCfg.hpEnemy),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(o.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.deck=o.editCfg.deckEnemy.split(";"),this.equipList=""!=o.editCfg.equipEnemy?[o.editCfg.equipEnemy]:[]}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(e,t,i){"use strict";cc._RF.push(t,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node},onLoad:function(){for(var e=0;e<o.equip.length;e++){var t=cc.instantiate(this.itemPrefab);t.getComponent("ItemCollection").init(o.equip[e]),t.position=cc.v2(0,-55-110*e),this.content.addChild(t)}this.content.height=Math.max(110*o.equip.length,1100)},close:function(){this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(e,t,i){"use strict";cc._RF.push(t,"a22ddJNtUJBS6PVq98jP/g9","Equip");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?o.equip:this.host.equipList,this.boxEquip=this.host.boxEquip,this.initItems(),this.swiftGlove=!1,this.suckRemainder=0,this.amulet=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0},initItems:function(){this.itemList=[];for(var e=0;e<this.equipList.length;e++)if(this.equipList[e]>0){var t=cc.instantiate(this.itemPrefab);t.getComponent("Item").init(this.equipList[e],this),0==this.index&&(t.x=110*e-350),this.boxEquip.addChild(t),this.itemList.push(t)}},check:function(e){for(var t=0;t<this.equipList.length;t++)if(this.equipList[t]==e)return!0;return!1},checkWithTrigger:function(e){return!!this.check(e)&&(this.doTrigger(e),!0)},trigger:function(e){var t=!1;if(this.check(e))if(1==e)this.opponent.host.onHurt(1,2),t=!0;else if(2==e)this.player.cardList.length<=0&&(this.host.updateArmor(3),t=!0);else if(3==e)this.player.cardList.length<=0&&(this.host.onHeal(2),t=!0);else if(4==e)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.btnRoll&&this.player.rollCount>0&&this.host.btnRoll.runAction(cc.moveTo(.2,cc.v2(285,145))),t=!0);else if(5==e)this.opponent.buff.addBuff(26,2),t=!0;else if(6==e)this.player.buff.addBuff(13,1),t=!0;else if(7==e)this.host.onHeal(6),t=!0;else if(8==e)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(10),t=!0);else if(9==e)this.opponent.host.onHurt(6,2),t=!0;else if(10==e)this.host.hp=Math.floor(.3*this.host.hpMax),t=!0,this.removeItem(e);else if(11==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.host.updateArmor(-this.host.armor),t=!0);else if(e>=12&&e<=18){this.opponent.buff.addBuff(e+9,[3,3,2,2,2,4,2][e-12]),t=!0}else if(19==e)this.player.extraDice++,t=!0;else if(20==e)this.host.updateArmor(8),t=!0;else if(22==e)this.opponent.host.onHurt(5,2),t=!0;else if(23==e)this.suckRemainder>=4&&(this.host.onHeal(Math.floor(this.suckRemainder/4)),this.suckRemainder=this.suckRemainder%4,t=!0);else if(24==e)this.opponent.host.onHurt(2,2,1),t=!0;else if(25==e)this.host.hp==this.host.hpMax&&(this.player.extraDice++,t=!0);else if(27==e)this.host.armor<=0&&(this.host.updateArmor(3),t=!0);else if(30==e)3==this.player.round&&(this.player.extraDice++,t=!0);else if(44==e)this.player.buff.atkBack+=3,t=!0;else if(45==e)this.scheduleOnce(function(){this.player.createExDice()}.bind(this),.5),t=!0;else if(e>=48&&e<=53)this.scheduleOnce(function(){window.player.createExDice(e-47)}.bind(this),.5),t=!0;else if(57==e)this.player.cardList.length>0&&(this.player.extraDice++,t=!0);else if(59==e)this.player.cardList.length>0&&(this.host.updateArmor(3*this.player.cardList.length),t=!0);else if(60==e)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),t=!0);else if(61==e)this.host.onHeal(15),t=!0;else if(68==e)this.opponent.buff.addBuff(24,1),t=!0;else if(69==e)this.opponent.host.onHurt(10,2),t=!0;else if(70==e)this.player.patchCard(),t=!0;else if(78==e||83==e)this.host.onHeal(2),t=!0;else if(79==e||82==e)this.host.updateArmor(2),t=!0;else if(80==e||81==e)this.opponent.host.onHurt(2,2),t=!0;else if(84==e)this.player.buff.addBuff(27,1),t=!0;else if(86==e)this.host.onHurt(2,2),t=!0;else if(88==e){if(o.deck.length>0){t=!0;for(var i=s.get("cfg_card",o.deck[0]).element,n=1;n<o.deck.length;n++)if(s.get("cfg_card",o.deck[n]).element!=i){t=!1;break}}}else if(91==e)this.player.buff.addBuff(21,2),t=!0;else if(93==e)1==this.player.round&&(this.scheduleOnce(function(){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard();for(var e=0;e<=0;){var t=o.getRandomCardId();3==s.get("cfg_card",t).quality&&(e=t)}window.player.patchCard(e)}.bind(this),.5),t=!0);else if(96==e)this.opponent.buff.addBuff(26,5),t=!0;else if(97==e)this.host.updateArmor(1),t=!0;else if(102==e)this.host.hp>this.host.hpMax&&(this.host.updateArmor(this.host.hp-this.host.hpMax),t=!0);else if(104==e)this.opponent.buff.addBuff(Math.floor(8*Math.random())+21,1),t=!0;else if(105==e)this.host.onHurt(1,2),t=!0;else if(108==e)this.opponent.host.onHurt(5,2,6),t=!0;else if(109==e)this.opponent.host.onHurt(5,2),t=!0;else if(110==e)this.host.onHurt(1,2),this.opponent.buff.addBuff(26,2),t=!0;else if(111==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),t=!0);else if(115==e)this.player.rollCount++,t=!0;else if(116==e)this.opponent.host.onHurt(6,2),t=!0;else if(118==e){for(var r=0,c=0;c<this.opponent.cardList.length;c++){this.opponent.cardList[c].getComponent("Card").burn&&r++}r>0&&(this.opponent.host.onHurt(6*r,2),t=!0)}else if(119==e)this.opponent.host.onHurt(5,2),t=!0;else if(121==e){for(var a=[],h=0;h<=this.player.buff.buffList.length;h++){var d=this.player.buff.buffList[h];d>=21&&d<=28&&a.push(d)}if(a.length>0){var f=a[Math.floor(Math.random()*a.length)];this.player.buff.removeBuff(f,this.player.buff.table[f]),t=!0}}else 122==e?(this.opponent.host.onHurt(5,2),t=!0):123==e?this.host.hp>this.host.hpMax&&(this.opponent.host.onHurt(this.host.hp-this.host.hpMax,2),t=!0):t=!0;return t&&this.doTrigger(e),t},removeItem:function(e){var t=this.equipList.indexOf(e);t>=0&&this.equipList.splice(t,1);for(var i=0;i<this.itemList.length;i++){var s=this.itemList[i].getComponent("Item");if(s.cfgId==e){s.remove();break}}0==this.index&&o.deleteItem(e)},doTrigger:function(e){for(var t=0;t<this.itemList.length;t++){var i=this.itemList[t].getComponent("Item");if(i.cfgId==e&&!i.isRemoved){i.trigger();break}}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0d029pbdspBQZQHImTjZ76I","EventLayer");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtDesc:cc.Label,txtResults:[cc.Label],endPrefab:cc.Prefab},onLoad:function(){this.cfgId=o.eventId;var e=s.get("cfg_event",this.cfgId);this.txtName.string=e.name,this.txtDesc.string=e.desc;for(var t=["\u80dc\u5229/\u5e73\u5c40\uff1a","\u5931\u8d25\uff1a","\u79bb\u5f00\uff1a"],i=0;i<3;i++)this.txtResults[i].string=t[i]+e["result"+(i+1)]},onBattle:function(){o.stayRoom=!0,o.newRoom=!1,window.homeLayer=null,cc.director.loadScene("yahtzee")},onLeave:function(){if("\u65e0"!=s.get("cfg_event",this.cfgId).result3){var e=cc.instantiate(this.endPrefab);e.getComponent("EndYahtzeeLayer").init(2),window.homeLayer.node.addChild(e)}this.close()},close:function(){this.node.destroy(),window.homeLayer.btnAlter.node.active=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(e,t,i){"use strict";cc._RF.push(t,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{mark:cc.Sprite,line:cc.Node},init:function(e,t){cc.loader.loadRes("Texture/"+["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"][e-1],cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)),this.line.active=t}}),cc._RF.pop()},{}],Game:[function(e,t,i){"use strict";cc._RF.push(t,"f5308O6zsVOxr+EKRsyR7ba","Game");var o=e("Config"),s={version:0,getData:function(e){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(t){cc.log("getStorageSuccess:"+t.data),void 0!=t.data?(s.syncFromStorage(JSON.parse(t.data)),e()):(this.setDataToBase(),e())}.bind(this),fail:function(){this.setDataToBase(),e()}.bind(this)});else{var t=cc.sys.localStorage.getItem("dice");void 0!=t?s.syncFromStorage(JSON.parse(t)):this.setDataToBase(),e()}},setDataToBase:function(){s.heroId=1,s.deck=[],s.cardBag=[],s.equip=[],s.hp=s.hpMax=30,s.power=0,s.powerMax=20,s.heroPos=2,s.stayRoom=s.newRoom=!0,s.exp=0,s.level=1,s.character=1,s.castle=1,s.floor=1,s.roomType=0,s.copper=50,s.debuff=0,s.shopIds=[],s.eventIds=[],s.floorCfg=[],s.historyPath=[],s.historyChoose=[],s.specialRoomIds=[],s.monsterBeats=[],s.discountCard=s.discountItem=-1,s.itemEffect={vase:0,flagon:0,pen:0,vip1:!1,vip2:!1},s.saveData()},syncFromStorage:function(e){for(var t=["deck","cardBag","equip","hp","hpMax","power","powerMax","heroPos","stayRoom","newRoom","level","floor","castle","roomType","copper","debuff","shopIds","eventIds","floorCfg","historyPath","historyChoose","discountCard","discountItem","itemEffect","specialRoomIds","exp","monsterBeats"],i=0;i<t.length;i++)s[t[i]]=e[t[i]]},saveData:function(){s.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(s),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(s))},getItem:function(e){if(71==e)s.copper+=30;else if(87==e)for(var t=0;t<2;t++)s.getItem(s.getNewItemId(0,2));else s.equip.push(e);if(28==e)s.itemEffect.vase+=2;else if(29==e)s.itemEffect.flagon+=2;else if(40==e)s.hpMax+=5,s.hp+=5;else if(41==e)s.hpMax+=10,s.hp+=10;else if(46==e)s.itemEffect.vip1=!0;else if(47==e)s.itemEffect.vip2=!0;else if(72==e)s.copper+=10,s.hpMax+=5,s.hp+=5;else if(74==e)s.itemEffect.pen+=3;else if(84==e)for(var i=0;i<3;i++)s.getItem(s.getNewItemId(0));else 92==e?(s.hpMax=Math.max(s.hpMax-8,1),s.hp=Math.min(s.hp,s.hpMax)):95==e?(s.hpMax+=10,s.hp=s.hpMax):96==e?(s.hpMax=Math.max(s.hpMax-10,1),s.hp=Math.min(s.hp,s.hpMax)):105==e?(s.hpMax+=20,s.hp+=20):106==e&&(s.powerMax+=10);94!=e&&s.equip.indexOf(94)>=0&&(s.hpMax+=5,s.hp+=5),window.homeLayer&&window.homeLayer.refreshHeroData()},getCard:function(e){var t=2==s.heroId?4:6;s.deck.length<t?s.deck.push(e):s.cardBag.push(e)},deleteItem:function(e){var t=s.equip.indexOf(e);t>=0&&s.equip.splice(t,1)},getNewItemId:function(e,t){for(var i=0;i<=0;){var n=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1;s.equip.indexOf(n)<0&&(0==e&&o.get("cfg_item",n).get<=1||1==e&&0==o.get("cfg_item",n).get||2==e)&&(t?o.get("cfg_item",n).quality==t&&(i=n):i=n)}return i},getNewCardId:function(e,t){for(var i=0;i<=0;){var n=s.getRandomCardId(null,t);s.deck.indexOf(n)<0&&s.cardBag.indexOf(n)<0&&(e?o.get("cfg_card",n).quality==e&&(i=n):i=n)}return i},getRandomCardId:function(e,t){for(var i=0;i<=0;){var s=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_card).length)+1;o.get("cfg_card",s).get==(t?2:1)&&(e?o.get("cfg_card",s).element==e&&(i=s):i=s)}return i},getNewMonsterId:function(e,t){for(var i=0;i<=0;){var n=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_monster).length)+1;s.monsterBeats.indexOf(n)<0&&o.get("cfg_monster",n).level==e&&o.get("cfg_monster",n).type==t&&(i=n)}return i}};t.exports=s,cc._RF.pop()},{Config:"Config"}],HelloWorld:[function(e,t,i){"use strict";cc._RF.push(t,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var o=e("Game");cc.Class({extends:cc.Component,properties:{hero:cc.Node,door:[cc.Button],mark:[cc.Sprite],txtFloor:cc.Label,btnAlter:cc.Sprite,stripHp:cc.ProgressBar,txtHp:cc.Label,txtCopper:cc.Label,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,equipPrefab:cc.Prefab,completePrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab},onLoad:function(){if(window.homeLayer=this,this.pos=o.heroPos,this.abled=!1,o.stayRoom)this.abled=!0,this.door[this.pos].node.color=cc.Color.GRAY;else{var e=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];this.hero.position=e[this.pos],this.hero.runAction(cc.sequence(cc.moveTo(.2,cc.v2()),cc.callFunc(function(){this.abled=!0,this.door[this.pos].node.color=cc.Color.GRAY}.bind(this))))}1==o.floor&&1==o.castle&&this.initGameConfig(),o.newRoom?(this.checkEquip(),this.initFloorConfig()):this.typeList=o.floorCfg,this.initDoors(),this.initRoom(),this.refreshHeroData(),o.levelUp&&this.scheduleOnce(this.openLvUp,.3)},initDoors:function(){var e=this;this.txtFloor.string=o.castle+"-"+o.floor;for(var t=["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"],i=0;i<4;i++){var s=this.typeList[i];-1==s?this.door[i].node.active=!1:s>0&&function(){var o=e.mark[i];cc.loader.loadRes("Texture/"+t[s-1],cc.SpriteFrame,function(e,t){o.spriteFrame=t}.bind(e))}()}},initRoom:function(){if(o.newRoom&&(7==o.roomType&&o.floor>=12||6==o.roomType&&6==o.floor))cc.loader.loadRes("Texture/mark_treasure",cc.SpriteFrame,function(e,t){this.btnAlter.spriteFrame=t}.bind(this));else if(o.roomType<=1||!o.newRoom)this.btnAlter.node.active=!1;else{cc.loader.loadRes("Texture/"+["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"][o.roomType-1],cc.SpriteFrame,function(e,t){this.btnAlter.spriteFrame=t}.bind(this))}},gotoDoor:function(e,t){if(t!=this.pos&&this.abled){this.abled=!1;var i=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];this.hero.runAction(cc.sequence(cc.moveTo(.2,i[t]),cc.callFunc(function(){if(o.heroPos=(parseInt(t)+2)%4,o.floor++,o.castle<3&&o.floor>12)o.floor=1,o.castle++,o.historyPath=[],o.historyChoose=[];else if(3==o.castle&&o.floor>13){var e=cc.instantiate(this.completePrefab);return void this.node.addChild(e)}o.historyChoose.push(t),o.roomType=this.typeList[t],o.newRoom=!0,1==o.roomType||o.roomType>=6?(window.homeLayer=null,o.stayRoom=!0,o.monsterId=o.monsterCfg[t],cc.director.loadScene("mainLayer")):(o.stayRoom=!1,cc.director.loadScene("helloworld"))}.bind(this))))}},openAlter:function(){if(2==o.roomType){var e=cc.instantiate(this.campPrefab);this.node.addChild(e)}else if(3==o.roomType||o.roomType>=6){var t=cc.instantiate(this.treasurePrefab);t.getComponent("TreasureLayer").init(7==o.roomType),this.node.addChild(t)}else if(4==o.roomType){var i=cc.instantiate(this.eventPrefab);this.node.addChild(i)}else if(5==o.roomType){var s=cc.instantiate(this.shopPrefab);this.node.addChild(s)}},refreshHeroData:function(){this.txtHp.string=o.hp+"/"+o.hpMax,this.stripHp.progress=o.hp/o.hpMax,this.txtCopper.string=o.copper},openMap:function(){var e=cc.instantiate(this.mapPrefab);this.node.addChild(e)},openCardBag:function(){var e=cc.instantiate(this.bagPrefab);this.node.addChild(e)},openEquip:function(){var e=cc.instantiate(this.equipPrefab);this.node.addChild(e)},openLvUp:function(){var e=cc.instantiate(this.lvUpPrefab);this.node.addChild(e)},initDeck:function(){var e=2==o.heroId?2:3;if(o.deck.length+o.cardBag.length<=e)for(;o.deck.length<e;){var t=o.getNewCardId(null,!0);o.getCard(t)}},checkEquip:function(){2==o.roomType&&o.equip.indexOf(38)>=0&&(o.hp=Math.min(o.hp+10,o.hpMax)),3==o.roomType&&o.equip.indexOf(42)>=0&&(o.copper+=30)},initGameConfig:function(){this.initDeck(),o.eventIds=[];for(var e=0;e<17;e++){var t=Math.floor(Math.random()*(o.eventIds.length+1));o.eventIds.splice(t,0,e+1)}o.specialRoomIds=[3,4];for(var i=[[2,4,5],[2,3,4,4,5],[2,3,4,4,5]],s=0;s<3;s++)for(var n=i[s],r=n.length-1;r>=0;r--){var c=Math.floor(Math.random()*n.length);o.specialRoomIds.push(n[c]),n.splice(c,1)}},initFloorConfig:function(){if(this.typeList=[-1,-1,-1,-1],this.typeList[this.pos]=-2,1==o.floor)this.typeList[(this.pos+2)%4]=1;else if(11==o.floor)this.typeList[(this.pos+2)%4]=7;else if(12==o.floor)3==o.castle?this.typeList[(this.pos+2)%4]=7:this.typeList[(this.pos+2)%4]=0;else if(13==o.floor)this.typeList[(this.pos+2)%4]=0;else{var e=[];if(3==o.floor||7==o.floor||9==o.floor)e=Math.random()<.4?[1,1,1]:[1,1];else if(5==o.floor)e=[6,6];else{var t=5;o.specialRoomIds.length>0&&(t=o.specialRoomIds.shift()),e=Math.random()<.3?[t,1,1]:[t,1]}e.length<3&&e.splice(Math.floor(3*Math.random()),0,-1);for(var i=0;i<4;i++)if(i!=this.pos){var s=Math.floor(Math.random()*e.length),n=e[s];e.splice(s,1),this.typeList[i]=n}}o.floorCfg=this.typeList,o.historyPath.push(this.typeList),o.monsterCfg=[0,0,0,0];for(var r=2*(o.castle-1)+(o.floor<=5?1:2),c=0;c<4;c++){var a=this.typeList[c];if(1==a||a>=6){for(var h=0;h<=0;){var d=1==a?0:6==a?1:2;12==o.floor&&(r=7,d=3);var f=o.getNewMonsterId(r,d);o.monsterCfg.indexOf(f)<0&&(h=f)}o.monsterCfg[c]=h}}if(4==o.roomType)o.eventIds.length>0?o.eventId=o.eventIds.shift():o.eventId=Math.floor(17*Math.random())+1;else if(5==o.roomType){for(var l=[],p=[],u=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];l.length<3;){for(var m=0,g=Math.random(),w=0,v=0;v<3;v++)if(g<(w+=u[o.castle-1][v])){m=v+1;break}for(var C=o.getNewCardId(m),y=!1,b=0;b<l.length;b++)if(C==l[b]){y=!0;break}y||l.push(C)}for(u=[[.4,.4,.2],[.3,.4,.3],[.2,.4,.4]];p.length<3;){for(var x=0,L=Math.random(),k=0,I=0;I<3;I++)if(L<(k+=u[o.castle-1][I])){x=I+1;break}for(var M=o.getNewItemId(1,x),q=!1,R=0;R<p.length;R++)if(M==p[R]){q=!0;break}q||p.push(M)}o.shopIds=l.concat(p,[1,2]),o.itemEffect.vip1&&(o.discountItem=Math.floor(3*Math.random())),o.itemEffect.vip2&&(o.discountCard=Math.floor(3*Math.random()))}},gotoEdit:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Hero:[function(e,t,i){"use strict";cc._RF.push(t,"7311fX1RYNN1bDgBGcTZsee","Hero");var o=e("Game"),s=e("Skill");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,btnSkills:[cc.Button],txtSkills:[cc.Label],btnEnd:cc.Node,btnRoll:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){this.deck=o.deck.concat(),this.player.init(0),this.hpMax=o.hpMax,this.hp=o.hp,this.power=o.power,this.powerMax=o.powerMax,this.armor=0,this.refreshStrip(),this.initSkills()},startRound:function(){this.btnEnd.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.2,cc.v2(-260,145))))},endRound:function(){this.skillable=[!0,!0],this.checkSkills(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-480,145))),this.btnRoll.runAction(cc.moveTo(.2,cc.v2(465,145)))},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onHurt:function(e,t,i){if(!window.mainLayer.gameOver){var o=this.hp;i=i||7,this.player.onHurt(e,t,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),o>this.hp&&this.addPower(o-this.hp)}},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange(e),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(e){this.power+=e,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.checkSkills()},updateArmor:function(e){this.armor+=e,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor):(this.armor=0,this.boxArmor.active=!1)},update:function(){Math.abs(this.stripPower.progress-this.power/this.powerMax)>.03?this.stripPower.progress+=.03*(this.stripPower.progress>this.power/this.powerMax?-1:1):this.stripPower.progress=this.power/this.powerMax},initSkills:function(){this.skillable=[!0,!0];var e=[["\u8865\u5200","\u53cc\u6253"],["\u521b\u9020","\u5927\u6ee1\u8d2f"]];this.txtSkills[0].string=e[o.heroId-1][0],this.txtSkills[1].string=e[o.heroId-1][1],this.checkSkills()},doSkill:function(e,t){if(0==window.mainLayer.roundId){this.skillable[t]=!1,this.addPower(-[10,20][t]),s.doCast(t)}},checkSkills:function(){for(var e=[10,20],t=0;t<2;t++)1==t&&o.level<3?this.btnSkills[t].node.active=!1:this.btnSkills[t].interactable=this.skillable[t]&&this.power>=e[t]},roll:function(){this.player.roll()},checkBtnRoll:function(){var e=!1;if(this.player.cardList.length>0)e=!0;else if(this.player.chestList)for(var t=0;t<3;t++)if(this.player.chestList[t]){e=!0;break}e||this.btnRoll.runAction(cc.moveTo(.2,cc.v2(465,145)))}}),cc._RF.pop()},{Game:"Game",Skill:"Skill"}],ItemCollection:[function(e,t,i){"use strict";cc._RF.push(t,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.Label},init:function(e){var t=o.get("cfg_item",e),i=[cc.color(0,0,0),cc.color(0,255,0),cc.color(255,0,255)];this.txtName.string=t.name,this.txtDesc.string=t.desc,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][t.quality-1],this.txtQuality.node.color=i[t.quality-1]}}),cc._RF.pop()},{Config:"Config"}],ItemCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var o=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtDesc:cc.Label},init:function(e){var t=o.get("cfg_item",e);this.txtName.string=t.name,this.txtDesc.string=t.desc}}),cc._RF.pop()},{Config:"Config"}],Item:[function(e,t,i){"use strict";cc._RF.push(t,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var o=e("Config");cc.Class({extends:cc.Component,properties:{label:cc.Label},init:function(e,t){this.cfgId=e,this.cfg=o.get("cfg_item",e),this.label.string=this.cfg.name,this.equip=t},remove:function(){this.isRemoved=!0,this.action||this.doDelete()},trigger:function(){this.action&&this.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.2),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,this.isRemoved&&this.doDelete()}.bind(this))),this.node.runAction(this.action)},doDelete:function(){var e=this.equip.itemList.indexOf(this.node);e>=0&&this.equip.itemList.splice(e,1);for(var t=0;t<this.equip.itemList.length;t++)this.equip.itemList[t].x=110*t-350;this.node.destroy()}}),cc._RF.pop()},{Config:"Config"}],LevelUpLayer:[function(e,t,i){"use strict";cc._RF.push(t,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{btnClose:cc.Node,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,txtSkill:cc.Label,boxReward:cc.Node,btns:[cc.Node]},onLoad:function(){if(this.type=3,3==o.level){this.txtSkill.node.active=!0;this.txtSkill.string="\u6012\u6c14\u6280\uff1a"+["\u53cc\u6253","\u5927\u6ee1\u8d2f"][o.heroId-1],this.btns[0].active=this.btns[1].active=!1}else 4==o.level||7==o.level?(this.type=2,this.initItems()):(this.type=1,this.initCards())},initCards:function(){this.btnClose.active=!1,this.itemIdList=[],this.items=[];var e=o.getNewCardId();this.itemIdList.push(e);for(var t=0;t<=0;){var i=o.getNewCardId();i!=e&&(t=i)}this.itemIdList.push(t);for(var s=0;s<2;s++){var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(this.itemIdList[s]),n.position=cc.v2(0==s?-160:160,40),this.boxReward.addChild(n),this.items.push(n)}},initItems:function(){this.btnClose.active=!1,this.itemIdList=[],this.items=[];var e=o.getNewItemId(0);this.itemIdList.push(e);for(var t=0;t<=0;){var i=o.getNewItemId(0);i!=e&&(t=i)}this.itemIdList.push(t);for(var s=0;s<2;s++){var n=cc.instantiate(this.itemPrefab);n.getComponent("ItemCommodity").init(this.itemIdList[s]),n.position=cc.v2(0==s?-160:160,40),this.boxReward.addChild(n),this.items.push(n)}},choose:function(e,t){1==this.type?o.getCard(this.itemIdList[t]):o.getItem(this.itemIdList[t]),this.items[1-t].destroy(),this.items[t].runAction(cc.moveTo(.2,cc.v2(0,40))),this.btns[0].active=this.btns[1].active=!1,this.btnClose.active=!0},close:function(){o.levelUp=!1,this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],LoseLayer:[function(e,t,i){"use strict";cc._RF.push(t,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){if(o.floor>1){o.floor--,o.newRoom=!1;var e=o.floorCfg.indexOf(-2);e>=0&&(o.heroPos=e)}cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(e,t,i){"use strict";cc._RF.push(t,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,losePrefab:cc.Prefab,editEndPrefab:cc.Prefab},onLoad:function(){window.mainLayer=this,this.gameOver=!1},start:function(){this.hero=this.heroNode.getComponent("Hero"),this.enemy=this.enemyNode.getComponent("Enemy"),this.hero.init(),this.enemy.init(),this.roundId=1,this.scheduleOnce(function(){this.doRound()}.bind(this),.1)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.player.startRound()},showEnd:function(e){if(this.gameOver=!0,o.editCfg){var t=cc.instantiate(this.editEndPrefab);this.node.addChild(t)}else if(0==e){var i=cc.instantiate(this.endPrefab);this.node.addChild(i)}else{var s=cc.instantiate(this.losePrefab);this.node.addChild(s)}}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2be16dXDepLLbZP42Rqq+om","MapLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{scroll:cc.ScrollView,content:cc.Node,fortPrefab:cc.Prefab},onLoad:function(){cc.log(o.historyPath);for(var e=0;e<o.historyPath.length;e++){var t=o.historyPath[e],i=0,s=!1;if(o.historyChoose[e])i=o.historyChoose[e],s=!0;else for(var n=0;n<4;n++)if(t[n]>0){i=n;break}var r=cc.instantiate(this.fortPrefab);r.getComponent("Fort").init(t[i],s),r.position=cc.v2(0,190+120*e),this.content.addChild(r);for(var c=[-1,1],a=2;a>=0;a--){var h=c[a]+0;(h<-2||h>2)&&c.splice(a,1)}for(var d=0;d<4;d++){var f=t[d];if(d!=i&&f>0){var l=Math.floor(Math.random()*c.length),p=c[l],u=0+p;c.splice(l,1);var m=cc.instantiate(this.fortPrefab);if(m.getComponent("Fort").init(f),m.position=cc.v2(120*u,190+120*e),this.content.addChild(m),-1==p||1==p){var g=2*p+0;g>=-2&&g<=2&&c.push(2*p)}}}}this.content.height=Math.max(120*o.historyPath.length+140,1180),this.scroll.scrollToTop(0)},close:function(){this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(e,t,i){"use strict";cc._RF.push(t,"52880hyyK1GjLw1tAGJFFaD","Opening");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{endPrefab:cc.Prefab},onLoad:function(){this.login()},login:function(){s.load(function(){o.setDataToBase(),this.gotoMain()}.bind(this))},gotoMain:function(){cc.director.loadScene("cover")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Node]},init:function(e){this.index=e,this.win=0,this.dicePool=new cc.NodePool;for(var t=0;t<5;t++){var i=cc.instantiate(this.dicePrefab);this.dicePool.put(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){this.diceList=[];for(var e=0;e<5;e++){var t=this.dicePool.get();t.getComponent("DiceYahtzee").init(e,this.index),this.boxDice.addChild(t),this.diceList.push(t)}this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check()}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.hold(),t.abled=!1}}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){e[this.diceList[t].getComponent("DiceYahtzee").element-1]++}e.sort(function(e,t){return t-e}),5==e[0]?this.score=7:4==e[0]?this.score=6:3==e[0]?2==e[1]?this.score=5:this.score=4:2==e[0]?2==e[1]?this.score=3:this.score=1:this.score=2},doWin:function(){this.crowns[this.win].color=0==this.index?cc.color(0,0,255):cc.color(255,0,0),this.win++}}),cc._RF.pop()},{}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"ba4f5YaUElBy61UWqBofsfz","Player");var o=e("Game"),s=e("Utils"),n=e("Config");cc.Class({extends:cc.Component,properties:{boxCard:cc.Node,boxDice:cc.Node,cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,chestPrefab:cc.Prefab,markCurse:cc.Node},init:function(e){this.index=e,this.host=0==e?this.getComponent("Hero"):this.getComponent("Enemy"),this.opponent=0==e?window.mainLayer.enemy.player:window.mainLayer.hero.player,this.buff=this.getComponent("Buff"),this.buff.init(),this.equip=this.getComponent("Equip"),this.equip.init(),this.cardPool=new cc.NodePool;for(var t=0;t<6;t++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var o=0;o<5;o++){var s=cc.instantiate(this.dicePrefab);this.dicePool.put(s)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.atkRound=0,this.deck=this.host.deck,this.diceCount=0==e?5:this.host.diceCount;for(var n=[85,86,89,90,91,92],r=0;r<n.length;r++)this.equip.checkWithTrigger(n[r])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++},start:function(){this.checkGameBegin()},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,this.checkStart(),2==o.heroId&&0==this.index&&(this.chestList=[null,null,null],this.createChest()),this.initCards(),this.initDices(),window.mainLayer.gameOver||this.host.startRound()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var e=this.diceCount+this.extraDice,t=s.getDifferentRandomNum(e,e-1,0),i=Math.min(this.buff.lock,e),o=t.splice(0,i);this.buff.removeBuff(28,i);var n=0,r=[];this.equip.checkWithTrigger(63)||(n=Math.min(this.buff.freeze,e-i),r=t.splice(0,n),this.buff.removeBuff(22,n));for(var c=0;c<e;c++){for(var a=null,h=0;h<o.length;h++)if(c==o[h]){a=28;break}if(!a)for(var d=0;d<r.length;d++)if(c==r[d]){a=22;break}var f=null;(f=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab)).position=cc.v2(-(e-1)/2*110+110*c,0==window.mainLayer.roundId?-120:600),f.getComponent("Dice").init(c,a),this.boxDice.addChild(f),this.diceList.push(f)}this.extraDice=0,this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[];for(var e=Math.min(this.deck.length,6),t=this.equip.checkWithTrigger(66)?0:this.buff.silence,i=this.equip.checkWithTrigger(62)?0:this.buff.burn,o=0;o<e;o++){var s=null,r=n.get("cfg_card",this.deck[o]).element;this.buff.silenceDark&&6==r?s=25:Math.random()<t/(e-o)?(s=25,t--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==r?s=21:Math.random()<i/(e-o)&&(s=21,i--,this.buff.removeBuff(21,1)),this.drawCard(this.deck[o],s)}},drawCard:function(e,t,i){var o=this.getEmptyIndex();if(!(o<0)){var s=null;return(s=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(e,o,t,0),s.getComponent("Card").isTemp=i,this.boxCard.addChild(s,100),this.cardList.push(s),s}},patchCard:function(e,t){var i=this.buff,s=null;e=e||o.getRandomCardId();var r=n.get("cfg_card",e).element;i.silenceDark&&6==r?s=25:i.silence>0&&!this.equip.checkWithTrigger(66)?(s=25,i.removeBuff(25,1)):i.burnIce&&2==r?s=21:i.burn>0&&!this.equip.checkWithTrigger(62)&&(s=21,i.removeBuff(21,1));var c=this.drawCard(e,s,!t);return this.checkCardsRequire(),this.equip.trigger(119),c},roll:function(e,t){for(var i=0;i<this.diceList.length;i++){var o=this.diceList[i].getComponent("Dice");1==e?o.roll():o.freeze||o.lock||(t?(o.holded&&o.hold(),o.roll(t)):o.holded||o.roll())}this.checkElement();for(var s=0,n=0;n<6;n++)this.elementList[n]>s&&(s=this.elementList[n]);if(1==s&&(this.equip.trigger(115),this.equip.trigger(116)),e){this.cardAbledCount<=0&&this.equip.trigger(45);for(var r=48;r<=53;r++)this.equip.trigger(r);this.equip.trigger(93)}this.rollCount--,0==window.mainLayer.roundId&&(this.rollCount<=0?this.host.btnRoll.runAction(cc.moveTo(.15,cc.v2(465,145))):this.host.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(465,145)),cc.moveTo(.15,cc.v2(285,145)))))},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var e=0;e<this.diceList.length;e++){var t=this.diceList[e].getComponent("Dice");t.lock||this.elementList[t.element-1]++}if(this.cardAbledCount=this.checkCardsRequire(),this.chestList)for(var i=0;i<3;i++)this.chestList[i]&&this.chestList[i].getComponent("Chest").checkRequire()},createExDice:function(e){var t=null;this.buff.lock>0?(t=28,this.buff.removeBuff(28,1)):e?t=22:this.buff.freeze>0&&!this.equip.checkWithTrigger(63)&&(t=22,this.buff.removeBuff(22,1));var i=null;(i=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab)).getComponent("Dice").init(this.diceList.length-1,t),this.boxDice.addChild(i),this.diceList.push(i);for(var o=0;o<this.diceList.length;o++)this.diceList[o].position=cc.v2(-(this.diceList.length-1)/2*110+110*o,0);i.getComponent("Dice").roll(e),this.checkElement()},endRound:function(){this.scheduleOnce(function(){for(var e=this.cardList.length-1;e>=0;e--)this.cardList[e].getComponent("Card").remove()}.bind(this),.3);for(var e=0;e<this.diceList.length;e++)this.diceList[e].getComponent("Dice").remove();if(this.chestList)for(var t=0;t<3;t++)this.chestList[t]&&this.chestList[t].getComponent("Chest").remove();0==this.index&&this.host.endRound(),this.scheduleOnce(function(){this.buff.exRound>0?(this.startRound(),this.buff.exRound--):window.mainLayer.doRound()}.bind(this),.5),this.settleBuff(),this.settleEquip()},checkCardsRequire:function(){for(var e=0,t=0;t<this.cardList.length;t++){this.cardList[t].getComponent("Card").checkRequire()&&e++}return e},checkGameBegin:function(){for(var e=[6,12,13,14,15,16,17,18,19,20,30,44,86,91,96],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.equip.check(37)&&(this.equip.amulet=2),this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),7==o.roomType&&this.equip.trigger(61),0==this.index&&o.debuff>0&&this.onHurt(3*o.debuff,1)},checkStart:function(){this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]);for(var e=[5,9,25,84,105,111,121],t=0;t<e.length;t++)this.equip.trigger(e[t]);if(this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var i=this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?2:1);this.host.onHurt(i,1,26),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.undead--},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.table[23]>0&&this.buff.removeBuff(23,1),this.buff.table[24]>0&&this.buff.removeBuff(24,1),this.buff.multiCast=this.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1,this.buff.imitation>0&&(this.cardList.length<=0&&(this.extraDice+=this.buff.imitation),this.buff.imitation=0)},settleEquip:function(){for(var e=[2,3,27,11,57,59,60,104,110],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.opponent.equip.trigger(118),this.cardPlayedRound=0,this.atkRound=0,this.equip.swiftGlove=!1,this.equip.suckRemainder=0},onHurt:function(e,t,i){if(this.buff.frail>0&&0==t&&!this.equip.checkWithTrigger(64)){var o=.5;this.opponent.equip.checkWithTrigger(54)&&(o+=.25),this.equip.checkWithTrigger(56)&&(o-=.25),this.equip.checkWithTrigger(113)&&(o*=2),this.opponent.equip.checkWithTrigger(113)&&(o*=2),e=Math.floor(e*(o+1))}if(this.opponent.equip.checkWithTrigger(21)&&(e+=1),this.opponent.host.hp<10&&this.opponent.equip.checkWithTrigger(75)&&(e+=3),this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(e=0),e>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),e=1),e>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),e=1),e>0&&this.equip.checkWithTrigger(114)&&e--,9==i&&e>0&&this.opponent.host.onHeal(e),this.opponent.equip.suckRemainder+=e,this.opponent.equip.trigger(23),this.buff.atkBack>0&&0==t&&e>0&&this.opponent.host.onHurt(this.buff.atkBack,1),e>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(e,2),this.assertHpChange(-e),this.host.armor>0){if(this.host.armor>=e)return void this.host.updateArmor(-e);e-=this.host.armor,this.host.updateArmor(-this.armor)}this.host.hp-=e,this.host.hp<=0&&this.buff.undead>0&&(this.host.hp=1),this.host.hp<=0&&this.equip.trigger(10),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},onHeal:function(e){if(this.equip.checkWithTrigger(122)){var t=Math.min(e,this.host.hpMax-this.host.hp);this.opponent.host.onHurt(t,2)}this.host.hp+=e,this.equip.trigger(102),this.equip.trigger(123)},assertHpChange:function(e){this.showQueue.push(e),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var e=this.showQueue[0],t=cc.instantiate(this.host.txtNum);t.getComponent(cc.Label).string="\u95ea\u907f"==e?"\u95ea\u907f":e>0?"+"+e:0==e?"-0":e,t.position=this.host.txtNum.position,this.node.addChild(t),t.scale=.8,t.color=e-0==null||e>0?cc.color(0,255,0):cc.color(255,0,0);var i=cc.spawn(cc.moveBy(.5,cc.v2(0,150)),cc.fadeTo(.5,100),cc.scaleTo(.5,1));t.runAction(cc.sequence(cc.scaleTo(.1,1.1),i,cc.callFunc(function(){t.destroy()}.bind(this)))),t.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this))))},getEmptyIndex:function(){for(var e=0;e<6;e++){var t=!1;if(this.chestList&&this.chestList[e%3]&&(t=!0),!t)for(var i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==e){t=!0;break}}if(!t)return e}return-1},createChest:function(e){for(var t=-1,i=2;i>=0;i--)if(!this.chestList[i]){t=i;break}if(t>=0){var o=cc.instantiate(this.chestPrefab);o.getComponent("Chest").init(t),this.boxCard.addChild(o,100),this.chestList[t]=o,e&&o.getComponent("Chest").checkRequire()}}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],PotionCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"85c55EVbbNKe72lZU+lcHho","PotionCommodity"),cc.Class({extends:cc.Component,properties:{txtName:cc.Label},init:function(e){this.txtName.string="\u751f\u547d +"+10*e}}),cc._RF.pop()},{}],ShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"47158KpbiJMF46lKbQmGdRL","ShopItem");var o=e("Game"),s=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,potionPrefab:cc.Prefab,txtCost:cc.Label,txtDiscount:cc.Node},init:function(e,t,i){this.cfgId=e,this.type=t;var o=void 0;0==t?((o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),this.cost=3*s.get("cfg_card",e).value):1==t?((o=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(e),this.cost=6*s.get("cfg_item",e).value):((o=cc.instantiate(this.potionPrefab)).getComponent("PotionCommodity").init(e),this.cost=1==e?20:50),o.position=cc.v2(0,40),this.node.addChild(o),i&&(this.txtDiscount.active=!0,this.cost=Math.ceil(this.cost/3)),this.txtCost.string=this.cost},buy:function(){if(o.copper>=this.cost){o.copper-=this.cost,0==this.type?o.getCard(this.cfgId):1==this.type?o.getItem(this.cfgId):o.hp=Math.min(o.hp+10*this.cfgId,o.hpMax);var e=o.shopIds.indexOf(this.cfgId);o.shopIds[e]=0,this.node.destroy(),window.homeLayer.refreshHeroData()}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(e,t,i){"use strict";cc._RF.push(t,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{box:cc.Node,shopItemPrefab:cc.Prefab},onLoad:function(){window.shopLayer=this,this.initCards(),this.initEquip(),this.initPotions()},initCards:function(){for(var e=0;e<3;e++){var t=o.shopIds[e];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,0,e==o.discountCard),i.position=cc.v2(e%3*240-240,320),this.box.addChild(i)}}},initEquip:function(){for(var e=0;e<3;e++){var t=o.shopIds[e+3];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,1,e==o.discountItem),i.position=cc.v2(e%3*240-240,0),this.box.addChild(i)}}},initPotions:function(){for(var e=0;e<2;e++){var t=o.shopIds[e+6];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,2),i.position=cc.v2(e%3*240-240,-320),this.box.addChild(i)}}},close:function(){this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Skill:[function(e,t,i){"use strict";cc._RF.push(t,"6e80c9wWaBN46xspVtDUxQZ","Skill");var o=e("Game"),s={doCast:function(e){var t=window.mainLayer.hero,i=window.mainLayer.enemy;if(1==o.heroId)0==e?i.onHurt(5,4):1==e&&(t.buff.doubleDmg*=2);else if(2==o.heroId)if(0==e)t.player.createExDice();else if(1==e){for(var s=t.player.cardList.length-1;s>=0;s--)t.player.cardList[s].getComponent("Card").discard();t.player.cardList=[],t.player.createChest(!0)}}};t.exports=s,cc._RF.pop()},{Game:"Game"}],TreasureLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,btnGets:[cc.Node],btnClose:cc.Node},init:function(e){this.isBoss=e;for(var t=0,i=e?[[.5,.3,.2],[.2,.4,.4],[0,.5,.5]]:[[.6,.3,.1],[.3,.4,.3],[.1,.4,.5]],s=Math.random(),n=0,r=0;r<3;r++)if(s<(n+=i[o.castle-1][r])){t=r+1;break}5==o.roomType?t++:o.itemEffect.vase>0&&(o.itemEffect.vase--,t++,0==o.itemEffect.vase&&o.deleteItem(28)),t=Math.min(t,3),this.cfgIdList=[];var c=1;e?c=2:o.itemEffect.flagon>0&&(o.itemEffect.flagon--,c=2,0==o.itemEffect.flagon&&o.deleteItem(29));var a=o.getNewItemId(e?2:0,t);if(this.cfgIdList.push(a),2==c){for(var h=0;h<=0;){var d=o.getNewItemId(e?2:0,t);d!=a&&(h=d)}this.cfgIdList.push(h)}this.initItem(),this.itemGot=0},initItem:function(){var e;1==this.cfgIdList.length?((e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[0]),e.position=cc.v2(0,70),this.node.addChild(e)):((e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[0]),e.position=cc.v2(-165,70),this.node.addChild(e),(e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[1]),e.position=cc.v2(165,70),this.node.addChild(e),this.btnGets[1].active=!0,this.btnClose.position=cc.v2(0,-425))},onGet:function(e,t){o.getItem(this.cfgIdList[t]),this.isBoss?this.close():(this.btnGets[t].active=!1,this.itemGot++,this.itemGot>=this.cfgIdList.length&&this.close())},onGiveUp:function(){this.close()},close:function(){this.node.destroy(),window.homeLayer.btnAlter.node.active=!1}}),cc._RF.pop()},{Game:"Game"}],Utils:[function(e,t,i){"use strict";cc._RF.push(t,"85bfaYPayFNlrAFvtzNUMAc","Utils");var o={numberFormat:function(e){return e/1e13>=1?Math.floor(e/1e12)+"T":e/1e10>=1?Math.floor(e/1e9)+"B":e/1e7>=1?Math.floor(e/1e6)+"M":e/1e4>=1?Math.floor(e/1e3)+"K":e},timeFormat:function(e,t){var i=Math.round(e/1e3),o=i%60,s=t>1?Math.floor(i/60)%60:Math.floor(i/60),n=3==t?Math.floor(i/3600)%24:Math.floor(i/3600),r=Math.floor(i/86400),c=function(e){return e<10?"0"+e:e};return 1==t?c(s)+":"+c(o):2==t?c(n)+":"+c(s)+":"+c(o):r+"\u5929"+n+"\u65f6"+s+"\u5206"},getDifferentRandomNum:function(e,t,i){t=t||1,i=i||0;for(var o=[];o.length<e;){for(var s=Math.floor(Math.random()*(t-i+1))+i,n=!1,r=0;r<o.length;r++)if(o[r]-s==0){n=!0;break}n||o.push(s)}return o},createImage:function(e,t){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var e=new cc.Texture2D;e.initWithElement(i),e.handleLoadedTexture(),t.spriteFrame=new cc.SpriteFrame(e)}catch(e){cc.log(e),t.node.active=!1}},i.src=e}catch(e){cc.log(e),t.node.active=!1}else try{cc.loader.load({url:e,type:"jpg"},function(e,i){t.spriteFrame=new cc.SpriteFrame(i)})}catch(e){cc.log(e),t.node.active=!1}},substring:function(e,t){if(e.replace(/[\u4e00-\u9fa5]/g,"**").length<=t)return e;for(var i=0,o="",s=0;s<e.length&&(/[\u4e00-\u9fa5]/.test(e[s])?i+=2:i+=1,!(i>t));s++)o+=e[s];return o},getMd5Url:function(e){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(e)):cc.url.raw(e)},numToStr:function(e,t){t=t||1;for(var i=""+e,o=1;o<=t;o++)e<Math.pow(10,o)&&(i="0"+i);return i}};t.exports=o,cc._RF.pop()},{}],Yahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee"),cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label},onLoad:function(){window.yahtzeeLayer=this},start:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),this.roundId=1,this.hostId=0,this.doRound()},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,window.player.startRound()},endRound:function(){for(var e=this,t=function(t){var i=e.hero.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,350)),cc.delayTime(1.5),cc.callFunc(function(){this.hero.dicePool.put(i)}.bind(e))))},i=0;i<5;i++)t(i);var o=function(t){var i=e.enemy.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-200)),cc.delayTime(1.5),cc.callFunc(function(){this.enemy.dicePool.put(i)}.bind(e))))};for(i=0;i<5;i++)o(i);this.scheduleOnce(function(){this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.hero.doWin():this.hero.score<this.enemy.score?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),1.5),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(e){var t=cc.instantiate(this.endPrefab);t.getComponent("EndYahtzeeLayer").init(e),this.node.addChild(t)}}),cc._RF.pop()},{}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardCollection","CardManager","Chest","CompleteLayer","Config","CoverLayer","Dice","DiceYahtzee","Edit","EditEndLayer","EndLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","HelloWorld","Hero","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerYahtzee","PotionCommodity","ShopItem","ShopLayer","Skill","TreasureLayer","Utils","Yahtzee"]);