window.__require=function t(e,i,o){function s(c,r){if(!i[c]){if(!e[c]){var a=c.split("/");if(a=a[a.length-1],!e[a]){var h="function"==typeof __require&&__require;if(!r&&h)return h(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+c+"'")}}var d=i[c]={exports:{}};e[c][0].call(d.exports,function(t){return s(e[c][1][t]||t)},d,d.exports,t,e,i,o)}return i[c].exports}for(var n="function"==typeof __require&&__require,c=0;c<o.length;c++)s(o[c]);return s}({AIYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var t=[0,0,0,0,0,0],e=0;e<5;e++){var i=this.player.diceList[e].getComponent("DiceYahtzee");t[i.element-1]++}for(var o=-1,s=-1,n=0;n<6;n++)t[n]>(t[o]||0)&&(o=n);for(var c=0;c<6;c++)c!=o&&t[c]>(t[s]||0)&&(s=c);this.scheduleOnce(function(){t[o]>1?t[o]==t[s]?this.hold(o,s):this.hold(o):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(t,e){for(var i=0,o=0;o<5;o++){var s=this.player.diceList[o].getComponent("DiceYahtzee");s.holded?s.element!=t+1&&null!=e&&s.element!=e+1&&(s.doHold(),i++):(s.element==t+1||null!=e&&s.element==e+1)&&(s.doHold(),i++)}var n=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),n)}}),cc._RF.pop()},{}],AI:[function(t,e,i){"use strict";cc._RF.push(e,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy")},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var t=1,e=100,i=null,o=0;o<this.cards.length;o++){var s=this.cards[o].getComponent("Card");s.usable&&(s.cfg.priority<e||s.cfg.priority==e&&s.rate>t)&&(t=s.rate,e=s.cfg.priority,i=s)}i?(i.cast(),198!=i.cfgId&&this.scheduleOnce(function(){this.checkCards()}.bind(this),.8)):this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.5):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.8)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var t=[0,0,0,0,0,0],e=0;e<this.cards.length;e++){var i=this.cards[e].getComponent("Card");(m=i.require.split(";")).length>1&&t[m[0]-1]++;for(var o=["A","B","C","D","E","F"],s=0;s<6;s++)if(i.cfg.desc.indexOf(o[s])>=0){t[s]++;break}}for(var n=!1,c=0;c<6;c++)if(t[c]>0){n=!0;break}for(var r=[],a=0;a<this.cards.length;a++){var h=this.cards[a].getComponent("Card"),d=[0,0,0,0,0,0];if(h.require>=101&&h.require<=105){for(var f=0,l=0,p=0;p<6;p++)(!n||t[p]>0)&&this.player.elementList[p]>f&&(f=this.player.elementList[p],l=p+1);if(d=[-100,-100,-100,-100,-100,-100],f>=n||2){d[l-1]=[2,2,3,4,5][h.require-101]-f}}else{var u=[0,0,0,0,0,0];if(106==h.require||107==h.require)u=[1,1,1,1,1,1];else for(var m=h.require.split(";"),g=0;g<m.length;g++)u[m[g]-1]++;for(var w=["A","B","C","D","E","F"],v=0;v<6;v++){var C=u[v];h.cfg.desc.indexOf(w[v])>=0&&(C=this.player.elementList[v]+1),d[v]=C-this.player.elementList[v]}}r.push(d)}for(var y=100,b=0,x=0,L=1,k=0;k<r.length;k++){for(var I=r[k],M=0,q=0,R=0;R<I.length;R++)M+=I[R]<-10?0:Math.abs(I[R]),q+=I[R];(M<y||M==y&&q>b||M==y&&q==b&&this.cards[k].getComponent("Card").rate<L)&&(y=M,b=q,x=k,L=this.cards[k].getComponent("Card").rate)}for(var P=r[x],E=0;E<6;E++)if(0!=P[E]){var B=P[E]+this.player.elementList[E]-this.player.holdList[E];if(B>0)for(var F=0;F<this.dices.length;F++){var _=this.dices[F].getComponent("Dice");if(_.element==E+1&&!_.holded&&!_.lock&&!_.freeze&&(_.hold(),0==--B))break}else if(B<0)for(var T=0;T<this.dices.length;T++){var D=this.dices[T].getComponent("Dice");if(D.element==E+1&&D.holded&&!D.lock&&!D.freeze&&(D.hold(),0==++B))break}}this.player.roll(),this.scheduleOnce(function(){this.check()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var t=0;t<this.player.cardList.length;t++){var e=this.player.cardList[t].getComponent("Card");e.silence||e.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(e)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var o=this.player.diceList[i];o.lock||this.dices.push(o)}}}),cc._RF.pop()},{}],Buff:[function(t,e,i){"use strict";cc._RF.push(e,"76faa8y1jVIcqDL176r9ktK","Buff"),cc.Class({extends:cc.Component,properties:{},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.doubleDmg=1,this.doubleCast=0,this.multiCast=0,this.multiCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.exRound=0,this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.undead=0,this.atkBack=0,this.burnIce=!1,this.silenceDark=!1,this.table={};for(var t=[13,21,22,23,24,25,26,27,28],e=0;e<t.length;e++)this.table[t[e]]=0;this.quote(),this.refreshBuff()},addBuff:function(t,e){if(!(e<=0)){if(t>=21&&this.player.equip.amulet>0)return this.player.equip.amulet--,void this.player.equip.doTrigger(37);if(t>=21&&t<=26){if(this.opponent.equip.checkWithTrigger(t+10))e+=26==t?2:1;23==t&&this.opponent.equip.trigger(68)}this.table[t]+=e,this.quote();for(var i=!1,o=0;o<this.buffList.length;o++)if(this.buffList[o]==t){i=!0;break}i||this.buffList.push(t),this.refreshBuff()}},removeBuff:function(t,e){if(!(e<=0)){if(this.table[t]-=e,this.table[t]<=0){this.table[t]=0;var i=this.buffList.indexOf(t);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28]},refreshBuff:function(){for(var t="",e={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522"},i={13:"#0AFF78",21:"#FF3C32",22:"#32B4FF",23:"#9AE9BD",24:"#FA9650",25:"#FFFFFF",26:"#682AA1",27:"#CB97FB",28:"#FFFF3C"},o=0;o<this.buffList.length;o++){var s=this.buffList[o],n=e[s]+this.table[s]+" ";t+="<color="+i[s]+">"+n+"</c>"}this.player.host.txtBuff.string=t}}),cc._RF.pop()},{}],CampLayer:[function(t,e,i){"use strict";cc._RF.push(e,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{},onHeal:function(){var t=1;o.equip.indexOf(39)>=0&&(t+=.5),o.equip.indexOf(89)>=0&&(t-=.5);var e=Math.floor(.35*o.hpMax*t);o.hp=Math.min(o.hp+e,o.hpMax),this.close()},onCopper:function(){o.copper+=7*(o.castle+3),this.close()},close:function(){this.node.destroy(),window.homeLayer.refreshHeroData(),window.homeLayer.btnAlter.node.active=!1}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node},onLoad:function(){window.bagLayer=this,this.initDeck(),this.initBag()},initDeck:function(){this.deck=[];for(var t=0;t<o.deck.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(o.deck[t],0),e.position=cc.v2(t%3*240-240,95-190*Math.floor(t/3)),this.boxDeck.addChild(e),this.deck[t]=e}},initBag:function(){o.cardBag.sort(function(t,e){return s.get("cfg_card",t).element==s.get("cfg_card",e).element?t-e:s.get("cfg_card",t).element-s.get("cfg_card",e).element}),this.bagList=[];for(var t=0;t<o.cardBag.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(o.cardBag[t],1),e.position=cc.v2(t%3*240-240,-95-190*Math.floor(t/3)),this.content.addChild(e),this.bagList.push(e)}this.content.height=Math.max(190*Math.ceil(o.cardBag.length/3),730)},equip:function(t){for(var e=-1,i=0;i<6;i++)if(null==this.deck[i]){e=i;break}if(e>=0){t.parent=this.boxDeck,t.position=cc.v2(e%3*240-240,95-190*Math.floor(e/3)),t.getComponent("CardCollection").colletType=0;var s=t.getComponent("CardCollection").cfgId;this.deck[e]=t;var n=o.cardBag.indexOf(s);o.cardBag.splice(n,1);n=this.bagList.indexOf(t);this.bagList.splice(n,1),this.refreshBag()}},unEquip:function(t){var e=this.deck.indexOf(t);this.deck[e]=null;for(var i=o.cardBag.length,n=t.getComponent("CardCollection").cfgId,c=0;c<o.cardBag.length;c++)if(s.get("cfg_card",n).element<s.get("cfg_card",o.cardBag[c]).element||s.get("cfg_card",n).element==s.get("cfg_card",o.cardBag[c]).element&&n<o.cardBag[c]){i=c;break}o.cardBag.splice(i,0,n),this.bagList.splice(i,0,t),t.parent=this.content,t.position=cc.v2(i%3*240-240,-95-190*Math.floor(i/3)),t.getComponent("CardCollection").colletType=1,this.refreshBag()},refreshBag:function(){for(var t=0;t<this.bagList.length;t++)this.bagList[t].runAction(cc.moveTo(.15,cc.v2(t%3*240-240,-95-190*Math.floor(t/3))));this.content.height=Math.max(190*Math.ceil(o.cardBag.length/3),730)},close:function(){o.deck=[];for(var t=0;t<6;t++)null!=this.deck[t]&&o.deck.push(this.deck[t].getComponent("CardCollection").cfgId);this.node.destroy()}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardCollection:[function(t,e,i){"use strict";cc._RF.push(e,"a28bfVp4ABL54sr47isHV8F","CardCollection");var o=t("Config");cc.Class({extends:cc.Component,properties:{btn:cc.Button,txtTitle:cc.Label,txtDesc:cc.Label,txtRequire:cc.Label,markDelete:cc.Node},init:function(t,e){this.cfgId=t,this.cfg=o.get("cfg_card",t);var i=[cc.color(251,93,108),cc.color(123,200,254),cc.color(92,165,110),cc.color(150,80,50),cc.color(214,129,80),cc.color(179,149,235),cc.color(120,120,120)];this.btn.node.color=i[this.cfg.element-1],this.txtTitle.string=this.cfg.name,this.txtDesc.string=this.cfg.desc;var s=this.require=this.cfg.require;if(s>=101&&s<=107){var n=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c","5\u4e2a\u76f8\u540c","5\u79cd\u4e0d\u540c","6\u79cd\u4e0d\u540c"];this.txtRequire.string=n[s-101]}else{for(var c=s.split(";"),r="",a=(n=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],0);a<c.length;a++)r+=n[c[a]-1];this.txtRequire.string=r}null!=e&&(this.btn.interactable=!0,this.colletType=e)},changeCollectType:function(){0==this.colletType?window.bagLayer.unEquip(this.node):window.bagLayer.equip(this.node)}}),cc._RF.pop()},{Config:"Config"}],CardManager:[function(t,e,i){"use strict";cc._RF.push(e,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var o=t("Game"),s=t("Config"),n={doCast:function(t,e){this.cfgId=t;var i=s.get("cfg_card",t);if(this.desc=i.desc,this.card=e,window.opponent.buff.dodge>0&&(1==i.target1||1==i.target2||1==i.target3))return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("\u95ea\u907f"),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(t)},doEffect:function(t,e,i){var o=null,s=(o=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,n=window.player.buff,c=0,r=1;if((e+="")<0){for(var a=["A","B","C","D","E","F"],h=0,d=0;d<6;d++)if(this.desc.indexOf(a[d])>=0){h=d;break}c=window.player.elementList[h]*Math.abs(parseInt(e))}else{var f=e.split(";");if(8==t)c=parseInt(f[0]),r=parseInt(f[1]);else if(1==f.length)c=parseInt(e);else{var l=parseInt(f[0]),p=parseInt(f[1]);c=Math.floor(Math.random()*(p-l+1))+l}}if(t<10){if(1==i&&(c*=n.doubleDmg,n.doubleDmg=1),n.weak>0&&!window.player.equip.checkWithTrigger(65)){var u=.5;u+=window.opponent.equip.checkWithTrigger(55)?.25:0,c=Math.floor(c*(1-u))}0==window.player.cardPlayed&&window.player.equip.checkWithTrigger(100)&&(c*=2);for(var m=0;m<r;m++)o.onHurt(c,0,t)}else 11==t?o.updateArmor(c):12==t?o.onHeal(c):14==t?o.addPower&&o.addPower(c):(13==t||t>=21)&&s.addBuff(t,c)},doSpecial:function(t){var e=window.opponent.buff,i=window.player.buff;if(132==t)this.doEffect(11,window.host.armor,2);else if(133==t)this.doEffect(7,window.host.armor,1);else if(134==t)this.doEffect(7,2*window.host.armor,1),this.doEffect(11,-window.host.armor,2);else if(135==t)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==t)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==t)this.doEffect(7,Math.floor(window.host.hp/3),1);else if(138==t)i.undead=2;else if(139==t)i.exRound++;else if(140==t)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==t)window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==t)window.host.power&&(this.doEffect(11,2*window.host.power,2),window.host.addPower(-window.host.power));else if(143==t)window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==t)this.doEffect(7,2*e.poison,1);else if(145==t)this.doEffect(7,4*e.poison,1);else if(146==t)e.addBuff(26,e.poison);else if(147==t){var s=e.frail>0?12:6;this.doEffect(3,s,1)}else if(148==t){s=e.weak>0?12:6;this.doEffect(4,s,1)}else if(149==t){s=e.poison>0?12:6;this.doEffect(6,s,1)}else if(150==t)e.burn>0&&this.doEffect(21,1,1);else if(151==t)e.freeze>0&&this.doEffect(22,1,1);else if(152==t)e.silence>0&&this.doEffect(25,1,1);else if(t>=153&&t<=158){var n=[2,3,5,0,1,4][t-153];window.player.elementList[n]>=[2,2,2,3,3,3][t-153]&&this.doEffect(n+21,[2,2,2,2,2,1][t-153],1)}else if(t>=159&&t<=162)e.addBuff(Math.floor(8*Math.random())+21,162==t?2:1);else if(t>=163&&t<=166)i.doubleCast++;else if(167==t)i.multiCast++,i.multiCastMax++;else if(t>=168&&t<=171)i.doubleDmg*=2;else if(172==t)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-e.freeze,1);else if(173==t)this.doEffect(21,window.opponent.deck.length-e.burn,1);else if(174==t)this.doEffect(7,6*e.burn,1);else if(175==t)this.doEffect(7,6*e.freeze,1);else if(176==t)this.doEffect(7,6*e.silence,1);else if(177==t)this.doEffect(7,4*e.frail,1);else if(178==t)this.doEffect(7,4*e.weak,1);else if(t>=179&&t<=182){s=(c=[1,6,6,10])[t-179]+(r=[3,2,2,4])[t-179]*(i.iteraList[t-179]-1);this.doEffect(7,s,1)}else if(t>=183&&t<=186){var c=[8,13,13,18],r=[3,3,3,4],a=Math.min(i.iteraList[t-179]-1,[2,4,4,4][t-183]);s=c[t-183]-r[t-183]*a;this.doEffect(7,s,1)}else if(187==t)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==t)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==t)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==t)this.doEffect(1,10+3*i.elementRoundCasted[0],1);else if(191==t)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==t)this.doEffect(3,10+3*i.elementRoundCasted[2],1);else if(193==t){if((a=Math.min(window.opponent.deck.length,6))>0){var h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.opponent.deck.splice(h,1),window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(194==t){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(195==t){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d)}}else if(196==t){var f=o.getRandomCardId();window.player.patchCard(f,!0),window.player.deck.push(f)}else if(197==t){(v=window.player.patchCard()).getComponent("Card").silence||v.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){v.getComponent("Card").cast()}.bind(this))))}else if(198==t){var l=function(){var t=window.player.patchCard();!t.getComponent("Card").usable&&window.player.cardList.length<6?t.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){l()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&window.mainLayer.enemy.ai.check()}.bind(this),.8)}.bind(this);l()}else if(199==t)window.player.diceCount++,window.player.createExDice();else if(200==t)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==t){for(var p=21;p<=28;p++)i.removeBuff(p,i.table[p]);for(var u=0;u<window.player.cardList.length;u++)window.player.cardList[u].getComponent("Card").clear();for(var m=0;m<window.player.diceList.length;m++)window.player.diceList[m].getComponent("Dice").clear();window.player.checkElement()}else if(202==t){for(var g=0,w=21;w<=28;w++)e.table[w]>0&&g++;this.doEffect(7,5*g,1)}else if(203==t)window.player.rollCount++,0==window.mainLayer.roundId&&window.player.rollCount<=1&&window.mainLayer.hero.btnRoll.runAction(cc.moveTo(.15,cc.v2(285,145)));else if(204==t)window.player.rollCount++,window.player.roll();else if(205==t){if(window.player.cardList.length>0){h=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[h].getComponent("Card").discard(),this.doEffect(7,12,1)}}else if(206==t||207==t){if(window.player.cardList.length>0){var v;h=Math.floor(Math.random()*window.player.cardList.length);(v=window.player.cardList[h].getComponent("Card")).remove(),v.doDelete(),this.doEffect(7,206==t?20:30,1)}}else if(208==t){this.doEffect(7,5*window.player.cardList.length,1);for(var C=window.player.cardList.length-1;C>=0;C--)window.player.cardList[C].getComponent("Card").discard();window.player.cardList=[]}else if(t>=209&&t<=214){c=214==t?2:1;this.doEffect(t-209+21,c+i.iteraList2[t-209]-1,1)}else 215==t?window.opponent.buff.burnIce=!0:216==t?window.opponent.buff.silenceDark=!0:217==t&&(o.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax)}};e.exports=n,cc._RF.pop()},{Config:"Config",Game:"Game"}],Card:[function(t,e,i){"use strict";cc._RF.push(e,"cfa35/uH59ANIsjw79G+feg","Card");var o=t("Config"),s=t("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,fires:cc.Node,markSilence:cc.Node},init:function(t,e,i,s){this.cfgId=t,this.index=e,this.pos=cc.v2(e%3,Math.floor(e/3)),this.type=s,this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(240*this.pos.x-240,95-190*this.pos.y-500*this.delta),this.node.opacity=0;var n=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-190*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(0==window.mainLayer.roundId?1-this.pos.y:this.pos.y)),n,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),this.cfg=o.get("cfg_card",t);var c=[cc.color(251,93,108),cc.color(123,200,254),cc.color(92,165,110),cc.color(150,80,50),cc.color(214,129,80),cc.color(179,149,235),cc.color(120,120,120)];this.btn.node.color=c[this.cfg.element-1],this.txtTitle.string=this.cfg.name,this.initDesc(),this.mask.active=!0,this.rate=1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1;var r=this.require=this.cfg.require;if(r>=101&&r<=107){var a=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c","5\u4e2a\u76f8\u540c","5\u79cd\u4e0d\u540c","6\u79cd\u4e0d\u540c"];this.txtRequire.string=a[r-101];this.rate=[1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][r-101]}else{for(var h=r.split(";"),d="",f=(a=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],0);f<h.length;f++)d+=a[h[f]-1];this.txtRequire.string=d;this.rate=[1/6,1/36,1/216,1/1296,1/7776][h.length-1]}this.initBuff(i)},initWithCopy:function(t,e){this.cfgId=t,this.pos=e,this.isCopy=!0,this.isTemp=!0,this.cfg=o.get("cfg_card",t),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(){if(this.btn.interactable=!1,0==window.mainLayer.roundId){var t=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{t=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var e=window.player.cardList.indexOf(this.node);e>=0&&(window.player.cardList.splice(e,1),0==window.mainLayer.roundId&&window.player.cardList.length<=0&&window.mainLayer.hero.btnRoll.runAction(cc.moveTo(.2,cc.v2(465,145))))},initBuff:function(t){this.burn=21==t,this.fires.active=this.burn,this.silence=25==t,this.markSilence.active=this.silence},checkRequire:function(){var t=!1,e=window.player.elementList;if(this.require>=101&&this.require<=105){for(var i=[2,2,3,4,5],o=102==this.require?2:1,s=0;s<6;s++)e[s]>=i[this.require-101]&&o--,102==this.require&&e[s]>=4&&(o-=2);o<=0&&(t=!0)}else if(106==this.require||107==this.require){i=0;for(var n=0;n<6;n++)e[n]>0&&i++;i>=this.require-101&&(t=!0)}else{for(var c=[0,0,0,0,0,0],r=this.require.split(";"),a=0;a<r.length;a++)c[r[a]-1]++;t=!0;for(var h=0;h<6;h++)if(e[h]<c[h]){t=!1;break}}return this.silence&&(t=!1),this.usable=t,t?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),t},doCast:function(){1==this.type?(window.endLayer.select&&window.endLayer.select.unselect(),this.select()):0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c"):this.cast())},cast:function(){this.burn&&window.host.onHurt(3,1,21);var t=!1,e=window.opponent.equip.check(107)?.8:.5;if(window.player.buff.curse&&Math.random()<e&&(t=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.checkWithTrigger(108)),this.btn.interactable=!1,t){var i=cc.instantiate(window.player.markCurse);i.active=!0,i.parent=window.player.boxCard,i.position=this.node.position,i.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){i.destroy()}.bind(this)))),this.endCast()}else{var o=cc.spawn(cc.moveBy(.05,cc.v2(0,-20)),cc.scaleTo(.05,1)),n=cc.moveBy(.35,cc.v2(0,1100)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),o,n,cc.callFunc(function(){window.mainLayer.gameOver||(s.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var c=window.player.cardList.indexOf(this.node);c>=0&&(window.player.cardList.splice(c,1),0==window.mainLayer.roundId&&window.player.cardList.length<=0&&window.mainLayer.hero.btnRoll.runAction(cc.moveTo(.2,cc.v2(465,145))))}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var r=0;r<window.player.cardList.length;r++){var a=window.player.cardList[r].getComponent("Card");(a.cfgId>=179&&a.cfgId<=186||a.cfgId>=209&&a.cfgId<=214)&&a.initDesc()}t||(this.cfgId<163||this.cfgId>166)&&(window.player.buff.doubleCast>0?(window.player.buff.doubleCast--,this.reuse()):9==window.player.cardPlayed&&window.player.equip.luckyCard>0?(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)&&this.reuse()),this.isRemove&&this.doDelete()},endCast:function(){if(!this.isCopy){window.player.cardPlayed++,window.player.cardPlayedRound++;var t=window.player.equip;t.trigger(1),t.trigger(4),t.trigger(this.cfg.element+77),t.trigger(97),window.opponent.equip.trigger(24)}window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++,window.player.cardPool.put(this.node)},discard:function(){this.remove(),window.player.equip.trigger(22)},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),!this.isTemp){var t=window.player.deck.indexOf(this.cfgId);t>=0&&window.player.deck.splice(t,1)}},reuse:function(){var t=cc.instantiate(this.node);t.position=this.node.position,window.player.boxCard.addChild(t,this.node.zIndex-1),t.getComponent("Card").initWithCopy(this.cfgId,this.pos),t.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){t.getComponent("Card").cast()}.bind(this))))},clear:function(){this.initBuff()},initDesc:function(){var t=this.cfg.desc;if(this.cfgId>=179&&this.cfgId<=182){var e=[3,2,2,4];t+="<color=#EBC82E>  (\u5f53\u524d"+((i=[1,6,6,10])[this.cfgId-179]+e[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var i=[8,13,13,18],o=(e=[3,3,3,4],Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,4,4][this.cfgId-183]));t+="<color=#EBC82E>  (\u5f53\u524d"+(i[this.cfgId-183]-e[this.cfgId-183]*o)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){t+="<color=#EBC82E>  (\u5f53\u524d"+((i=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}this.txtDesc.string=t}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config"}],CompleteLayer:[function(t,e,i){"use strict";cc._RF.push(e,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){o.setDataToBase(),cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],Config:[function(t,e,i){"use strict";cc._RF.push(e,"e9b6cHrlOtILogPlENB3GXp","Config");var o={jsonTable:{},load:function(t){for(var e=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event"],o=0,s=function(s){c="Config/"+i[s],cc.loader.loadRes(c,function(e,n){this.jsonTable[i[s]]=n.json,(o+=1)==i.length&&t()}.bind(e))},n=0;n<i.length;n++){var c;s(n)}},get:function(t,e){return this.jsonTable[t][e]}};e.exports=o,cc._RF.pop()},{}],DiceYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(t,e){this.id=t,this.index=e,this.player=0==e?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1,this.holded=!1;var i=this.delta=0==this.index?1:-1;this.node.position=cc.v2(110*t-220,-320*i),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*i)),cc.moveBy(.1,cc.v2(0,-20*i))))},roll:function(t){this.abled=!0,this.holded=!1;var e=this.player.holdList.indexOf(this.node);e>=0&&this.player.holdList.splice(e,1),t||(this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/element"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)));var i=50*Math.random()+150*this.id-325,o=(440*Math.random()+240)*this.delta,s=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(i,o)),cc.rotateTo(.2,s)))},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var t=0;t<this.player.holdList.length;t++)this.player.holdList[t].runAction(cc.moveTo(.1,cc.v2(110*t-220,0)));this.player.txtBtn.string="\u6295\u63b7"}else this.hold()},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(t,e,i){"use strict";cc._RF.push(e,"24e6aDXOPZNaoyluEGeZSR/","Dice"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node},init:function(t,e){this.id=t,this.holded=!1,this.element=0,this.node.color=cc.Color.WHITE,this.initBuff(e)},initBuff:function(t){this.freeze=22==t,this.markIce.active=this.freeze,this.lock=28==t,this.markLock.active=this.lock},roll:function(t){this.element=t||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/element"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=200*-this.delta,this.node.opacity=0,this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveBy(.15,cc.v2(0,220*this.delta)),cc.moveBy(.1,cc.v2(0,20*-this.delta)))))},doHold:function(){0!=window.mainLayer.roundId||this.freeze||this.lock||this.hold()},hold:function(){this.holded?(this.holded=!1,this.node.color=cc.Color.WHITE,window.player.holdList[this.element-1]--):(this.holded=!0,this.node.color=cc.Color.GRAY,window.player.holdList[this.element-1]++)},remove:function(){var t=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.initBuff()}}),cc._RF.pop()},{}],EditEndLayer:[function(t,e,i){"use strict";cc._RF.push(e,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){o.deck=o.editCfg.deckHero.split(";"),o.equip=o.editCfg.equip.split(";"),o.hp=o.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(t,e,i){"use strict";cc._RF.push(e,"463d3gvgvdIabmN6qTyXAVR","Edit");var o=t("Game");cc.Class({extends:cc.Component,properties:{editHp:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox},onLoad:function(){o.editCfg&&(this.editHp.string=o.editCfg.hp,this.editDice.string=o.editCfg.dice,this.editDeckEnemy.string=o.editCfg.deckEnemy,this.editEquipEnemy.string=o.editCfg.equipEnemy,this.editDeckHero.string=o.editCfg.deckHero,this.editEquip.string=o.editCfg.equip)},goBattle:function(){o.editCfg={hp:this.editHp.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string},o.deck=this.editDeckHero.string.split(";"),o.equip=this.editEquip.string.split(";"),o.hp=o.hpMax,cc.director.loadScene("mainLayer")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(t,e,i){"use strict";cc._RF.push(e,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{btnClose:cc.Node,cardPrefab:cc.Prefab,txtReward:cc.Label,boxCard:cc.Node,btns:[cc.Node],txtCopper:cc.Label},onLoad:function(){window.endLayer=this,this.checkGameEnd(),window.mainLayer.hero.equip.check(26)?(o.hpMax+=3,o.hp+=3,this.txtReward.string="\u989d\u5916\u751f\u547d +3",this.boxCard.active=!1):this.initCards(),this.initCopper(),this.initExp(),o.monsterBeats.push(o.monsterId)},initCards:function(){this.btnClose.active=!1;for(var t=0,e=[[.5,.5,0],[.5,.5,0],[0,.5,.5]],i=Math.random(),n=0,c=0;c<3;c++)i<(n+=e[o.castle-1][c])&&(t=c+1);this.cardIdList=[],this.cards=[];for(var r=0;r<=0;){var a=o.getNewCardId(t),h=s.get("cfg_card",a).require;(o.castle>1||2==h.split(";").length||h<=102)&&(r=a)}this.cardIdList.push(r);for(var d=0;d<=0;){var f=o.getNewCardId(t),l=s.get("cfg_card",f).require;f!=r&&(o.castle>1||2==l.split(";").length||l<=102)&&(d=f)}this.cardIdList.push(d);for(var p=0;p<2;p++){var u=cc.instantiate(this.cardPrefab);u.getComponent("CardCollection").init(this.cardIdList[p]),u.position=cc.v2(0==p?-160:160,40),this.boxCard.addChild(u),this.cards.push(u)}},checkGameEnd:function(){var t=window.mainLayer.hero.player;t.equip.trigger(7),t.equip.trigger(8)},choose:function(t,e){o.getCard(this.cardIdList[e]),this.cards[1-e].destroy(),this.cards[e].runAction(cc.moveTo(.2,cc.v2(0,40))),this.btns[0].active=this.btns[1].active=!1,this.btnClose.active=!0},initCopper:function(){var t=window.mainLayer.enemy.cfg.level,e=1,i=window.mainLayer.hero.player;i.equip.check(73)&&(e+=.5),i.equip.check(74)&&(e+=1,o.itemEffect.pen--,o.itemEffect.pen<=0&&o.deleteItem(74)),i.equip.check(90)&&(e-=.5);var s=Math.max(Math.floor(t*e*4),1);this.txtCopper.string="\u91d1\u5e01 +"+s,o.copper+=s},initExp:function(){var t=window.mainLayer.enemy.cfg.level;o.exp+=t;var e=o.level<7?3*o.level:99;o.exp>=e&&(o.exp-=e,o.level++,o.hpMax+=5,o.hp=window.mainLayer.hero.hp=o.hpMax,o.levelUp=!0)},close:function(){o.hp=window.mainLayer.hero.hp,o.power=window.mainLayer.hero.power,cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndYahtzeeLayer:[function(t,e,i){"use strict";cc._RF.push(e,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtName:cc.Label,cardPrefab:cc.Prefab,itemNode:cc.Node,txtItemName:cc.Label,txtItemDesc:cc.Label,itemChangeNode:cc.Node,txtChangeName1:cc.Label,txtChangeDesc1:cc.Label,txtChangeName2:cc.Label,txtChangeDesc2:cc.Label,losePrefab:cc.Prefab,txtChange:cc.Node,rewardNode:cc.Node},init:function(t){this.result=t;this.txtTitle.string=["\u4f60\u8f93\u4e86","\u5e73\u5c40","\u4f60\u8d62\u4e86","\u4f60\u79bb\u5f00\u4e86"][t+1],this.checkResult()},checkResult:function(){var t=o.eventId,e="";if(0==this.result||1==this.result)if(1==t)e="\u6062\u590d\u5168\u90e8\u751f\u547d",o.hp=o.hpMax;else if(2==t||14==t)e="\u989d\u5916\u751f\u547d +15",o.hpMax+=15,o.hp+=15;else if(3==t)this.getItem(3);else if(4==t)e="\u91d1\u5e01 +50",o.copper+=50;else if(5==t||6==t)this.getItem(2);else if(7==t)e="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(3),this.rewardNode.y-=130;else if(8==t)e="\u751f\u547d\u4e0a\u9650 +10, \u6062\u590d\u5168\u90e8\u751f\u547d",o.hpMax+=10,o.hp=o.hpMax;else if(9==t||17==t)this.getItem();else if(10==t)e="\u91d1\u5e01\u7ffb\u500d",o.copper*=2;else if(11==t){e="\u590d\u5236\u5361\u724c";var i=o.deck[Math.floor(Math.random()*o.deck.length)];this.getCard(null,i),this.rewardNode.y-=130}else if(12==t||16==t)e="\u91d1\u5e01 +100",o.copper+=100;else if(13==t){this.getCard(3).x-=200,this.getCard(3).x+=200}else 15==t&&(e="\u751f\u547d +30",o.hp=Math.min(o.hp+30,o.hpMax));else-1==this.result?1==t?(e="\u751f\u547d +10",o.hp=Math.min(o.hp+10,o.hpMax)):2==t||12==t?(e="\u751f\u547d\u4e0a\u9650 -5",o.hpMax=Math.max(o.hpMax-5,1),o.hp=Math.min(o.hp,o.hpMax)):3==t?this.changeItem():4==t||9==t?this.getCard():5==t?(e="\u91d1\u5e01 +20",o.copper+=20):6==t||11==t?this.changeCard():7==t?(e="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(2),this.rewardNode.y-=130):8==t||10==t?(e="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",o.copper=Math.ceil(o.copper/2)):13==t?this.deleteCard(0):14==t?(e="\u751f\u547d\u4e0a\u9650 -10",o.hpMax=Math.max(o.hpMax-10,1),o.hp=Math.min(o.hp,o.hpMax)):15==t?(e="\u6028\u5ff5\uff1a\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59313\u751f\u547d",o.debuff++):16==t?(e="\u751f\u547d -10",this.loseHp(10)):17==t&&(e="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getCard(),this.rewardNode.y-=130):2==this.result&&(2==t||15==t?(e="\u751f\u547d -10",this.loseHp(10)):7==t?(e="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(1),this.rewardNode.y-=130):12==t?(e="\u91d1\u5e01 -20",o.copper=Math.max(o.copper-20,0)):13==t?(this.deleteCard(1,0),this.deleteCard(1,1)):16==t&&(e="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",o.copper=Math.ceil(o.copper/2)));this.txtName.string=e,window.homeLayer&&window.homeLayer.refreshHeroData()},close:function(){window.homeLayer?this.node.destroy():cc.director.loadScene("helloworld")},getCard:function(t,e){var i=e||o.getNewCardId(t),s=cc.instantiate(this.cardPrefab);return s.getComponent("CardCollection").init(i),this.rewardNode.addChild(s),o.getCard(i),s},getItem:function(t){var e=o.getNewItemId(0,t);this.itemNode.active=!0,this.txtItemName.string=s.get("cfg_item",e).name,this.txtItemDesc.string=s.get("cfg_item",e).desc,o.getItem(e)},loseHp:function(t){if(o.hp-=t,o.hp<=0){o.hp+=t;var e=cc.instantiate(this.losePrefab);this.node.addChild(e)}},changeCard:function(){if(o.deck.length>0){this.txtChange.active=!0;var t=Math.floor(Math.random()*o.deck.length),e=o.deck[t];o.deck.splice(t,1);var i,s=o.getNewCardId();o.getCard(s),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),i.x-=200,this.rewardNode.addChild(i),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(s),i.x+=200,this.rewardNode.addChild(i)}else this.txtName.string="\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362"},changeItem:function(){if(o.equip.length>0){var t=Math.floor(Math.random()*o.equip.length),e=o.equip[t];o.equip.splice(t,1);var i=o.getNewItemId(0);o.getItem(i),this.itemChangeNode.active=!0,this.txtChangeName1.string=s.get("cfg_item",e).name,this.txtChangeDesc1.string=s.get("cfg_item",e).desc,this.txtChangeName2.string=s.get("cfg_item",i).name,this.txtChangeDesc2.string=s.get("cfg_item",i).desc}else this.txtName.string="\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362"},deleteCard:function(t,e){var i=0==t?o.deck:o.cardBag;if(i.length>0){var s=Math.floor(Math.random()*i.length),n=i[s];i.splice(s,1);var c=cc.instantiate(this.cardPrefab);c.getComponent("CardCollection").init(n),c.getComponent("CardCollection").markDelete.active=!0,null!=e&&(c.x=400*e-200),this.rewardNode.addChild(c)}else this.txtName.string="\u53ef\u79fb\u9664\u5361\u724c\u4e0d\u8db3",this.rewardNode.y-=130}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(t,e,i){"use strict";cc._RF.push(e,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,txtHp:cc.Label,boxBuff:cc.Node,txtName:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){o.editCfg?this.initEdit():(this.cfgId=o.monsterId,this.cfg=s.get("cfg_monster",this.cfgId),this.hp=this.hpMax=this.cfg.hp,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,this.equipList=[this.cfg.item],this.txtName.string=this.cfg.name,this.initDeck()),this.player.init(1),this.ai=this.getComponent("AI")},startRound:function(){this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5)},onHurt:function(t,e,i){i=i||7,this.player.onHurt(t,e,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(0))},onHeal:function(t){this.player.onHeal(t),this.player.assertHpChange(t),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},updateArmor:function(t){this.armor+=t,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor):(this.armor=0,this.boxArmor.active=!1)},initDeck:function(){if(0==this.cfg.card1)this.deck=window.mainLayer.hero.deck;else{this.deck=[];for(var t=0;t<6;t++){var e=this.cfg["card"+(t+1)];e>0&&this.deck.push(e)}}},initEdit:function(){this.hp=this.hpMax=parseInt(o.editCfg.hp),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(o.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.deck=o.editCfg.deckEnemy.split(";"),this.equipList=""!=o.editCfg.equipEnemy?[o.editCfg.equipEnemy]:[]}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(t,e,i){"use strict";cc._RF.push(e,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node},onLoad:function(){for(var t=0;t<o.equip.length;t++){var e=cc.instantiate(this.itemPrefab);e.getComponent("ItemCollection").init(o.equip[t]),e.position=cc.v2(0,-55-110*t),this.content.addChild(e)}this.content.height=Math.max(110*o.equip.length,1100)},close:function(){this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(t,e,i){"use strict";cc._RF.push(e,"a22ddJNtUJBS6PVq98jP/g9","Equip");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?o.equip:this.host.equipList,this.boxEquip=this.host.boxEquip,this.initItems(),this.swiftGlove=!1,this.suckRemainder=0,this.amulet=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0},initItems:function(){this.itemList=[];for(var t=0;t<this.equipList.length;t++)if(this.equipList[t]>0){var e=cc.instantiate(this.itemPrefab);e.getComponent("Item").init(this.equipList[t],this),0==this.index&&(e.x=110*t-350),this.boxEquip.addChild(e),this.itemList.push(e)}},check:function(t){for(var e=0;e<this.equipList.length;e++)if(this.equipList[e]==t)return!0;return!1},checkWithTrigger:function(t){return!!this.check(t)&&(this.doTrigger(t),!0)},trigger:function(t){var e=!1;if(this.check(t))if(1==t)this.opponent.host.onHurt(1,2),e=!0;else if(2==t)this.player.cardList.length<=0&&(this.host.updateArmor(3),e=!0);else if(3==t)this.player.cardList.length<=0&&(this.host.onHeal(2),e=!0);else if(4==t)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.btnRoll&&this.player.rollCount>0&&this.host.btnRoll.runAction(cc.moveTo(.2,cc.v2(285,145))),e=!0);else if(5==t)this.opponent.buff.addBuff(26,2),e=!0;else if(6==t)this.player.buff.addBuff(13,1),e=!0;else if(7==t)this.host.onHeal(6),e=!0;else if(8==t)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(10),e=!0);else if(9==t)this.opponent.host.onHurt(3,2),e=!0;else if(10==t)this.host.hp=Math.floor(.3*this.host.hpMax),e=!0,this.removeItem(t);else if(11==t)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.host.updateArmor(-this.host.armor),e=!0);else if(t>=12&&t<=18){this.opponent.buff.addBuff(t+9,[2,1,2,2,1,4,1][t-12]),e=!0}else if(19==t)this.player.extraDice++,e=!0;else if(20==t)this.host.updateArmor(8),e=!0;else if(22==t)this.opponent.host.onHurt(5,2),e=!0;else if(23==t)this.suckRemainder>=4&&(this.host.onHeal(Math.floor(this.suckRemainder/4)),this.suckRemainder=this.suckRemainder%4,e=!0);else if(24==t)this.opponent.host.onHurt(2,2,1),e=!0;else if(25==t)this.host.hp==this.host.hpMax&&(this.player.extraDice++,e=!0);else if(27==t)this.host.armor<=0&&(this.host.updateArmor(3),e=!0);else if(30==t)3==this.player.round&&(this.player.extraDice++,e=!0);else if(44==t)this.player.buff.atkBack+=3,e=!0;else if(45==t)this.scheduleOnce(function(){this.player.createExDice()}.bind(this),.5),e=!0;else if(t>=48&&t<=53)1==this.player.round&&(this.scheduleOnce(function(){window.player.createExDice(t-47)}.bind(this),.5),e=!0);else if(57==t)this.player.cardList.length>0&&(this.player.extraDice++,e=!0);else if(59==t)this.player.cardList.length>0&&(this.host.updateArmor(3*this.player.cardList.length),e=!0);else if(60==t)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),e=!0);else if(61==t)this.host.onHeal(15),e=!0;else if(68==t)this.opponent.buff.addBuff(24,1),e=!0;else if(69==t)this.opponent.host.onHurt(10,2),e=!0;else if(70==t)this.player.patchCard(),e=!0;else if(78==t||83==t)this.host.onHeal(1),e=!0;else if(79==t||82==t)this.host.updateArmor(1),e=!0;else if(80==t||81==t)this.opponent.host.onHurt(1,2),e=!0;else if(84==t)this.player.buff.addBuff(27,1),e=!0;else if(86==t)this.host.onHurt(2,2),e=!0;else if(88==t){if(o.deck.length>0){e=!0;for(var i=s.get("cfg_card",o.deck[0]).element,n=1;n<o.deck.length;n++)if(s.get("cfg_card",o.deck[n]).element!=i){e=!1;break}}}else 91==t?(this.player.buff.addBuff(21,2),e=!0):93==t?1==this.player.round&&(this.scheduleOnce(function(){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard();for(var t=0;t<=0;){var e=o.getRandomCardId();3==s.get("cfg_card",e).quality&&(t=e)}window.player.patchCard(t)}.bind(this),.5),e=!0):96==t?(this.opponent.buff.addBuff(26,5),e=!0):97==t?(this.host.updateArmor(1),e=!0):102==t?this.host.hp>this.host.hpMax&&(this.host.updateArmor(this.host.hp-this.host.hpMax),e=!0):104==t?(this.opponent.buff.addBuff(Math.floor(8*Math.random())+21,1),e=!0):105==t?(this.host.onHurt(1,2),e=!0):108==t?(this.opponent.host.onHurt(5,2,6),e=!0):109==t?(this.opponent.host.onHurt(5,2),e=!0):110==t?(this.host.onHurt(1,2),this.opponent.buff.addBuff(26,2),e=!0):111==t?this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),e=!0):115==t?(this.player.rollCount++,e=!0):116==t?(this.opponent.host.onHurt(6,2),e=!0):e=!0;return e&&this.doTrigger(t),e},removeItem:function(t){var e=this.equipList.indexOf(t);e>=0&&this.equipList.splice(e,1);for(var i=0;i<this.itemList.length;i++){var s=this.itemList[i].getComponent("Item");if(s.cfgId==t){s.remove();break}}0==this.index&&o.deleteItem(t)},doTrigger:function(t){for(var e=0;e<this.itemList.length;e++){var i=this.itemList[e].getComponent("Item");if(i.cfgId==t&&!i.isRemoved){i.trigger();break}}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(t,e,i){"use strict";cc._RF.push(e,"0d029pbdspBQZQHImTjZ76I","EventLayer");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtDesc:cc.Label,txtResults:[cc.Label],endPrefab:cc.Prefab},onLoad:function(){this.cfgId=o.eventId;var t=s.get("cfg_event",this.cfgId);this.txtName.string=t.name,this.txtDesc.string=t.desc;for(var e=["\u80dc\u5229/\u5e73\u5c40\uff1a","\u5931\u8d25\uff1a","\u79bb\u5f00\uff1a"],i=0;i<3;i++)this.txtResults[i].string=e[i]+t["result"+(i+1)]},onBattle:function(){o.stayRoom=!0,o.newRoom=!1,window.homeLayer=null,cc.director.loadScene("yahtzee")},onLeave:function(){if("\u65e0"!=s.get("cfg_event",this.cfgId).result3){var t=cc.instantiate(this.endPrefab);t.getComponent("EndYahtzeeLayer").init(2),window.homeLayer.node.addChild(t)}this.close()},close:function(){this.node.destroy(),window.homeLayer.btnAlter.node.active=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(t,e,i){"use strict";cc._RF.push(e,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{mark:cc.Sprite,line:cc.Node},init:function(t,e){cc.loader.loadRes("Texture/"+["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"][t-1],cc.SpriteFrame,function(t,e){this.mark.spriteFrame=e}.bind(this)),this.line.active=e}}),cc._RF.pop()},{}],Game:[function(t,e,i){"use strict";cc._RF.push(e,"f5308O6zsVOxr+EKRsyR7ba","Game");var o=t("Config"),s={version:0,getData:function(t){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(e){cc.log("getStorageSuccess:"+e.data),void 0!=e.data?(s.syncFromStorage(JSON.parse(e.data)),t()):(this.setDataToBase(),t())}.bind(this),fail:function(){this.setDataToBase(),t()}.bind(this)});else{var e=cc.sys.localStorage.getItem("dice");void 0!=e?s.syncFromStorage(JSON.parse(e)):this.setDataToBase(),t()}},setDataToBase:function(){s.deck=[],s.cardBag=[],s.equip=[],s.hp=s.hpMax=30,s.power=0,s.powerMax=20,s.heroPos=2,s.stayRoom=s.newRoom=!0,s.exp=0,s.level=1,s.castle=1,s.floor=1,s.roomType=0,s.copper=50,s.debuff=0,s.shopIds=[],s.eventIds=[],s.floorCfg=[],s.historyPath=[],s.historyChoose=[],s.specialRoomIds=[],s.monsterBeats=[],s.discountCard=s.discountItem=-1,s.itemEffect={vase:0,flagon:0,pen:0,vip1:!1,vip2:!1},s.saveData()},syncFromStorage:function(t){for(var e=["deck","cardBag","equip","hp","hpMax","power","powerMax","heroPos","stayRoom","newRoom","level","floor","castle","roomType","copper","debuff","shopIds","eventIds","floorCfg","historyPath","historyChoose","discountCard","discountItem","itemEffect","specialRoomIds","exp","monsterBeats"],i=0;i<e.length;i++)s[e[i]]=t[e[i]]},saveData:function(){s.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(s),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(s))},getItem:function(t){if(71==t)s.copper+=30;else if(87==t)for(var e=0;e<2;e++)s.getItem(s.getNewItemId(0,2));else s.equip.push(t);if(28==t)s.itemEffect.vase+=2;else if(29==t)s.itemEffect.flagon+=2;else if(40==t)s.hpMax+=5,s.hp+=5;else if(41==t)s.hpMax+=10,s.hp+=10;else if(46==t)s.itemEffect.vip1=!0;else if(47==t)s.itemEffect.vip2=!0;else if(72==t)s.copper+=10,s.hpMax+=5,s.hp+=5;else if(74==t)s.itemEffect.pen+=3;else if(84==t)for(var i=0;i<3;i++)s.getItem(s.getNewItemId(0));else 92==t?(s.hpMax=Math.max(s.hpMax-8,1),s.hp=Math.min(s.hp,s.hpMax)):95==t?(s.hpMax+=10,s.hp=s.hpMax):96==t?(s.hpMax=Math.max(s.hpMax-10,1),s.hp=Math.min(s.hp,s.hpMax)):105==t?(s.hpMax+=20,s.hp+=20):106==t&&(s.powerMax+=10);94!=t&&s.equip.indexOf(94)>=0&&(s.hp=Math.min(s.hp+5,s.hpMax)),window.homeLayer&&window.homeLayer.refreshHeroData()},getCard:function(t){s.deck.length<6?s.deck.push(t):s.cardBag.push(t)},deleteItem:function(t){var e=s.equip.indexOf(t);e>=0&&s.equip.splice(e,1)},getNewItemId:function(t,e){for(var i=0;i<=0;){var n=Math.floor(117*Math.random())+1;s.equip.indexOf(n)<0&&(0==t&&o.get("cfg_item",n).get<=1||1==t&&0==o.get("cfg_item",n).get||2==t)&&(e?o.get("cfg_item",n).quality==e&&(i=n):i=n)}return i},getNewCardId:function(t,e){for(var i=0;i<=0;){var n=s.getRandomCardId(e);s.deck.indexOf(n)<0&&s.cardBag.indexOf(n)<0&&(t?o.get("cfg_card",n).quality==t&&(i=n):i=n)}return i},getRandomCardId:function(t){for(var e=0;e<=0;){var i=Math.floor(217*Math.random())+1;o.get("cfg_card",i).get==(t?2:1)&&(e=i)}return e},getNewMonsterId:function(t,e){for(var i=0;i<=0;){var n=Math.floor(57*Math.random())+1;s.monsterBeats.indexOf(n)<0&&o.get("cfg_monster",n).level==t&&o.get("cfg_monster",n).type==e&&(i=n)}return i}};e.exports=s,cc._RF.pop()},{Config:"Config"}],HelloWorld:[function(t,e,i){"use strict";cc._RF.push(e,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var o=t("Game");cc.Class({extends:cc.Component,properties:{hero:cc.Node,door:[cc.Button],mark:[cc.Sprite],txtFloor:cc.Label,btnAlter:cc.Sprite,stripHp:cc.ProgressBar,txtHp:cc.Label,txtCopper:cc.Label,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,equipPrefab:cc.Prefab,completePrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab},onLoad:function(){if(window.homeLayer=this,this.pos=o.heroPos,this.abled=!1,o.stayRoom)this.abled=!0,this.door[this.pos].node.color=cc.Color.GRAY;else{var t=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];this.hero.position=t[this.pos],this.hero.runAction(cc.sequence(cc.moveTo(.2,cc.v2()),cc.callFunc(function(){this.abled=!0,this.door[this.pos].node.color=cc.Color.GRAY}.bind(this))))}1==o.floor&&1==o.castle&&this.initGameConfig(),o.newRoom?(this.checkEquip(),this.initFloorConfig()):this.typeList=o.floorCfg,this.initDoors(),this.initRoom(),this.refreshHeroData(),o.levelUp&&this.scheduleOnce(this.openLvUp,.3)},initDoors:function(){var t=this;this.txtFloor.string=o.castle+"-"+o.floor;for(var e=["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"],i=0;i<4;i++){var s=this.typeList[i];-1==s?this.door[i].node.active=!1:s>0&&function(){var o=t.mark[i];cc.loader.loadRes("Texture/"+e[s-1],cc.SpriteFrame,function(t,e){o.spriteFrame=e}.bind(t))}()}},initRoom:function(){if(7==o.roomType&&o.floor>=12||6==o.roomType&&6==o.floor)cc.loader.loadRes("Texture/mark_treasure",cc.SpriteFrame,function(t,e){this.btnAlter.spriteFrame=e}.bind(this));else if(o.roomType<=1||!o.newRoom)this.btnAlter.node.active=!1;else{cc.loader.loadRes("Texture/"+["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"][o.roomType-1],cc.SpriteFrame,function(t,e){this.btnAlter.spriteFrame=e}.bind(this))}},gotoDoor:function(t,e){if(e!=this.pos&&this.abled){this.abled=!1;var i=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];this.hero.runAction(cc.sequence(cc.moveTo(.2,i[e]),cc.callFunc(function(){if(o.heroPos=(parseInt(e)+2)%4,o.floor++,o.castle<3&&o.floor>12)o.floor=1,o.castle++,o.historyPath=[],o.historyChoose=[];else if(3==o.castle&&o.floor>13){var t=cc.instantiate(this.completePrefab);return void this.node.addChild(t)}o.historyChoose.push(e),o.roomType=this.typeList[e],o.newRoom=!0,1==o.roomType||o.roomType>=6?(window.homeLayer=null,o.stayRoom=!0,o.monsterId=o.monsterCfg[e],cc.director.loadScene("mainLayer")):(o.stayRoom=!1,cc.director.loadScene("helloworld"))}.bind(this))))}},openAlter:function(){if(2==o.roomType){var t=cc.instantiate(this.campPrefab);this.node.addChild(t)}else if(3==o.roomType||o.roomType>=6){var e=cc.instantiate(this.treasurePrefab);e.getComponent("TreasureLayer").init(7==o.roomType),this.node.addChild(e)}else if(4==o.roomType){var i=cc.instantiate(this.eventPrefab);this.node.addChild(i)}else if(5==o.roomType){var s=cc.instantiate(this.shopPrefab);this.node.addChild(s)}},refreshHeroData:function(){this.txtHp.string=o.hp+"/"+o.hpMax,this.stripHp.progress=o.hp/o.hpMax,this.txtCopper.string=o.copper},openMap:function(){var t=cc.instantiate(this.mapPrefab);this.node.addChild(t)},openCardBag:function(){var t=cc.instantiate(this.bagPrefab);this.node.addChild(t)},openEquip:function(){var t=cc.instantiate(this.equipPrefab);this.node.addChild(t)},openLvUp:function(){var t=cc.instantiate(this.lvUpPrefab);this.node.addChild(t)},initDeck:function(){if(o.deck.length+o.cardBag.length<=3)for(;o.deck.length<3;){var t=o.getNewCardId(null,!0);o.getCard(t)}},checkEquip:function(){2==o.roomType&&o.equip.indexOf(38)>=0&&(o.hp=Math.min(o.hp+10,o.hpMax)),3==o.roomType&&o.equip.indexOf(42)>=0&&(o.copper+=10)},initGameConfig:function(){this.initDeck(),o.eventIds=[];for(var t=0;t<17;t++){var e=Math.floor(Math.random()*(o.eventIds.length+1));o.eventIds.splice(e,0,t+1)}o.specialRoomIds=[3,4];for(var i=[[2,4,5],[2,3,4,4,5],[2,3,4,4,5]],s=0;s<3;s++)for(var n=i[s],c=n.length-1;c>=0;c--){var r=Math.floor(Math.random()*n.length);o.specialRoomIds.push(n[r]),n.splice(r,1)}},initFloorConfig:function(){if(this.typeList=[-1,-1,-1,-1],this.typeList[this.pos]=-2,1==o.floor)this.typeList[(this.pos+2)%4]=1;else if(11==o.floor)this.typeList[(this.pos+2)%4]=7;else if(12==o.floor)3==o.castle?this.typeList[(this.pos+2)%4]=7:this.typeList[(this.pos+2)%4]=0;else if(13==o.floor)this.typeList[(this.pos+2)%4]=0;else{var t=[];if(3==o.floor||7==o.floor||9==o.floor)t=Math.random()<.4?[1,1,1]:[1,1];else if(5==o.floor)t=[6,6];else{var e=5;o.specialRoomIds.length>0&&(e=o.specialRoomIds.shift()),t=Math.random()<.3?[e,1,1]:[e,1]}t.length<3&&t.splice(Math.floor(3*Math.random()),0,-1);for(var i=0;i<4;i++)if(i!=this.pos){var s=Math.floor(Math.random()*t.length),n=t[s];t.splice(s,1),this.typeList[i]=n}}o.floorCfg=this.typeList,o.historyPath.push(this.typeList),o.monsterCfg=[0,0,0,0];for(var c=2*(o.castle-1)+(o.floor<=5?1:2),r=0;r<4;r++){var a=this.typeList[r];if(1==a||a>=6){for(var h=0;h<=0;){var d=1==a?0:6==a?1:2;12==o.floor&&(c=7,d=3);var f=o.getNewMonsterId(c,d);o.monsterCfg.indexOf(f)<0&&(h=f)}o.monsterCfg[r]=h}}if(4==o.roomType)o.eventIds.length>0?o.eventId=o.eventIds.shift():o.eventId=Math.floor(17*Math.random())+1;else if(5==o.roomType){for(var l=[],p=[],u=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];l.length<3;){for(var m=0,g=Math.random(),w=0,v=0;v<3;v++)g<(w+=u[o.castle-1][v])&&(m=v+1);for(var C=o.getNewCardId(m),y=!1,b=0;b<l.length;b++)if(C==l[b]){y=!0;break}y||l.push(C)}for(u=[[.4,.4,.2],[.3,.4,.3],[.2,.4,.4]];p.length<3;){for(var x=0,L=Math.random(),k=0,I=0;I<3;I++)L<(k+=u[o.castle-1][I])&&(x=I+1);for(var M=o.getNewItemId(1,x),q=!1,R=0;R<p.length;R++)if(M==p[R]){q=!0;break}q||p.push(M)}o.shopIds=l.concat(p,[1,2]),o.itemEffect.vip1&&(o.discountItem=Math.floor(3*Math.random())),o.itemEffect.vip2&&(o.discountCard=Math.floor(3*Math.random()))}},gotoEdit:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Hero:[function(t,e,i){"use strict";cc._RF.push(e,"7311fX1RYNN1bDgBGcTZsee","Hero");var o=t("Game"),s=t("Skill");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,btnSkills:[cc.Button],btnEnd:cc.Node,btnRoll:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){this.deck=o.deck.concat(),this.player.init(0),this.hpMax=o.hpMax,this.hp=o.hp,this.power=o.power,this.powerMax=o.powerMax,this.armor=0,this.refreshStrip(),this.skillable=[!0,!0],this.checkSkills()},startRound:function(){this.btnEnd.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.2,cc.v2(-260,145))))},endRound:function(){this.skillable=[!0,!0],this.checkSkills(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-480,145))),this.btnRoll.runAction(cc.moveTo(.2,cc.v2(465,145)))},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onHurt:function(t,e,i){var o=this.hp;i=i||7,this.player.onHurt(t,e,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),o>this.hp&&this.addPower(o-this.hp)},onHeal:function(t){this.player.onHeal(t),this.player.assertHpChange(t),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(t){this.power+=t,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.checkSkills()},updateArmor:function(t){this.armor+=t,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor):(this.armor=0,this.boxArmor.active=!1)},update:function(){Math.abs(this.stripPower.progress-this.power/this.powerMax)>.03?this.stripPower.progress+=.03*(this.stripPower.progress>this.power/this.powerMax?-1:1):this.stripPower.progress=this.power/this.powerMax},doSkill:function(t,e){if(0==window.mainLayer.roundId){this.skillable[e]=!1,this.addPower(-[10,20][e]),s.doCast(e)}},checkSkills:function(){for(var t=[10,20],e=0;e<2;e++)1==e&&o.level<3?this.btnSkills[e].node.active=!1:this.btnSkills[e].interactable=this.skillable[e]&&this.power>=t[e]},roll:function(){this.player.roll()}}),cc._RF.pop()},{Game:"Game",Skill:"Skill"}],ItemCollection:[function(t,e,i){"use strict";cc._RF.push(e,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var o=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.Label},init:function(t){var e=o.get("cfg_item",t),i=[cc.color(0,0,0),cc.color(0,255,0),cc.color(255,0,255)];this.txtName.string=e.name,this.txtDesc.string=e.desc,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][e.quality-1],this.txtQuality.node.color=i[e.quality-1]}}),cc._RF.pop()},{Config:"Config"}],ItemCommodity:[function(t,e,i){"use strict";cc._RF.push(e,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var o=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtDesc:cc.Label},init:function(t){var e=o.get("cfg_item",t);this.txtName.string=e.name,this.txtDesc.string=e.desc}}),cc._RF.pop()},{Config:"Config"}],Item:[function(t,e,i){"use strict";cc._RF.push(e,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var o=t("Config");cc.Class({extends:cc.Component,properties:{label:cc.Label},init:function(t,e){this.cfgId=t,this.cfg=o.get("cfg_item",t),this.label.string=this.cfg.name,this.equip=e},remove:function(){this.isRemoved=!0,this.action||this.doDelete()},trigger:function(){this.action&&this.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.2),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,this.isRemoved&&this.doDelete()}.bind(this))),this.node.runAction(this.action)},doDelete:function(){var t=this.equip.itemList.indexOf(this.node);t>=0&&this.equip.itemList.splice(t,1);for(var e=0;e<this.equip.itemList.length;e++)this.equip.itemList[e].x=110*e-350;this.node.destroy()}}),cc._RF.pop()},{Config:"Config"}],LevelUpLayer:[function(t,e,i){"use strict";cc._RF.push(e,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{btnClose:cc.Node,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,txtSkill:cc.Node,boxReward:cc.Node,btns:[cc.Node]},onLoad:function(){this.type=3,3==o.level?(this.txtSkill.active=!0,this.btns[0].active=this.btns[1].active=!1):4==o.level||7==o.level?(this.type=2,this.initItems()):(this.type=1,this.initCards())},initCards:function(){this.btnClose.active=!1,this.itemIdList=[],this.items=[];var t=o.getNewCardId();this.itemIdList.push(t);for(var e=0;e<=0;){var i=o.getNewCardId();i!=t&&(e=i)}this.itemIdList.push(e);for(var s=0;s<2;s++){var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(this.itemIdList[s]),n.position=cc.v2(0==s?-160:160,40),this.boxReward.addChild(n),this.items.push(n)}},initItems:function(){this.btnClose.active=!1,this.itemIdList=[],this.items=[];var t=o.getNewItemId(0);this.itemIdList.push(t);for(var e=0;e<=0;){var i=o.getNewItemId(0);i!=t&&(e=i)}this.itemIdList.push(e);for(var s=0;s<2;s++){var n=cc.instantiate(this.itemPrefab);n.getComponent("ItemCommodity").init(this.itemIdList[s]),n.position=cc.v2(0==s?-160:160,40),this.boxReward.addChild(n),this.items.push(n)}},choose:function(t,e){1==this.type?o.getCard(this.itemIdList[e]):o.getItem(this.itemIdList[e]),this.items[1-e].destroy(),this.items[e].runAction(cc.moveTo(.2,cc.v2(0,40))),this.btns[0].active=this.btns[1].active=!1,this.btnClose.active=!0},close:function(){o.levelUp=!1,this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],LoseLayer:[function(t,e,i){"use strict";cc._RF.push(e,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){if(o.floor>1){o.floor--,o.newRoom=!1;var t=o.floorCfg.indexOf(-2);t>=0&&(o.heroPos=t)}cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(t,e,i){"use strict";cc._RF.push(e,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,losePrefab:cc.Prefab,editEndPrefab:cc.Prefab},onLoad:function(){window.mainLayer=this,this.gameOver=!1},start:function(){this.hero=this.heroNode.getComponent("Hero"),this.enemy=this.enemyNode.getComponent("Enemy"),this.hero.init(),this.enemy.init(),this.roundId=1,this.scheduleOnce(function(){this.doRound()}.bind(this),.1)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.player.startRound()},showEnd:function(t){if(this.gameOver=!0,o.editCfg){var e=cc.instantiate(this.editEndPrefab);this.node.addChild(e)}else if(0==t){var i=cc.instantiate(this.endPrefab);this.node.addChild(i)}else{var s=cc.instantiate(this.losePrefab);this.node.addChild(s)}}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2be16dXDepLLbZP42Rqq+om","MapLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{scroll:cc.ScrollView,content:cc.Node,fortPrefab:cc.Prefab},onLoad:function(){cc.log(o.historyPath);for(var t=0;t<o.historyPath.length;t++){var e=o.historyPath[t],i=0,s=!1;if(o.historyChoose[t])i=o.historyChoose[t],s=!0;else for(var n=0;n<4;n++)if(e[n]>0){i=n;break}var c=cc.instantiate(this.fortPrefab);c.getComponent("Fort").init(e[i],s),c.position=cc.v2(0,190+120*t),this.content.addChild(c);for(var r=[-1,1],a=2;a>=0;a--){var h=r[a]+0;(h<-2||h>2)&&r.splice(a,1)}for(var d=0;d<4;d++){var f=e[d];if(d!=i&&f>0){var l=Math.floor(Math.random()*r.length),p=r[l],u=0+p;r.splice(l,1);var m=cc.instantiate(this.fortPrefab);if(m.getComponent("Fort").init(f),m.position=cc.v2(120*u,190+120*t),this.content.addChild(m),-1==p||1==p){var g=2*p+0;g>=-2&&g<=2&&r.push(2*p)}}}}this.content.height=Math.max(120*o.historyPath.length+140,1180),this.scroll.scrollToTop(0)},close:function(){this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(t,e,i){"use strict";cc._RF.push(e,"52880hyyK1GjLw1tAGJFFaD","Opening");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{endPrefab:cc.Prefab},onLoad:function(){this.login()},login:function(){s.load(function(){o.setDataToBase(),this.gotoMain()}.bind(this))},gotoMain:function(){cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Node]},init:function(t){this.index=t,this.win=0,this.dicePool=new cc.NodePool;for(var e=0;e<5;e++){var i=cc.instantiate(this.dicePrefab);this.dicePool.put(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){this.diceList=[];for(var t=0;t<5;t++){var e=this.dicePool.get();e.getComponent("DiceYahtzee").init(t,this.index),this.boxDice.addChild(e),this.diceList.push(e)}this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var t=0;t<5;t++){var e=this.diceList[t].getComponent("DiceYahtzee");e.holded||e.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check()}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var t=0;t<5;t++){var e=this.diceList[t].getComponent("DiceYahtzee");e.holded||e.hold(),e.abled=!1}}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var t=[0,0,0,0,0,0],e=0;e<5;e++){t[this.diceList[e].getComponent("DiceYahtzee").element-1]++}t.sort(function(t,e){return e-t}),5==t[0]?this.score=7:4==t[0]?this.score=6:3==t[0]?2==t[1]?this.score=5:this.score=4:2==t[0]?2==t[1]?this.score=3:this.score=1:this.score=2},doWin:function(){this.crowns[this.win].color=0==this.index?cc.color(0,0,255):cc.color(255,0,0),this.win++}}),cc._RF.pop()},{}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"ba4f5YaUElBy61UWqBofsfz","Player");var o=t("Game"),s=t("Utils"),n=t("Config");cc.Class({extends:cc.Component,properties:{boxCard:cc.Node,boxDice:cc.Node,cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,markCurse:cc.Node},init:function(t){this.index=t,this.host=0==t?this.getComponent("Hero"):this.getComponent("Enemy"),this.opponent=0==t?window.mainLayer.enemy.player:window.mainLayer.hero.player,this.buff=this.getComponent("Buff"),this.buff.init(),this.equip=this.getComponent("Equip"),this.equip.init(),this.cardPool=new cc.NodePool;for(var e=0;e<6;e++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var o=0;o<5;o++){var s=cc.instantiate(this.dicePrefab);this.dicePool.put(s)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.deck=this.host.deck,this.diceCount=0==t?5:this.host.diceCount;for(var n=[85,86,89,90,91,92],c=0;c<n.length;c++)this.equip.checkWithTrigger(n[c])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++},start:function(){this.checkGameBegin()},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,this.checkStart(),this.initCards(),this.initDices(),window.mainLayer.gameOver||this.host.startRound()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var t=this.diceCount+this.extraDice,e=s.getDifferentRandomNum(t,t-1,0),i=Math.min(this.buff.lock,t),o=e.splice(0,i);this.buff.removeBuff(28,i);var n=0,c=[];this.equip.checkWithTrigger(63)||(n=Math.min(this.buff.freeze,t-i),c=e.splice(0,n),this.buff.removeBuff(22,n));for(var r=0;r<t;r++){for(var a=null,h=0;h<o.length;h++)if(r==o[h]){a=28;break}if(!a)for(var d=0;d<c.length;d++)if(r==c[d]){a=22;break}var f=null;(f=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab)).position=cc.v2(-(t-1)/2*110+110*r,0==window.mainLayer.roundId?-120:600),f.getComponent("Dice").init(r,a),this.boxDice.addChild(f),this.diceList.push(f)}this.extraDice=0,this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[];for(var t=Math.min(this.deck.length,6),e=this.equip.checkWithTrigger(66)?0:this.buff.silence,i=this.equip.checkWithTrigger(62)?0:this.buff.burn,o=0;o<t;o++){var s=null,c=n.get("cfg_card",this.deck[o]).element;this.buff.silenceDark&&6==c?s=25:Math.random()<e/(t-o)?(s=25,e--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==c?s=21:Math.random()<i/(t-o)&&(s=21,i--,this.buff.removeBuff(21,1)),this.drawCard(this.deck[o],s)}},drawCard:function(t,e,i){var o=this.getEmptyIndex();if(!(o<0)){var s=null;return(s=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(t,o,e,0),s.getComponent("Card").isTemp=i,this.boxCard.addChild(s,100),this.cardList.push(s),s}},patchCard:function(t,e){var i=this.buff,s=null;t=t||o.getRandomCardId();var c=n.get("cfg_card",t).element;i.silenceDark&&6==c?s=25:i.silence>0&&!this.equip.checkWithTrigger(66)?(s=25,i.removeBuff(25,1)):i.burnIce&&2==c?s=21:i.burn>0&&!this.equip.checkWithTrigger(62)&&(s=21,i.removeBuff(21,1));var r=this.drawCard(t,s,!e);return this.checkCardsRequire(),r},roll:function(t,e){for(var i=0;i<this.diceList.length;i++){var o=this.diceList[i].getComponent("Dice");1==t?o.roll():o.freeze||o.lock||(e?(o.holded&&o.hold(),o.roll(e)):o.holded||o.roll())}this.checkElement();for(var s=0,n=0;n<6;n++)this.elementList[n]>s&&(s=this.elementList[n]);if(1==s&&(this.equip.trigger(115),this.equip.trigger(116)),t){this.cardAbledCount<=0&&this.equip.trigger(45);for(var c=48;c<=53;c++)this.equip.trigger(c);this.equip.trigger(93)}this.rollCount--,0==window.mainLayer.roundId&&(this.rollCount<=0?this.host.btnRoll.runAction(cc.moveTo(.15,cc.v2(465,145))):this.host.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(465,145)),cc.moveTo(.15,cc.v2(285,145)))))},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var t=0;t<this.diceList.length;t++){var e=this.diceList[t].getComponent("Dice");e.lock||this.elementList[e.element-1]++}this.cardAbledCount=this.checkCardsRequire()},createExDice:function(t){var e=null;this.buff.lock>0?(e=28,this.buff.removeBuff(28,1)):t?e=22:this.buff.freeze>0&&!this.equip.checkWithTrigger(63)&&(e=22,this.buff.removeBuff(22,1));var i=null;(i=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab)).getComponent("Dice").init(this.diceList.length-1,e),this.boxDice.addChild(i),this.diceList.push(i);for(var o=0;o<this.diceList.length;o++)this.diceList[o].position=cc.v2(-(this.diceList.length-1)/2*110+110*o,0);i.getComponent("Dice").roll(t),this.checkElement()},endRound:function(){this.scheduleOnce(function(){for(var t=this.cardList.length-1;t>=0;t--)this.cardList[t].getComponent("Card").remove()}.bind(this),.3);for(var t=0;t<this.diceList.length;t++)this.diceList[t].getComponent("Dice").remove();0==this.index&&this.host.endRound(),this.scheduleOnce(function(){this.buff.exRound>0?(this.startRound(),this.buff.exRound--):window.mainLayer.doRound()}.bind(this),.5),this.settleBuff(),this.settleEquip()},checkCardsRequire:function(){for(var t=0,e=0;e<this.cardList.length;e++){this.cardList[e].getComponent("Card").checkRequire()&&t++}return t},checkGameBegin:function(){for(var t=[6,12,13,14,15,16,17,18,19,20,30,44,86,91,96],e=0;e<t.length;e++)this.equip.trigger(t[e]);this.equip.check(37)&&(this.equip.amulet=2),this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),7==o.roomType&&this.equip.trigger(61),0==this.index&&o.debuff>0&&this.onHurt(3*o.debuff,1)},checkStart:function(){if(this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]),this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var t=this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?2:1);this.host.onHurt(t,1,26),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.undead--;for(var e=[5,9,25,84,105,111],i=0;i<e.length;i++)this.equip.trigger(e[i])},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.table[23]>0&&this.buff.removeBuff(23,1),this.buff.table[24]>0&&this.buff.removeBuff(24,1),this.buff.multiCast=window.player.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1,this.buff.imitation>0&&(this.cardList.length<=0&&(this.extraDice+=this.buff.imitation),this.buff.imitation=0)},settleEquip:function(){for(var t=[2,3,27,11,57,59,60,104,110],e=0;e<t.length;e++)this.equip.trigger(t[e]);this.cardPlayedRound=0,this.equip.swiftGlove=!1,this.equip.suckRemainder=0},onHurt:function(t,e,i){if(this.buff.frail>0&&0==e&&!this.equip.checkWithTrigger(64)){var o=.5;this.opponent.equip.checkWithTrigger(54)&&(o+=.25),this.equip.checkWithTrigger(56)&&(o-=.25),this.equip.checkWithTrigger(113)&&(o*=2),this.opponent.equip.checkWithTrigger(113)&&(o*=2),t=Math.floor(t*(o+1))}if(this.opponent.equip.checkWithTrigger(21)&&(t+=1),this.opponent.host.hp<10&&this.opponent.equip.checkWithTrigger(75)&&(t+=3),this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(t=0),t>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),t=1),t>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),t=1),t>0&&this.equip.checkWithTrigger(114)&&t--,9==i&&t>0&&this.opponent.host.onHeal(t),this.opponent.equip.suckRemainder+=t,this.opponent.equip.trigger(23),this.buff.atkBack>0&&0==e&&t>0&&this.opponent.host.onHurt(this.buff.atkBack,1),t>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(t,2),this.assertHpChange(-t),this.host.armor>0){if(this.host.armor>=t)return void this.host.updateArmor(-t);t-=this.host.armor,this.host.updateArmor(-this.armor)}this.host.hp-=t,this.host.hp<=0&&this.buff.undead>0&&(this.host.hp=1),this.host.hp<=0&&this.equip.trigger(10),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},onHeal:function(t){this.equip.checkWithTrigger(76)&&(t=Math.floor(1.5*t)),this.host.hp+=t,this.equip.trigger(102)},assertHpChange:function(t){this.showQueue.push(t),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var t=this.showQueue[0],e=cc.instantiate(this.host.txtNum);e.getComponent(cc.Label).string="\u95ea\u907f"==t?"\u95ea\u907f":t>0?"+"+t:0==t?"-0":t,e.position=this.host.txtNum.position,this.node.addChild(e),e.scale=.8,e.color=t-0==null||t>0?cc.color(0,255,0):cc.color(255,0,0);var i=cc.spawn(cc.moveBy(.5,cc.v2(0,150)),cc.fadeTo(.5,100),cc.scaleTo(.5,1));e.runAction(cc.sequence(cc.scaleTo(.1,1.1),i,cc.callFunc(function(){e.destroy()}.bind(this)))),e.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this))))},getEmptyIndex:function(){for(var t=0;t<6;t++){for(var e=!1,i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==t){e=!0;break}}if(!e)return t}return-1}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],PotionCommodity:[function(t,e,i){"use strict";cc._RF.push(e,"85c55EVbbNKe72lZU+lcHho","PotionCommodity"),cc.Class({extends:cc.Component,properties:{txtName:cc.Label},init:function(t){this.txtName.string="\u751f\u547d +"+10*t}}),cc._RF.pop()},{}],ShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"47158KpbiJMF46lKbQmGdRL","ShopItem");var o=t("Game"),s=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,potionPrefab:cc.Prefab,txtCost:cc.Label,txtDiscount:cc.Node},init:function(t,e,i){this.cfgId=t,this.type=e;var o=void 0;0==e?((o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(t),this.cost=3*s.get("cfg_card",t).value):1==e?((o=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(t),this.cost=6*s.get("cfg_item",t).value):((o=cc.instantiate(this.potionPrefab)).getComponent("PotionCommodity").init(t),this.cost=1==t?20:50),o.position=cc.v2(0,40),this.node.addChild(o),i&&(this.txtDiscount.active=!0,this.cost=Math.ceil(this.cost/3)),this.txtCost.string=this.cost},buy:function(){if(o.copper>=this.cost){o.copper-=this.cost,0==this.type?o.getCard(this.cfgId):1==this.type?o.getItem(this.cfgId):o.hp=Math.min(o.hp+10*this.cfgId,o.hpMax);var t=o.shopIds.indexOf(this.cfgId);o.shopIds[t]=0,this.node.destroy(),window.homeLayer.refreshHeroData()}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(t,e,i){"use strict";cc._RF.push(e,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{box:cc.Node,shopItemPrefab:cc.Prefab},onLoad:function(){window.shopLayer=this,this.initCards(),this.initEquip(),this.initPotions()},initCards:function(){for(var t=0;t<3;t++){var e=o.shopIds[t];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,0,t==o.discountCard),i.position=cc.v2(t%3*240-240,320),this.box.addChild(i)}}},initEquip:function(){for(var t=0;t<3;t++){var e=o.shopIds[t+3];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,1,t==o.discountItem),i.position=cc.v2(t%3*240-240,0),this.box.addChild(i)}}},initPotions:function(){for(var t=0;t<2;t++){var e=o.shopIds[t+6];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,2),i.position=cc.v2(t%3*240-240,-320),this.box.addChild(i)}}},close:function(){this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Skill:[function(t,e,i){"use strict";cc._RF.push(e,"6e80c9wWaBN46xspVtDUxQZ","Skill");var o={doCast:function(t){var e=window.mainLayer.hero,i=window.mainLayer.enemy;0==t?i.onHurt(5,4):1==t&&(e.buff.doubleDmg*=2)}};e.exports=o,cc._RF.pop()},{}],TreasureLayer:[function(t,e,i){"use strict";cc._RF.push(e,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var o=t("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,btnGets:[cc.Node],btnClose:cc.Node},init:function(t){this.isBoss=t;for(var e=0,i=t?[[.5,.3,.2],[.2,.4,.4],[0,.5,.5]]:[[.6,.3,.1],[.3,.4,.3],[.1,.4,.5]],s=Math.random(),n=0,c=0;c<3;c++)s<(n+=i[o.castle-1][c])&&(e=c+1);5==o.roomType?e++:o.itemEffect.vase>0&&(o.itemEffect.vase--,e++,0==o.itemEffect.vase&&o.deleteItem(28)),e=Math.min(e,3),this.cfgIdList=[];var r=1;t?r=2:o.itemEffect.flagon>0&&(o.itemEffect.flagon--,r=2,0==o.itemEffect.flagon&&o.deleteItem(29));var a=o.getNewItemId(t?2:0,e);if(this.cfgIdList.push(a),2==r){for(var h=0;h<=0;){var d=o.getNewItemId(t?2:0,e);d!=a&&(h=d)}this.cfgIdList.push(h)}this.initItem(),this.itemGot=0},initItem:function(){var t;1==this.cfgIdList.length?((t=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[0]),t.position=cc.v2(0,70),this.node.addChild(t)):((t=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[0]),t.position=cc.v2(-165,70),this.node.addChild(t),(t=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[1]),t.position=cc.v2(165,70),this.node.addChild(t),this.btnGets[1].active=!0,this.btnClose.position=cc.v2(0,-425))},onGet:function(t,e){o.getItem(this.cfgIdList[e]),this.isBoss?this.close():(this.btnGets[e].active=!1,this.itemGot++,this.itemGot>=this.cfgIdList.length&&this.close())},onGiveUp:function(){this.close()},close:function(){this.node.destroy(),window.homeLayer.btnAlter.node.active=!1}}),cc._RF.pop()},{Game:"Game"}],Utils:[function(t,e,i){"use strict";cc._RF.push(e,"85bfaYPayFNlrAFvtzNUMAc","Utils");var o={numberFormat:function(t){return t/1e13>=1?Math.floor(t/1e12)+"T":t/1e10>=1?Math.floor(t/1e9)+"B":t/1e7>=1?Math.floor(t/1e6)+"M":t/1e4>=1?Math.floor(t/1e3)+"K":t},timeFormat:function(t,e){var i=Math.round(t/1e3),o=i%60,s=e>1?Math.floor(i/60)%60:Math.floor(i/60),n=3==e?Math.floor(i/3600)%24:Math.floor(i/3600),c=Math.floor(i/86400),r=function(t){return t<10?"0"+t:t};return 1==e?r(s)+":"+r(o):2==e?r(n)+":"+r(s)+":"+r(o):c+"\u5929"+n+"\u65f6"+s+"\u5206"},getDifferentRandomNum:function(t,e,i){e=e||1,i=i||0;for(var o=[];o.length<t;){for(var s=Math.floor(Math.random()*(e-i+1))+i,n=!1,c=0;c<o.length;c++)if(o[c]-s==0){n=!0;break}n||o.push(s)}return o},createImage:function(t,e){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var t=new cc.Texture2D;t.initWithElement(i),t.handleLoadedTexture(),e.spriteFrame=new cc.SpriteFrame(t)}catch(t){cc.log(t),e.node.active=!1}},i.src=t}catch(t){cc.log(t),e.node.active=!1}else try{cc.loader.load({url:t,type:"jpg"},function(t,i){e.spriteFrame=new cc.SpriteFrame(i)})}catch(t){cc.log(t),e.node.active=!1}},substring:function(t,e){if(t.replace(/[\u4e00-\u9fa5]/g,"**").length<=e)return t;for(var i=0,o="",s=0;s<t.length&&(/[\u4e00-\u9fa5]/.test(t[s])?i+=2:i+=1,!(i>e));s++)o+=t[s];return o},getMd5Url:function(t){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(t)):cc.url.raw(t)},numToStr:function(t,e){e=e||1;for(var i=""+t,o=1;o<=e;o++)t<Math.pow(10,o)&&(i="0"+i);return i}};e.exports=o,cc._RF.pop()},{}],Yahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee"),cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label},onLoad:function(){window.yahtzeeLayer=this},start:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),this.roundId=1,this.hostId=0,this.doRound()},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,window.player.startRound()},endRound:function(){for(var t=this,e=function(e){var i=t.hero.diceList[e];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,350)),cc.delayTime(1.5),cc.callFunc(function(){this.hero.dicePool.put(i)}.bind(t))))},i=0;i<5;i++)e(i);var o=function(e){var i=t.enemy.diceList[e];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-200)),cc.delayTime(1.5),cc.callFunc(function(){this.enemy.dicePool.put(i)}.bind(t))))};for(i=0;i<5;i++)o(i);this.scheduleOnce(function(){this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.hero.doWin():this.hero.score<this.enemy.score?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),1.5),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(t){var e=cc.instantiate(this.endPrefab);e.getComponent("EndYahtzeeLayer").init(t),this.node.addChild(e)}}),cc._RF.pop()},{}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardCollection","CardManager","CompleteLayer","Config","Dice","DiceYahtzee","Edit","EditEndLayer","EndLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","HelloWorld","Hero","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerYahtzee","PotionCommodity","ShopItem","ShopLayer","Skill","TreasureLayer","Utils","Yahtzee"]);