window.__require=function e(t,i,o){function c(n,r){if(!i[n]){if(!t[n]){var a=n.split("/");if(a=a[a.length-1],!t[a]){var h="function"==typeof __require&&__require;if(!r&&h)return h(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+n+"'")}}var d=i[n]={exports:{}};t[n][0].call(d.exports,function(e){return c(t[n][1][e]||e)},d,d.exports,e,t,i,o)}return i[n].exports}for(var s="function"==typeof __require&&__require,n=0;n<o.length;n++)c(o[n]);return c}({AIYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){var i=this.player.diceList[t].getComponent("DiceYahtzee");e[i.element-1]++}for(var o=-1,c=-1,s=0;s<6;s++)e[s]>(e[o]||0)&&(o=s);for(var n=0;n<6;n++)n!=o&&e[n]>(e[c]||0)&&(c=n);this.scheduleOnce(function(){e[o]>1?e[o]==e[c]?this.hold(o,c):this.hold(o):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(e,t){for(var i=0,o=0;o<5;o++){var c=this.player.diceList[o].getComponent("DiceYahtzee");c.holded?c.element!=e+1&&null!=t&&c.element!=t+1&&(c.doHold(),i++):(c.element==e+1||null!=t&&c.element==t+1)&&(c.doHold(),i++)}var s=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),s)}}),cc._RF.pop()},{}],AI:[function(e,t,i){"use strict";cc._RF.push(t,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy"),this.castList=[]},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var e=1,t=100,i=null,o=0;o<this.cards.length;o++){var c=this.cards[o].getComponent("Card");c.usable&&(c.cfg.priority<t||c.cfg.priority==t&&c.rate>e)&&(e=c.rate,t=c.cfg.priority,i=c)}i?i.cast():this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.8):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.6)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var e=[0,0,0,0,0,0],t=0;t<this.cards.length;t++){var i=this.cards[t].getComponent("Card");(m=i.require.split(";")).length>1&&e[m[0]-1]++;for(var o=["A","B","C","D","E","F"],c=0;c<6;c++)if(i.cfg.desc.indexOf(o[c])>=0){e[c]++;break}}for(var s=!1,n=0;n<6;n++)if(e[n]>0){s=!0;break}for(var r=[],a=0;a<this.cards.length;a++){var h=this.cards[a].getComponent("Card"),d=[0,0,0,0,0,0];if(h.require>=101&&h.require<=105){for(var l=0,f=0,p=0;p<6;p++)(!s||e[p]>0)&&this.player.elementList[p]>l&&(l=this.player.elementList[p],f=p+1);if(d=[-100,-100,-100,-100,-100,-100],l>=s||2){d[f-1]=[2,3,3,4,5][h.require-101]-l}}else{var u=[0,0,0,0,0,0];if(106==h.require||107==h.require)u=[1,1,1,1,1,1];else for(var m=h.require.split(";"),g=0;g<m.length;g++)u[m[g]-1]++;for(var w=["A","B","C","D","E","F"],v=0;v<6;v++){var y=u[v];h.cfg.desc.indexOf(w[v])>=0&&(y=this.player.elementList[v]+1),d[v]=y-this.player.elementList[v]}}r.push(d)}for(var b=100,C=0,x=0,L=1,k=0;k<r.length;k++){for(var q=r[k],I=0,R=0,B=0;B<q.length;B++)I+=q[B]<-10?0:Math.abs(q[B]),R+=q[B];(I<b||I==b&&R>C||I==b&&R==C&&this.cards[k].getComponent("Card").rate<L)&&(b=I,C=R,x=k,L=this.cards[k].getComponent("Card").rate)}for(var T=r[x],F=0;F<6;F++)if(0!=T[F]){var E=T[F]+this.player.elementList[F]-this.player.holdList[F];if(E>0)for(var M=0;M<this.dices.length;M++){var D=this.dices[M].getComponent("Dice");if(D.element==F+1&&!(D.holded||D.lock||D.freeze||D.temp)&&(D.hold(),0==--E))break}else if(E<0)for(var P=0;P<this.dices.length;P++){var A=this.dices[P].getComponent("Dice");if(A.element==F+1&&A.holded&&!A.lock&&!A.freeze&&!A.temp&&(A.hold(),0==++E))break}}this.player.roll();for(var N=!1,_=0;_<this.dices.length;_++){var S=this.dices[_].getComponent("Dice");if(!(S.holded||S.lock||S.freeze||S.temp)){N=!0;break}}this.scheduleOnce(function(){N?this.check():this.player.endRound()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var e=0;e<this.player.cardList.length;e++){var t=this.player.cardList[e].getComponent("Card");t.silence||t.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(t)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var o=this.player.diceList[i];o.lock||this.dices.push(o)}},insertAndCast:function(e){}}),cc._RF.pop()},{}],Buff:[function(e,t,i){"use strict";cc._RF.push(t,"76faa8y1jVIcqDL176r9ktK","Buff"),cc.Class({extends:cc.Component,properties:{buffBox:cc.Node,txtBuff:cc.RichText},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.doubleDmg=1,this.doubleCast=0,this.multiCast=0,this.multiCastMax=0,this.selfHarmCast=0,this.selfHarmCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.burnIce=!1,this.silenceDark=!1,this.table={};for(var e=[13,21,22,23,24,25,26,27,28,101,102,103,104,105,106],t=0;t<e.length;t++)this.table[e[t]]=0;this.quote(),this.refreshBuff()},addBuff:function(e,t){if(!(t<=0)){if(13==e)this.player.anim.show(13);else if(e>=21&&e<=28){if(this.immunity>0)return this.removeBuff(105,1),this.player.equip.doTrigger(37),void this.player.assertHpChange("MISS",3);if(e<=26){if(this.opponent.equip.checkWithTrigger(e+10))t+=26==e?2:1;23==e&&this.opponent.equip.trigger(68)}this.player.anim.show(e)}this.table[e]+=t,this.quote();for(var i=!1,o=0;o<this.buffList.length;o++)if(this.buffList[o]==e){i=!0;break}i||this.buffList.push(e),this.refreshBuff()}},removeBuff:function(e,t){if(!(t<=0)){if(this.table[e]-=t,this.table[e]<=0){this.table[e]=0;var i=this.buffList.indexOf(e);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28],this.exRound=this.table[101],this.undead=this.table[102],this.atkBack=this.table[103],this.atkAdd=this.table[104],this.immunity=this.table[105],this.hurtReduce=this.table[106]},refreshBuff:function(){var e="",t={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",101:"\u989d\u5916\u56de\u5408",102:"\u4e0d\u6b7b",103:"\u53cd\u4f24",104:"\u4f24\u5bb3\u63d0\u5347",105:"\u514d\u75ab",106:"\u53d7\u4f24\u964d\u4f4e"},i={13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",101:"FFF830",102:"FF5567",103:"FF5567",104:"FFF830",105:"42EBFF",106:"FF5567"};if(1==this.buffList.length){var o=this.buffList[0];e+="<img src='"+this.getBuffImg(o)+"'/>",e+="<color="+i[o]+">"+t[o]+this.table[o]+"</c>"}else for(var c=0;c<this.buffList.length;c++){var s=this.buffList[c];e+="<img src='"+this.getBuffImg(s)+"'/>",e+="<color="+i[s]+">"+this.table[s]+"</c>  "}if(this.player.host.txtBuff.string=e,this.buffBox.active){e="";for(var n=0;n<this.buffList.length;n++){var r=this.buffList[n];e+="<img src='"+this.getBuffImg(r)+"'/>",e+="<color="+i[r]+">"+t[r]+this.table[r]+"</c>  ",(n+1)%3==0&&this.buffList.length>n+1&&(e+="\r\n")}this.txtBuff.string=e,this.buffBox.height=44+30*Math.floor((this.buffList.length-1)/3)}},getBuffImg:function(e){var t={13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",101:"exRound",102:"undead",103:"atkback",104:"atkAdd",105:"immunity",106:"hurtReduce"}[e];if(23==e){var i=0;(this.opponent.equip.check(54)||this.opponent.equip.check(113)||this.player.equip.check(113))&&i++,this.player.equip.check(56)&&i--,i>0?t="frailPlus":i<0&&(t="frailMinus")}else 24==e&&this.opponent.equip.check(55)&&(t="weakPlus");return t},openBuffList:function(){if(!(this.buffList.length<=1)){if(window.mainLayer.buffTip){if(window.mainLayer.buffTip==this)return void this.hideTip();window.mainLayer.buffTip.hideTip()}this.buffBox.active=!0,this.refreshBuff(),window.mainLayer.buffTip=this,this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.buffBox.active=!1,window.mainLayer.buffTip=null}}),cc._RF.pop()},{}],CampLayer:[function(e,t,i){"use strict";cc._RF.push(t,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},onHeal:function(){var e=1;o.equip.indexOf(39)>=0&&(e+=.5),o.equip.indexOf(89)>=0&&(e-=.5);var t=Math.floor(.35*o.hpMax*e);o.hp=Math.min(o.hp+t,o.hpMax),this.close()},onCopper:function(){o.copper+=7*(o.castle+3),this.close()},close:function(){this.node.destroy(),window.homeLayer.refreshHeroData(),window.room.btnAlter.node.active=!1,o.floorBeats[o.floor-1]=!0}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,chestPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node,mask:cc.Node},onLoad:function(){window.bagLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var e=0;window.equipLayer?(e=.15,window.equipLayer.close()):window.mapLayer&&(e=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initDeck(),this.initBag(),o.newCard&&(o.newCard=!1,window.homeLayer.refreshHeroData())},initDeck:function(){this.deck=[];for(var e=2==o.heroId?2:3,t=0;t<o.deck.length;t++){var i=cc.instantiate(this.cardPrefab);i.getComponent("CardCollection").init(o.deck[t],0),i.position=cc.v2(t%e*247-247,104-210*Math.floor(t/e)),this.boxDeck.addChild(i),this.deck[t]=i}if(2==o.heroId){var c=cc.instantiate(this.chestPrefab);c.position=cc.v2(240,0),this.boxDeck.addChild(c)}},initBag:function(){o.cardBag.sort(function(e,t){return c.get("cfg_card",e).element==c.get("cfg_card",t).element?e-t:c.get("cfg_card",e).element-c.get("cfg_card",t).element}),this.bagList=[];for(var e=0;e<o.cardBag.length;e++){var t=cc.instantiate(this.cardPrefab);t.getComponent("CardCollection").init(o.cardBag[e],1),t.position=cc.v2(e%3*247-247,-120-210*Math.floor(e/3)),this.content.addChild(t),this.bagList.push(t)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+530,this.content.height=Math.max(210*Math.ceil(o.cardBag.length/3)+20,this.contentHeight)},equip:function(e){for(var t=-1,i=2==o.heroId?4:6,c=0;c<i;c++)if(null==this.deck[c]){t=c;break}if(t>=0){e.parent=this.boxDeck;var s=2==o.heroId?2:3;e.position=cc.v2(t%s*247-247,104-210*Math.floor(t/s)),e.getComponent("CardCollection").colletType=0;var n=e.getComponent("CardCollection").cfgId;this.deck[t]=e;var r=o.cardBag.indexOf(n);o.cardBag.splice(r,1);r=this.bagList.indexOf(e);this.bagList.splice(r,1),this.refreshBag()}},unEquip:function(e){var t=this.deck.indexOf(e);this.deck[t]=null;for(var i=o.cardBag.length,s=e.getComponent("CardCollection").cfgId,n=0;n<o.cardBag.length;n++)if(c.get("cfg_card",s).element<c.get("cfg_card",o.cardBag[n]).element||c.get("cfg_card",s).element==c.get("cfg_card",o.cardBag[n]).element&&s<o.cardBag[n]){i=n;break}o.cardBag.splice(i,0,s),this.bagList.splice(i,0,e),e.parent=this.content,e.position=cc.v2(i%3*247-247,-120-210*Math.floor(i/3)),e.getComponent("CardCollection").colletType=1,this.refreshBag()},refreshBag:function(){for(var e=0;e<this.bagList.length;e++)this.bagList[e].runAction(cc.moveTo(.15,cc.v2(e%3*247-247,-120-210*Math.floor(e/3))));this.content.height=Math.max(210*Math.ceil(o.cardBag.length/3)+20,this.contentHeight)},close:function(){o.deck=[];for(var e=0;e<6;e++)null!=this.deck[e]&&o.deck.push(this.deck[e].getComponent("CardCollection").cfgId);this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null,window.homeLayer.btnDeck.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardCollection:[function(e,t,i){"use strict";cc._RF.push(t,"a28bfVp4ABL54sr47isHV8F","CardCollection");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,btn:cc.Button,box:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,markDelete:cc.Node},init:function(e,t){this.cfgId=e,this.cfg=c.get("cfg_card",e);var i=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],s=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],n=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.element=this.cfg.element,this.btn.node.color=i[this.element-1],this.box.color=s[this.element-1],this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=n[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.txtDesc.string=o.analysisDesc(this.cfg.desc1);var r=this.cfg.require;if(r>=101&&r<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][r-101];for(var a=[[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][r-101],h=0;h<a.length;h++)this.createCircle(0,a[h])}else{this.requireNode.y-=8;for(var d=r.split(";"),l=(a=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][d.length-1],0);l<d.length;l++)this.createCircle(parseInt(d[l]),a[l])}null!=t&&(this.btn.interactable=!0,this.colletType=t)},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.requireNode.addChild(i),e>0&&i.getComponent("RequireRound").refreshSatisfy(!0)},changeCollectType:function(){0==this.colletType?window.bagLayer.unEquip(this.node):window.bagLayer.equip(this.node)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardManager:[function(e,t,i){"use strict";cc._RF.push(t,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var o=e("Game"),c=e("Config"),s={doCast:function(e,t){this.cfgId=e;var i=c.get("cfg_card",e);if(this.desc=i.desc,this.card=t,(1==i.target1||1==i.target2||1==i.target3)&&(window.player.atkPlayed++,window.opponent.buff.dodge>0))return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("MISS",2),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(e)},doEffect:function(e,t,i){var o=null,c=(o=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,s=window.player.buff,n=0,r=1;if((t+="")<0){for(var a=["A","B","C","D","E","F"],h=0,d=0;d<6;d++)if(this.desc.indexOf(a[d])>=0){h=d;break}n=window.player.elementList[h]*Math.abs(parseInt(t))}else{var l=t.split(";");if(8==e)n=parseInt(l[0]),r=parseInt(l[1]);else if(1==l.length)n=parseInt(t);else{var f=parseInt(l[0]),p=parseInt(l[1]);n=window.player.equip.checkWithTrigger(120)?p:Math.floor(Math.random()*(p-f+1))+f}}if(e<10){if(1==i&&(n*=s.doubleDmg,s.doubleDmg=1),s.weak>0&&!window.player.equip.checkWithTrigger(65)){var u=.7;window.opponent.equip.checkWithTrigger(55)&&(u=.5),n=Math.floor(n*u)}1==window.player.atkPlayed&&window.player.equip.checkWithTrigger(100)&&(n*=2);for(var m=0;m<r;m++)o.onHurt(n,0,e)}else 11==e?o.updateArmor(n):12==e?o.onHeal(n):14==e?o.addPower&&o.addPower(n):(13==e||e>=21)&&c.addBuff(e,n)},doSpecial:function(e){var t=window.opponent.buff,i=window.player.buff;if(132==e)this.doEffect(11,window.host.armor,2);else if(133==e)this.doEffect(7,window.host.armor,1);else if(134==e)this.doEffect(7,2*window.host.armor,1),this.doEffect(11,-window.host.armor,2);else if(135==e)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==e)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==e)this.doEffect(7,Math.floor(window.host.hp/2),1);else if(138==e)i.addBuff(102,2);else if(139==e)i.addBuff(101,1);else if(140==e)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==e)window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==e)window.host.power&&(this.doEffect(11,2*window.host.power,2),window.host.addPower(-window.host.power));else if(143==e)window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==e)this.doEffect(7,2*t.poison,1);else if(145==e)this.doEffect(7,4*t.poison,1);else if(146==e)t.addBuff(26,t.poison);else if(147==e){var c=t.frail>0?12:6;this.doEffect(3,c,1)}else if(148==e){c=t.weak>0?12:6;this.doEffect(4,c,1)}else if(149==e)t.poison>0&&this.doEffect(26,1,1);else if(150==e){c=t.burn>0?20:10;this.doEffect(1,c,1)}else if(151==e)t.freeze>0&&this.doEffect(22,1,1);else if(152==e)t.silence>0&&this.doEffect(25,1,1);else if(e>=153&&e<=158){var s=[2,3,5,0,1,4][e-153];window.player.elementList[s]>=[2,2,2,3,3,3][e-153]&&this.doEffect(s+21,[1,1,2,2,2,1][e-153],1)}else if(e>=159&&e<=162)t.addBuff(Math.floor(8*Math.random())+21,162==e?2:1);else if(e>=163&&e<=166)i.doubleCast++;else if(167==e)i.multiCast++,i.multiCastMax++;else if(e>=168&&e<=171)i.doubleDmg*=2;else if(172==e)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-t.freeze,1);else if(173==e)this.doEffect(21,window.opponent.deck.length-t.burn,1);else if(174==e)this.doEffect(7,6*t.burn,1);else if(175==e)this.doEffect(7,6*t.freeze,1);else if(176==e)this.doEffect(7,6*t.silence,1);else if(177==e)this.doEffect(7,4*t.frail,1);else if(178==e)this.doEffect(7,4*t.weak,1);else if(e>=179&&e<=182){c=(n=[1,6,6,10])[e-179]+(r=[3,2,3,4])[e-179]*(i.iteraList[e-179]-1);this.doEffect(7,c,1)}else if(e>=183&&e<=186){var n=[8,13,15,21],r=[3,3,4,5],a=Math.min(i.iteraList[e-179]-1,[2,4,3,4][e-183]);c=n[e-183]-r[e-183]*a;this.doEffect(7,c,1)}else if(187==e)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==e)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==e)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==e)this.doEffect(1,10+3*i.elementRoundCasted[0],1);else if(191==e)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==e)this.doEffect(3,10+3*i.elementRoundCasted[2],1);else if(193==e){if((a=Math.min(window.opponent.deck.length,6))>0){var h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.opponent.deck.splice(h,1),window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(194==e){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d,!0),window.player.deck.push(d)}}else if(195==e){if((a=Math.min(window.opponent.deck.length,6))>0){h=Math.floor(Math.random()*a),d=window.opponent.deck[h];window.player.patchCard(d)}}else if(196==e){var l=o.getRandomCardId(2);window.player.patchCard(l,!0),window.player.deck.push(l)}else if(197==e){l=o.getRandomCardId(2);var f=window.player.patchCard(l,null,!0)}else if(198==e){var p=function(){var e=window.player.patchCard();2==e.getComponent("Card").element&&window.player.cardList.length<6?e.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){p()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&(window.mainLayer.gameOver||window.mainLayer.enemy.ai.check())}.bind(this),.8)}.bind(this);p()}else if(199==e)window.player.diceCount++,window.player.host.txtDice.string="\xd7"+window.player.diceCount,window.player.createExDice();else if(200==e)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==e){for(var u=21;u<=28;u++)i.removeBuff(u,i.table[u]);for(var m=0;m<window.player.cardList.length;m++)window.player.cardList[m].getComponent("Card").clear();for(var g=0;g<window.player.diceList.length;g++)window.player.diceList[g].getComponent("Dice").clear();window.player.checkElement()}else if(202==e){for(var w=0,v=21;v<=28;v++)t.table[v]>0&&w++;this.doEffect(7,5*w,1)}else if(203==e)window.player.rollCount++,0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll();else if(204==e)window.player.rollCount++,window.player.roll();else if(205==e){if(window.player.cardList.length>0){h=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[h].getComponent("Card").discard(),this.doEffect(7,12,1)}}else if(206==e||207==e){if(window.player.cardList.length>0){h=Math.floor(Math.random()*window.player.cardList.length);(f=window.player.cardList[h].getComponent("Card")).remove(),f.doDelete(),this.doEffect(7,206==e?20:30,1)}}else if(208==e){this.doEffect(7,5*window.player.cardList.length,1);for(var y=window.player.cardList.length-1;y>=0;y--)window.player.cardList[y].getComponent("Card").discard();window.player.cardList=[]}else if(e>=209&&e<=214){n=214==e?2:1;this.doEffect(e-209+21,n+i.iteraList2[e-209]-1,1)}else if(215==e)window.opponent.buff.burnIce=!0;else if(216==e)window.opponent.buff.silenceDark=!0;else if(217==e)o.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(218==e){l=o.getRandomCardId(2);window.player.patchCard(l)}else 219==e?window.player.patchCard():220==e?this.doEffect(3,2*window.player.atkRound-1,1):221==e?(i.selfHarmCast++,i.selfHarmCastMax++):222==e&&(window.host.hpMax+=20,window.host.hp+=20,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax)}};t.exports=s,cc._RF.pop()},{Config:"Config",Game:"Game"}],Card:[function(e,t,i){"use strict";cc._RF.push(t,"cfa35/uH59ANIsjw79G+feg","Card");var o=e("Game"),c=e("Config"),s=e("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,box:cc.Node,fires:dragonBones.ArmatureDisplay,nodeSilence:cc.Node,markSilence:cc.Node,animationCursed:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(e,t,i){this.cfgId=e,this.index=t,this.buffId=i,this.pos=cc.v2(t%3,Math.floor(t/3)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(248*this.pos.x-248,95-206*this.pos.y-500*this.delta),this.node.opacity=0;var o=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-206*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(0==window.mainLayer.roundId?1-this.pos.y:this.pos.y)),o,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),this.cfg=c.get("cfg_card",e),this.element=this.cfg.element,this.initInfo(),this.mask.active=!0,this.btn.node.active=!0,this.nodeSilence.active=this.fires.node.active=this.animationCursed.active=this.animationDiscard.node.active=!1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1,this.hasCopy=!1,this.unCost=!1,this.rate=1;var s=this.require=this.cfg.require;if(s>=101&&s<=107){this.rate=[1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][s-101]}else{this.rate=[1/6,1/36,1/216,1/1296,1/7776][s.split(";").length-1]}},initInfo:function(){var e=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],t=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],i=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.btn.node.color=e[this.element-1],this.box.color=t[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.initDesc(),this.circleNode.removeAllChildren(),this.requireCircles=[];var o=this.cfg.require;if(this.requireNode.y=0,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),o>=101&&o<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][o-101];for(var c=[[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][o-101],s=0;s<c.length;s++)this.createCircle(0,c[s])}else{this.txtRequire.string="",this.requireNode.y-=8;for(var n=o.split(";"),r=(c=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][n.length-1],0);r<n.length;r++){this.createCircle(parseInt(n[r]),c[r]).zIndex=4-r}}},initWithCopy:function(e,t){this.cfgId=e,this.pos=t,this.isCopy=!0,this.isTemp=!0,this.cfg=c.get("cfg_card",e),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(){if(this.btn.interactable=!1,0==window.mainLayer.roundId){var e=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{e=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var t=window.player.cardList.indexOf(this.node);t>=0&&(window.player.cardList.splice(t,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())},createCircle:function(e,t){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(e,this.element),i.position=cc.v2(t,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},initBuff:function(){var e=this.buffId;this.burn=21==e,this.burn?(this.fires.node.active=!0,this.fires.playAnimation("play0",0)):this.fires.node.active=!1,this.silence=25==e,this.silence?(this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.nodeSilence.active=!0}.bind(this)))),this.titles[1].active=!1,this.markSilence.stopAllActions(),this.markSilence.y=130,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5)))):(this.nodeSilence.active=!1,this.titles[1].active=3==this.cfg.quality)},checkRequire:function(){var e=!1,t=window.player.elementList.concat();if(this.require>=101&&this.require<=105){for(var i=[2,2,3,4,5],o=102==this.require?2:1,c=[],s=0;s<6;s++)t[s]>=i[this.require-101]&&(o--,c.push(s+1)),102==this.require&&t[s]>=4&&(o-=2,c.push(s+1),c.push(s+1));if(o<=0&&(e=!0),102!=this.require){var n=0,r=this.requireCircles[0].getComponent("RequireRound").element;if(r)c.indexOf(r)<0&&(n=c.length>0?1:-1);else c.length>0&&(n=1);for(var a=0;a<this.requireCircles.length;a++){var h=this.requireCircles[a].getComponent("RequireRound");1==n?(h.refreshElement(c[0]),h.refreshSatisfy(!0)):-1==n&&h.hideElement()}}else{var d,l=[null,null],f=[0,0],p=this.requireCircles[0].getComponent("RequireRound").element,u=this.requireCircles[2].getComponent("RequireRound").element;if(p)(d=c.indexOf(p))>=0&&(l[0]=0,c.splice(d,1),f[0]=p);if(u)(d=c.indexOf(u))>=0&&(l[1]=0,c.splice(d,1),f[1]=p);for(var m=0;m<2;m++){if(null==l[m])(0==m?p:u)?c.length>0?(l[m]=1,f[m]=c[0],c.splice(0,1)):l[m]=-1:c.length>0?(l[m]=1,f[m]=c[0],c.splice(0,1)):l[m]=0}for(var g=0;g<this.requireCircles.length;g++){var w=this.requireCircles[g].getComponent("RequireRound"),v=g<2?0:1;1==l[v]?(w.refreshElement(f[v]),w.refreshSatisfy(!0)):-1==l[v]&&w.hideElement()}}}else{for(var y=[0,0,0,0,0,0],b=this.require.split(";"),C=0;C<b.length;C++)y[b[C]-1]++;e=!0;for(var x=0;x<6;x++)if(t[x]<y[x]){e=!1;break}for(var L=0;L<this.requireCircles.length;L++){var k=this.requireCircles[L].getComponent("RequireRound");t[k.element-1]>0?(k.refreshSatisfy(!0),t[k.element-1]--):k.refreshSatisfy(!1)}}return this.unCost&&(e=!0),this.silence&&(e=!1),this.usable=e,e?(this.mask.active=!1,this.btn.interactable=!0):this.silence?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),e},doCast:function(){0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c"):this.silence?(this.markSilence.stopAllActions(),this.markSilence.y=90,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,15)),cc.delayTime(.5),cc.fadeOut(.5)))):this.cast())},cast:function(){if(0==window.mainLayer.roundId){if(this.cfgId>=205&&this.cfgId<=208&&!window.player.cardUsabled)return}else if(!window.player.cardUsabled)return;this.burn&&window.host.onHurt(3,1,21);var e=!1,t=window.opponent.equip.check(107)?.8:.5;if(window.player.buff.curse&&Math.random()<t&&(e=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.trigger(108)),this.btn.interactable=!1,window.player.cardUsabled=!1,e)this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1;var e=cc.instantiate(this.animationCursed);e.active=!0,e.parent=window.player.boxCard,e.position=this.node.position.add(cc.v2(10,-10)),e.zIndex=100,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("play0"),e.getComponent(dragonBones.ArmatureDisplay).on(dragonBones.EventObject.COMPLETE,function(){e.destroy()}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1,this.endCast(),198==this.cfgId&&1==window.mainLayer.roundId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.5)}.bind(this))))}.bind(this))));else{var i=cc.spawn(cc.moveBy(.05,cc.v2(0,-20)),cc.scaleTo(.05,1)),o=cc.moveBy(.35,cc.v2(0,1100)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),i,o,cc.callFunc(function(){window.mainLayer.gameOver||(s.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var c=window.player.cardList.indexOf(this.node);c>=0&&(window.player.cardList.splice(c,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var n=0;n<3;n++)if(this.cfg["effect"+(n+1)]<10&&1==this.cfg["target"+(n+1)]){var r=1;8==this.cfg["effect"+(n+1)]&&(r=parseInt(this.cfg["num"+(n+1)].split(";")[1])),window.player.atkRound+=r}for(var a=0;a<window.player.cardList.length;a++){var h=window.player.cardList[a].getComponent("Card");(h.cfgId>=179&&h.cfgId<=186||h.cfgId>=209&&h.cfgId<=214||220==h.cfgId)&&h.initDesc()}e||this.isCopy||(this.cfgId<163||this.cfgId>166)&&(window.player.buff.selfHarmCast>0&&this.cfg.effect1<10&&2==this.cfg.target1?(window.player.buff.selfHarmCast--,this.reuse()):window.player.buff.doubleCast>0?(window.player.buff.doubleCast--,this.reuse()):window.player.equip.luckyCard>0?(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1)):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)&&167!=this.cfgId?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)&&this.reuse()),this.isRemove&&this.doDelete()},endCast:function(){if(!this.isCopy){window.player.cardPlayed++,window.player.cardPlayedRound++;var e=window.player.equip;e.trigger(1),e.trigger(4),e.trigger(this.cfg.element+77),e.trigger(97),window.opponent.equip.trigger(24)}window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.selfHarmCastMax>0&&window.player.buff.selfHarmCast<=0&&(window.player.buff.selfHarmCast=window.player.buff.selfHarmCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++,window.player.cardPool.put(this.node),window.player.cardUsabled=!0,1!=window.mainLayer.roundId||this.hasCopy||198!=this.cfgId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.6)},discard:function(){this.btn.interactable=!1,this.btn.node.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this))));var e=window.player.cardList.indexOf(this.node);e>=0&&(window.player.cardList.splice(e,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll()),window.player.equip.trigger(22)},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),!this.isTemp){var e=window.player.deck.indexOf(this.cfgId);e>=0&&window.player.deck.splice(e,1)}},reuse:function(){var e=cc.instantiate(this.node);e.position=this.node.position,window.player.boxCard.addChild(e,this.node.zIndex-1),e.getComponent("Card").initWithCopy(this.cfgId,this.pos),this.hasCopy=!0,e.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){e.getComponent("Card").cast()}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},initDesc:function(){var e=o.analysisDesc(this.cfg.desc1);if(this.cfgId>=179&&this.cfgId<=182){var t=[3,2,2,4];e+="<color=#EBC82E>  (\u5f53\u524d"+((i=[1,6,6,10])[this.cfgId-179]+t[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var i=[8,13,13,18],c=(t=[3,3,3,4],Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,4,4][this.cfgId-183]));e+="<color=#EBC82E>  (\u5f53\u524d"+(i[this.cfgId-183]-t[this.cfgId-183]*c)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){e+="<color=#EBC82E>  (\u5f53\u524d"+((i=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}else 220==this.cfgId&&(e+="<color=#EBC82E>  (\u5f53\u524d"+(2*window.player.atkRound+1)+")</c>");this.txtDesc.string=e},disCost:function(){this.unCost=!0;for(var e=0;e<this.requireCircles.length;e++){var t=this.requireCircles[e].getComponent("RequireRound");t.disCost(),this.require>=101&&this.require<=105&&t.hideElement()}}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Chest:[function(e,t,i){"use strict";cc._RF.push(t,"282832AcdZFNov+QpH9gQcZ","Chest");var o=e("Utils");cc.Class({extends:cc.Component,properties:{txtRequire:cc.RichText,btn:cc.Button},init:function(e){this.index=e,this.node.position=cc.v2(240*e-240,-500),this.btn.node.color=cc.Color.GRAY,this.node.opacity=0;var t=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.3),t,cc.moveBy(.05,cc.v2(0,-20)))),this.satisfied=[!1,!1,!1,!1,!1,!1],this.requireList=o.getDifferentRandomNum(4,6,1),this.refreshRequire()},refreshRequire:function(){this.usable=!0;for(var e="",t=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],i=0;i<this.requireList.length;i++){var o=this.requireList[i];this.satisfied[o-1]?e+="<color=#EBC82E>"+t[o-1]+"</c>":(e+="<color=#000000>"+t[o-1]+"</c>",this.usable=!1)}this.txtRequire.string=e,this.usable&&(this.btn.interactable=!0,this.btn.node.color=cc.Color.WHITE)},remove:function(){this.btn.interactable=!1;var e=cc.moveBy(.2,cc.v2(0,-500));this.node.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.1,cc.v2(0,20)),e,cc.callFunc(function(){this.node.destroy()}.bind(this)))),window.player.chestList[this.index]=null},checkRequire:function(){for(var e=window.player.elementList,t=0;t<6;t++)e[t]>0&&!this.satisfied[t]&&(this.satisfied[t]=!0);this.refreshRequire()},doCast:function(){this.remove();for(var e=0;e<6;e++)window.player.patchCard()}}),cc._RF.pop()},{Utils:"Utils"}],CompleteLayer:[function(e,t,i){"use strict";cc._RF.push(t,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){o.setDataToBase(),cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],Config:[function(e,t,i){"use strict";cc._RF.push(t,"e9b6cHrlOtILogPlENB3GXp","Config");var o={jsonTable:{},load:function(e){for(var t=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event"],o=0,c=function(c){n="Config/"+i[c],cc.loader.loadRes(n,function(t,s){this.jsonTable[i[c]]=s.json,(o+=1)==i.length&&e()}.bind(t))},s=0;s<i.length;s++){var n;c(s)}},get:function(e,t){return this.jsonTable[e][t]}};t.exports=o,cc._RF.pop()},{}],CoverLayer:[function(e,t,i){"use strict";cc._RF.push(t,"8cf180RYjFDS416GS8jeF0h","CoverLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},gotoMain:function(e,t){t<=2&&(o.heroId=t,cc.director.loadScene("helloworld"))}}),cc._RF.pop()},{Game:"Game"}],DiceYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(e,t){this.id=e,this.index=t,this.player=0==t?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1,this.holded=!1;var i=this.delta=0==this.index?1:-1;this.node.position=cc.v2(110*e-220,-320*i),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*i)),cc.moveBy(.1,cc.v2(0,-20*i))))},roll:function(e){this.abled=!0,this.holded=!1;var t=this.player.holdList.indexOf(this.node);if(t>=0&&this.player.holdList.splice(t,1),!e){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var i=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=i[this.element-1]}var o=50*Math.random()+150*this.id-325,c=(460*Math.random()+240)*this.delta,s=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(o,c)),cc.rotateTo(.2,s)))},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var e=0;e<this.player.holdList.length;e++)this.player.holdList[e].runAction(cc.moveTo(.1,cc.v2(110*e-220,0)));this.player.txtBtn.string="\u6295\u63b7"}else this.hold()},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(e,t,i){"use strict";cc._RF.push(t,"24e6aDXOPZNaoyluEGeZSR/","Dice"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node,mask:cc.Node,markTemp:cc.Node},init:function(e,t){this.id=e,this.holded=!1,this.element=0,this.mask.active=!1,this.temp=!1,this.buffId=t,this.markIce.active=this.markIce.markLock=this.markTemp.active=!1},initBuff:function(){var e=this.buffId;this.freeze=22==e,this.markIce.active=this.freeze,this.lock=28==e,this.markLock.active=this.lock},roll:function(e){this.element=e||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this));var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=t[this.element-1],this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=200*-this.delta,this.node.opacity=0,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20*this.delta)),cc.moveTo(.1,cc.v2(this.node.x,0)))))},doHold:function(){0!=window.mainLayer.roundId||this.freeze||this.lock||this.temp||window.player.diceUsabld&&this.hold()},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)},remove:function(){var e=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),e,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},doTemp:function(){this.temp=!0,this.markTemp.active=!0;var e=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.markTemp.color=e[this.element-1]}}),cc._RF.pop()},{}],DmgAnimation:[function(e,t,i){"use strict";cc._RF.push(t,"267b8j4vWVAPaVTrMCIVdTi","DmgAnimation"),cc.Class({extends:cc.Component,properties:{atks:[dragonBones.ArmatureDisplay],heal:dragonBones.ArmatureDisplay,fireAtk:dragonBones.ArmatureDisplay,waterAtk:dragonBones.ArmatureDisplay,windAtk:dragonBones.ArmatureDisplay,earthAtk:dragonBones.ArmatureDisplay,lightAtk:dragonBones.ArmatureDisplay,darkAtk:dragonBones.ArmatureDisplay,armor:dragonBones.ArmatureDisplay,dodge:dragonBones.ArmatureDisplay,frail:dragonBones.ArmatureDisplay,weak:dragonBones.ArmatureDisplay,silence:dragonBones.ArmatureDisplay,poison:dragonBones.ArmatureDisplay,curse:dragonBones.ArmatureDisplay,lock:dragonBones.ArmatureDisplay,atkback:dragonBones.ArmatureDisplay,undead:dragonBones.ArmatureDisplay,revive:dragonBones.ArmatureDisplay},init:function(e){this.index=e,this.host=0==e?window.mainLayer.hero:window.mainLayer.enemy,this.step=0},show:function(e){var t;if(e<=6){var i=[this.fireAtk,this.waterAtk,this.windAtk,this.earthAtk,this.lightAtk,this.darkAtk];t=i[e-1]}else if(e>=7&&e<=9)(t=this.atks[this.step%3]).node.rotation=360*Math.random();else if(e<=13){i=[this.armor,this.heal,this.dodge];t=i[e-11]}else if(e>=21&&e<=29){i=[this.fireAtk,this.waterAtk,this.frail,this.weak,this.silence,this.poison,this.curse,this.lock,this.atkback];t=i[e-21]}else 201==e?t=this.undead:202==e&&(t=this.revive);t.node.active=!0,t.node.zIndex=this.step,t.playAnimation("play0"),t.on(dragonBones.EventObject.COMPLETE,function(){t.node.active=!1}.bind(this)),this.host.doShake(e),this.step++}}),cc._RF.pop()},{}],EditEndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){o.deck=o.editCfg.deckHero.split(";"),o.equip=o.editCfg.equip.split(";"),o.hp=o.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(e,t,i){"use strict";cc._RF.push(t,"463d3gvgvdIabmN6qTyXAVR","Edit");var o=e("Game");cc.Class({extends:cc.Component,properties:{editHpEnemy:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox,editId:cc.EditBox,editHpHero:cc.EditBox},onLoad:function(){o.editCfg&&(this.editHpEnemy.string=o.editCfg.hpEnemy,this.editDice.string=o.editCfg.dice,this.editDeckEnemy.string=o.editCfg.deckEnemy,this.editEquipEnemy.string=o.editCfg.equipEnemy,this.editDeckHero.string=o.editCfg.deckHero,this.editEquip.string=o.editCfg.equip,this.editHpHero.string=o.editCfg.hpHero),this.editId.string=o.heroId},goBattle:function(){o.editCfg={hpEnemy:this.editHpEnemy.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string,hpHero:this.editHpHero.string};var e=this.editDeckHero.string.split(";");o.deck=[];for(var t=0;t<e.length;t++)o.deck.push(parseInt(e[t]));var i=this.editEquip.string.split(";");o.equip=[];for(var c=0;c<i.length;c++)o.equip.push(parseInt(i[c]));o.hp=o.hpMax=parseInt(o.editCfg.hpHero),o.heroId=parseInt(this.editId.string),o.level=7,cc.director.loadScene("mainLayer")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(e,t,i){"use strict";cc._RF.push(t,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{btnClose:cc.Node,cardPrefab:cc.Prefab,txtReward:cc.Label,boxCard:cc.Node,btns:[cc.Node],txtCopper:cc.Label},onLoad:function(){window.endLayer=this,this.checkGameEnd(),window.mainLayer.hero.equip.check(26)?(o.hpMax+=6,o.hp+=6,this.txtReward.string="\u989d\u5916\u751f\u547d +6",this.boxCard.active=!1):this.initCards(),this.initCopper(),this.initExp(),o.floorBeats[o.floor-1]=!0,o.monsterBeats.push(o.monsterId)},initCards:function(){this.btnClose.active=!1;for(var e=0,t=[[.5,.5,0],[.5,.5,0],[0,.5,.5]],i=Math.random(),s=0,n=0;n<3;n++)if(i<(s+=t[o.castle-1][n])){e=n+1;break}this.cardIdList=[],this.cards=[];for(var r=0;r<=0;){var a=o.getNewCardId(e),h=c.get("cfg_card",a).require;(o.castle>1||2==h.split(";").length||h<=102)&&(r=a)}this.cardIdList.push(r);for(var d=0;d<=0;){var l=o.getNewCardId(e),f=c.get("cfg_card",l).require;l!=r&&(o.castle>1||2==f.split(";").length||f<=102)&&(d=l)}this.cardIdList.push(d);for(var p=0;p<2;p++){var u=cc.instantiate(this.cardPrefab);u.getComponent("CardCollection").init(this.cardIdList[p]),u.position=cc.v2(0==p?-160:160,40),this.boxCard.addChild(u),this.cards.push(u)}},checkGameEnd:function(){var e=window.mainLayer.hero.player;e.equip.trigger(7),e.equip.trigger(8)},choose:function(e,t){o.getCard(this.cardIdList[t]),this.cards[1-t].destroy(),this.cards[t].runAction(cc.moveTo(.2,cc.v2(0,40))),this.btns[0].active=this.btns[1].active=!1,this.btnClose.active=!0},initCopper:function(){var e=window.mainLayer.enemy.cfg.level,t=1,i=window.mainLayer.hero.player;i.equip.check(73)&&(t+=.5),o.itemEffect.pen>0&&(t+=1,o.itemEffect.pen--),i.equip.check(90)&&(t-=.5);var c=Math.max([6,8,10,12,14,16,0][e-1]*t,1);this.txtCopper.string="\u91d1\u5e01 +"+c,o.copper+=c},initExp:function(){var e=window.mainLayer.enemy.cfg.level;o.exp+=e;var t=o.level<7?3*o.level:99;o.exp>=t&&(o.exp-=t,o.level++,o.hpMax+=5,o.hp=window.mainLayer.hero.hp=o.hpMax,o.levelUp=!0)},close:function(){o.hp=Math.min(window.mainLayer.hero.hp,o.hpMax),o.power=window.mainLayer.hero.power,cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndYahtzeeLayer:[function(e,t,i){"use strict";cc._RF.push(t,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtName:cc.Label,cardPrefab:cc.Prefab,itemNode:cc.Node,txtItemName:cc.Label,txtItemDesc:cc.Label,itemChangeNode:cc.Node,txtChangeName1:cc.Label,txtChangeDesc1:cc.Label,txtChangeName2:cc.Label,txtChangeDesc2:cc.Label,losePrefab:cc.Prefab,txtChange:cc.Node,rewardNode:cc.Node},init:function(e){this.result=e;this.txtTitle.string=["\u4f60\u8f93\u4e86","\u5e73\u5c40","\u4f60\u8d62\u4e86","\u4f60\u79bb\u5f00\u4e86"][e+1],this.checkResult()},checkResult:function(){var e=o.eventId,t="";if(0==this.result||1==this.result)if(1==e)t="\u6062\u590d\u5168\u90e8\u751f\u547d",o.hp=o.hpMax;else if(2==e||14==e)t="\u989d\u5916\u751f\u547d +15",o.hpMax+=15,o.hp+=15;else if(3==e)this.getItem(3);else if(4==e)t="\u91d1\u5e01 +50",o.copper+=50;else if(5==e||6==e)this.getItem(2);else if(7==e)t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(3),this.rewardNode.y-=130;else if(8==e)t="\u751f\u547d\u4e0a\u9650 +10, \u6062\u590d\u5168\u90e8\u751f\u547d",o.hpMax+=10,o.hp=o.hpMax;else if(9==e||17==e)this.getItem();else if(10==e)t="\u91d1\u5e01\u7ffb\u500d",o.copper*=2;else if(11==e){t="\u590d\u5236\u5361\u724c";var i=o.deck[Math.floor(Math.random()*o.deck.length)];this.getCard(null,i),this.rewardNode.y-=130}else if(12==e||16==e)t="\u91d1\u5e01 +100",o.copper+=100;else if(13==e){this.getCard(3).x-=200,this.getCard(3).x+=200}else 15==e&&(t="\u751f\u547d +30",o.hp=Math.min(o.hp+30,o.hpMax));else-1==this.result?1==e?(t="\u751f\u547d +10",o.hp=Math.min(o.hp+10,o.hpMax)):2==e||12==e?(t="\u751f\u547d\u4e0a\u9650 -5",o.hpMax=Math.max(o.hpMax-5,1),o.hp=Math.min(o.hp,o.hpMax)):3==e?this.changeItem():4==e||9==e?this.getCard():5==e?(t="\u91d1\u5e01 +20",o.copper+=20):6==e||11==e?this.changeCard():7==e?(t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(2),this.rewardNode.y-=130):8==e||10==e?(t="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",o.copper=Math.ceil(o.copper/2)):13==e?this.deleteCard(0):14==e?(t="\u751f\u547d\u4e0a\u9650 -10",o.hpMax=Math.max(o.hpMax-10,1),o.hp=Math.min(o.hp,o.hpMax)):15==e?(t="\u6028\u5ff5\uff1a\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59313\u751f\u547d",o.debuff++):16==e?(t="\u751f\u547d -10",this.loseHp(10)):17==e&&(t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getCard(),this.rewardNode.y-=130):2==this.result&&(2==e||15==e?(t="\u751f\u547d -10",this.loseHp(10)):7==e?(t="\u91d1\u5e01 -30",o.copper=Math.max(o.copper-30,0),this.getItem(1),this.rewardNode.y-=130):12==e?(t="\u91d1\u5e01 -20",o.copper=Math.max(o.copper-20,0)):13==e?(this.deleteCard(1,0),this.deleteCard(1,1)):16==e&&(t="\u5931\u53bb\u4e00\u534a\u91d1\u5e01",o.copper=Math.ceil(o.copper/2)));this.txtName.string=t,window.homeLayer&&window.homeLayer.refreshHeroData()},close:function(){window.homeLayer?this.node.destroy():(cc.director.loadScene("helloworld"),o.floorBeats[o.floor-1]=!0)},getCard:function(e,t){var i=t||o.getNewCardId(e),c=cc.instantiate(this.cardPrefab);return c.getComponent("CardCollection").init(i),this.rewardNode.addChild(c),o.getCard(i),c},getItem:function(e){var t=o.getNewItemId(0,e);this.itemNode.active=!0,this.txtItemName.string=c.get("cfg_item",t).name,this.txtItemDesc.string=c.get("cfg_item",t).desc,o.getItem(t)},loseHp:function(e){if(o.hp-=e,o.hp<=0){o.hp+=e;var t=cc.instantiate(this.losePrefab);this.node.addChild(t)}},changeCard:function(){if(o.deck.length+o.cardBag.length>0){var e;this.txtChange.active=!0;var t=Math.floor(Math.random()*(o.deck.length+o.cardBag.length));t<o.deck.length?(e=o.deck[t],o.deck.splice(t,1)):(e=o.cardBag[t-o.deck.length],o.cardBag.splice(t-o.deck.length,1));var i,c=o.getNewCardId();o.getCard(c),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),i.x-=200,this.rewardNode.addChild(i),(i=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(c),i.x+=200,this.rewardNode.addChild(i)}else this.txtName.string="\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362"},changeItem:function(){if(o.equip.length>0){var e=Math.floor(Math.random()*o.equip.length),t=o.equip[e];o.equip.splice(e,1);var i=o.getNewItemId(0);o.getItem(i),this.itemChangeNode.active=!0,this.txtChangeName1.string=c.get("cfg_item",t).name,this.txtChangeDesc1.string=c.get("cfg_item",t).desc,this.txtChangeName2.string=c.get("cfg_item",i).name,this.txtChangeDesc2.string=c.get("cfg_item",i).desc}else this.txtName.string="\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362"},deleteCard:function(e,t){var i=0==e?o.deck:o.cardBag;if(i.length>0){var c=Math.floor(Math.random()*i.length),s=i[c];i.splice(c,1);var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(s),n.getComponent("CardCollection").markDelete.active=!0,null!=t&&(n.x=400*t-200),this.rewardNode.addChild(n)}else this.txtName.string="\u53ef\u79fb\u9664\u5361\u724c\u4e0d\u8db3",this.rewardNode.y-=130}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(e,t,i){"use strict";cc._RF.push(t,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,boxBuff:cc.Node,txtName:cc.Label,txtLevel:cc.Label,txtDice:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,figure:cc.Node,figureNode:cc.Node,equipDesc:cc.RichText,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){o.editCfg?this.initEdit():(this.cfgId=o.monsterId,this.cfg=c.get("cfg_monster",this.cfgId),this.hp=this.hpMax=this.cfg.hp,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,this.equipList=this.cfg.item>0?[this.cfg.item]:[],this.txtName.string=this.cfg.name,this.txtLevel.string="Lv."+this.cfg.level,this.initDeck()),this.player.init(1),this.ai=this.getComponent("AI"),this.board=window.mainLayer.board,cc.loader.loadRes("Texture/monster/"+this.cfgId,cc.SpriteFrame,function(e,t){this.figure.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())},startRound:function(){this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5),this.board.y=-497,this.board.runAction(cc.sequence(cc.delayTime(.5),cc.moveTo(.15,cc.v2(0,-377))))},endRound:function(){this.board.runAction(cc.moveTo(.15,cc.v2(0,-497)))},onHurt:function(e,t,i){window.mainLayer.gameOver||(i=i||7,this.player.onHurt(e,t,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(0)))},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},updateArmor:function(e){this.armor+=e,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor,this.stripHp.node.color=cc.color(24,136,176),this.barHp.color=cc.color(92,214,255)):(this.armor=0,this.boxArmor.active=!1,this.stripHp.node.color=cc.color(172,45,56),this.barHp.color=cc.color(252,94,108)),e>0&&this.player.anim.show(11)},initDeck:function(){if(0==this.cfg.card1)this.deck=window.mainLayer.hero.deck.concat();else{this.deck=[];for(var e=0;e<6;e++){var t=this.cfg["card"+(e+1)];t>0&&this.deck.push(t)}}},initEdit:function(){this.cfgId=50,this.hp=this.hpMax=parseInt(o.editCfg.hpEnemy),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(o.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.deck=o.editCfg.deckEnemy.split(";"),this.equipList=""!=o.editCfg.equipEnemy?[o.editCfg.equipEnemy]:[]},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"9C434A"};t[e]&&(this.figure.color=cc.Color.WHITE.fromHEX("#"+t[e]),this.figure.stopAllActions(),this.figure.runAction(cc.sequence(cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(-15,-5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.08,cc.v2(-15,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){this.figure.position=cc.v2(0,0),this.figure.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(e,t,i){"use strict";cc._RF.push(t,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,mask:cc.Node},onLoad:function(){window.equipLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var e=0;window.bagLayer?(e=.15,window.bagLayer.close()):window.mapLayer&&(e=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initItems()},initItems:function(){for(var e=0;e<o.equip.length;e++){var t=cc.instantiate(this.itemPrefab);t.getComponent("ItemCollection").init(o.equip[e]),t.position=cc.v2(0,-60-118*e),this.content.addChild(t)}this.content.height=Math.max(118*o.equip.length,cc.winSize.height/cc.winSize.width*750-1334+870)},close:function(){this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.equipLayer=null,window.homeLayer.btnEquip.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(e,t,i){"use strict";cc._RF.push(t,"a22ddJNtUJBS6PVq98jP/g9","Equip");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?o.equip:this.host.equipList,this.boxEquip=this.host.boxEquip,this.initItems(),this.swiftGlove=!1,this.suckRemainder=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0},initItems:function(){if(this.itemList=[],0==this.index){for(var e=0;e<this.equipList.length;e++){if(this.equipList[e]>0)if(c.get("cfg_item",this.equipList[e]).battle&&(10!=this.equipList[e]||o.itemEffect.feather>0)){var t=cc.instantiate(this.itemPrefab);t.getComponent("Item").init(this.equipList[e],this),this.boxEquip.addChild(t),this.itemList.push(t)}}for(var i=0;i<this.itemList.length;i++){var s=72;this.itemList.length>10&&(s=648/(this.itemList.length-1)),this.itemList[i].x=s*i-324}}else if(this.equipList.length>0){var n=cc.instantiate(this.itemPrefab);n.getComponent("Item").init(this.equipList[0],this),n.x=-240,n.scale=.5,this.boxEquip.addChild(n),this.itemList.push(n);var r=c.get("cfg_item",this.equipList[0]);this.host.equipDesc.string="<color=#FEF64B>"+r.name+"\uff1a</c>"+o.analysisDesc(r.desc1)}else this.boxEquip.active=!1},check:function(e){for(var t=0;t<this.equipList.length;t++)if(this.equipList[t]==e)return!0;return!1},checkWithTrigger:function(e){return!!this.check(e)&&(this.doTrigger(e),!0)},trigger:function(e){var t=!1;if(this.check(e))if(1==e)this.opponent.host.onHurt(1,2),t=!0;else if(2==e)this.player.cardList.length<=0&&(this.host.updateArmor(3),t=!0);else if(3==e)this.player.cardList.length<=0&&(this.host.onHeal(2),t=!0);else if(4==e)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.btnRoll&&this.host.checkBtnRoll(),t=!0);else if(5==e)this.opponent.buff.addBuff(26,2),t=!0;else if(6==e)this.player.buff.addBuff(13,1),t=!0;else if(7==e)this.host.onHeal(6),t=!0;else if(8==e)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(10),t=!0);else if(9==e)this.opponent.host.onHurt(6,2),t=!0;else if(10==e)o.itemEffect.feather>0&&(this.player.anim.show(202),this.host.hp=Math.floor(.3*this.host.hpMax),t=!0,o.itemEffect.feather=-1);else if(11==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.host.updateArmor(-this.host.armor),t=!0);else if(e>=12&&e<=18){this.opponent.buff.addBuff(e+9,[3,3,2,2,2,4,2][e-12]),t=!0}else if(19==e)this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0;else if(20==e)this.host.updateArmor(8),t=!0;else if(21==e)this.player.buff.addBuff(104,1);else if(22==e)this.opponent.host.onHurt(5,2),t=!0;else if(23==e)this.suckRemainder>=4&&(this.host.onHeal(Math.floor(this.suckRemainder/4)),this.suckRemainder=this.suckRemainder%4,t=!0);else if(24==e)this.opponent.host.onHurt(2,2,1),t=!0;else if(25==e)this.host.hp==this.host.hpMax&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(27==e)this.host.armor<=0&&(this.host.updateArmor(3),t=!0);else if(30==e)3==this.player.round&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(37==e)this.player.buff.addBuff(105,2);else if(44==e)this.player.buff.addBuff(103,3),t=!0;else if(45==e)this.scheduleOnce(function(){this.player.createExDice()}.bind(this),.5),t=!0;else if(e>=48&&e<=53)this.scheduleOnce(function(){window.player.createExDice(e-47)}.bind(this),.5),t=!0;else if(57==e)this.player.cardList.length>0&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",t=!0);else if(59==e)this.player.cardList.length>0&&(this.host.updateArmor(3*this.player.cardList.length),t=!0);else if(60==e)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),t=!0);else if(61==e)this.host.onHeal(15),t=!0;else if(68==e)this.opponent.buff.addBuff(24,1),t=!0;else if(69==e)this.opponent.host.onHurt(10,2),t=!0;else if(70==e)this.player.patchCard(),t=!0;else if(78==e||83==e)this.host.onHeal(2),t=!0;else if(79==e||82==e)this.host.updateArmor(2),t=!0;else if(80==e||81==e)this.opponent.host.onHurt(2,2),t=!0;else if(84==e)this.player.buff.addBuff(27,1),t=!0;else if(86==e)this.host.onHurt(2,2),t=!0;else if(88==e){if(o.deck.length>0){t=!0;for(var i=c.get("cfg_card",o.deck[0]).element,s=1;s<o.deck.length;s++)if(c.get("cfg_card",o.deck[s]).element!=i){t=!1;break}}}else if(91==e)this.player.buff.addBuff(21,2),t=!0;else if(93==e)1==this.player.round&&(this.scheduleOnce(function(){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard();for(var e=0;e<=0;){var t=o.getRandomCardId();3==c.get("cfg_card",t).quality&&(e=t)}window.player.patchCard(e)}.bind(this),.5),t=!0);else if(96==e)this.opponent.buff.addBuff(26,5),t=!0;else if(97==e)this.host.updateArmor(1),t=!0;else if(102==e)this.host.hp>this.host.hpMax&&(this.host.updateArmor(this.host.hp-this.host.hpMax),t=!0);else if(104==e)this.opponent.buff.addBuff(Math.floor(8*Math.random())+21,1),t=!0;else if(105==e)this.host.onHurt(1,2),t=!0;else if(108==e)this.opponent.host.onHurt(5,2,6),t=!0;else if(109==e)this.opponent.host.onHurt(5,2),t=!0;else if(110==e)this.host.onHurt(1,2),this.opponent.buff.addBuff(26,2),t=!0;else if(111==e)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),t=!0);else if(114==e)this.player.buff.addBuff(106,1);else if(115==e)this.player.rollCount++,0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll(),t=!0;else if(116==e)this.opponent.host.onHurt(6,2),t=!0;else if(118==e){for(var n=0,r=0;r<this.opponent.cardList.length;r++){this.opponent.cardList[r].getComponent("Card").burn&&n++}n>0&&(this.opponent.host.onHurt(6*n,2),t=!0)}else if(119==e)this.opponent.host.onHurt(5,2),t=!0;else if(121==e){for(var a=[],h=0;h<=this.player.buff.buffList.length;h++){var d=this.player.buff.buffList[h];d>=21&&d<=28&&a.push(d)}if(a.length>0){var l=a[Math.floor(Math.random()*a.length)];this.player.buff.removeBuff(l,this.player.buff.table[l]),t=!0}}else 122==e?(this.opponent.host.onHurt(5,2),t=!0):123==e?this.host.hp>this.host.hpMax&&(this.opponent.host.onHurt(this.host.hp-this.host.hpMax,2),t=!0):t=!0;return t&&this.doTrigger(e),t},doTrigger:function(e){for(var t=0;t<this.itemList.length;t++){var i=this.itemList[t].getComponent("Item");if(i.cfgId==e&&!i.isRemoved){i.trigger();break}}},refreshItemNum:function(e,t){for(var i=0;i<this.itemList.length;i++){var o=this.itemList[i].getComponent("Item");if(o.cfgId==e){o.txtCount.string=t;break}}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0d029pbdspBQZQHImTjZ76I","EventLayer");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtDesc:cc.Label,txtResults:[cc.Label],endPrefab:cc.Prefab},onLoad:function(){this.cfgId=o.eventId;var e=c.get("cfg_event",this.cfgId);this.txtName.string=e.name,this.txtDesc.string=e.desc;for(var t=["\u80dc\u5229/\u5e73\u5c40\uff1a","\u5931\u8d25\uff1a","\u79bb\u5f00\uff1a"],i=0;i<3;i++)this.txtResults[i].string=t[i]+e["result"+(i+1)]},onBattle:function(){o.stayRoom=!0,o.newRoom=!1,window.homeLayer=null,cc.director.loadScene("yahtzee")},onLeave:function(){if("\u65e0"!=c.get("cfg_event",this.cfgId).result3){var e=cc.instantiate(this.endPrefab);e.getComponent("EndYahtzeeLayer").init(2),window.homeLayer.node.addChild(e)}this.close()},close:function(){this.node.destroy(),window.room.btnAlter.node.active=!1,o.floorBeats[o.floor-1]=!0}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(e,t,i){"use strict";cc._RF.push(t,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{mark:cc.Sprite,line:cc.Node},init:function(e,t){cc.loader.loadRes("Texture/battle/"+["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"][e-1],cc.SpriteFrame,function(e,t){this.mark.spriteFrame=t}.bind(this)),this.line.active=t}}),cc._RF.pop()},{}],Game:[function(e,t,i){"use strict";cc._RF.push(t,"f5308O6zsVOxr+EKRsyR7ba","Game");var o=e("Config"),c={version:0,getData:function(e){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(t){cc.log("getStorageSuccess:"+t.data),void 0!=t.data?(c.syncFromStorage(JSON.parse(t.data)),e()):(this.setDataToBase(),e())}.bind(this),fail:function(){this.setDataToBase(),e()}.bind(this)});else{var t=cc.sys.localStorage.getItem("dice");void 0!=t?c.syncFromStorage(JSON.parse(t)):this.setDataToBase(),e()}},setDataToBase:function(){c.heroId=1,c.deck=[],c.cardBag=[],c.equip=[],c.hp=c.hpMax=35,c.power=0,c.powerMax=20,c.heroPos=2,c.stayRoom=c.newRoom=!0,c.exp=0,c.level=1,c.character=1,c.castle=1,c.floor=1,c.roomType=0,c.copper=50,c.debuff=0,c.shopIds=[],c.eventIds=[],c.floorCfg=[],c.historyPath=[],c.historyChoose=[],c.floorBeats=[],c.specialRoomIds=[],c.monsterBeats=[],c.discountCard=c.discountItem=-1,c.itemEffect={feather:0,vase:0,flagon:0,pen:0,vip1:!1,vip2:!1},c.saveData()},syncFromStorage:function(e){for(var t=["deck","cardBag","equip","hp","hpMax","power","powerMax","heroPos","stayRoom","newRoom","level","floor","castle","roomType","copper","debuff","shopIds","eventIds","floorCfg","historyPath","historyChoose","discountCard","discountItem","itemEffect","specialRoomIds","exp","monsterBeats"],i=0;i<t.length;i++)c[t[i]]=e[t[i]]},saveData:function(){c.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(c),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(c))},getItem:function(e){if(71==e)c.copper+=30;else if(87==e)for(var t=0;t<2;t++)c.getItem(c.getNewItemId(0,2));else c.equip.push(e);if(10==e)c.itemEffect.feather=1;else if(28==e)c.itemEffect.vase+=2;else if(29==e)c.itemEffect.flagon+=2;else if(40==e)c.hpMax+=5,c.hp+=5;else if(41==e)c.hpMax+=10,c.hp+=10;else if(46==e)c.itemEffect.vip1=!0;else if(47==e)c.itemEffect.vip2=!0;else if(72==e)c.copper+=50,c.hpMax+=10,c.hp+=10;else if(74==e)c.itemEffect.pen+=3;else if(84==e)for(var i=0;i<3;i++)c.getItem(c.getNewItemId(0));else 92==e?(c.hpMax=Math.max(c.hpMax-8,1),c.hp=Math.min(c.hp,c.hpMax)):95==e?(c.hpMax+=10,c.hp=c.hpMax):96==e?(c.hpMax=Math.max(c.hpMax-10,1),c.hp=Math.min(c.hp,c.hpMax)):105==e?(c.hpMax+=20,c.hp+=20):106==e&&(c.powerMax+=10);94!=e&&c.equip.indexOf(94)>=0&&(c.hpMax+=5,c.hp+=5),window.homeLayer&&window.homeLayer.refreshHeroData()},getCard:function(e){var t=2==c.heroId?4:6;c.deck.length<t?c.deck.push(e):(c.cardBag.push(e),c.newCard=!0,window.homeLayer&&window.homeLayer.refreshHeroData())},getNewItemId:function(e,t){for(var i=0;i<=0;){var s=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1;c.equip.indexOf(s)<0&&(0==e&&o.get("cfg_item",s).get<=1||1==e&&0==o.get("cfg_item",s).get||2==e)&&(t?o.get("cfg_item",s).quality==t&&(i=s):i=s)}return i},getNewCardId:function(e,t){for(var i=0;i<=0;){var s=c.getRandomCardId(null,t);c.deck.indexOf(s)<0&&c.cardBag.indexOf(s)<0&&(e?o.get("cfg_card",s).quality==e&&(i=s):i=s)}return i},getRandomCardId:function(e,t){for(var i=0;i<=0;){var c=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_card).length)+1;o.get("cfg_card",c).get==(t?2:1)&&(e?o.get("cfg_card",c).element==e&&(i=c):i=c)}return i},getNewMonsterId:function(e,t){for(var i=0;i<=0;){var s=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_monster).length)+1;c.monsterBeats.indexOf(s)<0&&o.get("cfg_monster",s).level==e&&o.get("cfg_monster",s).type==t&&(i=s)}return i},analysisDesc:function(e,t){for(var i="",o=0,c="",s={1:"fire",2:"water",3:"wind",4:"earth",5:"light",6:"dark",7:t?"atk2":"atk",9:"suck",11:"armor",12:"heal",13:"dodge",14:"power",15:"heart",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"atkback"},n={1:"FF3832",2:"2CB4FF",3:"00F776",4:"FF9652",5:"FFFB4B",6:"BF7FE4",7:t||"FFFFFF",9:"FF5567",11:"42EBFF",12:"98F700",13:"FFF830",14:"FFFB4B",15:"FF5567",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FF5567"},r=0;r<e.length;r++)"#"==e[r]?0==o?(o=1,c="",i+="<img src='"):(i+=s[parseInt(c)],i+="'/>",o=0):"["==e[r]?(c="",0==o&&(o=2,i+="<color=#")):"]"==e[r]?""!=c?(i+=n[parseInt(c)],i+=">",o=-1):(o=0,i+="</c>"):o<=0?e[r]>="A"&&e[r]<="F"?i+=" <img src='dice"+(e[r].charCodeAt()-64)+"'/> ":i+=e[r]:c+=e[r];return i}};t.exports=c,cc._RF.pop()},{Config:"Config"}],HelloWorld:[function(e,t,i){"use strict";cc._RF.push(t,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var o=e("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,hero:cc.Node,txtFloor:cc.Label,roomPrefab:cc.Prefab,stripHp:cc.ProgressBar,txtHp:cc.Label,stripExp:cc.ProgressBar,txtExp:cc.Label,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,txtEquipCount:cc.Label,markRed:cc.Node,layerNode:cc.Node,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,equipPrefab:cc.Prefab,completePrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab,btnMap:cc.Node,btnEquip:cc.Node,btnDeck:cc.Node},onLoad:function(){window.homeLayer=this,1==o.floor&&1==o.castle&&this.initGameConfig(),this.createRoom(),this.refreshHeroData(),o.levelUp&&this.scheduleOnce(this.openLvUp,.3)},createRoom:function(){var e=cc.instantiate(this.roomPrefab);this.bg.addChild(e),this.room=e,this.hero.parent=e,o.floorCfg.length<=0?(e.getComponent("Room").init(!0),e.getComponent("Room").initHero()):e.getComponent("Room").init(!1)},changeRoom:function(e){var t=cc.instantiate(this.roomPrefab);this.bg.addChild(t),t.getComponent("Room").init(!0);var i=cc.v2();0==e?(t.position=cc.v2(0,1334),i=cc.v2(0,-1334)):1==e?(t.position=cc.v2(750,0),i=cc.v2(-750,0)):2==e?(t.position=cc.v2(0,-1334),i=cc.v2(0,1334)):3==e&&(t.position=cc.v2(-750,0),i=cc.v2(750,0));var o=this.room;o.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.hero.parent=t,o.destroy()}.bind(this)))),t.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.room=t,t.getComponent("Room").initHero()}.bind(this))))},openAlter:function(){if(2==o.roomType){var e=cc.instantiate(this.campPrefab);this.node.addChild(e)}else if(3==o.roomType||o.roomType>=6){var t=cc.instantiate(this.treasurePrefab);t.getComponent("TreasureLayer").init(7==o.roomType),this.node.addChild(t)}else if(4==o.roomType){var i=cc.instantiate(this.eventPrefab);this.node.addChild(i)}else if(5==o.roomType){var c=cc.instantiate(this.shopPrefab);this.layerNode.addChild(c)}},refreshHeroData:function(){this.txtHp.string=o.hp+"/"+o.hpMax,this.stripHp.progress=o.hp/o.hpMax;var e=o.level<7?3*o.level:99;this.txtExp.string=o.exp+"/"+e,this.stripExp.progress=o.exp/e,this.txtLevel.string="Lv."+o.level,this.txtCopper.string=o.copper,this.txtEquipCount.string=o.equip.length,this.markRed.active=o.newCard},openMap:function(){if(window.mapLayer)window.mapLayer.mask.active&&window.mapLayer.close();else{var e=cc.instantiate(this.mapPrefab);this.layerNode.addChild(e)}},openCardBag:function(){if(window.bagLayer)window.bagLayer.mask.active&&window.bagLayer.close();else{var e=cc.instantiate(this.bagPrefab);this.layerNode.addChild(e)}},openEquip:function(){if(window.equipLayer)window.equipLayer.mask.active&&window.equipLayer.close();else{var e=cc.instantiate(this.equipPrefab);this.layerNode.addChild(e)}},openLvUp:function(){var e=cc.instantiate(this.lvUpPrefab);this.node.addChild(e)},openComplete:function(){var e=cc.instantiate(this.completePrefab);this.node.addChild(e)},initDeck:function(){var e=2==o.heroId?2:3;if(o.deck.length+o.cardBag.length<=e)for(;o.deck.length<e;){var t=o.getNewCardId(null,!0);o.getCard(t)}},initGameConfig:function(){this.initDeck(),o.eventIds=[];for(var e=0;e<17;e++){var t=Math.floor(Math.random()*(o.eventIds.length+1));o.eventIds.splice(t,0,e+1)}o.specialRoomIds=[3,4];for(var i=[[2,4,5],[2,3,4,4,5],[2,3,4,4,5]],c=0;c<3;c++)for(var s=i[c],n=s.length-1;n>=0;n--){var r=Math.floor(Math.random()*s.length);o.specialRoomIds.push(s[r]),s.splice(r,1)}},gotoEdit:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Hero:[function(e,t,i){"use strict";cc._RF.push(t,"7311fX1RYNN1bDgBGcTZsee","Hero");var o=e("Game");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,skillPrefab:cc.Prefab,head:cc.Node,skillNode:cc.Node,txtDice:cc.Label,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){this.btnEnd=window.mainLayer.btnEnd,this.btnRoll=window.mainLayer.btnRoll,this.txtRollCount=window.mainLayer.txtRollCount,this.deck=o.deck.concat(),this.player.init(0),this.hpMax=o.hpMax,this.hp=o.hp,this.power=o.power,this.powerMax=o.powerMax,this.armor=0,this.rollabled=!0,this.refreshStrip(),this.initSkills()},startRound:function(){this.btnEnd.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.2,cc.v2(-275,140))))},endRound:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").abled=!0;this.checkSkills(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-475,140))),this.player.rollCount=0,this.checkBtnRoll()},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onHurt:function(e,t,i){if(!window.mainLayer.gameOver){var o=this.hp;i=i||7,this.player.onHurt(e,t,i),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),o>this.hp&&this.addPower(o-this.hp)}},onHeal:function(e){this.equip.checkWithTrigger(76)&&(e=Math.floor(1.5*e)),this.player.onHeal(e),this.player.assertHpChange("+"+e,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(e){this.power+=e,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.checkSkills()},updateArmor:function(e){this.armor+=e,this.armor>0?(this.boxArmor.active=!0,this.txtArmor.string=this.armor,this.stripHp.node.color=cc.color(24,136,176),this.barHp.color=cc.color(92,214,255)):(this.armor=0,this.boxArmor.active=!1,this.stripHp.node.color=cc.color(172,45,56),this.barHp.color=cc.color(252,94,108)),e>0&&this.player.anim.show(11)},initSkills:function(){this.btnSkills=[];for(var e=0;e<2;e++){var t=cc.instantiate(this.skillPrefab);t.position=cc.v2(0==e?127:285,31),t.getComponent("Skill").init(e),this.skillNode.addChild(t),this.btnSkills.push(t)}},checkSkills:function(){for(var e=0;e<2;e++)this.btnSkills[e].getComponent("Skill").check()},checkBtnRoll:function(e){var t=!1;if(this.player.rollCount>0)if(this.player.cardList.length>0)t=!0;else if(this.player.chestList)for(var i=0;i<3;i++)if(this.player.chestList[i]){t=!0;break}t!=this.rollabled?(this.rollabled=t,t?this.btnRoll.runAction(cc.moveTo(.15,cc.v2(310,140))):this.btnRoll.runAction(cc.moveTo(.15,cc.v2(425,140)))):t&&e&&this.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(425,140)),cc.moveTo(.15,cc.v2(310,140)))),this.txtRollCount.string=this.player.rollCount},doShake:function(e){var t={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"9C434A"};t[e]&&(this.head.color=cc.Color.WHITE.fromHEX("#"+t[e]),window.mainLayer.camera.stopAllActions(),window.mainLayer.camera.runAction(cc.sequence(cc.moveTo(.05,cc.v2(5,5)),cc.moveTo(.1,cc.v2(-5,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){window.mainLayer.camera.position=cc.v2(0,0),this.head.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Game:"Game"}],ItemCollection:[function(e,t,i){"use strict";cc._RF.push(t,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.RichText,icon:cc.Sprite},init:function(e){var t=c.get("cfg_item",e),i=[cc.color(28,130,224),cc.color(106,0,173),cc.color(241,95,0)];this.txtName.string=t.name;var s=o.analysisDesc(t.desc1),n=-1;10==e?n=o.itemEffect.feather>0?1:0:28==e?n=o.itemEffect.vase:29==e?n=o.itemEffect.flagon:74==e&&(n=o.itemEffect.pen),n>=0&&(s+="<color=#EBC82E>  (\u5269\u4f59\u6b21\u6570"+n+")</c>"),this.txtDesc.string=s,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][t.quality-1],this.txtQuality.node.color=i[t.quality-1],cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ItemCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtName2:cc.Label,icon:cc.Sprite,bg:cc.Sprite,txtDesc:cc.RichText},init:function(e){var t=c.get("cfg_item",e);this.txtName.string=this.txtName2.string=t.name,this.txtDesc.string=o.analysisDesc(t.desc1),cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/battle/box_equip"+t.quality,cc.SpriteFrame,function(e,t){this.bg.spriteFrame=t}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Item:[function(e,t,i){"use strict";cc._RF.push(t,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,iconBtn:cc.Button,boxNum:cc.Node,txtCount:cc.Label,tip:cc.Node,txtDesc:cc.RichText,box:cc.Node},init:function(e,t){this.cfgId=e,this.cfg=c.get("cfg_item",e),this.equip=t,cc.loader.loadRes("Texture/equip/"+e,cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this)),43==e&&(this.boxNum.active=!0)},trigger:function(){this.action&&this.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.5),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,1==this.cfg.num&&this.doDisabled()}.bind(this))),this.icon.node.runAction(this.action)},doDisabled:function(){this.iconBtn.enableAutoGrayEffect=!0},openTip:function(){if(1!=this.equip.index){if(window.mainLayer.equipTip){if(window.mainLayer.equipTip==this)return void this.hideTip();window.mainLayer.equipTip.hideTip()}this.tip.active=!0,window.mainLayer.equipTip=this;this.txtDesc.string="<color=#"+["5CC7FF","C262FF","FF9231"][this.cfg.quality-1]+">"+this.cfg.name+"\uff1a</c>"+o.analysisDesc(this.cfg.desc1),this.node.x<-220?this.box.x=-220-this.node.x:this.node.x>220&&(this.box.x=220-this.node.x),this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.tip.active=!1,window.mainLayer.equipTip=null}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LevelUpLayer:[function(e,t,i){"use strict";cc._RF.push(t,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{btnClose:cc.Node,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,txtSkill:cc.Label,boxReward:cc.Node,btns:[cc.Node]},onLoad:function(){if(this.type=3,3==o.level){this.txtSkill.node.active=!0;this.txtSkill.string="\u6012\u6c14\u6280\uff1a"+["\u53cc\u6253","\u5927\u6ee1\u8d2f"][o.heroId-1],this.btns[0].active=this.btns[1].active=!1}else 5==o.level||7==o.level?(this.type=2,this.initItems()):(this.type=1,this.initCards())},initCards:function(){this.btnClose.active=!1,this.itemIdList=[],this.items=[];var e=o.getNewCardId();this.itemIdList.push(e);for(var t=0;t<=0;){var i=o.getNewCardId();i!=e&&(t=i)}this.itemIdList.push(t);for(var c=0;c<2;c++){var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(this.itemIdList[c]),s.position=cc.v2(0==c?-160:160,40),this.boxReward.addChild(s),this.items.push(s)}},initItems:function(){this.btnClose.active=!1,this.itemIdList=[],this.items=[];var e=o.getNewItemId(0);this.itemIdList.push(e);for(var t=0;t<=0;){var i=o.getNewItemId(0);i!=e&&(t=i)}this.itemIdList.push(t);for(var c=0;c<2;c++){var s=cc.instantiate(this.itemPrefab);s.getComponent("ItemCommodity").init(this.itemIdList[c]),s.position=cc.v2(0==c?-160:160,40),this.boxReward.addChild(s),this.items.push(s)}},choose:function(e,t){1==this.type?o.getCard(this.itemIdList[t]):o.getItem(this.itemIdList[t]),this.items[1-t].destroy(),this.items[t].runAction(cc.moveTo(.2,cc.v2(0,40))),this.btns[0].active=this.btns[1].active=!1,this.btnClose.active=!0},close:function(){o.levelUp=!1,this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],LoseLayer:[function(e,t,i){"use strict";cc._RF.push(t,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){if(o.floor>1){o.floor--,o.floorCfg=o.historyPath[o.historyPath.length-2],o.floor>1?o.roomType=o.historyPath[o.floor-2][o.historyChoose[o.floor-1]]:o.roomType=0;var e=o.floorCfg.indexOf(-2);e>=0&&(o.heroPos=e)}cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(e,t,i){"use strict";cc._RF.push(t,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{heroPrefab:cc.Prefab,enemyPrefab:cc.Prefab,enemyNode:cc.Node,endPrefab:cc.Prefab,losePrefab:cc.Prefab,editEndPrefab:cc.Prefab,btnEnd:cc.Node,btnRoll:cc.Node,boxCardHero:cc.Node,boxDiceHero:cc.Node,boxCardEnemy:cc.Node,boxDiceEnemy:cc.Node,board:cc.Node,camera:cc.Node,txtRollCount:cc.Label,bg:cc.Node},onLoad:function(){window.mainLayer=this,this.gameOver=!1,this.bg.on(cc.Node.EventType.TOUCH_START,this.hideTip,this)},start:function(){var e=cc.instantiate(this.heroPrefab);e.position=cc.v2(0,115-cc.winSize.height/2),this.node.addChild(e),this.hero=e.getComponent("Hero");var t=cc.instantiate(this.enemyPrefab);t.position=cc.v2(0,cc.winSize.height/2-300),this.enemyNode.addChild(t),this.enemy=t.getComponent("Enemy"),this.hero.init(),this.enemy.init(),this.roundId=1,this.scheduleOnce(function(){this.doRound()}.bind(this),.1)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.player.startRound()},showEnd:function(e){if(this.gameOver=!0,o.editCfg){var t=cc.instantiate(this.editEndPrefab);this.node.addChild(t)}else if(0==e){var i=cc.instantiate(this.endPrefab);this.node.addChild(i)}else{var c=cc.instantiate(this.losePrefab);this.node.addChild(c)}},roll:function(){this.hero.player.roll()},endRound:function(){this.hero.player.endRound()},hideTip:function(){this.equipTip&&this.equipTip.hideTip(),this.buffTip&&this.buffTip.hideTip()}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(e,t,i){"use strict";cc._RF.push(t,"2be16dXDepLLbZP42Rqq+om","MapLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{scroll:cc.ScrollView,content:cc.Node,fortPrefab:cc.Prefab,mask:cc.Node},onLoad:function(){cc.log(o.historyPath),window.mapLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var e=0;window.bagLayer?(e=.15,window.bagLayer.close()):window.equipLayer&&(e=.15,window.equipLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.drawMap()},drawMap:function(){for(var e=0;e<o.historyPath.length;e++){var t=o.historyPath[e],i=0,c=!1;if(o.historyChoose[e])i=o.historyChoose[e],c=!0;else for(var s=0;s<4;s++)if(t[s]>0){i=s;break}var n=cc.instantiate(this.fortPrefab);n.getComponent("Fort").init(t[i],c),n.position=cc.v2(0,190+120*e),this.content.addChild(n);for(var r=[-1,1],a=2;a>=0;a--){var h=r[a]+0;(h<-2||h>2)&&r.splice(a,1)}for(var d=0;d<4;d++){var l=t[d];if(d!=i&&l>0){var f=Math.floor(Math.random()*r.length),p=r[f],u=0+p;r.splice(f,1);var m=cc.instantiate(this.fortPrefab);if(m.getComponent("Fort").init(l),m.position=cc.v2(120*u,190+120*e),this.content.addChild(m),-1==p||1==p){var g=2*p+0;g>=-2&&g<=2&&r.push(2*p)}}}}this.content.height=Math.max(120*o.historyPath.length+140,1180),this.scroll.scrollToTop(0)},close:function(){this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.mapLayer=null,window.homeLayer.btnMap.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(e,t,i){"use strict";cc._RF.push(t,"52880hyyK1GjLw1tAGJFFaD","Opening");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{endPrefab:cc.Prefab},onLoad:function(){this.login()},login:function(){c.load(function(){o.setDataToBase(),this.loadRes(),this.gotoMain()}.bind(this))},gotoMain:function(){cc.director.loadScene("helloworld")},loadRes:function(){}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerYahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Sprite]},init:function(e){this.index=e,this.win=0,this.dicePool=new cc.NodePool;for(var t=0;t<5;t++){var i=cc.instantiate(this.dicePrefab);this.dicePool.put(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){this.diceList=[];for(var e=0;e<5;e++){var t=this.dicePool.get();t.getComponent("DiceYahtzee").init(e,this.index),this.boxDice.addChild(t),this.diceList.push(t)}this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check()}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var e=0;e<5;e++){var t=this.diceList[e].getComponent("DiceYahtzee");t.holded||t.hold(),t.abled=!1}}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound()):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var e=[0,0,0,0,0,0],t=0;t<5;t++){e[this.diceList[t].getComponent("DiceYahtzee").element-1]++}e.sort(function(e,t){return t-e}),5==e[0]?this.score=7:4==e[0]?this.score=6:3==e[0]?2==e[1]?this.score=5:this.score=4:2==e[0]?2==e[1]?this.score=3:this.score=1:this.score=2},doWin:function(){cc.loader.loadRes("Texture/battle/mark_crown1",cc.SpriteFrame,function(e,t){this.crowns[this.win].spriteFrame=t,this.win++}.bind(this))}}),cc._RF.pop()},{}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"ba4f5YaUElBy61UWqBofsfz","Player");var o=e("Game"),c=e("Utils"),s=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,chestPrefab:cc.Prefab,dmgAnimation:cc.Prefab},init:function(e){this.index=e,0==e?(this.host=this.getComponent("Hero"),this.opponent=window.mainLayer.enemy.player,this.boxCard=window.mainLayer.boxCardHero,this.boxDice=window.mainLayer.boxDiceHero):(this.host=this.getComponent("Enemy"),this.opponent=window.mainLayer.hero.player,this.boxCard=window.mainLayer.boxCardEnemy,this.boxDice=window.mainLayer.boxDiceEnemy),this.buff=this.getComponent("Buff"),this.buff.init(),this.equip=this.getComponent("Equip"),this.equip.init(),this.cardPool=new cc.NodePool;for(var t=0;t<6;t++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var o=0;o<5;o++){var c=cc.instantiate(this.dicePrefab);this.dicePool.put(c)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.atkPlayed=0,this.atkRound=0,this.diceUsabld=!0,this.cardUsabled=!0,this.deck=this.host.deck,this.diceCount=0==e?5:this.host.diceCount;for(var s=[85,86,89,90,91,92],n=0;n<s.length;n++)this.equip.checkWithTrigger(s[n])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++,this.host.txtDice.string="\xd7"+this.diceCount;var r=cc.instantiate(this.dmgAnimation);this.node.addChild(r),0==this.index?(r.scale=.8,r.position=cc.v2(-302,33)):r.position=cc.v2(0,this.host.figureNode.y+this.host.figure.height/2),this.anim=r.getComponent("DmgAnimation"),this.anim.init(e)},start:function(){this.checkGameBegin()},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,this.checkStart(),0==this.index&&(this.diceUsabld=!1,this.cardUsabled=!1,2==o.heroId&&(this.chestList=[null,null,null],this.createChest())),this.initCards(),this.initDices(),window.mainLayer.gameOver||this.host.startRound()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var e=this.diceCount+this.extraDice,t=c.getDifferentRandomNum(e,e-1,0),i=Math.min(this.buff.lock,e),o=t.splice(0,i);this.buff.removeBuff(28,i);var s=0,n=[];this.equip.checkWithTrigger(63)||(s=Math.min(this.buff.freeze,e-i),n=t.splice(0,s),this.buff.removeBuff(22,s));for(var r=0;r<e;r++){for(var a=null,h=0;h<o.length;h++)if(r==o[h]){a=28;break}if(!a)for(var d=0;d<n.length;d++)if(r==n[d]){a=22;break}var l=null;l=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab);var f=0;f=e<=6?-(e-1)/2*110+110*r:640/(e-1)*r-320,l.position=cc.v2(f,0==window.mainLayer.roundId?-120:600),l.getComponent("Dice").init(r,a),this.boxDice.addChild(l),this.diceList.push(l)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[];for(var e=Math.min(this.deck.length,6),t=this.equip.checkWithTrigger(66)?0:this.buff.silence,i=this.equip.checkWithTrigger(62)?0:this.buff.burn,o=0;o<e;o++){var c=null,n=s.get("cfg_card",this.deck[o]).element;this.buff.silenceDark&&6==n?c=25:Math.random()<t/(e-o)?(c=25,t--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==n?c=21:Math.random()<i/(e-o)&&(c=21,i--,this.buff.removeBuff(21,1)),this.drawCard(this.deck[o],c)}},drawCard:function(e,t,i){var o=this.getEmptyIndex();if(!(o<0)){var c=null;return(c=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(e,o,t,0),c.getComponent("Card").isTemp=i,this.boxCard.addChild(c,100),this.cardList.push(c),c}},patchCard:function(e,t,i){var c=this.buff,n=null;e=e||o.getRandomCardId();var r=s.get("cfg_card",e).element;c.silenceDark&&6==r?n=25:c.silence>0&&!this.equip.checkWithTrigger(66)?(n=25,c.removeBuff(25,1)):c.burnIce&&2==r?n=21:c.burn>0&&!this.equip.checkWithTrigger(62)&&(n=21,c.removeBuff(21,1));var a=this.drawCard(e,n,!t);return i&&a.getComponent("Card").disCost(),this.checkCardsRequire(),0==this.index&&this.host.checkBtnRoll(),this.equip.trigger(119),a},roll:function(e,t){for(var i=0;i<this.diceList.length;i++){var o=this.diceList[i].getComponent("Dice");1==e?o.roll():o.freeze||o.lock||o.temp||(t?(o.holded&&o.hold(),o.roll(t)):o.holded||o.roll())}e?this.scheduleOnce(function(){this.refreshCardBuff(),this.checkElement(),this.rollCount--}.bind(this),.2):(this.checkElement(),this.rollCount--,0==window.mainLayer.roundId&&this.host.checkBtnRoll(!0))},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var e=0;e<this.diceList.length;e++){var t=this.diceList[e].getComponent("Dice");t.lock||this.elementList[t.element-1]++}if(this.cardAbledCount=this.checkCardsRequire(),this.chestList)for(var i=0;i<3;i++)this.chestList[i]&&this.chestList[i].getComponent("Chest").checkRequire()},refreshCardBuff:function(){for(var e=0;e<this.cardList.length;e++)this.cardList[e].getComponent("Card").initBuff();this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2)},refreshDiceBuff:function(){for(var e=0;e<this.diceList.length;e++)this.diceList[e].getComponent("Dice").initBuff();this.checkElement();for(var t=0,i=0;i<6;i++)this.elementList[i]>0&&t++;t>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.cardAbledCount<=0&&this.equip.trigger(45);for(var o=48;o<=53;o++)this.equip.trigger(o);this.equip.trigger(93),0==window.mainLayer.roundId&&(this.host.checkBtnRoll(!0),this.diceUsabld=!0,this.cardUsabled=!0)},createExDice:function(e){var t=null;this.buff.lock>0?(t=28,this.buff.removeBuff(28,1)):this.buff.freeze>0&&!this.equip.checkWithTrigger(63)&&(t=22,this.buff.removeBuff(22,1));var i=null;i=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab),this.diceList.length<=5?i.x=this.diceList.length/2*110:i.x=320,i.getComponent("Dice").init(this.diceList.length-1,t),this.boxDice.addChild(i),this.diceList.push(i),i.getComponent("Dice").roll(e),e&&i.getComponent("Dice").doTemp();for(var o=0;o<this.diceList.length;o++){var c=this.diceList[o];c.stopAllActions(),c.opacity=255;var s=0;s=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*o:640/(this.diceList.length-1)*o-320,c.runAction(cc.moveTo(.2,cc.v2(s,0)))}this.checkElement(),this.extraDice++,this.host.txtExDice.string="(+"+this.extraDice+")"},endRound:function(){this.scheduleOnce(function(){for(var e=this.cardList.length-1;e>=0;e--)this.cardList[e].getComponent("Card").remove()}.bind(this),.3);for(var e=0;e<this.diceList.length;e++)this.diceList[e].getComponent("Dice").remove();if(this.chestList)for(var t=0;t<3;t++)this.chestList[t]&&this.chestList[t].getComponent("Chest").remove();this.host.endRound(),this.scheduleOnce(function(){this.buff.exRound>0?(this.startRound(),this.buff.removeBuff(101,1)):window.mainLayer.doRound()}.bind(this),.5),this.settleBuff(),this.settleEquip(),this.extraDice=0,this.host.txtExDice.string=""},checkCardsRequire:function(){for(var e=0,t=0;t<this.cardList.length;t++){this.cardList[t].getComponent("Card").checkRequire()&&e++}return e},checkGameBegin:function(){for(var e=[6,12,13,14,15,16,17,18,19,20,21,30,37,44,86,91,96,114],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),7==o.roomType&&this.equip.trigger(61),0==this.index&&o.debuff>0&&this.onHurt(3*o.debuff,1,7)},checkStart:function(){this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]);for(var e=[5,9,25,84,105,111,121],t=0;t<e.length;t++)this.equip.trigger(e[t]);if(this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var i=this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?2:1);this.host.onHurt(i,1,26),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.removeBuff(102,1)},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.table[23]>0&&this.buff.removeBuff(23,1),this.buff.table[24]>0&&this.buff.removeBuff(24,1),this.buff.multiCast=this.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1},settleEquip:function(){for(var e=[2,3,27,11,57,59,60,104,110],t=0;t<e.length;t++)this.equip.trigger(e[t]);this.opponent.equip.trigger(118),this.cardPlayedRound=0,this.atkRound=0,this.equip.swiftGlove=!1,this.equip.suckRemainder=0},onHurt:function(e,t,i){if(this.buff.frail>0&&0==t&&!this.equip.checkWithTrigger(64)){var o=.5;this.opponent.equip.checkWithTrigger(54)&&(o+=.25),this.equip.checkWithTrigger(56)&&(o-=.25),this.equip.checkWithTrigger(113)&&(o*=2),this.opponent.equip.checkWithTrigger(113)&&(o*=2),e=Math.floor(e*(o+1))}if(this.opponent.equip.checkWithTrigger(21)&&(e+=1),this.opponent.host.hp<10&&this.opponent.equip.checkWithTrigger(75)&&(e+=3),this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(e=0),e>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),e=1),e>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),e=1),e>0&&this.equip.checkWithTrigger(114)&&e--,9==i&&e>0&&this.opponent.host.onHeal(e),this.opponent.equip.suckRemainder+=e,this.opponent.equip.trigger(23),this.buff.atkBack>0&&0==t&&e>0&&this.opponent.host.onHurt(this.buff.atkBack,1,29),e>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(e,2,29),this.assertHpChange("-"+e,0),this.anim.show(i),this.host.armor>0){if(this.host.armor>=e)return void this.host.updateArmor(-e);e-=this.host.armor,this.host.updateArmor(-this.armor)}this.host.hp-=e,this.host.hp<=0&&this.buff.undead>0&&(this.anim.show(201),this.host.hp=1),this.host.hp<=0&&this.equip.trigger(10),this.equip.check(75)&&this.host.hp<10&&this.buff.atkAdd<3&&this.buff.addBuff(104,3),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},onHeal:function(e){if(this.equip.checkWithTrigger(122)){var t=Math.min(e,this.host.hpMax-this.host.hp);this.opponent.host.onHurt(t,2)}this.host.hp+=e,this.equip.trigger(102),this.equip.trigger(123),this.anim.show(12),this.equip.check(75)&&this.host.hp>=10&&this.buff.atkAdd>=3&&this.buff.removeBuff(104,3)},assertHpChange:function(e,t){this.showQueue.push([e,t]),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var e=this.showQueue[0],t=e[0],i=e[1],o=[cc.Color.WHITE,cc.color(139,255,70),cc.color(255,40,40),cc.color(60,247,255)],c=cc.instantiate(this.host.txtNum);c.getComponent(cc.Label).string=t,c.color=o[i],c.position=this.host.txtNum.position,this.node.addChild(c),c.scale=0;var s=cc.spawn(cc.moveBy(.1,cc.v2(30,10)),cc.scaleTo(.1,1.1));s=cc.spawn(cc.moveBy(.05,cc.v2(0,0==this.index?0:-10)),cc.scaleTo(.05,1));c.runAction(cc.sequence(s,s,cc.moveBy(.05,cc.v2(13+10*Math.random(),3+5*Math.random())),cc.moveBy(.1,cc.v2(3+10*Math.random(),-3-10*Math.random())),cc.fadeOut(.5),cc.callFunc(function(){c.destroy()}.bind(this)))),c.runAction(cc.sequence(cc.delayTime(.15),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this))))},getEmptyIndex:function(){for(var e=0;e<6;e++){var t=!1;if(this.chestList&&this.chestList[e%3]&&(t=!0),!t)for(var i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==e){t=!0;break}}if(!t)return e}return-1},createChest:function(e){for(var t=-1,i=2;i>=0;i--)if(!this.chestList[i]){t=i;break}if(t>=0){var o=cc.instantiate(this.chestPrefab);o.getComponent("Chest").init(t),this.boxCard.addChild(o,100),this.chestList[t]=o,e&&o.getComponent("Chest").checkRequire()}}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],PotionCommodity:[function(e,t,i){"use strict";cc._RF.push(t,"85c55EVbbNKe72lZU+lcHho","PotionCommodity"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,txtName:cc.Label},init:function(e){cc.loader.loadRes("Texture/battle/image_potion"+e,cc.SpriteFrame,function(e,t){this.sprite.spriteFrame=t}.bind(this)),this.txtName.string="\u751f\u547d +"+10*e}}),cc._RF.pop()},{}],RequireRound:[function(e,t,i){"use strict";cc._RF.push(t,"3a0eeaFa/FFsJmcvXZBEaHe","RequireRound"),cc.Class({extends:cc.Component,properties:{circle:cc.Sprite,sprite:cc.Sprite},init:function(e,t){var i=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)];this.node.color=i[t-1],this.unCost=!1,this.satisfied=!1,e>0&&(this.element=e,this.refreshElement())},refreshElement:function(e){e&&(this.element=e),cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(e,t){this.sprite.node.active=!0,this.sprite.spriteFrame=t}.bind(this))},refreshSatisfy:function(e){if(this.satisfied=e,this.satisfied&&!this.unCost){var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=t[this.element-1]}else this.sprite.node.color=cc.color(255,255,255)},hideElement:function(){this.element=null,this.sprite.node.active=!1},disCost:function(){this.unCost=!0,cc.loader.loadRes("Texture/battle/image_requireLine2",cc.SpriteFrame,function(e,t){this.circle.spriteFrame=t}.bind(this)),cc.loader.loadRes("Texture/battle/unelement"+this.element,cc.SpriteFrame,function(e,t){this.sprite.node.active&&(this.sprite.spriteFrame=t)}.bind(this)),this.refreshSatisfy(!0)}}),cc._RF.pop()},{}],Room:[function(e,t,i){"use strict";cc._RF.push(t,"20286qrg/RMq6rq0m6qk3EY","Room");var o=e("Game");cc.Class({extends:cc.Component,properties:{door:[cc.Button],mark:[cc.Sprite],btnAlter:cc.Sprite,monsterNode:cc.Node,monsterFigure:cc.Sprite},init:function(e){window.room=this,this.pos=o.heroPos,this.abled=!1,this.isNewRoom=e,e?this.initFloorConfig():(this.initHero(),this.typeList=o.floorCfg,o.floorBeats[o.floor-1]&&this.initMonsterCfg()),this.initDoors(),this.initRoom()},initHero:function(){if(this.hero=window.homeLayer.hero,window.homeLayer.txtFloor.string=o.castle+"-"+o.floor,this.isNewRoom){var e=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];this.hero.position=e[this.pos],this.hero.runAction(cc.sequence(cc.moveTo(.2,cc.v2()),cc.callFunc(function(){this.door[this.pos].node.color=cc.Color.GRAY,1!=o.roomType&&o.roomType<6&&(this.abled=!0)}.bind(this)),cc.delayTime(.3),cc.callFunc(function(){(1==o.roomType||o.roomType>=6)&&(window.homeLayer=null,cc.director.loadScene("mainLayer"))}.bind(this)))),this.checkEquip()}else this.abled=!0,this.door[this.pos].node.color=cc.Color.GRAY},initDoors:function(){for(var e=this,t=["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"],i=0;i<4;i++){var o=this.typeList[i];-1==o?this.door[i].node.active=!1:o>0&&function(){var c=e.mark[i];cc.loader.loadRes("Texture/battle/"+t[o-1],cc.SpriteFrame,function(e,t){c.spriteFrame=t}.bind(e))}()}},initRoom:function(){if(this.isNewRoom)if(1==o.roomType||o.roomType>=6)cc.loader.loadRes("Texture/monster/"+o.monsterId,cc.SpriteFrame,function(e,t){this.monsterFigure.spriteFrame=t}.bind(this)),this.monsterNode.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever()),this.btnAlter.node.active=!1;else if(o.roomType>0){cc.loader.loadRes("Texture/battle/"+["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"][o.roomType-1],cc.SpriteFrame,function(e,t){this.btnAlter.spriteFrame=t}.bind(this))}else this.btnAlter.node.active=!1;else if(1==o.roomType)this.btnAlter.node.active=!1;else if(o.roomType>=6)o.floorBeats[o.floor-1]?cc.loader.loadRes("Texture/battle/mark_treasure",cc.SpriteFrame,function(e,t){this.btnAlter.spriteFrame=t}.bind(this)):this.btnAlter.node.active=!1;else if(5==o.roomType)cc.loader.loadRes("Texture/battle/mark_shop",cc.SpriteFrame,function(e,t){this.btnAlter.spriteFrame=t}.bind(this));else if(o.floorBeats[o.floor-1])this.btnAlter.node.active=!1;else if(o.roomType>0){cc.loader.loadRes("Texture/battle/"+["mark_monster","mark_camp","mark_treasure","mark_event","mark_shop","mark_elite","mark_boss"][o.roomType-1],cc.SpriteFrame,function(e,t){this.btnAlter.spriteFrame=t}.bind(this))}else this.btnAlter.node.active=!1},gotoDoor:function(e,t){if(t!=this.pos&&this.abled){this.abled=!1;var i=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];if(o.heroPos=(parseInt(t)+2)%4,o.floor++,o.castle<3&&o.floor>12)o.floor=1,o.castle++,o.historyPath=[],o.historyChoose=[],o.floorBeats=[];else if(3==o.castle&&o.floor>13)return void window.homeLayer.openComplete();o.historyChoose[o.floor-1]=t,o.roomType=this.typeList[t],(1==o.roomType||o.roomType>=6)&&(o.monsterId=o.monsterCfg[t]),this.hero.runAction(cc.sequence(cc.moveTo(.2,i[t]),cc.callFunc(function(){window.homeLayer.changeRoom(t)}.bind(this))))}},openAlter:function(){window.homeLayer.openAlter()},checkEquip:function(){2==o.roomType&&o.equip.indexOf(38)>=0&&(o.hp=Math.min(o.hp+10,o.hpMax)),3==o.roomType&&o.equip.indexOf(42)>=0&&(o.copper+=30)},initFloorConfig:function(){if(o.floor>o.historyPath.length||this.pos!=o.floorCfg.indexOf(-2)){if(this.typeList=[-1,-1,-1,-1],this.typeList[this.pos]=-2,1==o.floor)this.typeList[(this.pos+2)%4]=1;else if(11==o.floor)this.typeList[(this.pos+2)%4]=7;else if(12==o.floor)3==o.castle?this.typeList[(this.pos+2)%4]=7:this.typeList[(this.pos+2)%4]=0;else if(13==o.floor)this.typeList[(this.pos+2)%4]=0;else{var e=[];if(3==o.floor||7==o.floor||9==o.floor)e=Math.random()<.4?[1,1,1]:[1,1];else if(5==o.floor)e=[6,6];else{var t=5;o.specialRoomIds.length>0&&(t=o.specialRoomIds.shift()),e=Math.random()<.3?[t,1,1]:[t,1]}e.length<3&&e.splice(Math.floor(3*Math.random()),0,-1);for(var i=0;i<4;i++)if(i!=this.pos){var c=Math.floor(Math.random()*e.length),s=e[c];e.splice(c,1),this.typeList[i]=s}}if(o.floorCfg=this.typeList,o.historyPath.push(this.typeList),1!=o.roomType&&o.roomType<6&&this.initMonsterCfg(),4==o.roomType)o.eventIds.length>0?o.eventId=o.eventIds.shift():o.eventId=Math.floor(17*Math.random())+1;else if(5==o.roomType){for(var n=[],r=[],a=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];n.length<3;){for(var h=0,d=Math.random(),l=0,f=0;f<3;f++)if(d<(l+=a[o.castle-1][f])){h=f+1;break}for(var p=o.getNewCardId(h),u=!1,m=0;m<n.length;m++)if(p==n[m]){u=!0;break}u||n.push(p)}for(a=[[.4,.4,.2],[.3,.4,.3],[.2,.4,.4]];r.length<3;){for(var g=0,w=Math.random(),v=0,y=0;y<3;y++)if(w<(v+=a[o.castle-1][y])){g=y+1;break}for(var b=o.getNewItemId(1,g),C=!1,x=0;x<r.length;x++)if(b==r[x]){C=!0;break}C||r.push(b)}o.shopIds=n.concat(r,[1,2]),o.itemEffect.vip1&&(o.discountItem=Math.floor(3*Math.random())),o.itemEffect.vip2&&(o.discountCard=Math.floor(3*Math.random()))}}else o.floorCfg=this.typeList=o.historyPath[o.floor-1]},initMonsterCfg:function(){o.monsterCfg=[0,0,0,0];for(var e=2*(o.castle-1)+(o.floor<=5?1:2),t=0;t<4;t++){var i=this.typeList[t];if(1==i||i>=6){for(var c=0;c<=0;){var s=1==i?0:6==i?1:2;12==o.floor&&(e=7,s=3);var n=o.getNewMonsterId(e,s);o.monsterCfg.indexOf(n)<0&&(c=n)}o.monsterCfg[t]=c}}}}),cc._RF.pop()},{Game:"Game"}],ShopItem:[function(e,t,i){"use strict";cc._RF.push(t,"47158KpbiJMF46lKbQmGdRL","ShopItem");var o=e("Game"),c=e("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,potionPrefab:cc.Prefab,txtCost:cc.Label,txtDiscount:cc.Node,iconNode:cc.Node},init:function(e,t,i){this.cfgId=e,this.type=t;var o=void 0;0==t?((o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),this.cost=3*c.get("cfg_card",e).value):1==t?((o=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(e),this.cost=6*c.get("cfg_item",e).value):((o=cc.instantiate(this.potionPrefab)).getComponent("PotionCommodity").init(e),this.cost=1==e?20:50),o.position=cc.v2(0,1==t?20:10),this.iconNode.addChild(o),this.item=o,i&&(this.txtDiscount.active=!0,this.cost=Math.ceil(this.cost/3)),this.txtCost.string=this.cost},buy:function(){if(o.copper>=this.cost){o.copper-=this.cost,0==this.type?o.getCard(this.cfgId):1==this.type?o.getItem(this.cfgId):o.hp=Math.min(o.hp+10*this.cfgId,o.hpMax);var e=o.shopIds.indexOf(this.cfgId);o.shopIds[e]=0,this.node.destroy(),window.homeLayer.refreshHeroData()}else this.item.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0)))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(e,t,i){"use strict";cc._RF.push(t,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{boxs:[cc.Node],shopItemPrefab:cc.Prefab,curtain:cc.Node,title:cc.Node},onLoad:function(){window.shopLayer=this,this.initCards(),this.initEquip(),this.initPotions(),this.curtain.runAction(cc.moveTo(.15,cc.v2(0,-17))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.moveTo(.25,cc.v2(9,-35)))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.skewTo(.2,2,0),cc.skewTo(.2,-2,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,0,0)))},initCards:function(){for(var e=0;e<3;e++){var t=o.shopIds[e];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,0,e==o.discountCard),i.position=cc.v2(e%3*245-245,0),this.boxs[0].addChild(i)}}this.boxs[0].x=-750,this.boxs[0].y+=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[0].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0))))},initEquip:function(){for(var e=0;e<3;e++){var t=o.shopIds[e+3];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,1,e==o.discountItem),i.position=cc.v2(e%3*245-245,0),this.boxs[1].addChild(i)}}this.boxs[1].x=750,this.boxs[1].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0))))},initPotions:function(){for(var e=0;e<2;e++){var t=o.shopIds[e+6];if(t>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(t,2),i.position=cc.v2(e%3*245-245,0),this.boxs[2].addChild(i)}}this.boxs[2].x=-750,this.boxs[2].y-=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[2].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.2,cc.v2(750,0))))},close:function(){this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0)))),this.boxs[0].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0)))),this.title.runAction(cc.moveTo(.2,cc.v2(9,230))),this.curtain.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.1,cc.v2(0,43)))),this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4)}}),cc._RF.pop()},{Game:"Game"}],SkillManager:[function(e,t,i){"use strict";cc._RF.push(t,"f9b8a6FzCFFt4zg92Jc9Ljj","SkillManager");var o=e("Game"),c={doCast:function(e){var t=window.mainLayer.hero,i=window.mainLayer.enemy;if(1==o.heroId)0==e?i.onHurt(5,4):1==e&&(t.buff.doubleDmg*=2);else if(2==o.heroId)if(0==e)t.player.createExDice();else if(1==e){for(var c=t.player.cardList.length-1;c>=0;c--)t.player.cardList[c].getComponent("Card").discard();t.player.cardList=[],t.player.createChest(!0)}}};t.exports=c,cc._RF.pop()},{Game:"Game"}],Skill:[function(e,t,i){"use strict";cc._RF.push(t,"84424zovvVHiZ6bvX7VE49L","Skill");var o=e("Game"),c=e("SkillManager");cc.Class({extends:cc.Component,properties:{txtCost:cc.Label,icon:cc.Sprite,btn:cc.Button,txtName:cc.Label,mask:cc.Node},init:function(e){if(this.index=e,this.lock=!0,this.abled=!0,this.cost=10*(e+1),1==e&&o.level<3&&(this.lock=!1),this.lock){var t=[["\u8865\u5200","\u53cc\u6253"],["\u521b\u9020","\u5927\u6ee1\u8d2f"]][o.heroId-1];this.txtName.string=t[e],this.txtCost.string=this.cost,cc.loader.loadRes("Texture/hero/skill/"+(2*o.heroId-1+e),cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this))}else this.txtName.string="3\u7ea7\u89e3\u9501",cc.loader.loadRes("Texture/battle/mark_skill",cc.SpriteFrame,function(e,t){this.icon.spriteFrame=t}.bind(this));this.check()},check:function(){this.lock&&this.abled&&window.mainLayer.hero.power>=this.cost?this.btn.interactable=!0:this.btn.interactable=!1,this.btn.interactable?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=this.lock)},doSkill:function(){0==window.mainLayer.roundId&&(this.abled=!1,window.mainLayer.hero.addPower(-this.cost),c.doCast(this.index))}}),cc._RF.pop()},{Game:"Game",SkillManager:"SkillManager"}],TreasureLayer:[function(e,t,i){"use strict";cc._RF.push(t,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var o=e("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,btnGets:[cc.Node],btnClose:cc.Node},init:function(e){this.isBoss=e;for(var t=0,i=e?[[.5,.3,.2],[.2,.4,.4],[0,.5,.5]]:[[.6,.3,.1],[.3,.4,.3],[.1,.4,.5]],c=Math.random(),s=0,n=0;n<3;n++)if(c<(s+=i[o.castle-1][n])){t=n+1;break}5==o.roomType?t++:o.itemEffect.vase>0&&(o.itemEffect.vase--,t++),t=Math.min(t,3),this.cfgIdList=[];var r=1;e?r=2:o.itemEffect.flagon>0&&(o.itemEffect.flagon--,r=2);var a=o.getNewItemId(e?2:0,t);if(this.cfgIdList.push(a),2==r){for(var h=0;h<=0;){var d=o.getNewItemId(e?2:0,t);d!=a&&(h=d)}this.cfgIdList.push(h)}this.initItem(),this.itemGot=0},initItem:function(){var e;1==this.cfgIdList.length?((e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[0]),e.position=cc.v2(0,70),this.node.addChild(e)):((e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[0]),e.position=cc.v2(-165,70),this.node.addChild(e),(e=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(this.cfgIdList[1]),e.position=cc.v2(165,70),this.node.addChild(e),this.btnGets[1].active=!0,this.btnClose.position=cc.v2(0,-425))},onGet:function(e,t){o.getItem(this.cfgIdList[t]),this.isBoss?this.close():(this.btnGets[t].active=!1,this.itemGot++,this.itemGot>=this.cfgIdList.length&&this.close())},onGiveUp:function(){this.close()},close:function(){this.node.destroy(),window.room.btnAlter.node.active=!1,o.floorBeats[o.floor-1]=3==o.roomType}}),cc._RF.pop()},{Game:"Game"}],Utils:[function(e,t,i){"use strict";cc._RF.push(t,"85bfaYPayFNlrAFvtzNUMAc","Utils");var o={numberFormat:function(e){return e/1e13>=1?Math.floor(e/1e12)+"T":e/1e10>=1?Math.floor(e/1e9)+"B":e/1e7>=1?Math.floor(e/1e6)+"M":e/1e4>=1?Math.floor(e/1e3)+"K":e},timeFormat:function(e,t){var i=Math.round(e/1e3),o=i%60,c=t>1?Math.floor(i/60)%60:Math.floor(i/60),s=3==t?Math.floor(i/3600)%24:Math.floor(i/3600),n=Math.floor(i/86400),r=function(e){return e<10?"0"+e:e};return 1==t?r(c)+":"+r(o):2==t?r(s)+":"+r(c)+":"+r(o):n+"\u5929"+s+"\u65f6"+c+"\u5206"},getDifferentRandomNum:function(e,t,i){t=t||1,i=i||0;for(var o=[];o.length<e;){for(var c=Math.floor(Math.random()*(t-i+1))+i,s=!1,n=0;n<o.length;n++)if(o[n]-c==0){s=!0;break}s||o.push(c)}return o},createImage:function(e,t){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var e=new cc.Texture2D;e.initWithElement(i),e.handleLoadedTexture(),t.spriteFrame=new cc.SpriteFrame(e)}catch(e){cc.log(e),t.node.active=!1}},i.src=e}catch(e){cc.log(e),t.node.active=!1}else try{cc.loader.load({url:e,type:"jpg"},function(e,i){t.spriteFrame=new cc.SpriteFrame(i)})}catch(e){cc.log(e),t.node.active=!1}},substring:function(e,t){if(e.replace(/[\u4e00-\u9fa5]/g,"**").length<=t)return e;for(var i=0,o="",c=0;c<e.length&&(/[\u4e00-\u9fa5]/.test(e[c])?i+=2:i+=1,!(i>t));c++)o+=e[c];return o},getMd5Url:function(e){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(e)):cc.url.raw(e)},numToStr:function(e,t){t=t||1;for(var i=""+e,o=1;o<=t;o++)e<Math.pow(10,o)&&(i="0"+i);return i}};t.exports=o,cc._RF.pop()},{}],Yahtzee:[function(e,t,i){"use strict";cc._RF.push(t,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee"),cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label,boxDesc:cc.Node},onLoad:function(){window.yahtzeeLayer=this,this.descOpen=!0},start:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),this.roundId=1,this.hostId=0,this.doRound(),this.boxDesc.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(this.openDesc,this)))},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,window.player.startRound()},endRound:function(){for(var e=this,t=function(t){var i=e.hero.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,300)),cc.delayTime(1.5),cc.callFunc(function(){this.hero.dicePool.put(i)}.bind(e))))},i=0;i<5;i++)t(i);var o=function(t){var i=e.enemy.diceList[t];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-300)),cc.delayTime(1.5),cc.callFunc(function(){this.enemy.dicePool.put(i)}.bind(e))))};for(i=0;i<5;i++)o(i);this.scheduleOnce(function(){this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.hero.doWin():this.hero.score<this.enemy.score?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),1.5),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(e){var t=cc.instantiate(this.endPrefab);t.getComponent("EndYahtzeeLayer").init(e),this.node.addChild(t)},openDesc:function(){this.boxDesc.stopAllActions(),this.descOpen?(this.descOpen=!1,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-428,93)))):(this.descOpen=!0,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-279,93))))}}),cc._RF.pop()},{}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardCollection","CardManager","Chest","CompleteLayer","Config","CoverLayer","Dice","DiceYahtzee","DmgAnimation","Edit","EditEndLayer","EndLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","HelloWorld","Hero","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerYahtzee","PotionCommodity","RequireRound","Room","ShopItem","ShopLayer","Skill","SkillManager","TreasureLayer","Utils","Yahtzee"]);