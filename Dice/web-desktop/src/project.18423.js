window.__require=function t(e,i,c){function o(s,n){if(!i[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!n&&h)return h(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+s+"'")}}var d=i[s]={exports:{}};e[s][0].call(d.exports,function(t){return o(e[s][1][t]||t)},d,d.exports,t,e,i,c)}return i[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<c.length;s++)o(c[s]);return o}({AIYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var t=[0,0,0,0,0,0],e=0;e<5;e++){var i=this.player.diceList[e].getComponent("DiceYahtzee");t[i.element-1]++}for(var c=-1,o=-1,a=0;a<6;a++)t[a]>(t[c]||0)&&(c=a);for(var s=0;s<6;s++)s!=c&&t[s]>(t[o]||0)&&(o=s);this.scheduleOnce(function(){t[c]>1?t[c]==t[o]?this.hold(c,o):this.hold(c):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(t,e){for(var i=0,c=0;c<5;c++){var o=this.player.diceList[c].getComponent("DiceYahtzee");o.holded?o.element!=t+1&&null!=e&&o.element!=e+1&&(o.doHold(),i++):(o.element==t+1||null!=e&&o.element==e+1)&&(o.doHold(),i++)}var a=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),a)}}),cc._RF.pop()},{}],AI:[function(t,e,i){"use strict";cc._RF.push(e,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy"),this.castList=[]},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var t=1,e=100,i=null,c=0;c<this.cards.length;c++){var o=this.cards[c].getComponent("Card");o.usable&&(o.cfg.priority<e||o.cfg.priority==e&&o.rate>t)&&(t=o.rate,e=o.cfg.priority,i=o)}i?i.cast():this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.8):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.6)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var t=[0,0,0,0,0,0],e=0;e<this.cards.length;e++){var i=this.cards[e].getComponent("Card");(m=i.require.split(";")).length>1&&t[m[0]-1]++;for(var c=["A","B","C","D","E","F"],o=0;o<6;o++)if(i.cfg.desc.indexOf(c[o])>=0){t[o]++;break}}for(var a=!1,s=0;s<6;s++)if(t[s]>0){a=!0;break}for(var n=[],r=0;r<this.cards.length;r++){var h=this.cards[r].getComponent("Card"),d=[0,0,0,0,0,0];if(h.require>=101&&h.require<=105){for(var l=0,f=0,p=0;p<6;p++)(!a||t[p]>0)&&this.player.elementList[p]>l&&(l=this.player.elementList[p],f=p+1);if(d=[-100,-100,-100,-100,-100,-100],l>=a||2){d[f-1]=[2,3,3,4,5][h.require-101]-l}}else{var u=[0,0,0,0,0,0];if(106==h.require||107==h.require)u=[1,1,1,1,1,1];else for(var m=h.require.split(";"),g=0;g<m.length;g++)u[m[g]-1]++;for(var w=["A","B","C","D","E","F"],v=0;v<6;v++){var y=u[v];h.cfg.desc.indexOf(w[v])>=0&&(y=this.player.elementList[v]+1),d[v]=y-this.player.elementList[v]}}n.push(d)}for(var b=100,C=0,x=0,k=1,L=0;L<n.length;L++){for(var I=n[L],q=0,B=0,T=0;T<I.length;T++)q+=I[T]<-10?0:Math.abs(I[T]),B+=I[T];(q<b||q==b&&B>C||q==b&&B==C&&this.cards[L].getComponent("Card").rate<k)&&(b=q,C=B,x=L,k=this.cards[L].getComponent("Card").rate)}for(var E=n[x],R=0;R<6;R++)if(0!=E[R]){var M=E[R]+this.player.elementList[R]-this.player.holdList[R];if(M>0)for(var S=0;S<this.dices.length;S++){var N=this.dices[S].getComponent("Dice");if(N.element==R+1&&!(N.holded||N.lock||N.freeze||N.temp)&&(N.hold(),0==--M))break}else if(M<0)for(var F=0;F<this.dices.length;F++){var A=this.dices[F].getComponent("Dice");if(A.element==R+1&&A.holded&&!A.lock&&!A.freeze&&!A.temp&&(A.hold(),0==++M))break}}this.player.roll();for(var D=!1,P=0;P<this.dices.length;P++){var _=this.dices[P].getComponent("Dice");if(!(_.holded||_.lock||_.freeze||_.temp)){D=!0;break}}this.scheduleOnce(function(){D?this.check():this.player.endRound()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var t=0;t<this.player.cardList.length;t++){var e=this.player.cardList[t].getComponent("Card");e.silence||e.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(e)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var c=this.player.diceList[i];c.lock||this.dices.push(c)}},insertAndCast:function(t){}}),cc._RF.pop()},{}],Buff:[function(t,e,i){"use strict";cc._RF.push(e,"76faa8y1jVIcqDL176r9ktK","Buff"),cc.Class({extends:cc.Component,properties:{buffBox:cc.Node,txtBuff:cc.RichText},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.multiCast=0,this.multiCastMax=0,this.selfHarmCast=0,this.selfHarmCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.burnIce=!1,this.silenceDark=!1,this.atkAd3=!1,this.creatDiceFire=0,this.exCreateDice=0,this.tempBuff=[0,0,0,0],this.table={};for(var t=[13,21,22,23,24,25,26,27,28,29,30,101,102,103,104,105,106,107,108],e=0;e<t.length;e++)this.table[t[e]]=0;this.quote(),this.refreshBuff()},addBuff:function(t,e){if(!(e<=0)){if(13==t)this.player.anim.show(13);else if(t>=21&&t<=30){if(this.immunity>0)return this.removeBuff(105,1),this.player.equip.doTrigger(37),void this.player.assertHpChange("MISS",3);if(t<=26){if(this.opponent.equip.checkWithTrigger(t+10))e+=26==t?2:1;23==t&&this.opponent.equip.trigger(68)}this.player.anim.show(t)}this.table[t]+=e,this.quote();for(var i=!1,c=0;c<this.buffList.length;c++)if(this.buffList[c]==t){i=!0;break}i||this.buffList.push(t),this.refreshBuff()}},removeBuff:function(t,e){if(!(e<=0)){if(this.table[t]-=e,this.table[t]<=0){this.table[t]=0;var i=this.buffList.indexOf(t);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28],this.chaos=this.table[29],this.blind=this.table[30],this.exRound=this.table[101],this.undead=this.table[102],this.atkBack=this.table[103],this.atkAdd=this.table[104],this.immunity=this.table[105],this.hurtReduce=this.table[106],this.doubleDmg=this.table[107],this.doubleCast=this.table[108]},refreshBuff:function(){var t="",e={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",29:"\u6df7\u4e71",30:"\u76f2\u76ee",101:"\u989d\u5916\u56de\u5408",102:"\u4e0d\u6b7b",103:"\u53cd\u4f24",104:"\u4f24\u5bb3\u63d0\u5347",105:"\u514d\u75ab",106:"\u53d7\u4f24\u51cf\u514d",107:"\u53cc\u500d\u4f24\u5bb3",108:"\u91cd\u590d\u884c\u52a8"},i={13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1",101:"FFF830",102:"FF5567",103:"FF5567",104:"FFF830",105:"42EBFF",106:"FF5567",107:"F15162",108:"E2BD6D"};if(1==this.buffList.length){var c=this.buffList[0];t+="<img src='"+this.getBuffImg(c)+"'/>",t+="<color="+i[c]+">"+e[c]+this.table[c]+"</c>"}else for(var o=0;o<this.buffList.length;o++){var a=this.buffList[o];t+="<img src='"+this.getBuffImg(a)+"'/>",t+="<color="+i[a]+">"+this.table[a]+"</c>  "}if(this.player.host.txtBuff.string=t,this.buffBox.active){t="";var s=50;this.opponent.equip.check(54)&&(s+=25),this.player.equip.check(56)&&(s-=25),this.player.equip.check(113)&&(s*=2),this.opponent.equip.check(113)&&(s*=2);for(var n={13:"\u5bf9\u624b\u4f7f\u7528\u7684\u4e0b\u4e00\u5f20\u653b\u51fb\u724c\u65e0\u6548",21:"\u4f7f\u7528\u5e26\u6709\u71c3\u70e7\u6548\u679c\u7684\u5361\u724c\u65f6\uff0c\u53d7\u52303\u706b\u4f24\u5bb3",22:"\u88ab\u51bb\u7ed3\u7684\u9ab0\u5b50\u65e0\u6cd5\u88ab\u91cd\u63b7",23:"\u53d7\u5230\u4f24\u5bb3\u65f6\uff0c\u989d\u5916\u627f\u53d7"+s+"%\u4f24\u5bb3",24:"\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u51cf\u5c11"+(this.opponent.equip.check(55)?50:30)+"%",25:"\u88ab\u6c89\u9ed8\u7684\u5361\u724c\u65e0\u6cd5\u4f7f\u7528",26:"\u56de\u5408\u5f00\u59cb\u65f6\u53d7\u5230\u4e2d\u6bd2\u5c42\u6570\u7684\u4f24\u5bb3\uff0c\u4e2d\u6bd2\u5c42\u6570-1",27:"\u4f7f\u7528\u5361\u724c\u65f6\u6709"+(this.opponent.equip.check(107)?80:50)+"%\u6982\u7387\u65e0\u6548\uff0c\u8bc5\u5492\u5c42\u6570-1",28:"\u88ab\u7981\u9522\u7684\u9ab0\u5b50\u65e0\u6cd5\u4f7f\u7528",29:"\u4f7f\u7528\u653b\u51fb\u724c\u65f6\u670950%\u6982\u7387\u66f4\u6362\u76ee\u6807\uff0c\u6df7\u4e71\u5c42\u6570-1",30:"\u65e0\u6cd5\u770b\u89c1\u88ab\u76f2\u76ee\u7684\u9ab0\u5b50\u7684\u5143\u7d20",101:"\u56de\u5408\u7ed3\u675f\u65f6\u5f00\u59cb\u989d\u5916\u7684\u5df1\u65b9\u56de\u5408",102:"\u751f\u547d\u65e0\u6cd5\u51cf\u5c11\u52301\u4ee5\u4e0b",103:"\u53d7\u5230\u4f24\u5bb3\u65f6\uff0c\u5bf9\u5bf9\u624b\u9020\u6210\u53cd\u4f24\u5c42\u6570\u7684\u4f24\u5bb3",104:"\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u589e\u52a0\u5c42\u6570",105:"\u65e0\u6548\u4e0b\u4e00\u6b21\u83b7\u5f97\u7684\u8d1f\u9762\u72b6\u6001",106:"\u53d7\u5230\u7684\u4f24\u5bb3\u51cf\u5c11\u5c42\u6570",107:"\u4e0b\u4e00\u6b21\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u7ffb\u500d",108:"\u4e0b\u4e00\u5f20\u5361\u724c\u989d\u5916\u4f7f\u7528\u4e00\u6b21"},r=0;r<this.buffList.length;r++){var h=this.buffList[r];t+="<img src='"+this.getBuffImg(h)+"'/>",t+="<color="+i[h]+">"+e[h]+this.table[h]+": "+n[h]+"</c>",r!=this.buffList.length-1&&(t+="\r\n")}this.txtBuff.string=t,this.buffBox.height=14+30*this.buffList.length,this.buffBox.width=this.txtBuff.node.width+20,this.txtBuff.node.x=-this.txtBuff.node.width/2}},getBuffImg:function(t){var e={13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind",101:"exRound",102:"undead",103:"atkback",104:"atkAdd",105:"immunity",106:"hurtReduce",107:"doubleDmg",108:"doubleAction"}[t];if(23==t){var i=0;(this.opponent.equip.check(54)||this.opponent.equip.check(113)||this.player.equip.check(113))&&i++,this.player.equip.check(56)&&i--,i>0?e="frailPlus":i<0&&(e="frailMinus")}else 24==t&&this.opponent.equip.check(55)&&(e="weakPlus");return e},openBuffList:function(){if(0!=this.buffList.length){if(window.mainLayer.buffTip){if(window.mainLayer.buffTip==this)return void this.hideTip();window.mainLayer.buffTip.hideTip()}this.buffBox.active=!0,this.refreshBuff(),window.mainLayer.buffTip=this,this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.buffBox.active=!1,window.mainLayer.buffTip=null}}),cc._RF.pop()},{}],CampLayer:[function(t,e,i){"use strict";cc._RF.push(e,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{txtHeal:cc.Label,txtCopper:cc.Label,btnHeal:cc.Node,btnCopper:cc.Node,btnDelete:cc.Node,btnEquip:cc.Node,boxHeal:cc.Node,boxCopper:cc.Node,boxDelete:cc.Node,boxEquip:cc.Node},onLoad:function(){window.campLayer=this;var t=1;c.data.equip.indexOf(39)>=0&&(t+=.5),c.data.equip.indexOf(89)>=0&&(t=0),this.hp=Math.floor(.35*c.data.hpMax*t),this.copper=7*(c.data.castle+3),this.txtHeal.string="\u751f\u547d+"+this.hp,t>1?this.txtHeal.node.color=cc.color(255,230,62):t<1&&(this.txtHeal.node.color=cc.color(49,248,255)),this.txtCopper.string="\u91d1\u5e01+"+this.copper,4==c.data.heroId&&(this.boxCopper.active=!1,this.boxDelete.active=!0),c.data.equip.indexOf(38)>=0&&(this.boxEquip.active=!0,this.boxHeal.x=-240,this.boxCopper.x=this.boxDelete.x=0),this.btnHeal.opacity=1,this.btnCopper.opacity=1,this.btnDelete.opacity=1,this.btnEquip.opacity=1,this.btnHeal.y-=150,this.btnCopper.y-=150,this.btnDelete.y-=150,this.btnEquip.y-=150,this.btnHeal.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnCopper.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnDelete.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnEquip.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))},onHeal:function(){c.data.hp=Math.min(c.data.hp+this.hp,c.data.hpMax),cc.audioEngine.playEffect(window.sound.healSound),this.close()},onCopper:function(){c.data.copper+=this.copper,cc.audioEngine.playEffect(window.sound.copperSound),this.close()},onDelete:function(){window.homeLayer.openDelete(),this.close()},onEquip:function(){window.homeLayer.openTreasure(),this.close()},close:function(){this.node.destroy(),window.homeLayer.refreshHeroData(),c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.campLayer=null}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,chestPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node,mask:cc.Node,scrollView:cc.ScrollView,boxRandom:cc.Node},onLoad:function(){window.bagLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var t=0;window.equipLayer?(t=.15,window.equipLayer.close()):window.mapLayer&&(t=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(t),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initDeck(),this.initBag(),c.newCard&&(c.newCard=!1,window.homeLayer.refreshHeroData()),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initDeck:function(){if(4==c.data.heroId)return this.boxDeck.active=!1,this.scrollView.getComponent(cc.Widget).top=158,void this.scrollView.getComponent(cc.Widget).updateAlignment();this.deck=[];for(var t=5==c.data.heroId?2:3,e=0;e<c.data.deck.length;e++){var i=cc.instantiate(this.cardPrefab);i.getComponent("CardCollection").init(c.data.deck[e],0),i.position=cc.v2(e%t*247-247,104-210*Math.floor(e/t)),this.boxDeck.addChild(i),this.deck[e]=i}if(5==c.data.heroId){var o=cc.instantiate(this.chestPrefab);o.position=cc.v2(240,0),this.boxDeck.addChild(o)}else 2==c.data.heroId&&3==c.data.difficulty&&(this.boxRandom.active=!0)},initBag:function(){c.data.cardBag.sort(function(t,e){return o.get("cfg_card",t).element==o.get("cfg_card",e).element?t-e:o.get("cfg_card",t).element-o.get("cfg_card",e).element}),this.bagList=[];for(var t=0;t<c.data.cardBag.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.cardBag[t],1),e.position=cc.v2(t%3*247-247,-120-210*Math.floor(t/3)),this.content.addChild(e),this.bagList.push(e)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+530,4==c.data.heroId&&(this.contentHeight+=450),this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},equip:function(t){for(var e=-1,i=5==c.data.heroId?4:2==c.data.heroId&&3==c.data.difficulty?5:6,o=0;o<i;o++)if(null==this.deck[o]){e=o;break}if(e>=0){t.parent=this.boxDeck;var a=5==c.data.heroId?2:3;t.position=cc.v2(e%a*247-247,104-210*Math.floor(e/a)),t.getComponent("CardCollection").colletType=0;var s=t.getComponent("CardCollection").cfgId;this.deck[e]=t;var n=c.data.cardBag.indexOf(s);c.data.cardBag.splice(n,1);n=this.bagList.indexOf(t);this.bagList.splice(n,1),this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)}},unEquip:function(t){var e=this.deck.indexOf(t);this.deck[e]=null;for(var i=c.data.cardBag.length,a=t.getComponent("CardCollection").cfgId,s=0;s<c.data.cardBag.length;s++)if(o.get("cfg_card",a).element<o.get("cfg_card",c.data.cardBag[s]).element||o.get("cfg_card",a).element==o.get("cfg_card",c.data.cardBag[s]).element&&a<c.data.cardBag[s]){i=s;break}c.data.cardBag.splice(i,0,a),this.bagList.splice(i,0,t),t.parent=this.content,t.position=cc.v2(i%3*247-247,-120-210*Math.floor(i/3)),t.getComponent("CardCollection").colletType=1,this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)},refreshBag:function(){for(var t=0;t<this.bagList.length;t++)this.bagList[t].runAction(cc.moveTo(.15,cc.v2(t%3*247-247,-120-210*Math.floor(t/3))));this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},close:function(){if(4!=c.data.heroId){c.data.deck=[];for(var t=0;t<6;t++)null!=this.deck[t]&&c.data.deck.push(this.deck[t].getComponent("CardCollection").cfgId)}this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null,window.homeLayer.btnDeck.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardChangeLayer:[function(t,e,i){"use strict";cc._RF.push(e,"0efbet/DcpBqY6/+LvJ5kbp","CardChangeLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,btns:[cc.Node],bg:cc.Node},init:function(t,e,i){window.changeLayer=this,this.cfgId=t,this.cfgId2=e,this.closeFunc=i,this.count=0,this.initDeck(),this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initDeck:function(){for(var t=0;t<c.data.deck.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.deck[t]),e.position=cc.v2(t%3*248-248,385-300*Math.floor(t/3)),this.bg.addChild(e)}},initCards:function(){var t=cc.instantiate(this.cardPrefab);if(t.getComponent("CardCollection").init(this.cfgId),t.position=cc.v2(0,-420),this.bg.addChild(t),this.cfgId2){t.x=-165;var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(this.cfgId2),e.position=cc.v2(165,-420),this.bg.addChild(e)}},onChange:function(t,e){this.btns[e].active=!1,0==this.count?(c.data.deck[e]=this.cfgId,this.count++,this.cfgId2||this.close()):(c.data.deck[e]=this.cfgId2,this.close()),cc.audioEngine.playEffect(window.sound.bingo)},close:function(){this.node.destroy(),window.changeLayer=null,this.closeFunc&&this.closeFunc()}}),cc._RF.pop()},{Game:"Game"}],CardCollection:[function(t,e,i){"use strict";cc._RF.push(e,"a28bfVp4ABL54sr47isHV8F","CardCollection");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,btn:cc.Button,box:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,markDelete:cc.Node,explode:cc.Node},init:function(t,e,i){this.cfgId=t,this.cfg=o.get("cfg_card",t);var a=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],s=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],n=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.element=this.cfg.element,this.btn.node.color=a[this.element-1],this.box.color=s[this.element-1],this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=n[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.txtDesc.string=c.analysisDesc(this.cfg.desc1);var r=this.cfg.require;if(r>=101&&r<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][r-101];for(var h=[[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][r-101],d=0;d<h.length;d++)this.createCircle(0,h[d])}else{this.requireNode.y-=8;for(var l=r.split(";"),f=(h=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][l.length-1],0);f<l.length;f++)this.createCircle(parseInt(l[f]),h[f])}null!=e&&(this.btn.interactable=!0,this.colletType=e),null!=i&&(this.explode.active=!0,-1==i?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(t,e){this.explode.getComponent(cc.Sprite).spriteFrame=e}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(t,e){this.explode.getComponent(cc.Sprite).spriteFrame=e}.bind(this)))},createCircle:function(t,e){var i=cc.instantiate(this.requirePrefab);i.getComponent("RequireRound").init(t,this.element),i.position=cc.v2(e,24),this.requireNode.addChild(i),t>0&&i.getComponent("RequireRound").refreshSatisfy(!0)},changeCollectType:function(){1==c.data.heroId&&3==c.data.difficulty||4==c.data.heroId&&2!=this.colletType||(0==this.colletType?window.bagLayer.unEquip(this.node):1==this.colletType?window.bagLayer.equip(this.node):2==this.colletType&&window.deleteLayer.confirm(this.cfgId))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardDeleteLayer:[function(t,e,i){"use strict";cc._RF.push(e,"ba205encTVLE4/a2/Sy3k6o","CardDeleteLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,content:cc.Node,confirmNode:cc.Node},onLoad:function(){window.deleteLayer=this,this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initCards:function(){c.data.cardBag.sort(function(t,e){return o.get("cfg_card",t).element==o.get("cfg_card",e).element?t-e:o.get("cfg_card",t).element-o.get("cfg_card",e).element});for(var t=0;t<c.data.cardBag.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.cardBag[t],2),e.position=cc.v2(t%3*247-247,-120-210*Math.floor(t/3)),this.content.addChild(e)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+1120,this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},confirm:function(t){this.cardId=t,this.confirmNode.active=!0;var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(t,0,-1),e.getComponent("CardCollection").markDelete.active=!0,e.position=cc.v2(0,100),this.confirmNode.addChild(e),cc.audioEngine.playEffect(window.sound.btn1)},doCancel:function(){this.confirmNode.active=!1},doDelete:function(){var t=c.data.cardBag.indexOf(this.cardId);c.data.cardBag.splice(t,1),this.close(),cc.audioEngine.playEffect(window.sound.delete)},close:function(){this.node.destroy(),window.deleteLayer=null}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardManager:[function(t,e,i){"use strict";cc._RF.push(e,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var c=t("Game"),o=t("Config"),a={doCast:function(t,e){this.cfgId=t;var i=o.get("cfg_card",t);if(this.desc=i.desc,this.card=e,this.chaos=!1,1==i.target1||1==i.target2||1==i.target3)if(window.player.atkPlayed++,window.player.buff.chaos>0&&Math.random()<.5)window.player.buff.removeBuff(29,1),this.chaos=!0;else if(window.opponent.buff.dodge>0)return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("MISS",2),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(t)},doEffect:function(t,e,i){1==i&&this.chaos&&(i=2);var c=null,o=(c=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,a=window.player.buff,s=0,n=1;if((e+="")<0){for(var r=["A","B","C","D","E","F"],h=0,d=0;d<6;d++)if(this.desc.indexOf(r[d])>=0){h=d;break}s=window.player.elementList[h]*Math.abs(parseInt(e))}else{var l=e.split(";");if(8==t)s=parseInt(l[0]),n=parseInt(l[1]);else if(1==l.length)s=parseInt(e);else{var f=parseInt(l[0]),p=parseInt(l[1]);s=window.player.equip.checkWithTrigger(120)?p:Math.floor(Math.random()*(p-f+1))+f}}if(t<10){if(1==i){if(s*=Math.pow(2,a.doubleDmg),a.removeBuff(107,a.doubleDmg),window.player.equip.wolfBlood&&a.addBuff(107,1),a.weak>0&&!window.player.equip.checkWithTrigger(65)){var u=.7;window.opponent.equip.checkWithTrigger(55)&&(u=.5),s=Math.ceil(s*u)}1==window.player.atkPlayed&&window.player.equip.checkWithTrigger(100)&&(s*=2)}for(var m=0;m<n;m++)c.onHurt(s,0,t,i)}else 11==t?c.player.updateArmor(s):12==t?c.onHeal(s):14==t?c.addPower&&c.addPower(s):(13==t||t>=21)&&o.addBuff(t,s)},doSpecial:function(t){var e=window.opponent.buff,i=window.player.buff;if(132==t)this.doEffect(11,window.host.armor,2);else if(133==t)this.doEffect(7,window.host.armor,1);else if(134==t)this.doEffect(7,2*window.host.armor,1),window.player.updateArmor(-window.host.armor);else if(135==t)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==t)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==t)this.doEffect(7,Math.floor(window.host.hp/2),1);else if(138==t)i.addBuff(102,2);else if(139==t)i.addBuff(101,1);else if(140==t)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==t)null!=window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==t)null!=window.host.power&&(this.doEffect(11,window.host.power,2),window.host.addPower(-window.host.power));else if(143==t)null!=window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==t)this.doEffect(7,2*e.poison,1);else if(145==t)this.doEffect(7,4*e.poison,1);else if(146==t)e.addBuff(26,e.poison);else if(147==t){for(var a=window.player.deck,s=0,n=0;n<a.length;n++){var r=o.get("cfg_card",a[n]);23!=r.effect1&&23!=r.effect2&&23!=r.effect3||s++}var h=20+4*s;this.doEffect(3,"4;"+h,1)}else if(148==t){var d=e.weak>0?20:10;this.doEffect(4,d,1)}else if(149==t)e.poison>0&&this.doEffect(26,1,1);else if(150==t){d=e.burn>0?16:8;this.doEffect(1,d,1)}else if(151==t)e.freeze>0&&this.doEffect(22,1,1);else if(152==t)e.silence>0&&this.doEffect(25,1,1);else if(t>=153&&t<=158){var l=[2,3,5,0,1,4][t-153];window.player.elementList[l]>=[2,2,2,3,3,3][t-153]&&this.doEffect(l+21,[1,1,2,2,2,1][t-153],1)}else if(t>=159&&t<=162)e.addBuff(Math.floor(10*Math.random())+21,162==t?2:1);else if(t>=163&&t<=166)this.doEffect(108,1,2);else if(167==t)i.multiCast++,i.multiCastMax++;else if(t>=168&&t<=171)this.doEffect(107,1,2);else if(172==t)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-e.freeze,1);else if(173==t)this.doEffect(21,window.opponent.deck.length-e.burn,1);else if(174==t)this.doEffect(1,6*e.burn,1);else if(175==t)this.doEffect(7,6*e.freeze,1);else if(176==t)this.doEffect(7,6*e.silence,1);else if(177==t)this.doEffect(7,4*e.frail,1);else if(178==t)this.doEffect(7,4*e.weak,1);else if(t>=179&&t<=182){d=(f=[1,6,6,10])[t-179]+(p=[3,2,3,4])[t-179]*(i.iteraList[t-179]-1);this.doEffect(7,d,1)}else if(t>=183&&t<=186){var f=[8,13,15,21],p=[3,3,4,5];s=Math.min(i.iteraList[t-179]-1,[2,4,3,4][t-183]),d=f[t-183]-p[t-183]*s;this.doEffect(7,d,1)}else if(187==t)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==t)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==t)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==t)this.doEffect(1,12+3*i.elementRoundCasted[0],1);else if(191==t)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==t)this.doEffect(3,12+3*i.elementRoundCasted[2],1);else if(193==t){if((s=Math.min(window.opponent.deck.length,6))>0){var u=Math.floor(Math.random()*s),m=window.opponent.deck[u];window.opponent.deck.splice(u,1),window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(194==t){if((s=Math.min(window.opponent.deck.length,6))>0){u=Math.floor(Math.random()*s),m=window.opponent.deck[u];window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(195==t){if((s=Math.min(window.opponent.deck.length,6))>0){u=Math.floor(Math.random()*s),m=window.opponent.deck[u];window.player.patchCard(m)}}else if(196==t){var g=c.getRandomCardId(2);window.player.patchCard(g,!0),window.player.deck.push(g)}else if(197==t){g=c.getRandomCardId(2);window.player.patchCard(g,null,!0)}else if(198==t){var w=function(){var t=window.player.patchCard();t&&(2!=t.getComponent("Card").element&&window.player.cardList.length<6?t.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){w()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&(window.mainLayer.gameOver||window.mainLayer.enemy.ai.check())}.bind(this),.8))}.bind(this);w()}else if(199==t)window.player.diceCount++,window.player.host.txtDice.string="\xd7"+window.player.diceCount,window.player.createExDice();else if(200==t)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==t){for(var v=21;v<=30;v++)i.removeBuff(v,i.table[v]);for(var y=0;y<window.player.cardList.length;y++)window.player.cardList[y].getComponent("Card").clear();for(var b=0;b<window.player.diceList.length;b++)window.player.diceList[b].getComponent("Dice").clear();window.player.checkElement()}else if(202==t){for(var C=0,x=21;x<=30;x++)e.table[x]>0&&C++;this.doEffect(7,5*C,1)}else if(203==t)window.player.addRollCount();else if(204==t)window.player.rollCount++,window.player.roll();else if(205==t){if(window.player.cardList.length>0){u=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[u].getComponent("Card").discard(),this.doEffect(7,12,1)}}else if(206==t||207==t){if(window.player.cardList.length>0){u=Math.floor(Math.random()*window.player.cardList.length);var k=window.player.cardList[u].getComponent("Card");k.discard(null,!0),k.doDelete(),this.doEffect(7,206==t?20:30,1)}}else if(208==t){this.doEffect(7,5*window.player.cardList.length,1);for(var L=[],I=0;I<window.player.cardList.length;I++)L.push(window.player.cardList[I].getComponent("Card"));for(var q=0;q<L.length;q++)L[q].discard()}else if(t>=209&&t<=214){f=214==t?2:1;this.doEffect(t-209+21,f+i.iteraList2[t-209]-1,1)}else if(215==t)window.opponent.buff.burnIce=!0;else if(216==t)window.opponent.buff.silenceDark=!0;else if(217==t)c.data.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(218==t){g=c.getRandomCardId(2);window.player.patchCard(g)}else if(219==t)window.player.patchCard();else if(220==t)this.doEffect(3,2*window.player.atkRound-1,1);else if(221==t)i.selfHarmCast++,i.selfHarmCastMax++;else if(222==t)window.host.hpMax+=20,window.host.hp+=20,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(225==t||226==t)window.player.elementList[t-223]>=2&&this.doEffect(7,4,1);else if(227==t||228==t)window.player.elementList[t-225]>=3&&this.doEffect(11,4,2);else if(229==t)window.player.createExDice(3);else if(230==t)window.player.createExDice(4);else if(231==t)1==window.player.cardPlayedRound&&this.doEffect(23,2,1);else if(234==t){h=e.frail>0?30:20;this.doEffect(3,"4;"+h,1)}else 235==t?i.creatDiceFire++:236==t?window.player.addRollCount():237==t?(this.doEffect(7,Math.floor(window.host.hp/2),2),this.doEffect(7,Math.min(30,Math.floor(window.opponent.host.hp/2)),1)):238==t?this.doEffect(7,6+6*window.player.createDiceRound[4],1):239==t&&i.exCreateDice++}};e.exports=a,cc._RF.pop()},{Config:"Config",Game:"Game"}],CardTavern:[function(t,e,i){"use strict";cc._RF.push(e,"a4f5bK9YrVNG5vdkkTG5T0R","CardTavern");var c=t("Game"),o=t("Config");t("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,bg:cc.Node,box:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(t,e){this.cfgId=t,this.index=e,this.pos=cc.v2(e%3,Math.floor(e/3)),this.node.position=cc.v2(248*this.pos.x-248,95-206*this.pos.y-500),this.node.opacity=1;var i=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-206*this.pos.y+20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(1-this.pos.y)),i,cc.moveBy(.05,cc.v2(0,-20)))),this.cfg=o.get("cfg_tavern",t),this.element=this.cfg.element,this.require=this.cfg.require,this.initInfo(),this.mask.active=!0,this.bg.active=!0,this.animationDiscard.node.active=!1,this.usable=!1},initInfo:function(){var t=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],e=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],i=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.bg.color=t[this.element-1],this.box.color=e[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name;var o=c.analysisDesc(this.cfg.desc1);this.txtDesc.string=o,this.circleNode.removeAllChildren(),this.requireCircles=[];var a=this.cfg.require;if(this.requireNode.y=0,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),a>=100&&a<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][a-100];for(var s=[[0],[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][a-100],n=0;n<s.length;n++)this.createCircle(0,s[n])}else{this.txtRequire.string="",this.requireNode.y-=8;for(var r=a.split(";"),h=(s=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][r.length-1],0);h<r.length;h++){this.createCircle(parseInt(r[h]),s[h]).zIndex=4-h}}},createCircle:function(t,e){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(t,this.element),i.position=cc.v2(e,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},checkRequire:function(){if(this.usable)return!0;var t=!1,e=window.player.elementList.concat();if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],c=102==this.require?2:1,o=[],a=0;a<6;a++)e[a]>=i[this.require-100]&&(c--,o.push(a+1)),102==this.require&&e[a]>=4&&(c-=2,o.push(a+1),o.push(a+1));if(c<=0&&(t=!0),102!=this.require){var s=0,n=this.requireCircles[0].getComponent("RequireRound").element;if(n)o.indexOf(n)<0&&(s=o.length>0?1:-1);else o.length>0&&(s=1);for(var r=0;r<this.requireCircles.length;r++){var h=this.requireCircles[r].getComponent("RequireRound");1==s?(h.refreshElement(o[0]),h.refreshSatisfy(!0)):-1==s&&h.hideElement()}}else{var d,l=[null,null],f=[0,0],p=this.requireCircles[0].getComponent("RequireRound").element,u=this.requireCircles[2].getComponent("RequireRound").element;if(p)(d=o.indexOf(p))>=0&&(l[0]=0,o.splice(d,1),f[0]=p);if(u)(d=o.indexOf(u))>=0&&(l[1]=0,o.splice(d,1),f[1]=p);for(var m=0;m<2;m++){if(null==l[m])(0==m?p:u)?o.length>0?(l[m]=1,f[m]=o[0],o.splice(0,1)):l[m]=-1:o.length>0?(l[m]=1,f[m]=o[0],o.splice(0,1)):l[m]=0}for(var g=0;g<this.requireCircles.length;g++){var w=this.requireCircles[g].getComponent("RequireRound"),v=g<2?0:1;1==l[v]?(w.refreshElement(f[v]),w.refreshSatisfy(!0)):-1==l[v]&&w.hideElement()}}}else{for(var y=[0,0,0,0,0,0],b=this.require.split(";"),C=0;C<b.length;C++)y[b[C]-1]++;t=!0;for(var x=0;x<6;x++)if(e[x]<y[x]){t=!1;break}for(var k=0;k<this.requireCircles.length;k++){var L=this.requireCircles[k].getComponent("RequireRound");e[L.element-1]>0?(L.refreshSatisfy(!0),e[L.element-1]--):L.refreshSatisfy(!1)}}if(this.usable=t,t){this.mask.active=!1;for(var I=0;I<this.requireCircles.length;I++){this.requireCircles[I].getComponent("RequireRound").bingo()}cc.audioEngine.playEffect(window.sound.bingo)}else this.mask.active=!0;return t},discard:function(){this.bg.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.LOOP_COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(window.sound.discardSound);var t=window.player.cardList.indexOf(this.node);t>=0&&window.player.cardList.splice(t,1)}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Card:[function(t,e,i){"use strict";cc._RF.push(e,"cfa35/uH59ANIsjw79G+feg","Card");var c=t("Game"),o=t("Config"),a=t("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,box:cc.Node,fires:dragonBones.ArmatureDisplay,nodeSilence:cc.Node,markSilence:cc.Node,markDelete:cc.Node,animationCursed:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,animationCounter:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(t,e,i){this.cfgId=t,this.index=e,this.buffId=i,this.pos=cc.v2(e%3,Math.floor(e/3)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(248*this.pos.x-248,95-206*this.pos.y-500*this.delta),this.btn.interactable=!1,this.node.opacity=1;var a=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,95-206*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*(0==window.mainLayer.roundId?1-this.pos.y:this.pos.y)),a,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),this.cfg=o.get("cfg_card",t),this.element=this.cfg.element,this.initInfo(),this.mask.active=!0,this.btn.node.active=!0,this.nodeSilence.active=this.fires.node.active=this.animationCursed.active=this.animationDiscard.node.active=this.animationCounter.active=this.markDelete.active=!1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1,this.hasCopy=!1,this.unCost=!1,this.rate=1;var s=this.require=this.cfg.require;if(s>=100&&s<=107){this.rate=[1,1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][s-100]}else{this.rate=[1/6,1/36,1/216,1/1296,1/7776][s.split(";").length-1]}0==window.mainLayer.roundId&&4==c.data.heroId&&this.disCost(!0)},initInfo:function(){var t=[cc.color(252,94,108),cc.color(123,200,255),cc.color(93,166,111),cc.color(229,138,81),cc.color(215,193,81),cc.color(180,150,236),cc.color(150,150,158)],e=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)],i=[cc.color(251,53,70),cc.color(86,160,255),cc.color(24,143,87),cc.color(253,138,47),cc.color(227,188,49),cc.color(152,98,254),cc.color(155,158,173)];this.btn.node.color=t[this.element-1],this.box.color=e[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.initDesc(),this.circleNode.removeAllChildren(),this.requireCircles=[];var c=this.cfg.require;if(this.requireNode.y=0,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),c>=100&&c<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][c-100];for(var o=[[0],[16,-16],[-38,-62,62,38],[32,0,-32],[48,16,-16,-48]][c-100],a=0;a<o.length;a++)this.createCircle(0,o[a])}else{this.txtRequire.string="",this.requireNode.y-=8;for(var s=c.split(";"),n=(o=[[0],[-35,35],[-65,0,65],[-75,-25,25,75]][s.length-1],0);n<s.length;n++){this.createCircle(parseInt(s[n]),o[n]).zIndex=4-n}}},initWithCopy:function(t,e){this.cfgId=t,this.pos=e,this.isCopy=!0,this.isTemp=!0,this.cfg=o.get("cfg_card",t),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(t){this.usable=!1,this.btn.interactable=!1;var e=t?.3:0;this.scheduleOnce(function(){if(0==window.mainLayer.roundId){var t=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{t=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var e=window.player.cardList.indexOf(this.node);e>=0&&(window.player.cardList.splice(e,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}.bind(this),e)},createCircle:function(t,e){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(t,this.element),i.position=cc.v2(e,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},initBuff:function(){6==this.element&&window.opponent.equip.checkWithTrigger(172)&&(this.buffId=25);var t=this.buffId;this.burn=21==t,this.burn?(this.fires.node.active=!0,this.fires.playAnimation("play0",0),cc.audioEngine.playEffect(window.sound.burnSound)):this.fires.node.active=!1,this.silence=25==t,this.silence?(this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.nodeSilence.active=!0}.bind(this)))),this.titles[1].active=!1,this.markSilence.stopAllActions(),this.markSilence.y=130,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5))),cc.audioEngine.playEffect(window.sound.blackSound)):(this.nodeSilence.active=!1,this.titles[1].active=3==this.cfg.quality)},checkRequire:function(){var t=!1,e=window.player.elementList.concat();if(0==window.player.index&&4==c.data.heroId)t=this.element<7?e[this.element-1]>0:window.player.diceList.length>0;else if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],o=102==this.require?2:1,a=[],s=0;s<6;s++)e[s]>=i[this.require-100]&&(o--,a.push(s+1)),102==this.require&&e[s]>=4&&(o-=2,a.push(s+1),a.push(s+1));if(o<=0&&(t=!0),102!=this.require){var n=0,r=this.requireCircles[0].getComponent("RequireRound").element;if(r)a.indexOf(r)<0&&(n=a.length>0?1:-1);else a.length>0&&(n=1);for(var h=0;h<this.requireCircles.length;h++){var d=this.requireCircles[h].getComponent("RequireRound");1==n?(d.refreshElement(a[0]),d.refreshSatisfy(!0)):-1==n&&d.hideElement()}}else{var l,f=[null,null],p=[0,0],u=this.requireCircles[0].getComponent("RequireRound").element,m=this.requireCircles[2].getComponent("RequireRound").element;if(u)(l=a.indexOf(u))>=0&&(f[0]=0,a.splice(l,1),p[0]=u);if(m)(l=a.indexOf(m))>=0&&(f[1]=0,a.splice(l,1),p[1]=u);for(var g=0;g<2;g++){if(null==f[g])(0==g?u:m)?a.length>0?(f[g]=1,p[g]=a[0],a.splice(0,1)):f[g]=-1:a.length>0?(f[g]=1,p[g]=a[0],a.splice(0,1)):f[g]=0}for(var w=0;w<this.requireCircles.length;w++){var v=this.requireCircles[w].getComponent("RequireRound"),y=w<2?0:1;1==f[y]?(v.refreshElement(p[y]),v.refreshSatisfy(!0)):-1==f[y]&&v.hideElement()}}}else{for(var b=[0,0,0,0,0,0],C=this.require.split(";"),x=0;x<C.length;x++)b[C[x]-1]++;t=!0;for(var k=0;k<6;k++)if(e[k]<b[k]){t=!1;break}for(var L=0;L<this.requireCircles.length;L++){var I=this.requireCircles[L].getComponent("RequireRound");e[I.element-1]>0?(I.refreshSatisfy(!0),e[I.element-1]--):I.refreshSatisfy(!1)}}return this.unCost&&(t=!0),this.silence&&(t=!1),224==this.cfgId&&(t=!1),this.usable=t,t?(this.mask.active=!1,this.btn.interactable=!0):this.silence?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),t},doCast:function(){this.usable&&0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?(this.btn.node.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound),cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c")):this.silence?(this.markSilence.stopAllActions(),this.markSilence.y=90,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,15)),cc.delayTime(.5),cc.fadeOut(.5)))):this.cast())},cast:function(){if(0==window.mainLayer.roundId){if(this.cfgId>=205&&this.cfgId<=208&&!window.player.cardUsabled)return}else if(!window.player.cardUsabled)return;this.burn&&window.host.onHurt(3,1,21,0);var t=!1,e=!1;if(0==window.player.cardPlayedRound&&window.opponent.equip.trigger(127))e=!0,t=!0;else{var i=window.opponent.equip.check(107)?.8:.5;window.player.buff.curse&&Math.random()<i&&(t=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.trigger(108))}if(this.btn.interactable=!1,window.player.cardUsabled=!1,t)this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1;var t=cc.instantiate(e?this.animationCounter:this.animationCursed);t.active=!0,t.parent=window.player.boxCard,t.position=this.node.position.add(cc.v2(10,-10)),t.zIndex=100,t.getComponent(dragonBones.ArmatureDisplay).playAnimation("play0"),t.getComponent(dragonBones.ArmatureDisplay).on(dragonBones.EventObject.LOOP_COMPLETE,function(){t.destroy()}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(e?0:.1),cc.callFunc(function(){this.maskBlack.active=!1,this.endCast(),198==this.cfgId&&1==window.mainLayer.roundId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.5)}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(e?window.sound.counterSound:window.sound.curseSound),window.player.equip.luckyCard>0&&(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43)),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1));else{var o=cc.spawn(cc.moveBy(.05,cc.v2(0,-20)),cc.scaleTo(.05,1)),s=cc.moveBy(.35,cc.v2(0,1100)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),o,s,cc.callFunc(function(){window.mainLayer.gameOver||(a.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var n=window.player.cardList.indexOf(this.node);n>=0&&(window.player.cardList.splice(n,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var r=0;r<3;r++)if(this.cfg["effect"+(r+1)]<10&&1==this.cfg["target"+(r+1)]){var h=1;8==this.cfg["effect"+(r+1)]&&(h=parseInt(this.cfg["num"+(r+1)].split(";")[1])),window.player.atkRound+=h}for(var d=0;d<window.player.cardList.length;d++){var l=window.player.cardList[d].getComponent("Card");(l.cfgId>=179&&l.cfgId<=186||l.cfgId>=209&&l.cfgId<=214||220==l.cfgId)&&l.initDesc(),232==l.cfgId&&Math.random()<.3&&window.opponent.buff.addBuff(23,1)}t||this.isCopy||(this.cfgId<163||this.cfgId>166)&&(233==this.cfgId&&window.opponent.buff.frail>0?this.reuse():window.player.buff.selfHarmCast>0&&this.cfg.effect1<10&&2==this.cfg.target1?(window.player.buff.selfHarmCast--,this.reuse()):window.player.buff.doubleCast>0?(window.player.buff.removeBuff(108,1),this.reuse()):window.player.equip.luckyCard>0?(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1)):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)&&167!=this.cfgId?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)?this.reuse():Math.random()<.3&&window.player.equip.checkWithTrigger(149)&&this.reuse()),this.isRemove&&this.doDelete(),this.isCopy||(window.player.cardPlayed++,window.player.cardPlayedRound++),0==window.player.index&&(4==c.data.heroId?(window.player.deleteDice(this.element),2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId))):2==c.data.heroId&&window.player.randomCard&&window.player.randomCard==this.node&&(window.player.randomCard=null))},endCast:function(){if(!this.isCopy){var t=window.player.equip;t.trigger(1),t.trigger(4),t.trigger(97),t.trigger(153),t.trigger(169),this.cfg.element<=6&&t.trigger(this.cfg.element+77),2==this.cfg.element&&t.trigger(157),window.opponent.equip.trigger(24),window.opponent.equip.trigger(166),window.player.cardPlayed%3==0&&window.opponent.equip.trigger(144),0==window.player.index&&(2==c.data.heroId?2==c.data.difficulty?(window.player.rollCount++,window.player.roll()):window.player.addRollCount():4==c.data.heroId&&(window.player.suppleCard(),c.data.cardPlayed[this.cfgId]?c.data.cardPlayed[this.cfgId]++:c.data.cardPlayed[this.cfgId]=1)),window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.selfHarmCastMax>0&&window.player.buff.selfHarmCast<=0&&(window.player.buff.selfHarmCast=window.player.buff.selfHarmCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++}window.player.cardPool.put(this.node),window.player.cardUsabled=!0,1!=window.mainLayer.roundId||this.hasCopy||198!=this.cfgId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.6)},discard:function(t,e){this.btn.interactable=!1,this.btn.node.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.LOOP_COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(window.sound.discardSound);var i=window.player.cardList.indexOf(this.node);i>=0&&(window.player.cardList.splice(i,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll()),e?(this.markDelete.active=!0,this.markDelete.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5)))):4==c.data.heroId&&2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId)),t||e||window.player.equip.trigger(22),0==window.player.index&&4==c.data.heroId&&window.player.suppleCard()},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),!this.isTemp){var t=window.player.deck.indexOf(this.cfgId);t>=0&&window.player.deck.splice(t,1)}},reuse:function(){var t=cc.instantiate(this.node);t.position=this.node.position,window.player.boxCard.addChild(t,this.node.zIndex-1),t.getComponent("Card").initWithCopy(this.cfgId,this.pos),this.hasCopy=!0,t.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){t.getComponent("Card").cast()}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},initDesc:function(){var t=c.analysisDesc(this.cfg.desc1);if(147==this.cfgId){for(var e=window.player.deck,i=0,a=0;a<e.length;a++){var s=o.get("cfg_card",e[a]);23!=s.effect1&&23!=s.effect2&&23!=s.effect3||i++}t+="<color=#EBC82E>  (\u4e0a\u9650"+(20+4*i)+")</c>"}else if(this.cfgId>=179&&this.cfgId<=182){var n=[3,2,3,4];t+="<color=#EBC82E>  (\u5f53\u524d"+((r=[1,6,6,10])[this.cfgId-179]+n[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var r=[8,13,15,21];n=[3,3,4,5],i=Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,3,4][this.cfgId-183]);t+="<color=#EBC82E>  (\u5f53\u524d"+(r[this.cfgId-183]-n[this.cfgId-183]*i)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){t+="<color=#EBC82E>  (\u5f53\u524d"+((r=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}else 220==this.cfgId?t+="<color=#EBC82E>  (\u5f53\u524d"+(2*window.player.atkRound+1)+")</c>":238==this.cfgId&&(t+="<color=#EBC82E>  (\u5f53\u524d"+(6+6*window.player.createDiceRound[4])+")</c>");this.txtDesc.string=t},disCost:function(t){t||(this.unCost=!0);for(var e=0;e<this.requireCircles.length;e++){var i=this.requireCircles[e].getComponent("RequireRound");i.disCost(),this.require>=100&&this.require<=105&&i.hideElement()}},discribeRandom:function(){this.txtTitle.string=this.txtTitle2.string=this.cfg.name+"*"}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Chest:[function(t,e,i){"use strict";cc._RF.push(e,"282832AcdZFNov+QpH9gQcZ","Chest");var c=t("Utils");cc.Class({extends:cc.Component,properties:{txtRequire:cc.RichText,btn:cc.Button},init:function(t){this.index=t,this.node.position=cc.v2(240*t-240,-500),this.btn.node.color=cc.Color.GRAY,this.node.opacity=1;var e=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.3),e,cc.moveBy(.05,cc.v2(0,-20)))),this.satisfied=[!1,!1,!1,!1,!1,!1],this.requireList=c.getDifferentRandomNum(4,6,1),this.refreshRequire()},refreshRequire:function(){this.usable=!0;for(var t="",e=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],i=0;i<this.requireList.length;i++){var c=this.requireList[i];this.satisfied[c-1]?t+="<color=#EBC82E>"+e[c-1]+"</c>":(t+="<color=#000000>"+e[c-1]+"</c>",this.usable=!1)}this.txtRequire.string=t,this.usable&&(this.btn.interactable=!0,this.btn.node.color=cc.Color.WHITE)},remove:function(){this.btn.interactable=!1;var t=cc.moveBy(.2,cc.v2(0,-500));this.node.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.1,cc.v2(0,20)),t,cc.callFunc(function(){this.node.destroy()}.bind(this)))),window.player.chestList[this.index]=null},checkRequire:function(){for(var t=window.player.elementList,e=0;e<6;e++)t[e]>0&&!this.satisfied[e]&&(this.satisfied[e]=!0);this.refreshRequire()},doCast:function(){this.remove();for(var t=0;t<6;t++)window.player.patchCard()}}),cc._RF.pop()},{Utils:"Utils"}],ChooseDiceLayer:[function(t,e,i){"use strict";cc._RF.push(e,"a7b85fk8JhBnoBwYoqOsmoi","ChooseDiceLayer"),cc.Class({extends:cc.Component,properties:{mask:cc.Node,diceNode:cc.Node,dice:cc.Prefab},onLoad:function(){window.chooseDiceLayer=this,this.mask.opacity=10,this.mask.runAction(cc.fadeTo(.2,120)),this.createDice()},createDice:function(){var t=[];for(window.player.buff.creatDiceFire>0&&(t.push(1),window.player.buff.creatDiceFire--);t.length<3;){var e=Math.floor(6*Math.random())+1;t.indexOf(e)<0&&t.push(e)}for(var i=0;i<3;i++){var c=cc.instantiate(this.dice);c.x=425,this.diceNode.addChild(c),c.getComponent("DiceChoose").init(t[i],i)}},close:function(){window.chooseDiceLayer=null,this.node.destroy()}}),cc._RF.pop()},{}],CompleteLayer:[function(t,e,i){"use strict";cc._RF.push(e,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var c=t("Game"),o=t("Utils"),a=t("Config");cc.Class({extends:cc.Component,properties:{markOccupation:cc.Sprite,txtName:cc.Label,txtDuration:cc.Label,heads:[cc.Sprite],txtTime:cc.Label,cardPrefab:cc.Prefab,cardNode:cc.Node,itemNode:cc.Node,btnRestart:cc.Node,itemPrefab:cc.Prefab},onLoad:function(){window.completeLayer=this;var t=new Date,e=t.getTime()-c.data.startTime;this.txtDuration.string=o.timeFormat(e,2);var i=function(t){return t<10?"0"+t:t};this.txtTime.string=t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate())+" "+i(t.getHours())+":"+i(t.getMinutes()),this.initMonster(),this.initDeck(),this.initEquip(),this.btnRestart.y-=280,this.btnRestart.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(0,280))));this.txtName.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1]+"("+["\u666e\u901a","\u56f0\u96be","\u9ad8\u624b","\u5927\u5e08","\u82e6\u75db"][c.data.difficulty-1]+")",cc.audioEngine.playEffect(window.sound.cheer),cc.audioEngine.playMusic(window.sound.bgmComplete,!0)},initMonster:function(){for(var t=this,e=[],i=0;i<c.data.monsterBeats.length;i++){var o=c.data.monsterBeats[i];a.get("cfg_monster",o).type>=2&&e.push(o)}for(var s=function(i){var c=t.heads[i];cc.loader.loadRes("Texture/monster/head/"+e[i],cc.SpriteFrame,function(t,e){c.spriteFrame=e}.bind(t))},n=0;n<e.length;n++)s(n)},initDeck:function(){if(this.deck=[],4==c.data.heroId){var t=[];for(var e in c.data.cardPlayed){var i=[e,c.data.cardPlayed[e]];t.push(i)}t.sort(function(t,e){return e[1]-t[1]});for(var o=Math.min(t.length,6),a=0;a<o;a++)this.deck.push(t[a][0])}else this.deck=c.data.deck;for(var s=0;s<this.deck.length;s++){var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(this.deck[s],0),n.position=cc.v2(s%3*247-247,105-210*Math.floor(s/3)),this.cardNode.addChild(n),n.y-=1e3,n.runAction(cc.sequence(cc.delayTime(s<3?.2:0),cc.moveBy(.3,cc.v2(0,1e3))))}},initEquip:function(){for(var t=Math.max(Math.ceil(c.data.equip.length/2),6),e=600/(t-1),i=0;i<c.data.equip.length;i++){var o=c.data.equip[i],a=cc.instantiate(this.itemPrefab);a.getComponent("Item").init(o,null,!0),a.position=cc.v2(i%t*e-300,50-100*Math.floor(i/t)),this.itemNode.addChild(a)}this.itemNode.y-=480,this.itemNode.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.2,cc.v2(0,480))))},restart:function(){window.completeLayer=null,c.setDataToBase(),cc.director.loadScene("prepare")}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],Config:[function(t,e,i){"use strict";cc._RF.push(e,"e9b6cHrlOtILogPlENB3GXp","Config");var c={jsonTable:{},load:function(t){for(var e=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event","cfg_hero","cfg_tavern"],c=0,o=function(o){s="Config/"+i[o],cc.loader.loadRes(s,function(e,a){this.jsonTable[i[o]]=a.json,(c+=1)==i.length&&t()}.bind(e))},a=0;a<i.length;a++){var s;o(a)}},get:function(t,e){return this.jsonTable[t][e]}};e.exports=c,cc._RF.pop()},{}],DiceChoose:[function(t,e,i){"use strict";cc._RF.push(e,"2f252xYsv5IdrGnewf/1jBc","DiceChoose");var c=t("Game");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(t,e){this.element=t,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var i=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=i[this.element-1],this.node.runAction(cc.moveTo(.2,cc.v2(110*e-110,0)))},choose:function(){if(5==c.data.difficulty){var t=Math.floor(10*Math.random())+21;if(21==t){for(var e=[],i=window.player.cardList,o=0;o<i.length;o++){var a=i[o].getComponent("Card");a.burn||a.silence||e.push(a)}if(e.length>0){var s=e[Math.floor(Math.random()*e.length)];s.buffId=21,s.initBuff()}else window.player.buff.addBuff(21,1)}else if(25==t){e=[];for(var n=window.player.cardList,r=0;r<n.length;r++){var h=n[r].getComponent("Card");h.silence||e.push(h)}if(e.length>0){var d=e[Math.floor(Math.random()*e.length)];d.buffId=25,d.initBuff()}else window.player.buff.addBuff(25,1)}else window.player.buff.addBuff(t,1)}for(var l=1+window.player.buff.exCreateDice,f=0;f<l;f++)window.player.createExDice(this.element,!0);window.player.endRoll(),window.player.buff.exCreateDice=0,window.player.createDiceRound[this.element-1]++;for(var p=0;p<window.player.cardList.length;p++){var u=window.player.cardList[p].getComponent("Card");238==u.cfgId&&u.initDesc()}window.chooseDiceLayer.close()}}),cc._RF.pop()},{Game:"Game"}],DiceTavern:[function(t,e,i){"use strict";cc._RF.push(e,"2a3b72qgEZPdL0PbR9yMWKz","DiceTavern"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,mask:cc.Node},onLoad:function(){this.holded=!1,this.element=0,this.mask.active=!1},roll:function(){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=t[this.element-1],this.node.y=-200,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20)),cc.moveTo(.1,cc.v2(this.node.x,0)))))},doHold:function(){window.player.diceUsabld&&this.hold()},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)}}),cc._RF.pop()},{}],DiceYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(t,e){this.id=t,this.index=e,this.player=0==e?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1,this.holded=!1;var i=this.delta=0==this.index?1:-1;this.node.position=cc.v2(110*t-220,-320*i),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*i)),cc.moveBy(.1,cc.v2(0,-20*i))))},roll:function(t){this.abled=!0,this.holded=!1;var e=this.player.holdList.indexOf(this.node);if(e>=0&&this.player.holdList.splice(e,1),!t){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var i=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=i[this.element-1]}var c=50*Math.random()+150*this.id-325,o=(460*Math.random()+240)*this.delta,a=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(c,o)),cc.rotateTo(.2,a)))},toHold:function(){0==this.index&&this.doHold()},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var t=0;t<this.player.holdList.length;t++)this.player.holdList[t].runAction(cc.moveTo(.1,cc.v2(110*t-220,0)));this.player.txtBtn.string="\u6295\u63b7",cc.audioEngine.playEffect(window.sound.rollSound2)}else this.hold(),cc.audioEngine.playEffect(window.sound.holdSound)},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(t,e,i){"use strict";cc._RF.push(e,"24e6aDXOPZNaoyluEGeZSR/","Dice"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node,mask:cc.Node,markTemp:cc.Node,markBlind:cc.Node},init:function(t,e){this.id=t,this.holded=!1,this.element=0,this.mask.active=!1,this.temp=!1,this.isRemoved=!1,this.buffList=e,this.markIce.active=this.markLock.active=this.markTemp.active=this.markBlind.active=!1,this.blind=e.indexOf(30)>=0,this.markBlind.active=this.blind},initBuff:function(){1==this.element&&window.opponent.equip.checkWithTrigger(171)?this.buffList.indexOf(22)<0&&this.buffList.indexOf(28)<0&&this.buffList.push(22):4==this.element&&window.opponent.equip.checkWithTrigger(173)&&this.buffList.indexOf(28)<0&&this.buffList.push(28);var t=this.buffList;this.freeze=t.indexOf(22)>=0,this.markIce.active=this.freeze,this.lock=t.indexOf(28)>=0,this.markLock.active=this.lock},roll:function(t){if(!this.isRemoved){this.element=t||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var e=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=e[this.element-1],this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=200*-this.delta,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20*this.delta)),cc.moveTo(.1,cc.v2(this.node.x,0)))))}},doHold:function(){0!=window.mainLayer.roundId||this.freeze||this.lock||this.temp||window.player.diceUsabld&&this.hold()},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)},remove:function(){this.isRemoved=!0,this.node.stopAllActions();var t=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.buffList=[],this.initBuff(),this.markBlind.active=!1},doTemp:function(){this.temp=!0,this.markTemp.active=!0;var t=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.markTemp.color=t[this.element-1]}}),cc._RF.pop()},{}],DmgAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"267b8j4vWVAPaVTrMCIVdTi","DmgAnimation");t("Utils");cc.Class({extends:cc.Component,properties:{atks:[dragonBones.ArmatureDisplay],heal:dragonBones.ArmatureDisplay,fireAtk:dragonBones.ArmatureDisplay,waterAtk:dragonBones.ArmatureDisplay,windAtk:dragonBones.ArmatureDisplay,earthAtk:dragonBones.ArmatureDisplay,lightAtk:dragonBones.ArmatureDisplay,darkAtk:dragonBones.ArmatureDisplay,armor:dragonBones.ArmatureDisplay,dodge:dragonBones.ArmatureDisplay,frail:dragonBones.ArmatureDisplay,weak:dragonBones.ArmatureDisplay,silence:dragonBones.ArmatureDisplay,poison:dragonBones.ArmatureDisplay,curse:dragonBones.ArmatureDisplay,lock:dragonBones.ArmatureDisplay,atkback:dragonBones.ArmatureDisplay,blind:dragonBones.ArmatureDisplay,undead:dragonBones.ArmatureDisplay,revive:dragonBones.ArmatureDisplay},init:function(t){this.index=t,this.host=0==t?window.mainLayer.hero:window.mainLayer.enemy,this.step=0},show:function(t){var e;if(t<=6){var i=[this.fireAtk,this.waterAtk,this.windAtk,this.earthAtk,this.lightAtk,this.darkAtk];e=i[t-1];i=[window.sound.fireSound,window.sound.iceSound,window.sound.windSound,window.sound.earthSound,window.sound.lightSound,window.sound.darkSound];cc.audioEngine.playEffect(i[t-1])}else if(t>=7&&t<=9)(e=this.atks[this.step%3]).node.rotation=360*Math.random(),cc.audioEngine.playEffect(window.sound.atkSound);else if(t<=16){i=[this.armor,this.heal,this.dodge,null,null,this.atkback];e=i[t-11];i=[window.sound.armorSound,window.sound.healSound,window.sound.dodgeSound,null,null,window.sound.atkSound];cc.audioEngine.playEffect(i[t-11])}else if(t>=21&&t<=30&&29!=t){i=[this.fireAtk,this.waterAtk,this.frail,this.weak,this.silence,this.poison,this.curse,this.lock,null,this.blind];e=i[t-21];i=[window.sound.fireSound,window.sound.iceSound,window.sound.frailSound,window.sound.weakSound,window.sound.silenceSound,window.sound.poisonSound,window.sound.curseSound,window.sound.lockSound,null,window.sound.blindSound];cc.audioEngine.playEffect(i[t-21])}else 201==t?(e=this.undead,cc.audioEngine.playEffect(window.sound.undeadSound)):202==t&&(e=this.revive,cc.audioEngine.playEffect(window.sound.reviveSound));e&&(e.node.active=!0,e.node.zIndex=this.step,e.playAnimation("play0"),e.on(dragonBones.EventObject.LOOP_COMPLETE,function(){e.node.active=!1}.bind(this))),this.host.doShake(t),this.step++}}),cc._RF.pop()},{Utils:"Utils"}],Door:[function(t,e,i){"use strict";cc._RF.push(e,"03087MNqj9O2qA5J4CBmWTy","Door");var c=t("Game");cc.Class({extends:cc.Component,properties:{road:cc.Sprite,view:cc.Node,wall:cc.Node,image:cc.Sprite,btn:cc.Button},init:function(t,e){this.type=t,this.index=e;var i="road"+c.data.castle+(Math.floor(4*Math.random())+1);8==t?i="boss":0==t&&(i="empty"),cc.loader.loadRes("Texture/map/road/"+i,cc.SpriteFrame,function(i,c){this.road.spriteFrame=c,this.road.node.parent=window.room.node,this.road.node.rotation=this.node.rotation;var o=8==t||0==t?49:19,a=[cc.v2(0,-o),cc.v2(-o,0),cc.v2(0,o),cc.v2(o,0)];this.road.node.position=this.node.position.add(a[e])}.bind(this)),cc.loader.loadRes("Texture/map/door/door"+t,cc.SpriteFrame,function(t,e){this.image.spriteFrame=e}.bind(this))},onEvent:function(){window.room.gotoDoor(this.index)},close:function(t){this.btn.interactable=!1,this.view.active=!0,t&&(this.wall.y=130,this.wall.runAction(cc.moveTo(.2,cc.v2()))),8!=this.type&&0!=this.type||(this.road.getComponent(cc.Button).interactable=!1)}}),cc._RF.pop()},{Game:"Game"}],EditEndLayer:[function(t,e,i){"use strict";cc._RF.push(e,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){c.data.deck=c.editCfg.deckHero.split(";"),c.data.equip=c.editCfg.equip.split(";"),c.data.hp=c.data.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(t,e,i){"use strict";cc._RF.push(e,"463d3gvgvdIabmN6qTyXAVR","Edit");var c=t("Game");cc.Class({extends:cc.Component,properties:{editHpEnemy:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox,editId:cc.EditBox,editHpHero:cc.EditBox},onLoad:function(){c.editCfg&&(this.editHpEnemy.string=c.editCfg.hpEnemy,this.editDice.string=c.editCfg.dice,this.editDeckEnemy.string=c.editCfg.deckEnemy,this.editEquipEnemy.string=c.editCfg.equipEnemy,this.editDeckHero.string=c.editCfg.deckHero,this.editEquip.string=c.editCfg.equip,this.editHpHero.string=c.editCfg.hpHero),this.editId.string=c.data.heroId},goBattle:function(){c.editCfg={hpEnemy:this.editHpEnemy.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string,hpHero:this.editHpHero.string};var t=this.editDeckHero.string.split(";");if(4==c.data.heroId){c.data.cardBag=[];for(var e=0;e<t.length;e++)c.data.cardBag.push(parseInt(t[e]))}else{c.data.deck=[];for(var i=0;i<t.length;i++)c.data.deck.push(parseInt(t[i]))}var o=this.editEquip.string.split(";");c.data.equip=[];for(var a=0;a<o.length;a++)c.data.equip.push(parseInt(o[a]));c.data.hp=c.data.hpMax=parseInt(c.editCfg.hpHero),c.data.heroId=parseInt(this.editId.string),c.data.level=7,cc.director.loadScene("mainLayer")},goBack:function(){cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(t,e,i){"use strict";cc._RF.push(e,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,boxReward:cc.Node,boxCard:cc.Node,boxEquip:cc.Node,cardBtns:[cc.Node],equipBtns:[cc.Node],txtCopper:cc.Label,txtExp:cc.Label,txtHp:cc.Label,rewardNodes:[cc.Node],mask:cc.Node,endNode:cc.Node,txtNext:cc.Node,cardNodes:[cc.Node],equipNodes:[cc.Node],treasurePrefab:cc.Prefab,cardChangePrefab:cc.Prefab,btnGiveUp:cc.Node},init:function(t){window.endLayer=this,this.isEscape=t,this.step=0;var e=2,i=window.mainLayer.hero.player;this.isEscape?this.step++:1==c.data.roomType?i.equip.check(26)?(c.data.hpMax+=6,c.data.hp+=6,this.rewardNodes[2].active=!0,e++,this.step++):this.initCards():this.initEquip();var o=0;i.equip.trigger(7)&&(o+=6),i.equip.trigger(8)&&(o+=10),o>0&&(this.rewardNodes[3].active=!0,this.txtHp.string=o,e++),-1==i.equip.feather&&(c.data.itemEffect.feather=-1),-1==i.equip.reviveBook&&(c.data.itemEffect.reviveBook=-1);for(var a=[[30,-30],[50,0,-50],[60,20,-20,-60]][e-2],s=0;s<e;s++)this.rewardNodes[s].y=a[s]-20;this.initCopper(),this.initExp(),c.data.floorBeats[c.data.floor-1]=!0,c.data.monsterBeats.push(c.monsterId),this.mask.on(cc.Node.EventType.TOUCH_START,this.nextStep,this),this.boxReward.scale=.8,this.boxReward.runAction(cc.sequence(cc.scaleTo(.15,1.2),cc.scaleTo(.1,1),cc.callFunc(function(){this.step++,this.txtNext.active=!0}.bind(this)))),cc.audioEngine.playMusic(window.sound.win,!1)},initCards:function(){if(this.boxCard.active=!0,this.boxCard.y-=cc.winSize.height/cc.winSize.width*750,1==c.data.heroId&&2==c.data.difficulty){var t=(i=window.mainLayer.enemy.initialDeck)[Math.floor(Math.random()*i.length)],e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(t,null,1),e.position=cc.v2(0,40),this.boxCard.addChild(e),c.getCard(t),this.cardNodes[0].active=this.cardNodes[1].active=!1}else if(4==c.data.heroId&&3==c.data.difficulty){for(var i=window.mainLayer.enemy.initialDeck,a=0;a<i.length;a++){t=i[a];var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(t),s.position=cc.v2(30*(i.length-1)/2-30*a,40+30*(i.length-1)/2-30*a),this.boxCard.addChild(s),c.getCard(t)}this.cardNodes[0].active=this.cardNodes[1].active=!1}else{for(var n=0,r=[[1/3,1/3,1/3],[1/3,1/3,1/3],[0,.5,.5]],h=Math.random(),d=0,l=0;l<3;l++)if(h<(d+=r[c.data.castle-1][l])){n=l+1;break}this.cardIdList=[];for(var f=0;f<=0;){var p=c.getNewCardId(n),u=o.get("cfg_card",p).require;(c.data.castle>1||2==u.split(";").length||u<=102)&&(f=p)}this.cardIdList.push(f);for(var m=0;m<=0;){var g=c.getNewCardId(n),w=o.get("cfg_card",g).require;g!=f&&(c.data.castle>1||2==w.split(";").length||w<=102)&&(m=g)}this.cardIdList.push(m);for(var v=0;v<2;v++){var y=cc.instantiate(this.cardPrefab);y.getComponent("CardCollection").init(this.cardIdList[v]),y.position=cc.v2(0,40),this.cardNodes[v].addChild(y)}}4==c.data.heroId&&3!=c.data.difficulty&&(this.btnGiveUp.active=!0)},chooseCard:function(t,e){this.getCard(this.cardIdList[e]),this.cardNodes[1-e].destroy(),this.cardNodes[e].runAction(cc.moveTo(.2,cc.v2(0,0))),this.cardBtns[0].active=this.cardBtns[1].active=!1,this.step++,this.txtNext.active=!0,this.btnGiveUp.active=!1,cc.audioEngine.playEffect(window.sound.selectSound)},initCopper:function(){var t=window.mainLayer.enemy.cfg.level,e=1,i=window.mainLayer.hero.player;i.equip.check(73)&&(e+=.5),i.equip.check(90)&&(e-=.5);var o=Math.max([6,8,10,12,14,16,0][t-1]*e,1);this.isEscape&&(o=0),this.txtCopper.string=o,c.data.copper+=o},initExp:function(){var t=window.mainLayer.enemy.cfg.level,e=1==c.data.roomType?t:[5,11,19,29,41,55,70][t-1];this.isEscape&&(e=0),this.txtExp.string=e,c.data.exp+=e;var i=[7,15,25,37,51,67,150][c.data.level-1];c.data.exp>=i&&(c.data.exp-=i,c.data.level++,c.data.hpMax+=10,c.data.hp=window.mainLayer.hero.hp=c.data.hpMax,c.data.levelUp=!0)},initEquip:function(){this.boxEquip.active=!0,this.boxEquip.y-=cc.winSize.height/cc.winSize.width*750;for(var t=8==c.data.roomType?2:0,e=0,i=[[.4,.3,.3],[.3,.4,.3],[.2,.4,.4]],o=Math.random(),a=0,s=0;s<3;s++)if(o<(a+=i[c.data.castle-1][s])){e=s+1;break}this.cfgIdList=[];var n=c.getNewItemId(t,e);if(this.cfgIdList.push(n),8==c.data.roomType){for(var r=0;r<=0;){var h=c.getNewItemId(t,e);h!=n&&(r=h)}this.cfgIdList.push(r)}},showEquip:function(){if(1==this.cfgIdList.length)(e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),e.y=-120,this.boxEquip.addChild(e),c.getItem(this.cfgIdList[0]),this.equipNodes[0].active=!1,this.equipNodes[1].active=!1,this.scheduleOnce(function(){this.step++,this.txtNext.active=!0}.bind(this),1);else for(var t=0;t<2;t++){var e;(e=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[t]),e.y=-120,this.equipNodes[t].addChild(e),this.equipBtns[t].y-=150;var i=cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))));this.equipBtns[t].runAction(cc.sequence(cc.delayTime(.8),i))}},chooseEquip:function(t,e){c.getItem(this.cfgIdList[e]),this.equipNodes[1-e].destroy(),this.equipNodes[e].runAction(cc.moveTo(.2,cc.v2(0,0))),this.equipBtns[0].active=this.equipBtns[1].active=!1,this.step++,this.txtNext.active=!0},nextStep:function(){this.txtNext.active&&(1==this.step?(this.txtNext.active=!1,cc.audioEngine.playEffect(window.sound.reward),this.endNode.runAction(cc.sequence(cc.moveBy(.35,cc.v2(0,cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){c.data.roomType>=7?this.showEquip():(1==c.data.heroId&&2==c.data.difficulty||4==c.data.heroId&&3==c.data.difficulty)&&(this.step++,this.txtNext.active=!0)}.bind(this))))):2==this.step&&this.close())},getCard:function(t){if(1==c.data.heroId&&3==c.data.difficulty)if(c.data.deck.length<6)c.getCard(t);else{var e=cc.instantiate(this.cardChangePrefab);e.getComponent("CardChangeLayer").init(t),this.node.addChild(e,100)}else c.getCard(t)},close:function(){c.data.hp=Math.min(window.mainLayer.hero.hp,c.data.hpMax),c.data.power=window.mainLayer.hero.power,cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndTavernLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2d083apwQNCHIRnqoFt5WSN","EndTavernLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{txtNode:cc.Node,rewardNode:cc.Node,boxSingle:cc.Node,iconSingle:cc.Sprite,txtSingle:cc.Label,txtName:cc.Label,markTxt:cc.Sprite,markDouble:cc.Node,itemPrefab:cc.Prefab,cardPrefab:cc.Prefab,itemChangeNode:cc.Node,bg:cc.Node,mask:cc.Node,cardChangePrefab:cc.Prefab,losePrefab:cc.Prefab,itemNode:cc.Node},init:function(t){this.rewards=t,this.getCardList=[],this.showReward(),this.bg.scale=.8,this.bg.runAction(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.1,1))),this.mask.on(cc.Node.EventType.TOUCH_START,this.doNext,this),cc.audioEngine.playEffect(window.sound.end)},showReward:function(){this.abled=!1,this.scheduleOnce(function(){this.abled=!0}.bind(this),.3),0==this.rewards.length?this.showSingle("\u6ca1\u6709\u83b7\u5f97\u5956\u52b1","mark_empty",-1):this.checkResult()},changeReward:function(){this.abled=!1;var t=cc.instantiate(this.bg);this.node.addChild(t),t.runAction(cc.sequence(cc.moveBy(.3,cc.v2(-750,0)),cc.callFunc(function(){t.destroy()}.bind(this)))),this.bg.x=750,this.bg.runAction(cc.sequence(cc.moveBy(.3,cc.v2(-750,0)),cc.callFunc(function(){this.abled=!0}.bind(this)))),this.checkResult()},checkResult:function(){this.iconSingle.node.x=0,this.txtNode.active=this.boxSingle.active=this.markTxt.node.active=this.markDouble.active=this.itemChangeNode.active=!1,this.itemNode.removeAllChildren();var t=this.rewards.shift();if(1==t)this.showBox("\u83b7\u5f97\u666e\u901a\u88c5\u5907"),this.getItem(1);else if(2==t)this.showBox("\u83b7\u5f97\u7a00\u6709\u88c5\u5907"),this.getItem(2);else if(3==t)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u88c5\u5907"),this.getItem(3);else if(4==t)this.showSingle("\u83b7\u5f9720\u91d1\u5e01","mark_copper1"),c.data.copper+=20;else if(5==t){var e=Math.floor(99*Math.random())+1;this.showSingle("\u83b7\u5f97"+e+"\u91d1\u5e01","mark_copper1"),c.data.copper+=e}else if(6==t)this.showSingle("\u83b7\u5f97100\u91d1\u5e01","mark_copper1"),c.data.copper+=100;else if(7==t)this.showSingle("\u83b7\u5f97188\u91d1\u5e01","mark_copper1"),c.data.copper+=188;else if(8==t)this.showSingle("\u5f53\u524d\u91d1\u5e01\u6570\u91cf\u7ffb\u500d","mark_copper1"),this.iconSingle.node.x=-42,this.markDouble.active=!0,c.data.copper*=2;else if(9==t)this.showBox("\u83b7\u5f97\u968f\u673a\u5361\u724c"),this.getCard();else if(10==t)this.showBox("\u83b7\u5f97\u7a00\u6709\u5361\u724c"),this.getCard(2);else if(11==t)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u5361\u724c"),this.getCard(3);else if(12==t)this.showSingle("\u6062\u590d10\u751f\u547d","mark_hp"),c.data.hp=Math.min(c.data.hp+10,c.data.hpMax);else if(13==t)this.showSingle("\u6062\u590d30%\u6700\u5927\u751f\u547d","mark_hp"),c.data.hp=Math.min(Math.floor(c.data.hp+.3*c.data.hpMax),c.data.hpMax);else if(14==t)this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),c.data.hp=c.data.hpMax;else if(15==t){this.showBox("\u83b7\u5f97\u590d\u5236\u5361\u724c");var i=c.data.deck[Math.floor(Math.random()*c.data.deck.length)];4==c.data.heroId&&(i=c.data.cardBag[Math.floor(Math.random()*c.data.cardBag.length)]),this.getCard(null,i)}else 16==t?(this.showSingle("\u989d\u5916\u751f\u547d +5","mark_hpMax1"),c.data.hpMax+=5,c.data.hp+=5):17==t?(this.showSingle("\u989d\u5916\u751f\u547d +10","mark_hpMax1"),c.data.hpMax+=10,c.data.hp+=10):18==t?(this.showSingle("\u989d\u5916\u751f\u547d +15","mark_hpMax1"),c.data.hpMax+=15,c.data.hp+=15):19==t?this.changeItem():20==t?this.deleteItem():21==t?(this.showSingle("\u5931\u53bb20\u91d1\u5e01","mark_copper2",-1),c.data.copper=Math.max(c.data.copper-20,0)):22==t?(this.showSingle("\u5931\u53bb50\u91d1\u5e01","mark_copper2",-1),c.data.copper=Math.max(c.data.copper-50,0)):23==t?(this.showSingle("\u5931\u53bb\u4e00\u534a\u91d1\u5e01","mark_copper2",-1),c.data.copper=Math.ceil(c.data.copper/2)):24==t?(this.showBox("\u5931\u53bb1\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c"),this.deleteCard(4==c.data.heroId?1:0)):25==t?(this.showBox("\u5931\u53bb2\u5f20\u80cc\u5305\u4e2d\u7684\u724c"),this.deleteCard(1,0),this.deleteCard(1,1)):26==t?(this.showSingle("\u5931\u53bb10\u751f\u547d","mark_hp2",-1),this.loseHp(10)):27==t?(this.showSingle("\u5931\u53bb30%\u6700\u5927\u751f\u547d","mark_hp2",-1),this.loseHp(Math.floor(.3*c.data.hpMax))):28==t?(this.showSingle("\u751f\u547d\u4e0a\u9650-5","Mark_hpMax2",-1),c.data.hpMax-=5,c.data.hp=Math.min(c.data.hp,c.data.hpMax)):29==t?(this.showSingle("\u751f\u547d\u4e0a\u9650-10","Mark_hpMax2",-1),c.data.hpMax-=10,c.data.hp=Math.min(c.data.hp,c.data.hpMax)):30==t&&(this.showSingle("\u6028\u5ff5","mark_curse",-1),this.showBox("\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59315\u751f\u547d"),this.boxSingle.y-=60,c.data.debuff++)},showSingle:function(t,e,i){this.boxSingle.active=!0,e&&cc.loader.loadRes("Texture/UI/yahtzee/"+e,cc.SpriteFrame,function(t,e){this.iconSingle.spriteFrame=e}.bind(this)),this.txtSingle.string=t,-1==i?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(t,e){this.boxSingle.getComponent(cc.Sprite).spriteFrame=e}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(t,e){this.boxSingle.getComponent(cc.Sprite).spriteFrame=e}.bind(this))},showBox:function(t,e){this.txtNode.active=!0,this.txtName.string=t,e&&(cc.loader.loadRes("Texture/UI/yahtzee/"+e,cc.SpriteFrame,function(t,e){this.markTxt.spriteFrame=e}.bind(this)),this.txtName.node.x=50)},getCard:function(t,e,i){var o=e||c.getNewCardId(t),a=cc.instantiate(this.cardPrefab);return a.getComponent("CardCollection").init(o,null,i?null:1),a.y=-60,this.itemNode.addChild(a),1==c.data.heroId&&3==c.data.difficulty&&c.data.deck.length>=6?this.getCardList.push(o):c.getCard(o),a},getItem:function(t,e){var i=e||c.getNewItemId(0,t);c.getItem(i);var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(i,1),o.position=cc.v2(0,-60),this.itemNode.addChild(o)},loseHp:function(t){this.dmg=t,c.data.hp-=t},changeCard:function(t){var e;if(1==t){this.showBox("\u53d8\u63621\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c");var i=Math.floor(Math.random()*c.data.deck.length);e=c.data.deck[i],c.data.deck.splice(i,1)}else{this.showBox("\u53d8\u63621\u5f20\u80cc\u5305\u4e2d\u7684\u724c");i=Math.floor(Math.random()*c.data.cardBag.length);e=c.data.cardBag[i],c.data.cardBag.splice(i,1)}if(e){var o,a=c.getNewCardId();c.getCard(a),this.itemChangeNode.active=!0,(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),o.position=cc.v2(-165,-60),this.itemNode.addChild(o),(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(a),o.position=cc.v2(165,-60),this.itemNode.addChild(o)}else this.showBox("\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362")},changeItem:function(){if(c.data.equip.length>0){this.showBox("\u53d8\u63621\u4ef6\u5df2\u6709\u88c5\u5907");var t,e=c.deleteItem(),i=c.getNewItemId(0);c.getItem(i),this.itemChangeNode.active=!0,(t=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(e),t.position=cc.v2(-165,-60),this.itemNode.addChild(t),(t=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(i),t.position=cc.v2(165,-60),this.itemNode.addChild(t)}else this.showBox("\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362")},deleteCard:function(t,e){var i=0==t?c.data.deck:c.data.cardBag;if(i.length>0){var o=Math.floor(Math.random()*i.length),a=i[o];i.splice(o,1);var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(a,null,null!=e?null:-1),s.getComponent("CardCollection").markDelete.active=!0,null!=e&&(s.x=330*e-165),s.y=-60,this.itemNode.addChild(s)}},deleteItem:function(){if(c.data.equip.length>0){var t=c.deleteItem(),e=cc.instantiate(this.itemPrefab);e.getComponent("ItemCommodity").init(t,-1),e.position=cc.v2(0,-60),this.itemNode.addChild(e)}},doNext:function(){this.abled&&(0==this.rewards.length?this.doClose():this.changeReward())},doClose:function(){if(c.data.hp<=0){c.data.hp+=this.dmg;var t=cc.instantiate(this.losePrefab);this.node.addChild(t)}else if(this.getCardList.length>0){var e=cc.instantiate(this.cardChangePrefab);e.getComponent("CardChangeLayer").init(this.getCardList[0],this.getCardList[1],this.close.bind(this)),this.node.addChild(e,100)}else this.close()},close:function(){cc.director.loadScene("helloworld"),c.data.floorBeats[c.data.floor-1]=!0}}),cc._RF.pop()},{Game:"Game"}],EndYahtzeeLayer:[function(t,e,i){"use strict";cc._RF.push(e,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var c=t("Game");t("Config");cc.Class({extends:cc.Component,properties:{titles:[cc.Node],txtNode:cc.Node,rewardNode:cc.Node,boxSingle:cc.Node,iconSingle:cc.Sprite,txtSingle:cc.Label,txtName:cc.Label,markTxt:cc.Sprite,markDouble:cc.Node,itemPrefab:cc.Prefab,cardPrefab:cc.Prefab,itemChangeNode:cc.Node,bg:cc.Node,mask:cc.Node,cardChangePrefab:cc.Prefab,losePrefab:cc.Prefab},init:function(t){this.result=t,-1==t?this.titles[1].active=!0:2==t?this.titles[2].active=!0:this.titles[0].active=!0,this.getCardList=[],this.checkResult(),this.bg.scale=.8,this.bg.runAction(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.1,1))),this.abled=!1,this.mask.on(cc.Node.EventType.TOUCH_START,this.doClose,this),this.scheduleOnce(function(){this.abled=!0}.bind(this),.3),cc.audioEngine.playEffect(window.sound.end)},checkResult:function(){var t=c.data.eventIds[c.data.castle-1];if(0==this.result||1==this.result)if(1==t||15==t||22==t)this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),c.data.hp=c.data.hpMax;else if(2==t||8==t)this.showSingle("\u989d\u5916\u751f\u547d +10","mark_hpMax"),c.data.hpMax+=10,c.data.hp+=10;else if(3==t)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u88c5\u5907"),this.getItem(3);else if(4==t)this.showSingle("\u83b7\u5f9788\u91d1\u5e01","mark_copper1"),c.data.copper+=88;else if(5==t||9==t||19==t||26==t||30==t)this.showBox("\u83b7\u5f97\u968f\u673a\u88c5\u5907"),this.getItem();else if(6==t)this.showBox("\u83b7\u5f97\u53f2\u8bd7\u5361\u724c"),this.getCard(3);else if(7==t)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-50,0),this.getItem(3);else if(10==t)this.showSingle("\u5f53\u524d\u91d1\u5e01\u6570\u91cf\u7ffb\u500d","mark_copper1"),this.iconSingle.node.x=-42,this.markDouble.active=!0,c.data.copper*=2;else if(11==t||21==t){this.showBox("\u83b7\u5f97\u590d\u5236\u5361\u724c");var e=c.data.deck[Math.floor(Math.random()*c.data.deck.length)];4==c.data.heroId&&(e=c.data.cardBag[Math.floor(Math.random()*c.data.cardBag.length)]),this.getCard(null,e)}else if(12==t||16==t||20==t)this.showSingle("\u83b7\u5f97100\u91d1\u5e01","mark_copper1"),c.data.copper+=100;else if(13==t||25==t){this.showBox("\u83b7\u5f972\u5f20\u53f2\u8bd7\u5361\u724c"),this.getCard(3,null,!0).x-=140,this.getCard(3,null,!0).x+=140}else if(14==t||29==t)this.showBox("\u751f\u547d\u4e0a\u9650+5","mark_hpMax"),this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),this.boxSingle.y-=60,c.data.hpMax+=5,c.data.hp=c.data.hpMax;else if(17==t){this.showBox("\u83b7\u5f972\u5f20\u7a00\u6709\u5361\u724c"),this.getCard(2,null,!0).x-=140,this.getCard(2,null,!0).x+=140}else if(18==t)this.showBox('\u83b7\u5f97\u88c5\u5907"\u7eaa\u5ff5\u5e01"'),this.getItem(null,73);else if(23==t)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),this.showSingle("\u989d\u5916\u751f\u547d +15","mark_hpMax"),this.boxSingle.y-=60,c.data.copper=Math.max(c.data.copper-50,0),c.data.hpMax+=15,c.data.hp+=15;else if(24==t){this.showBox("\u83b7\u5f972\u5f20\u968f\u673a\u5361\u724c"),this.getCard(null,null,!0).x-=140,this.getCard(null,null,!0).x+=140}else 27==t?(this.showSingle("\u83b7\u5f97188\u91d1\u5e01","mark_copper1"),c.data.copper+=188):28==t&&(this.showBox("\u5931\u53bb10\u751f\u547d","mark_hp3"),this.showSingle("\u83b7\u5f97188\u91d1\u5e01","mark_copper1"),this.boxSingle.y-=60,c.data.copper+=188,this.loseHp(10));else if(-1==this.result)if(1==t||8==t||24==t)this.showSingle("\u6062\u590d10\u751f\u547d","mark_hp"),c.data.hp=Math.min(c.data.hp+10,c.data.hpMax);else if(2==t)this.showBox("\u751f\u547d\u4e0a\u9650-5","Mark_hpMax3"),this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),this.boxSingle.y-=60,c.data.hpMax-=5,c.data.hp=c.data.hpMax;else if(3==t||29==t)this.changeItem();else if(4==t||9==t)this.showBox("\u83b7\u5f97\u968f\u673a\u5361\u724c"),this.getCard();else if(5==t)this.showSingle("\u83b7\u5f9750\u91d1\u5e01","mark_copper1"),c.data.copper+=50;else if(6==t||11==t)this.changeCard(2);else if(7==t)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-50,0),this.getItem(2);else if(10==t)this.showSingle("\u5931\u53bb\u4e00\u534a\u91d1\u5e01","mark_copper2"),c.data.copper=Math.ceil(c.data.copper/2);else if(12==t||18==t)this.showSingle("\u83b7\u5f9720\u91d1\u5e01","mark_copper1"),c.data.copper+=20;else if(13==t)this.showBox("\u5931\u53bb1\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c"),this.deleteCard(4==c.data.heroId?1:0);else if(14==t||16==t)this.showSingle("\u5931\u53bb10\u751f\u547d","mark_hp2"),this.loseHp(10);else if(15==t)this.showSingle("\u6028\u5ff5","mark_curse"),this.showBox("\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59315\u751f\u547d"),this.boxSingle.y-=60,c.data.debuff++;else if(17==t)this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-50,0),this.getCard(2);else if(19==t)this.showSingle("\u989d\u5916\u751f\u547d +5","mark_hpMax"),c.data.hpMax+=5,c.data.hp+=5;else if(20==t)this.showBox("\u83b7\u5f97\u7a00\u6709\u5361\u724c"),this.getCard(2);else if(21==t){var i=Math.floor(99*Math.random())+1;this.showSingle("\u83b7\u5f97"+i+"\u91d1\u5e01","mark_copper1"),c.data.copper+=i}else 22==t?(this.showBox("\u989d\u5916\u751f\u547d +5","mark_hpMax"),this.showSingle("\u5931\u53bb10\u751f\u547d","mark_hp2"),this.boxSingle.y-=60,c.data.hpMax+=5,this.loseHp(5)):23==t?(this.showBox("\u5931\u53bb50\u91d1\u5e01","mark_copper"),this.showSingle("\u6062\u590d\u5168\u90e8\u751f\u547d","mark_hp"),this.boxSingle.y-=60,c.data.copper=Math.max(c.data.copper-50,0),c.data.hp=c.data.hpMax):25==t?(this.showBox("\u5931\u53bb10\u751f\u547d","mark_hp3"),this.loseHp(10),this.getCard(3)):26==t?(this.showBox("\u6bcf\u573a\u6218\u6597\u5f00\u59cb\u65f6\uff0c\u635f\u59315\u751f\u547d"),c.data.debuff++,this.getItem()):27==t?(this.showBox("\u5931\u53bb100\u91d1\u5e01","mark_copper"),c.data.copper=Math.max(c.data.copper-100,0)):28==t?(this.showBox("\u5931\u53bb10\u751f\u547d","mark_hp3"),this.showSingle("\u83b7\u5f9788\u91d1\u5e01","mark_copper1"),this.boxSingle.y-=60,c.data.copper+=88,this.loseHp(10)):30==t&&(this.showBox("\u5931\u53bb2\u5f20\u80cc\u5305\u4e2d\u7684\u724c"),this.deleteCard(1,0),this.deleteCard(1,1));window.homeLayer&&window.homeLayer.refreshHeroData()},showSingle:function(t,e){this.boxSingle.active=!0,e&&cc.loader.loadRes("Texture/UI/yahtzee/"+e,cc.SpriteFrame,function(t,e){this.iconSingle.spriteFrame=e}.bind(this)),this.txtSingle.string=t,-1==this.result||2==this.result?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(t,e){this.boxSingle.getComponent(cc.Sprite).spriteFrame=e}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(t,e){this.boxSingle.getComponent(cc.Sprite).spriteFrame=e}.bind(this))},showBox:function(t,e){this.txtNode.active=!0,this.txtName.string=t,e&&(cc.loader.loadRes("Texture/UI/yahtzee/"+e,cc.SpriteFrame,function(t,e){this.markTxt.spriteFrame=e}.bind(this)),this.txtName.node.x=50)},getCard:function(t,e,i){var o=e||c.getNewCardId(t),a=cc.instantiate(this.cardPrefab);return a.getComponent("CardCollection").init(o,null,i?null:1),a.y=-60,this.rewardNode.addChild(a),1==c.data.heroId&&3==c.data.difficulty&&c.data.deck.length>=6?this.getCardList.push(o):c.getCard(o),a},getItem:function(t,e){var i=e||c.getNewItemId(0,t);c.getItem(i);var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(i,1),o.position=cc.v2(0,-60),this.rewardNode.addChild(o)},loseHp:function(t){this.dmg=t,c.data.hp-=t},changeCard:function(t){var e;if(1==t){this.showBox("\u53d8\u63621\u5f20\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u724c");var i=Math.floor(Math.random()*c.data.deck.length);e=c.data.deck[i],c.data.deck.splice(i,1)}else{this.showBox("\u53d8\u63621\u5f20\u80cc\u5305\u4e2d\u7684\u724c");i=Math.floor(Math.random()*c.data.cardBag.length);e=c.data.cardBag[i],c.data.cardBag.splice(i,1)}if(e){var o,a=c.getNewCardId();c.getCard(a),this.itemChangeNode.active=!0,(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(e),o.position=cc.v2(-165,-60),this.rewardNode.addChild(o),(o=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(a),o.position=cc.v2(165,-60),this.rewardNode.addChild(o)}else this.showBox("\u6ca1\u6709\u5361\u724c\u53ef\u53d8\u6362")},changeItem:function(){if(c.data.equip.length>0){this.showBox("\u53d8\u63621\u4ef6\u5df2\u6709\u88c5\u5907");var t,e=c.deleteItem(),i=c.getNewItemId(0);c.getItem(i),this.itemChangeNode.active=!0,(t=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(e),t.position=cc.v2(-165,-60),this.rewardNode.addChild(t),(t=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(i),t.position=cc.v2(165,-60),this.rewardNode.addChild(t)}else this.showBox("\u6ca1\u6709\u88c5\u5907\u53ef\u53d8\u6362")},deleteCard:function(t,e){var i=0==t?c.data.deck:c.data.cardBag;if(i.length>0){var o=Math.floor(Math.random()*i.length),a=i[o];i.splice(o,1);var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(a,null,null!=e?null:-1),s.getComponent("CardCollection").markDelete.active=!0,null!=e&&(s.x=330*e-165),s.y=-60,this.rewardNode.addChild(s)}},doClose:function(){if(c.data.hp<=0){c.data.hp+=this.dmg;var t=cc.instantiate(this.losePrefab);this.node.addChild(t)}else if(this.getCardList.length>0){var e=cc.instantiate(this.cardChangePrefab);e.getComponent("CardChangeLayer").init(this.getCardList[0],this.getCardList[1],this.close.bind(this)),this.node.addChild(e,100)}else this.close()},close:function(){this.abled&&(window.homeLayer?this.node.destroy():(cc.director.loadScene("helloworld"),c.data.floorBeats[c.data.floor-1]=!0))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(t,e,i){"use strict";cc._RF.push(e,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,boxBuff:cc.Node,txtName:cc.Label,txtLevel:cc.Label,txtDice:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,figure:cc.Node,figureNode:cc.Node,equipDesc:cc.RichText,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){c.editCfg?this.initEdit():(this.cfgId=c.monsterId,this.cfg=o.get("cfg_monster",this.cfgId),this.hpMax=this.cfg.hp,4==c.data.difficulty?this.hpMax=1.15*this.hpMax:5==c.data.difficulty&&(this.hpMax=1.3*this.hpMax),c.data.equip.indexOf(91)>=0&&(this.hpMax=1.1*this.hpMax),c.data.itemEffect.pen>0&&(this.hpMax=this.hpMax/2,c.data.itemEffect.pen--),this.hpMax=Math.floor(this.hpMax),this.hp=this.hpMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,1==c.data.heroId&&5==c.data.difficulty&&this.diceCount++,this.cfg.item>0?this.equipList=[this.cfg.item]:this.equipList=[],this.txtName.string=this.cfg.name,this.txtLevel.string="Lv."+this.cfg.level,this.initDeck()),this.player.init(1),this.escapeRate=0,this.exRollCount=0,this.ai=this.getComponent("AI"),this.board=window.mainLayer.board,cc.loader.loadRes("Texture/monster/figure/"+this.cfgId,cc.SpriteFrame,function(t,e){this.figure.getComponent(cc.Sprite).spriteFrame=e,12==this.cfgId||17==this.cfgId||20==this.cfgId||33==this.cfgId||42==this.cfgId||45==this.cfgId||55==this.cfgId||62==this.cfgId||65==this.cfgId||76==this.cfgId||1==this.cfgId?(this.figureNode.scaleX=1.5,this.figureNode.scaleY=.6,this.figureNode.runAction(cc.sequence(cc.scaleTo(.4,.8,1.2),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))):(this.figureNode.y+=250,this.figureNode.scaleX=.8,this.figureNode.scaleY=1.2,this.figureNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,-250)),cc.scaleTo(.3,1.2,.8)),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))),this.scheduleOnce(function(){window.sound.monsterSound[this.cfgId-1]&&cc.audioEngine.playEffect(window.sound.monsterSound[this.cfgId-1])}.bind(this),.2)}.bind(this))},startRound:function(){this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5),this.board.runAction(cc.sequence(cc.delayTime(.5),cc.moveBy(.15,cc.v2(0,120))))},endRound:function(){this.exRollCount=0,this.board.runAction(cc.moveBy(.15,cc.v2(0,-120))),this.equip.check(126)&&(this.escapeRate+=.1,Math.random()<this.escapeRate&&this.escape())},onHurt:function(t,e,i,c){window.mainLayer.gameOver||(i=i||7,c=null!=c?c:1,this.player.onHurt(t,e,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(0)))},onHeal:function(t){this.equip.checkWithTrigger(76)&&(t=Math.floor(1.5*t)),this.player.onHeal(t),this.player.assertHpChange("+"+t,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},initDeck:function(){if(0==this.cfg.card1)if(4==c.data.heroId){var t=Math.min(c.data.cardBag.length,6),e=c.data.cardBag.concat();this.deck=[];for(var i=0;i<t;i++){var o=Math.floor(e.length*Math.random()),a=e[o];this.deck.push(a),e.splice(o,1)}}else this.deck=c.data.deck.concat();else{this.deck=[];for(var s=0;s<6;s++){var n=this.cfg["card"+(s+1)];n>0&&this.deck.push(n)}}this.initialDeck=this.deck.concat()},initEdit:function(){this.cfgId=35,this.hp=this.hpMax=parseInt(c.editCfg.hpEnemy),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(c.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.equipList=""!=c.editCfg.equipEnemy?[c.editCfg.equipEnemy]:[],this.deck=[];for(var t=c.editCfg.deckEnemy.split(";"),e=0;e<t.length;e++)""!=t[e]&&this.deck.push(parseInt(t[e]))},doShake:function(t){var e={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};e[t]&&(this.figure.color=cc.Color.WHITE.fromHEX("#"+e[t]),this.figure.stopAllActions(),this.figure.runAction(cc.sequence(cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(-15,-5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.08,cc.v2(-15,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){this.figure.position=cc.v2(0,0),this.figure.color=cc.Color.WHITE}.bind(this)))))},escape:function(){window.mainLayer.showEnd(0,!0)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(t,e,i){"use strict";cc._RF.push(e,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,mask:cc.Node},onLoad:function(){window.equipLayer=this,this.getComponent(cc.Widget).top=cc.winSize.height/cc.winSize.width*750,this.getComponent(cc.Widget).bottom=-cc.winSize.height/cc.winSize.width*750;var t=0;window.bagLayer?(t=.15,window.bagLayer.close()):window.mapLayer&&(t=.15,window.mapLayer.close()),this.node.runAction(cc.sequence(cc.delayTime(t),cc.moveTo(.15,cc.v2(0,0)),cc.callFunc(function(){this.mask.active=!0,this.getComponent(cc.Widget).top=0,this.getComponent(cc.Widget).bottom=0}.bind(this)))),this.initItems(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initItems:function(){for(var t=0;t<c.data.equip.length;t++){var e=cc.instantiate(this.itemPrefab);e.getComponent("ItemCollection").init(c.data.equip[t]),e.position=cc.v2(-20,-70-124*t),this.content.addChild(e)}this.content.height=Math.max(124*c.data.equip.length+20,cc.winSize.height/cc.winSize.width*750-1334+870)},close:function(){this.mask.active=!1,this.node.runAction(cc.sequence(cc.moveTo(.15,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.equipLayer=null,window.homeLayer.btnEquip.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(t,e,i){"use strict";cc._RF.push(e,"a22ddJNtUJBS6PVq98jP/g9","Equip");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?c.data.equip:this.host.equipList,this.boxEquip=this.host.boxEquip,this.abled=1==this.index||159!=this.opponent.host.equipList[0],this.swiftGlove=!1,this.luckDice=!1,this.luckFlag=!1,this.suckRemainder=0,this.armorRemainder=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0,this.feedBack=0,this.feather=0,this.reviveBook=0,this.wolfBlood=!1,this.initItems()},initItems:function(){if(this.itemList=[],0==this.index){for(var t=0;t<this.equipList.length;t++){if(this.equipList[t]>0)if(o.get("cfg_item",this.equipList[t]).battle){var e=!1;if(10==this.equipList[t]&&c.data.itemEffect.feather>0?(this.feather=1,e=!0):158==this.equipList[t]&&c.data.itemEffect.reviveBook>0?(this.reviveBook=1,e=!0):e=!0,e){var i=cc.instantiate(this.itemPrefab);i.getComponent("Item").init(this.equipList[t],this),this.boxEquip.addChild(i),this.itemList.push(i),this.abled||i.getComponent("Item").doDisabled()}}}for(var a=0;a<this.itemList.length;a++){var s=72;this.itemList.length>10&&(s=648/(this.itemList.length-1)),this.itemList[a].x=s*a-324}}else if(this.equipList.length>0){var n=o.get("cfg_item",this.equipList[0]);this.host.equipDesc.string="<color=#FEF64B>"+n.name+"\uff1a</c>"+c.analysisDesc(n.desc1);var r=cc.instantiate(this.itemPrefab);r.getComponent("Item").init(this.equipList[0],this),r.x=-this.host.equipDesc.node.width/2-25,r.scale=.5,this.boxEquip.addChild(r),this.itemList.push(r),r.getComponent("Item").boxNum.scale=2,10==this.equipList[0]?this.feather=1:158==this.equipList[0]&&(this.reviveBook=1)}else this.boxEquip.active=!1},check:function(t){if(!this.abled)return!1;for(var e=0;e<this.equipList.length;e++)if(this.equipList[e]==t)return!0;return!1},checkWithTrigger:function(t){return!!this.check(t)&&(this.doTrigger(t),!0)},trigger:function(t){var e=!1;if(this.check(t))if(1==t)this.opponent.host.onHurt(1,2),e=!0;else if(2==t)this.player.cardList.length<=0&&(this.player.updateArmor(5),e=!0);else if(3==t)this.player.cardList.length<=0&&(this.host.onHeal(3),e=!0);else if(4==t)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),e=!0);else if(5==t)this.opponent.buff.addBuff(26,2),e=!0;else if(6==t)this.player.buff.addBuff(13,1),e=!0;else if(7==t)this.host.onHeal(10),e=!0;else if(8==t)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(20),e=!0);else if(9==t)this.opponent.host.onHurt(6,2),e=!0;else if(10==t)this.feather>0&&(this.player.anim.show(202),this.host.hp=Math.floor(.3*this.host.hpMax),e=!0,this.feather=-1);else if(11==t)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.player.updateArmor(-this.host.armor),e=!0);else if(t>=12&&t<=18){this.opponent.buff.addBuff(t+9,[3,3,2,2,2,4,2][t-12]),e=!0}else if(19==t)this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",e=!0;else if(20==t)this.player.updateArmor(10),e=!0;else if(21==t)this.player.buff.addBuff(104,1);else if(22==t)this.opponent.host.onHurt(5,2),e=!0;else if(23==t){if(this.suckRemainder>=4){var i=Math.floor(this.suckRemainder/4);this.suckRemainder=this.suckRemainder%4,this.host.onHeal(i),e=!0}}else if(24==t)this.opponent.host.onHurt(2,2,1),e=!0;else if(25==t)this.host.hp==this.host.hpMax&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",e=!0);else if(27==t)this.host.armor<=0&&(this.player.updateArmor(5),e=!0);else if(30==t)3==this.player.round&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",e=!0);else if(37==t)this.player.buff.addBuff(105,2);else if(44==t)this.player.buff.addBuff(103,3),e=!0;else if(45==t)this.scheduleOnce(function(){this.player.createExDice()}.bind(this),.5),e=!0;else if(t>=48&&t<=53)this.scheduleOnce(function(){window.player.createExDice(t-47)}.bind(this),.5),e=!0;else if(57==t)this.player.cardList.length>0&&(this.player.extraDice++,this.host.txtExDice.string="(+"+this.player.extraDice+")",e=!0);else if(59==t)this.player.cardList.length>0&&(this.player.updateArmor(3*this.player.cardList.length),e=!0);else if(60==t)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),e=!0);else if(61==t)this.host.onHeal(15),e=!0;else if(68==t)this.opponent.buff.addBuff(24,1),e=!0;else if(69==t)this.opponent.host.onHurt(10,2),e=!0;else if(70==t){var a=c.getRandomCardId();window.player.patchCard(a,!0),window.player.deck.push(a),e=!0}else if(75==t)this.host.hp<.3*this.host.hpMax?this.player.buff.atkAd3||(this.player.buff.addBuff(104,3),this.player.buff.atkAd3=!0):this.player.buff.atkAd3&&(this.buff.removeBuff(104,3),this.player.buff.atkAd3=!1);else if(82==t||83==t)this.host.onHeal(2),e=!0;else if(79==t||78==t)this.player.updateArmor(2),e=!0;else if(80==t||81==t)this.opponent.host.onHurt(2,2),e=!0;else if(84==t)this.player.buff.addBuff(27,1),e=!0;else if(86==t)this.host.onHurt(3,2,7,2),e=!0;else if(88==t){var s=4==c.data.heroId?c.data.cardBag:c.data.deck;if(s.length>0){e=!0;for(var n=o.get("cfg_card",s[0]).element,r=1;r<s.length;r++)if(o.get("cfg_card",s[r]).element!=n){e=!1;break}}}else if(93==t){if(1==this.player.round){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard(!0);for(a=0;a<=0;){var h=c.getRandomCardId();3==o.get("cfg_card",h).quality&&(a=h)}window.player.patchCard(a),e=!0}}else if(96==t)this.opponent.buff.addBuff(26,5),e=!0;else if(97==t)this.player.updateArmor(1),e=!0;else if(102==t)this.host.hp>this.host.hpMax&&(this.player.updateArmor(this.host.hp-this.host.hpMax),e=!0);else if(104==t)this.opponent.buff.addBuff(Math.floor(10*Math.random())+21,1),e=!0;else if(105==t)this.host.onHurt(1,2,7,2),e=!0;else if(108==t)Math.random()<.3&&(this.opponent.buff.addBuff(27,1),e=!0);else if(109==t)Math.random()<.3&&(this.player.buff.addBuff(13,1),e=!0);else if(110==t)this.host.onHurt(1,2,7,2),this.opponent.buff.addBuff(26,2),e=!0;else if(111==t)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),e=!0);else if(114==t)this.player.buff.addBuff(106,1);else if(115==t)this.luckDice||(this.luckDice=!0,this.player.addRollCount(),e=!0);else if(116==t)this.luckFlag||(this.luckFlag=!0,this.opponent.host.onHurt(6,2),e=!0);else if(118==t){for(var d=0,l=0;l<this.opponent.cardList.length;l++){this.opponent.cardList[l].getComponent("Card").burn&&d++}d>0&&(this.opponent.host.onHurt(6*d,2),e=!0)}else if(119==t)this.opponent.host.onHurt(5,2),e=!0;else if(121==t){for(var f=[],p=0;p<=this.player.buff.buffList.length;p++){var u=this.player.buff.buffList[p];u>=21&&u<=28&&f.push(u)}if(f.length>0){var m=f[Math.floor(Math.random()*f.length)];this.player.buff.removeBuff(m,this.player.buff.table[m]),e=!0}}else if(122==t)this.opponent.host.onHurt(1,2),e=!0;else if(123==t)this.host.hp>this.host.hpMax&&(this.opponent.host.onHurt(this.host.hp-this.host.hpMax,2),e=!0);else if(124==t)this.player.buff.addBuff(106,2);else if(126==t)c.data.copper=Math.max(c.data.copper-10,0),e=!0;else if(128==t){if(this.player.cardList.length>0&&this.opponent.deck.length>0){var g=Math.floor(Math.random()*this.player.cardList.length),w=(a=this.player.cardList[g].getComponent("Card").cfgId,Math.floor(Math.random()*this.opponent.deck.length)),v=this.opponent.deck[w];this.player.deck[g]=v,this.opponent.deck[w]=a,this.player.cardList[g].getComponent("Card").discard(!0),this.player.patchCard(v)}e=!0}else if(129==t)this.host.onHeal(3),e=!0;else if(138==t)this.opponent.buff.addBuff(29,1),e=!0;else if(142==t)this.player.diceCount++,this.host.txtDice.string="\xd7"+this.player.diceCount,e=!0;else if(143==t)this.player.updateArmor(this.host.hpMax-this.host.hp),e=!0;else if(144==t)this.opponent.buff.addBuff(27,1),e=!0;else if(145==t){if(1==this.player.round){if(this.opponent.equip.itemList.length>0){var y=this.opponent.equip.itemList[Math.floor(Math.random()*this.opponent.equip.itemList.length)].getComponent("Item");this.equipList[0]=y.cfgId,this.itemList[0].getComponent("Item").refresh(y.cfgId);var b=o.get("cfg_item",y.cfgId);this.host.equipDesc.string="<color=#FEF64B>"+b.name+"\uff1a</c>"+c.analysisDesc(b.desc1),this.itemList[0].x=-this.host.equipDesc.node.width/2-25,this.player.checkGameBegin()}e=!0}}else if(146==t)this.feedBack=8,this.refreshItemNum(146,8),e=!0;else if(147==t)this.player.buff.addBuff(104,1),e=!0;else if(148==t)this.opponent.host.onHurt(2*this.player.round,2,1),e=!0;else if(150==t)this.player.updateArmor(3),e=!0;else if(151==t)0==this.player.cardPlayedRound&&(this.player.extraDice+=2,this.host.txtExDice.string="(+"+this.player.extraDice+")",e=!0);else if(152==t)null!=this.host.power&&(this.host.addPower(5),e=!0);else if(153==t)Math.random()<.2&&(this.player.patchCard(),e=!0);else if(155==t)this.opponent.host.armor>0&&(this.opponent.player.updateArmor(-this.opponent.host.armor),e=!0);else if(156==t)this.player.updateArmor(this.player.dmgRound),e=!0;else if(157==t)Math.random()<.3&&(this.player.patchCard(c.getRandomCardId(2)),e=!0);else if(158==t)this.reviveBook>0&&(this.player.anim.show(202),this.host.hp=this.host.hpMax,e=!0,this.reviveBook=-1);else if(160==t)!this.wolfBlood&&this.host.hp<this.host.hpMax/2&&(this.wolfBlood=!0,this.host.onHeal(Math.floor(this.host.hpMax/2)),this.player.buff.addBuff(107,1),1==this.player.index&&cc.loader.loadRes("Texture/monster/figure/999",cc.SpriteFrame,function(t,e){this.host.figure.getComponent(cc.Sprite).spriteFrame=e,this.host.figure.scale=.5,this.host.figure.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.1,1))),cc.audioEngine.playEffect(window.sound.wolfSound)}.bind(this)),e=!0);else if(161==t)this.opponent.buff.addBuff(30,3),e=!0;else if(162==t)this.host.power&&(this.opponent.host.onHurt(this.host.power,2),e=!0);else if(164==t)this.armorRemainder>=3&&(this.player.updateArmor(Math.floor(this.armorRemainder/3)),this.armorRemainder=this.armorRemainder%3,e=!0);else if(165==t){var C=Math.random();C<1/3?this.opponent.host.onHurt(5,2):C<2/3?this.opponent.buff.addBuff(26,3):this.player.buff.addBuff(27,1),e=!0}else if(166==t){if(this.refreshItemNum(166,this.opponent.cardPlayed%5),this.opponent.cardPlayed%5==0){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}e=!0}}else if(168==t)this.host.armor>0&&(this.host.onHeal(Math.floor(this.host.armor/2)),e=!0);else if(169==t){if(this.player.cardList.length<=0){for(var x=0;x<6;x++)this.player.patchCard();this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),e=!0}}else if(170==t){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}e=!0}else if(174==t){if((d=this.player.cardList.length-this.player.cardAbledCount)>0){for(var k=0;k<d;k++)this.opponent.host.onHurt(3,2);e=!0}}else 176==t?this.opponent.host.onHurt(3,2):e=!0;return e&&this.doTrigger(t),e},doTrigger:function(t){for(var e=0;e<this.itemList.length;e++){var i=this.itemList[e].getComponent("Item");if(i.cfgId==t&&!i.isRemoved){i.trigger();break}}},refreshItemNum:function(t,e){for(var i=0;i<this.itemList.length;i++){var c=this.itemList[i].getComponent("Item");if(c.cfgId==t){c.txtCount.string=e;break}}},doDisabled:function(t){for(var e=0;e<this.itemList.length;e++){var i=this.itemList[e].getComponent("Item");if(i.cfgId==t){i.doDisabled();break}}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(t,e,i){"use strict";cc._RF.push(e,"0d029pbdspBQZQHImTjZ76I","EventLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{figure:cc.Sprite,txtName:cc.Label,txtDesc:cc.Label,txtResults:[cc.Label],endPrefab:cc.Prefab,btnLeave:cc.Node,btnPlay:cc.Node},onLoad:function(){window.eventLayer=this,this.cfgId=c.data.eventIds[c.data.castle-1];var t=o.get("cfg_event",this.cfgId);this.txtName.string=t.name,this.txtDesc.string=t.desc,cc.loader.loadRes("Texture/npc/figure/"+this.cfgId,cc.SpriteFrame,function(t,e){this.figure.spriteFrame=e}.bind(this));for(var e=0;e<3;e++)this.txtResults[e].string=t["result"+(e+1)];this.btnLeave.opacity=1,this.btnPlay.opacity=1,this.btnLeave.y-=150,this.btnPlay.y-=150,this.btnLeave.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnPlay.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))},onBattle:function(){window.homeLayer=null,window.eventLayer=null,cc.director.loadScene("yahtzee")},onLeave:function(){if("\u65e0"!=o.get("cfg_event",this.cfgId).result3){var t=cc.instantiate(this.endPrefab);t.getComponent("EndYahtzeeLayer").init(2),window.homeLayer.node.addChild(t)}this.close()},close:function(){this.node.destroy(),c.data.floorBeats[c.data.floor-1]=!0,window.eventLayer=null}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(t,e,i){"use strict";cc._RF.push(e,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{box:cc.Sprite,mark:cc.Sprite,markCurrent:cc.Node},init:function(t,e,i){i&&(cc.loader.loadRes("Texture/UI/map/box_fort1",cc.SpriteFrame,function(t,e){this.box.spriteFrame=e}.bind(this)),this.markCurrent.active=!0,this.markCurrent.runAction(cc.sequence(cc.moveBy(.35,cc.v2(0,10)),cc.moveBy(.35,cc.v2(0,-10))).repeatForever())),0==e?cc.loader.loadRes("Texture/UI/map/image_fort0"+t,cc.SpriteFrame,function(t,e){this.mark.spriteFrame=e}.bind(this)):(cc.loader.loadRes(t>0?"Texture/UI/map/image_fort"+t:"Texture/UI/map/box_fort2",cc.SpriteFrame,function(t,e){this.mark.spriteFrame=e}.bind(this)),i||(this.mark.node.scale=.8))},hide:function(){this.markCurrent.active=!1,cc.loader.loadRes("Texture/UI/map/box_fort2",cc.SpriteFrame,function(t,e){this.box.spriteFrame=e}.bind(this))}}),cc._RF.pop()},{}],Game:[function(t,e,i){"use strict";cc._RF.push(e,"f5308O6zsVOxr+EKRsyR7ba","Game");var c=t("Config"),o={version:0,getData:function(t){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(e){cc.log("getStorageSuccess:"+e.data),void 0!=e.data?(o.data=JSON.parse(e.data),t()):(this.setDataToBase(),t())}.bind(this),fail:function(){this.setDataToBase(),t()}.bind(this)});else{var e=cc.sys.localStorage.getItem("dice");void 0!=e?o.data=JSON.parse(e):this.setDataToBase(),t()}},setDataToBase:function(){o.data={heroId:1,difficulty:1,deck:[],cardBag:[],equip:[],hp:35,hpMax:35,power:0,powerMax:20,heroPos:2,exp:0,level:1,castle:1,floor:1,roomType:0,copper:99,debuff:0,shopIds:[],eventIds:[],monsterList:[],historyPath:[],historyChoose:[0],floorBeats:[],specialRoomIds:[],monsterBeats:[],monsterUnbeats:[],discountCard:-1,discountItem:-1,itemEffect:{feather:0,vase:0,flagon:0,pen:0,vip1:!1,vip2:!1,reviveBook:0},startTime:0,face:1,restartCount:0,cardPlayed:{}},o.saveData()},saveData:function(){o.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(o.data),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(o.data))},getItem:function(t){if(o.data.equip.push(t),10==t)o.data.itemEffect.feather=1;else if(28==t)o.data.itemEffect.vase=2;else if(29==t)o.data.itemEffect.flagon=2;else if(40==t)o.data.hpMax+=5,o.data.hp+=5;else if(41==t)o.data.hpMax+=10,o.data.hp+=10;else if(46==t)o.data.itemEffect.vip1=!0;else if(47==t)o.data.itemEffect.vip2=!0;else if(71==t)o.data.copper+=50;else if(72==t)o.data.copper+=50,o.data.hpMax+=10,o.data.hp+=10;else if(74==t)o.data.itemEffect.pen+=2;else if(84==t)for(var e=0;e<3;e++)o.getItem(o.getNewItemId(0));else if(87==t)for(var i=0;i<2;i++)o.getItem(o.getNewItemId(0,2));else 92==t?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hp,o.data.hpMax)):95==t?(o.data.hpMax+=10,o.data.hp=o.data.hpMax):96==t?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hp,o.data.hpMax)):105==t?(o.data.hpMax+=20,o.data.hp+=20):106==t?o.data.powerMax+=10:158==t&&(o.data.itemEffect.reviveBook=1);94!=t&&o.data.equip.indexOf(94)>=0&&(o.data.hpMax+=5,o.data.hp+=5),window.homeLayer&&window.homeLayer.refreshHeroData()},getCard:function(t){var e=5==o.data.heroId?4:2==o.data.heroId&&3==o.data.difficulty?5:6;4!=o.data.heroId&&o.data.deck.length<e?o.data.deck.push(t):(o.data.cardBag.push(t),o.newCard=!0,window.homeLayer&&window.homeLayer.refreshHeroData())},getNewItemId:function(t,e,i){for(var a=0;a<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_item).length)+1,n=c.get("cfg_item",s);if(o.data.equip.indexOf(s)<0&&(0==t&&n.get<=1||1==t&&0==n.get||2==t&&3!=n.get)){var r=0;e?n.quality==e&&(r=s):r=s,i?n.hero==o.data.heroId&&(a=r):0==n.hero&&(a=r)}}return a},getNewCardId:function(t,e,i){for(var a=0;a<=0;){var s=o.getRandomCardId(null,e?2:1,t);if(o.data.deck.indexOf(s)<0&&o.data.cardBag.indexOf(s)<0){var n=c.get("cfg_card",s);n.hero!=o.data.heroId&&0!=n.hero||(a=s)}}return a},getRandomCardId:function(t,e,i){for(var a=0;a<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_card).length)+1,n=c.get("cfg_card",s);(3==e?n.get<=1:n.get==(e||1))&&(4!=o.data.heroId||n.element<7)&&(t?n.element==t&&(a=s):i?n.quality==i&&(a=s):a=s)}return a},getNewMonsterId:function(t,e){for(var i=0,a=0;i<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_monster).length)+1;o.data.monsterBeats.indexOf(s)<0&&c.get("cfg_monster",s).level==t&&c.get("cfg_monster",s).type==e&&(i=s),o.data.monsterUnbeats.indexOf(s)>=0&&a<500&&(i=0,a++)}return i},deleteItem:function(){var t=Math.floor(Math.random()*o.data.equip.length),e=o.data.equip[t];return o.data.equip.splice(t,1),10==e?o.data.itemEffect.feather=0:28==e?o.data.itemEffect.vase=0:29==e?o.data.itemEffect.flagon=0:40==e?(o.data.hpMax=Math.max(o.data.hpMax-5,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):41==e?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):46==e?o.data.itemEffect.vip1=!1:47==e?o.data.itemEffect.vip2=!1:72==e?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):74==e?o.data.itemEffect.pen=0:92==e?o.data.hpMax+=20:95==e?o.data.hpMax=Math.max(o.data.hpMax-10,1):96==e?o.data.hpMax+=10:105==e?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):106==e?(o.data.powerMax-=10,o.data.power=Math.min(o.data.powerMax,o.data.power)):158==e&&(o.data.itemEffect.reviveBook=0),e},analysisDesc:function(t,e){for(var i="",c=0,o="",a={1:"fire",2:"water",3:"wind",4:"earth",5:"light",6:"dark",7:"atk",9:"suck",11:"armor",12:"heal",13:"dodge",14:"power",15:"heart",16:"atkback",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind"},s={1:"FF3832",2:"2CB4FF",3:"00F776",4:"FF9652",5:"FFFB4B",6:"BF7FE4",7:"FFFFFF",9:"FF5567",11:"42EBFF",12:"98F700",13:"FFF830",14:"FFFB4B",15:"FF5567",16:"FF5567",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1"},n=0;n<t.length;n++)"#"==t[n]?0==c?(c=1,o="",i+="<img src='"):(i+=a[parseInt(o)],i+="'/>",c=0):"["==t[n]?(o="",0==c&&(c=2,i+="<color=#")):"]"==t[n]?""!=o?(i+=s[parseInt(o)],i+=">",c=-1):(c=0,i+="</c>"):c<=0?t[n]>="A"&&t[n]<="F"?i+=" <img src='dice"+(t[n].charCodeAt()-64)+"'/> ":i+=t[n]:o+=t[n];return i}};e.exports=o,cc._RF.pop()},{Config:"Config"}],HelloWorld:[function(t,e,i){"use strict";cc._RF.push(e,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var c=t("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,hero:cc.Node,roomPrefab:cc.Prefab,stripHp:cc.ProgressBar,txtHp:cc.Label,stripExp:cc.ProgressBar,txtExp:cc.Label,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,txtEquipCount:cc.Label,markRed:cc.Node,layerNode:cc.Node,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,equipPrefab:cc.Prefab,completePrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab,btnMap:cc.Node,btnEquip:cc.Node,btnDeck:cc.Node,mask:cc.Node,chess:cc.Node,fortPrefab:cc.Prefab,boxFort:cc.Node,cardChangePrefab:cc.Prefab,cardDeletePrefab:cc.Prefab,soundPrefab:cc.Prefab},onLoad:function(){window.homeLayer=this,this.initPath(),1==c.data.floor&&1==c.data.castle&&this.initGameConfig(),this.createRoom(),this.refreshHeroData(),c.data.levelUp&&this.scheduleOnce(this.openLvUp,.3),this.status=0,this.mask.active=!0,this.mask.zIndex=1e3,this.mask.width=this.mask.height=100,this.schedule(this.updateMask,0),this.hero.scaleX=c.data.face,this.chess.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever());var t=cc.instantiate(this.soundPrefab);this.node.addChild(t),window.sound=t.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmMap[c.data.castle-1],!0)},createRoom:function(){var t=cc.instantiate(this.roomPrefab);this.bg.addChild(t),this.room=t,this.hero.parent=t,this.hero.zIndex=10,c.begin?(t.getComponent("Room").init(!0),t.getComponent("Room").initHero(),c.begin=!1):t.getComponent("Room").init(!1)},changeRoom:function(t){var e=cc.instantiate(this.roomPrefab);this.bg.addChild(e),e.getComponent("Room").init(!0);var i=cc.v2();0==t?(e.position=cc.v2(0,1450),i=cc.v2(0,-1450)):1==t?(e.position=cc.v2(1080,0),i=cc.v2(-1080,0)):2==t?(e.position=cc.v2(0,-1450),i=cc.v2(0,1450)):3==t&&(e.position=cc.v2(-1080,0),i=cc.v2(1080,0));var c=this.room;c.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.hero.parent=e,this.hero.zIndex=10,c.destroy()}.bind(this)))),e.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.room=e,e.getComponent("Room").initHero()}.bind(this))))},openAlter:function(){if(2==c.data.roomType){if(!window.campLayer){var t=cc.instantiate(this.campPrefab);this.node.addChild(t)}}else if(3==c.data.roomType)window.treasureLayer||this.openTreasure();else if(4==c.data.roomType){if(!window.eventLayer){var e=cc.instantiate(this.eventPrefab);this.node.addChild(e)}}else if(5==c.data.roomType){if(!window.shopLayer){var i=cc.instantiate(this.shopPrefab);this.layerNode.addChild(i)}}else 6==c.data.roomType&&(cc.director.loadScene("tavern"),window.homeLayer=null)},refreshHeroData:function(){this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax;var t=[7,15,25,37,51,67,150][c.data.level-1];this.txtExp.string=c.data.exp+"/"+t,this.stripExp.progress=c.data.exp/t;this.txtName.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtLevel.string="Lv."+c.data.level,this.txtCopper.string=c.data.copper,this.txtEquipCount.string=c.data.equip.length,this.markRed.active=c.newCard},openMap:function(){if(window.mapLayer)window.mapLayer.mask.opacity>=180&&window.mapLayer.close();else{var t=cc.instantiate(this.mapPrefab);this.layerNode.addChild(t)}},openCardBag:function(){if(window.bagLayer)window.bagLayer.mask.active&&window.bagLayer.close();else{var t=cc.instantiate(this.bagPrefab);this.layerNode.addChild(t)}},openEquip:function(){if(window.equipLayer)window.equipLayer.mask.active&&window.equipLayer.close();else{var t=cc.instantiate(this.equipPrefab);this.layerNode.addChild(t)}},openTreasure:function(){var t=cc.instantiate(this.treasurePrefab);t.getComponent("TreasureLayer").init(),this.node.addChild(t)},openLvUp:function(){var t=cc.instantiate(this.lvUpPrefab);this.node.addChild(t)},openComplete:function(){var t=cc.instantiate(this.completePrefab);this.node.addChild(t)},initDeck:function(){if(4==c.data.heroId)c.data.cardBag=[1,2,3,4,5,6];else{var t=5==c.data.heroId?2:3;if(c.data.deck.length+c.data.cardBag.length<=t)for(;c.data.deck.length+c.data.cardBag.length<t;){var e=c.getNewCardId(null,!0);c.getCard(e)}}},initGameConfig:function(){this.initDeck(),c.data.eventIds=[];for(var t=0;t<30;t++){var e=Math.floor(Math.random()*(c.data.eventIds.length+1));c.data.eventIds.splice(e,0,t+1)}c.data.specialRoomIds=[3,4];for(var i=[[2,6,5],[2,3,4,6,5],[2,3,4,6]],o=0;o<3;o++)for(var a=i[o],s=a.length-1;s>=0;s--){var n=Math.floor(Math.random()*a.length);c.data.specialRoomIds.push(a[n]),a.splice(n,1)}c.data.specialRoomIds.push(5),c.data.floorQuests=[[],[],[]];for(var r=0;r<3;r++)for(var h=0;h<13;h++)this.initFloorConfig(r,h)},initFloorConfig:function(t,e){var i=[];if(0==e)i=[1];else if(4==e)i=[7,7];else if(10==e)i=[8];else if(11==e)i=t<2?[0]:[8];else if(12==e){if(t<2)return;i=[0]}else if(2==e||6==e||8==e)i=Math.random()<.4?[1,1,1]:[1,1];else{var o=c.data.specialRoomIds.shift();i=Math.random()<.3?[o,1,1]:[o,1]}c.data.floorQuests[t].push(i)},gotoEdit:function(){cc.director.loadScene("edit")},goBattle:function(){this.status=2,this.mask.active=!0,this.schedule(this.updateMask,0)},updateMask:function(){0==this.status?(this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1,this.status)):2==this.status&&(this.mask.width-=60,this.mask.height-=60,this.mask.width<=100&&(this.mask.width=this.mask.height=100,this.unschedule(this.updateMask),window.homeLayer=null,cc.director.loadScene("mainLayer")))},initPath:function(){this.pathList=[];for(var t=3==c.data.castle?12:11,e=0;e<t;e++){var i=cc.instantiate(this.fortPrefab);i.scale=.8,i.x=-(t-1)/2*54+54*e,this.boxFort.addChild(i),this.pathList.push(i),0==e?i.getComponent("Fort").init(1,1,!1):e>=10?i.getComponent("Fort").init(8,1,!1):e<=c.data.historyChoose.length-2&&i.getComponent("Fort").init(c.data.historyChoose[e+1],1,!1)}this.boxFort.width=54*(t-1)},refreshPath:function(){c.data.floor>1&&(this.pathList[c.data.floor-2].getComponent("Fort").init(c.data.roomType,1,!0),c.data.floor>2&&this.pathList[c.data.floor-3].getComponent("Fort").hide())},getCard:function(t){if(1==c.data.heroId&&3==c.data.difficulty)if(c.data.deck.length<6)c.getCard(t);else{var e=cc.instantiate(this.cardChangePrefab);e.getComponent("CardChangeLayer").init(t),this.node.addChild(e,100)}else c.getCard(t)},openDelete:function(){var t=cc.instantiate(this.cardDeletePrefab);this.node.addChild(t,100)}}),cc._RF.pop()},{Game:"Game"}],Hero:[function(t,e,i){"use strict";cc._RF.push(e,"7311fX1RYNN1bDgBGcTZsee","Hero");var c=t("Game");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,skillPrefab:cc.Prefab,head:cc.Node,skillNode:cc.Node,txtDice:cc.Label,txtExDice:cc.Label},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){this.btnEnd=window.mainLayer.btnEnd,this.btnRoll=window.mainLayer.btnRoll,this.txtRollCount=window.mainLayer.txtRollCount,this.initDeck(),this.diceCount=5,3==c.data.heroId&&(this.diceCount=4),this.player.init(0),this.hpMax=c.data.hpMax,this.hp=c.data.hp,this.power=c.data.power,this.powerMax=c.data.powerMax,this.armor=0,this.rollabled=!0,this.refreshStrip(),this.initSkills()},startRound:function(){this.btnEnd.runAction(cc.sequence(cc.delayTime(.8),cc.moveTo(.2,cc.v2(-275,this.btnEnd.y))))},endRound:function(){for(var t=0;t<2;t++)this.btnSkills[t].getComponent("Skill").abled=!0;this.checkSkills(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-475,this.btnEnd.y))),this.player.totalRollCount=this.player.rollCount,this.player.rollCount=0,this.checkBtnRoll()},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onHurt:function(t,e,i,c){if(!window.mainLayer.gameOver){var o=this.hp;if(i=i||7,c=null!=c?c:1,this.player.onHurt(t,e,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),o>this.hp){var a=o-this.hp;this.equip.checkWithTrigger(163)&&(a*=2),this.addPower(a)}}},onHeal:function(t){this.equip.checkWithTrigger(76)&&(t=Math.floor(1.5*t)),this.player.onHeal(t),this.player.assertHpChange("+"+t,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(t){t>0&&this.player.opponent.equip.checkWithTrigger(178)||(this.power+=t,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.checkSkills())},initSkills:function(){this.btnSkills=[];for(var t=0;t<2;t++){var e=cc.instantiate(this.skillPrefab);e.position=cc.v2(0==t?127:285,31),e.getComponent("Skill").init(t),this.skillNode.addChild(e),this.btnSkills.push(e)}},checkSkills:function(){for(var t=0;t<2;t++)this.btnSkills[t].getComponent("Skill").check()},checkBtnRoll:function(t){var e=!1;if(this.player.rollCount>0&&this.player.diceList.length>0)if(this.player.cardList.length>0)e=!0;else if(this.player.chestList)for(var i=0;i<3;i++)if(this.player.chestList[i]){e=!0;break}var c=this.btnRoll.y;e!=this.rollabled?(this.rollabled=e,this.btnRoll.stopAllActions(),e?this.btnRoll.runAction(cc.moveTo(.15,cc.v2(310,c))):this.btnRoll.runAction(cc.moveTo(.15,cc.v2(425,c)))):e&&t&&(this.btnRoll.stopAllActions(),this.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(425,c)),cc.moveTo(.15,cc.v2(310,c))))),this.txtRollCount.string=this.player.rollCount},initDeck:function(){if(4==c.data.heroId){if(this.deck=c.data.cardBag.concat(),4==c.data.difficulty)for(var t=0;t<c.data.level;t++)this.deck.push(224)}else this.deck=c.data.deck.concat()},doShake:function(t){var e={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};e[t]&&(this.head.color=cc.Color.WHITE.fromHEX("#"+e[t]),window.mainLayer.camera.stopAllActions(),window.mainLayer.camera.runAction(cc.sequence(cc.moveTo(.05,cc.v2(5,5)),cc.moveTo(.1,cc.v2(-5,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){window.mainLayer.camera.position=cc.v2(0,0),this.head.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Game:"Game"}],ItemCollection:[function(t,e,i){"use strict";cc._RF.push(e,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.RichText,icon:cc.Sprite,boxHead:cc.Sprite},init:function(t){var e=o.get("cfg_item",t),i=[cc.color(85,229,255),cc.color(255,128,242),cc.color(255,154,73)];this.txtName.string=e.name;var a=c.analysisDesc(e.desc1),s=-1;10==t?s=c.data.itemEffect.feather>0?1:0:28==t?s=c.data.itemEffect.vase:29==t?s=c.data.itemEffect.flagon:74==t?s=c.data.itemEffect.pen:158==t&&(s=c.data.itemEffect.reviveBook>0?1:0),s>=0&&(a+="<color=#EBC82E>  (\u5269\u4f59\u6b21\u6570"+s+")</c>"),this.txtDesc.string=a,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][e.quality-1],this.txtQuality.node.color=i[e.quality-1],cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+e.quality,cc.SpriteFrame,function(t,e){this.boxHead.spriteFrame=e}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ItemCommodity:[function(t,e,i){"use strict";cc._RF.push(e,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtName2:cc.Label,icon:cc.Sprite,bg:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,explode:cc.Node},init:function(t,e){var i=o.get("cfg_item",t);this.txtName.string=this.txtName2.string=i.name,this.txtDesc.string=c.analysisDesc(i.desc1),cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/UI/box_item"+i.quality,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+i.quality,cc.SpriteFrame,function(t,e){this.boxIcon.spriteFrame=e}.bind(this)),null!=e&&(this.explode.active=!0,-1==e?cc.loader.loadRes("Texture/UI/yahtzee/bg_lose",cc.SpriteFrame,function(t,e){this.explode.getComponent(cc.Sprite).spriteFrame=e}.bind(this)):cc.loader.loadRes("Texture/UI/box_explode",cc.SpriteFrame,function(t,e){this.explode.getComponent(cc.Sprite).spriteFrame=e}.bind(this)))},hideBox:function(){this.bg.node.active=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Item:[function(t,e,i){"use strict";cc._RF.push(e,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,iconBtn:cc.Button,boxNum:cc.Node,txtCount:cc.Label,tip:cc.Node,txtDesc:cc.RichText,box:cc.Node,bg:cc.Sprite},init:function(t,e,i){this.cfgId=t,this.cfg=o.get("cfg_item",t),this.equip=e,cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),43!=t&&146!=t&&166!=t||(this.boxNum.active=!0),i&&(this.boxNum.active=!1,cc.loader.loadRes("Texture/UI/box_icon"+this.cfg.quality,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this))),this.layer=window.mainLayer||window.completeLayer},trigger:function(){this.action&&this.icon.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.5),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,1==this.cfg.num&&this.doDisabled()}.bind(this))),this.icon.node.runAction(this.action)},doDisabled:function(){this.iconBtn.enableAutoGrayEffect=!0},openTip:function(){if(!this.equip||1!=this.equip.index){if(this.layer.equipTip){if(this.layer.equipTip==this)return void this.hideTip();this.layer.equipTip.hideTip()}this.tip.active=!0,this.layer.equipTip=this;this.txtDesc.string="<color=#"+["5CC7FF","C262FF","FF9231"][this.cfg.quality-1]+">"+this.cfg.name+"\uff1a</c>"+c.analysisDesc(this.cfg.desc1),this.node.x<-220?this.box.x=-220-this.node.x:this.node.x>220&&(this.box.x=220-this.node.x),this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.tip.active=!1,this.layer.equipTip=null},refresh:function(t){this.cfgId=t,this.cfg=o.get("cfg_item",t),cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),43!=t&&146!=t&&166!=t||(this.boxNum.active=!0),this.iconBtn.enableAutoGrayEffect=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LevelUpLayer:[function(t,e,i){"use strict";cc._RF.push(e,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,boxSkill:cc.Node,iconSkill:cc.Sprite,txtSkill:cc.Label,boxCard:cc.Node,btns:[cc.Node],txtLevel:cc.Label,shine:cc.Node,boxReward:cc.Node,txtNext:cc.Node,mask:cc.Node,bg:cc.Node,bgNode:cc.Node,boxMax:cc.Node},onLoad:function(){this.type=3,3==c.data.level?this.initSkill():5==c.data.level||7==c.data.level?(this.type=2,this.initItems()):(this.type=1,this.initCards()),this.txtLevel.string=c.data.level,this.boxReward.opacity=1,this.shine.opacity=1,this.bg.height=400,this.step=0,this.schedule(this.updateFrame,0),this.shine.runAction(cc.rotateBy(5,360).repeatForever()),this.shine.runAction(cc.fadeIn(.5)),cc.audioEngine.playEffect(window.sound.levelUpSound)},updateFrame:function(){if(0==this.step)this.bg.height+=30,this.bg.height>846&&this.step++;else if(this.bg.height-=3,this.bg.height<=826){this.unschedule(this.updateFrame),this.boxReward.opacity=255;for(var t=0;t<2;t++)this.btns[t].opacity=1,this.btns[t].y-=100,this.btns[t].runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,110)),cc.moveBy(.1,cc.v2(0,-10)))))}},initCards:function(){this.boxCard.active=!0,this.itemIdList=[],this.items=[];var t=c.getNewCardId(null,!1,!0);this.itemIdList.push(t);for(var e=0;e<=0;){var i=c.getNewCardId(null,!1,!0);i!=t&&(e=i)}this.itemIdList.push(e);for(var o=0;o<2;o++){var a=cc.instantiate(this.cardPrefab);a.getComponent("CardCollection").init(this.itemIdList[o]),a.position=cc.v2(0==o?-170:170,45),this.boxCard.addChild(a),this.items.push(a)}},initItems:function(){this.boxCard.active=!0,this.itemIdList=[],this.items=[];var t=c.getNewItemId(0,null,!0);this.itemIdList.push(t);for(var e=0;e<=0;){var i=c.getNewItemId(0,null,!0);i!=t&&(e=i)}this.itemIdList.push(e);for(var o=0;o<2;o++){var a=cc.instantiate(this.itemPrefab);a.getComponent("ItemCommodity").init(this.itemIdList[o]),a.position=cc.v2(0==o?-170:170,45),this.boxCard.addChild(a),this.items.push(a)}},initSkill:function(){this.boxSkill.active=!0;this.txtSkill.string=["\u72c2\u6012","\u5927\u6ee1\u8d2f","\u6536\u5272","\u751f\u673a"][c.data.heroId-1],cc.loader.loadRes("Texture/hero/skill/"+2*c.data.heroId,cc.SpriteFrame,function(t,e){this.iconSkill.spriteFrame=e}.bind(this)),this.scheduleOnce(function(){this.txtNext.active=!0,this.mask.on(cc.Node.EventType.TOUCH_START,this.close,this)}.bind(this),.5)},choose:function(t,e){1==this.type?window.homeLayer.getCard(this.itemIdList[e]):c.getItem(this.itemIdList[e]),this.close(e),cc.audioEngine.playEffect(window.sound.selectSound)},close:function(t){if(c.data.levelUp=!1,3==this.type)this.node.destroy();else{this.mask.runAction(cc.fadeOut(.2)),this.bgNode.active=!1,this.boxMax.active=!1,this.btns[0].active=this.btns[1].active=!1,this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4);var e=cc.winSize.height/cc.winSize.width*750;this.items[1-t].active=!1,1==this.type?this.items[t].runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.spawn(cc.moveTo(.3,cc.v2(312,-e/2-80+115+33+120-30)),cc.scaleTo(.3,.4)))):(this.items[t].getComponent("ItemCommodity").hideBox(),this.items[t].runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveTo(.3,cc.v2(211,-e/2-80+115+33+120-30-35)))))}}}),cc._RF.pop()},{Game:"Game"}],LoseLayer:[function(t,e,i){"use strict";cc._RF.push(e,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,btnRestart:cc.Node,btnQuit:cc.Node,txtCount:cc.Label},onLoad:function(){this.title.y+=350,this.title.runAction(cc.moveBy(.2,cc.v2(0,-350))),this.btnRestart.opacity=1,this.btnQuit.opacity=1,this.btnRestart.y-=150,this.btnQuit.y-=150,this.btnRestart.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnQuit.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.scheduleOnce(function(){this.txtCount.string=c.data.restartCount>100?"":"\u5269\u4f59\u6b21\u6570 "+c.data.restartCount}.bind(this),.4),c.data.restartCount<=0&&(this.btnRestart.getComponent(cc.Button).interactable=!1),cc.audioEngine.playEffect(window.sound.lose)},restart:function(){var t=JSON.parse(JSON.stringify(c.data));c.data=c.tempData,c.data.historyPath=t.historyPath,c.data.historyChoose=t.historyChoose,c.data.monsterList=t.monsterList,c.data.restartCount--,cc.director.loadScene("helloworld")},quit:function(){c.setDataToBase(),cc.director.loadScene("prepare")}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(t,e,i){"use strict";cc._RF.push(e,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{heroPrefab:cc.Prefab,enemyPrefab:cc.Prefab,enemyNode:cc.Node,endPrefab:cc.Prefab,losePrefab:cc.Prefab,editEndPrefab:cc.Prefab,btnEnd:cc.Node,btnRoll:cc.Node,boxCardHero:cc.Node,boxDiceHero:cc.Node,boxCardEnemy:cc.Node,boxDiceEnemy:cc.Node,board:cc.Node,camera:cc.Node,txtRollCount:cc.Label,bg:cc.Sprite,mask:cc.Node,chooseDiceLayer:cc.Prefab,soundPrefab:cc.Prefab},onLoad:function(){window.mainLayer=this,this.gameOver=!1,cc.loader.loadRes("Texture/scene/castle"+c.data.castle,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this)),this.bg.node.on(cc.Node.EventType.TOUCH_START,this.hideTip,this),this.mask.active=!0,this.mask.zIndex=1e3,this.schedule(this.updateMask,0);var t=cc.instantiate(this.soundPrefab);this.node.addChild(t),window.sound=t.getComponent("Sound"),8==c.data.roomType?13==c.data.floor?cc.audioEngine.playMusic(window.sound.bgmBossBig,!0):cc.audioEngine.playMusic(window.sound.bgmBoss[c.data.castle-1],!0):cc.audioEngine.playMusic(window.sound.bgmBattle[c.data.castle-1],!0)},start:function(){var t=cc.instantiate(this.heroPrefab);t.position=cc.v2(0,115-cc.winSize.height/2),this.node.addChild(t),this.hero=t.getComponent("Hero");var e=cc.instantiate(this.enemyPrefab);e.position=cc.v2(0,cc.winSize.height/2-330),this.enemyNode.addChild(e),this.enemy=e.getComponent("Enemy"),this.enemy.init(),this.hero.init(),this.roundId=1,this.scheduleOnce(function(){this.enemy.equip.checkWithTrigger(141)&&!this.hero.equip.checkWithTrigger(141)&&(this.roundId=0),this.doRound()}.bind(this),.5)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.player.startRound()},showEnd:function(t,e){if(!this.gameOver)if(this.gameOver=!0,c.editCfg){var i=cc.instantiate(this.editEndPrefab);this.node.addChild(i)}else this.scheduleOnce(function(){if(0==t){var i=cc.instantiate(this.endPrefab);i.getComponent("EndLayer").init(e),this.node.addChild(i)}else{c.data.monsterUnbeats.push(c.monsterId);var o=cc.instantiate(this.losePrefab);this.node.addChild(o)}}.bind(this),.5)},roll:function(){3==c.data.heroId?this.chooseDice():this.hero.player.roll()},chooseDice:function(){var t=cc.instantiate(this.chooseDiceLayer);this.node.addChild(t,100)},endRound:function(){this.hero.player.endRound()},hideTip:function(){this.equipTip&&this.equipTip.hideTip(),this.buffTip&&this.buffTip.hideTip()},updateMask:function(){this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1)}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2be16dXDepLLbZP42Rqq+om","MapLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{scroll:cc.ScrollView,content:cc.Node,fortPrefab:cc.Prefab,mask:cc.Node,markBoss:cc.Node,lineNode:cc.Node,line:cc.Node,txtTitle:cc.Label,view:cc.Node,top:cc.Node,bottom:cc.Node,box:cc.Node,btnBack:cc.Node},onLoad:function(){window.mapLayer=this;this.txtTitle.string="\u53e4\u5821"+["\u4e00","\u4e8c","\u4e09"][c.data.castle-1]+"\u5c42",window.bagLayer?window.bagLayer.close():window.equipLayer&&window.equipLayer.close(),this.box.opacity=1,this.mask.opacity=1,this.mask.runAction(cc.sequence(cc.fadeTo(.2,180),cc.callFunc(function(){this.openMap()}.bind(this)))),this.drawMap(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},openMap:function(){this.box.opacity=255,this.winHeight=cc.winSize.height/cc.winSize.width*750,this.bottom.y=-this.winHeight/2+330,this.bottom.runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.05,cc.v2(0,-150)),cc.moveBy(.1,cc.v2(0,-50)),cc.moveBy(.1,cc.v2(0,15)))),this.top.y=-this.winHeight/2+435,this.top.runAction(cc.sequence(cc.delayTime(.05),cc.moveTo(.3,cc.v2(0,this.winHeight/2-129)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.1,cc.v2(0,-10)))),this.view.height=50,this.view.y=(this.bottom.y+this.top.y)/2-9,this.btnBack.opacity=1,this.btnBack.y-=200,this.btnBack.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,200)),cc.fadeIn(.1)))),this.frame=0,this.schedule(this.updateFrame,0)},updateFrame:function(){this.frame++,this.view.height=this.top.y-this.bottom.y-65,this.view.y=(this.bottom.y+this.top.y)/2-9},drawMap:function(){var t=cc.instantiate(this.fortPrefab);t.getComponent("Fort").init(0,1,1==c.data.floor),t.position=cc.v2(0,66),this.content.addChild(t);var e=0,i=c.data.historyPath.length;i>=12&&(this.markBoss.active=!1,i=12);for(var o=0;o<i;o++){for(var a=c.data.historyPath[o],s=0,n=0;n<4;n++)if(null!=c.data.historyChoose[o+1]){if(a[n]==c.data.historyChoose[o+1]){s=n;break}}else if(a[n]>0){s=n;break}var r=a[s];if(r>0&&(11!=c.data.historyPath.length||10!=o)){for(var h=[-1,0,1],d=[],l=0;l<3;l++){var f=e+h[l],p=o<7?4:10-o;f>=-p&&f<=p&&d.push(f)}var u=d[Math.floor(Math.random()*d.length)];o<c.data.historyPath.length-1&&this.createLine(e,u,o),e=u;var m=cc.instantiate(this.fortPrefab);m.getComponent("Fort").init(r,o==c.data.historyPath.length-1?2:1,o==c.data.floor-2),m.position=cc.v2(70*e,198+132*o),this.content.addChild(m);for(var g=[-1,1],w=2;w>=0;w--){var v=g[w]+e;(v<-4||v>4)&&g.splice(w,1)}for(var y=0;y<4;y++){var b=a[y];if(y!=s&&b>0){var C=Math.floor(Math.random()*g.length),x=g[C],k=e+x;g.splice(C,1);var L=cc.instantiate(this.fortPrefab);if(L.getComponent("Fort").init(b,o==c.data.historyPath.length-1?2:0),L.position=cc.v2(70*k,198+132*o),this.content.addChild(L),-1==x||1==x){var I=2*x+e;I>=-4&&I<=4&&g.push(2*x)}}}}}var q=0;c.data.historyPath.length>=9?q=1:c.data.historyPath.length>4&&(q=(c.data.historyPath.length-4)/5),this.scroll.scrollToPercentVertical(q,.3)},createLine:function(t,e,i){var c=cc.instantiate(this.line);c.position=cc.v2(70*t,66+132*i),this.lineNode.addChild(c);var o=0,a=1;t==e?(o=Math.floor(2*Math.random())+1,a=Math.random()<.5?1:-1):(o=Math.floor(3*Math.random())+3,a=e>t?1:-1),cc.loader.loadRes("Texture/UI/map/image_load"+o,cc.SpriteFrame,function(t,e){c&&(c.scaleX=a,c.x-=10*a,c.getComponent(cc.Sprite).spriteFrame=e)}.bind(this))},close:function(){this.btnBack.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,-300)),cc.fadeIn(.3))),this.bottom.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveBy(.1,cc.v2(0,50)),cc.moveTo(.1,cc.v2(0,-this.winHeight/2+280)))),this.top.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,10)),cc.moveBy(.1,cc.v2(0,-20)),cc.moveTo(.2,cc.v2(0,-this.winHeight/2+385)))),this.mask.runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.15,cc.v2(0,-400)),cc.callFunc(function(){this.node.destroy(),window.mapLayer=null,window.homeLayer.btnMap.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1)))}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(t,e,i){"use strict";cc._RF.push(e,"52880hyyK1GjLw1tAGJFFaD","Opening");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{endPrefab:cc.Prefab},onLoad:function(){this.login()},login:function(){o.load(function(){c.setDataToBase(),this.loadRes(),this.gotoMain()}.bind(this))},gotoMain:function(){cc.director.loadScene("prepare")},loadRes:function(){}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerTavern:[function(t,e,i){"use strict";cc._RF.push(e,"f1734zLgkZCHperU+957PgJ","PlayerTavern");var c=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,btnRoll:cc.Node,btnEnd:cc.Node,boxCard:cc.Node,boxDice:cc.Node,txtRollCount:cc.Label},onLoad:function(){window.player=this,this.cardPool=new cc.NodePool;for(var t=0;t<6;t++){var e=cc.instantiate(this.cardPrefab);this.cardPool.put(e)}this.dicePool=new cc.NodePool;for(var i=0;i<5;i++){var c=cc.instantiate(this.dicePrefab);this.dicePool.put(c)}this.diceUsabld=!0,this.scheduleOnce(this.startRound,.5)},startRound:function(){this.rollCount=2,this.diceUsabld=!1,this.initCards(),this.initDices()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];for(var t=0;t<5;t++){var e=null;(e=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab)).position=cc.v2(110*t-220,-200),this.boxDice.addChild(e),this.diceList.push(e)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[],this.deck=this.getRandomCards();for(var t=0;t<6;t++)this.drawCard(this.deck[t])},getRandomCards:function(t){for(var e=[],i=0;e.length<6;){for(var o=0,a=Math.random(),s=0,n=e.length<4?1:19,r=e.length<4?18:30,h=n;h<=r;h++){if(a<(s+=c.get("cfg_tavern",h).rate)){o=h;break}}e.indexOf(o)<0&&(!t||t.indexOf(o)<0)&&(o>=9&&o<=11||15==o?i<2&&(e.push(o),i++):e.push(o))}return e},drawCard:function(t){var e=this.getEmptyIndex();if(!(e<0)){var i=null;(i=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("CardTavern").init(t,e),this.boxCard.addChild(i,100),this.cardList.push(i),cc.audioEngine.playEffect(window.sound.drawSound)}},patchCard:function(t){this.drawCard(t),this.checkCardsRequire(),this.checkBtnRoll()},roll:function(t){for(var e=0;e<this.diceList.length;e++){var i=this.diceList[e].getComponent("DiceTavern");1==t?i.roll():i.holded||i.roll()}this.endRoll(t),t?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound)},endRoll:function(t){t?this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2):(this.checkElement(),this.rollCount--,this.checkBtnRoll())},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var t=0;t<this.diceList.length;t++){var e=this.diceList[t].getComponent("DiceTavern");e.lock||this.elementList[e.element-1]++}this.cardAbledCount=this.checkCardsRequire()},refreshDiceBuff:function(){this.checkElement(),this.checkBtnRoll(),this.diceUsabld=!0,this.btnEnd.runAction(cc.moveTo(.2,cc.v2(-275,this.btnEnd.y)))},checkCardsRequire:function(){for(var t=0,e=0;e<this.cardList.length;e++){this.cardList[e].getComponent("CardTavern").checkRequire()&&t++}return t},getEmptyIndex:function(){for(var t=0;t<6;t++){for(var e=!1,i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("CardTavern").index==t){e=!0;break}}if(!e)return t}return-1},addRollCount:function(){this.rollCount++,this.checkBtnRoll()},checkBtnRoll:function(){var t=this.btnRoll.y;this.rollCount>0?this.btnRoll.runAction(cc.sequence(cc.moveTo(.15,cc.v2(425,t)),cc.moveTo(.15,cc.v2(310,t)))):this.btnRoll.runAction(cc.moveTo(.15,cc.v2(425,t))),this.txtRollCount.string=this.rollCount},changeAllCards:function(){for(var t=0;t<6;t++){this.cardList[0].getComponent("CardTavern").discard()}var e=this.deck.concat();this.deck=this.getRandomCards(e);for(var i=0;i<6;i++)this.drawCard(this.deck[i]);this.checkCardsRequire(),this.checkBtnRoll()},checkRewards:function(){for(var t=[],e=0;e<this.cardList.length;e++){var i=this.cardList[e].getComponent("CardTavern");i.usable&&t.push(i.cfgId)}return t}}),cc._RF.pop()},{Config:"Config"}],PlayerYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Sprite]},init:function(t){this.index=t,this.win=0,this.dicePool=new cc.NodePool;for(var e=0;e<5;e++){var i=cc.instantiate(this.dicePrefab);this.dicePool.put(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){this.diceList=[];for(var t=0;t<5;t++){var e=this.dicePool.get();e.getComponent("DiceYahtzee").init(t,this.index),this.boxDice.addChild(e),this.diceList.push(e)}this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var t=0;t<5;t++){var e=this.diceList[t].getComponent("DiceYahtzee");e.holded||e.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check(),cc.audioEngine.playEffect(window.sound.rollSound2)}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var t=0;t<5;t++){var e=this.diceList[t].getComponent("DiceYahtzee");e.holded||e.hold(),e.abled=!1}cc.audioEngine.playEffect(window.sound.holdSound)}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var t=[0,0,0,0,0,0],e=0;e<5;e++){t[this.diceList[e].getComponent("DiceYahtzee").element-1]++}t.sort(function(t,e){return e-t}),5==t[0]?this.score=7:4==t[0]?this.score=6:3==t[0]?2==t[1]?this.score=5:this.score=4:2==t[0]?2==t[1]?this.score=3:this.score=1:this.score=2},doWin:function(){cc.loader.loadRes("Texture/battle/mark_crown1",cc.SpriteFrame,function(t,e){this.crowns[this.win].spriteFrame=e,this.win++}.bind(this)),cc.audioEngine.playEffect(window.sound.bingo)}}),cc._RF.pop()},{}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"ba4f5YaUElBy61UWqBofsfz","Player");var c=t("Game"),o=t("Utils"),a=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,chestPrefab:cc.Prefab,dmgAnimation:cc.Prefab},init:function(t){this.index=t,0==t?(this.host=this.getComponent("Hero"),this.opponent=window.mainLayer.enemy.player,this.boxCard=window.mainLayer.boxCardHero,this.boxDice=window.mainLayer.boxDiceHero):(this.host=this.getComponent("Enemy"),this.opponent=window.mainLayer.hero.player,this.boxCard=window.mainLayer.boxCardEnemy,this.boxDice=window.mainLayer.boxDiceEnemy),this.cardPool=new cc.NodePool;for(var e=0;e<6;e++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var o=0;o<5;o++){var a=cc.instantiate(this.dicePrefab);this.dicePool.put(a)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.atkPlayed=0,this.atkRound=0,this.dmgRound=0,this.diceUsabld=!0,this.cardUsabled=!0,this.elementList=[0,0,0,0,0,0],this.createDiceRound=[0,0,0,0,0,0],this.deck=this.host.deck,0==this.index&&(3==c.data.heroId&&4==c.data.difficulty?this.bag=c.data.cardBag.concat():4==c.data.heroId&&2==c.data.difficulty&&(this.cemetery=[]));var s=cc.instantiate(this.dmgAnimation);this.node.addChild(s),0==this.index?(s.scale=.8,s.position=cc.v2(-302,33)):s.position=cc.v2(0,this.host.figureNode.y+this.host.figure.height/2),this.anim=s.getComponent("DmgAnimation"),this.anim.init(t)},start:function(){this.buff=this.getComponent("Buff"),this.buff.init(),this.equip=this.getComponent("Equip"),this.equip.init(),this.diceCount=this.host.diceCount;for(var t=[85,86,89,90,91,92],e=0;e<t.length;e++)this.equip.checkWithTrigger(t[e])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++,this.host.txtDice.string="\xd7"+this.diceCount,this.scheduleOnce(this.checkGameBegin,.4),0==this.index&&3==c.data.heroId&&2==c.data.difficulty&&(this.totalRollCount=this.equip.checkWithTrigger(58)?7:6)},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,0==this.index?2==c.data.heroId?this.rollCount=1:3==c.data.heroId&&(2==c.data.difficulty?this.rollCount=this.totalRollCount:3==c.data.difficulty&&this.rollCount--):(this.rollCount+=this.host.exRollCount,1==c.data.heroId&&5==c.data.difficulty&&this.rollCount++),this.checkStart(),0==this.index&&(this.diceUsabld=!1,this.cardUsabled=!1,4==c.data.heroId?(2!=c.data.difficulty||this.round<=1)&&(this.deckArray=this.deck.concat(),this.deckArray.sort(function(t,e){return.5-Math.random()})):5==c.data.heroId&&(this.chestList=[null,null,null],this.createChest())),this.initCards(),this.initDices(),window.mainLayer.gameOver||this.host.startRound()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var t=this.diceCount+this.extraDice,e=o.getDifferentRandomNum(t,t-1,0),i=Math.min(this.buff.lock,t),c=e.splice(0,i);this.buff.removeBuff(28,i);var a=0,s=[];this.equip.checkWithTrigger(63)||(a=Math.min(this.buff.freeze,t-i),s=e.splice(0,a),this.buff.removeBuff(22,a));var n=e.concat(s),r=Math.min(this.buff.blind,t-i),h=n.splice(0,r);this.buff.removeBuff(30,r);for(var d=0;d<t;d++){for(var l=[],f=0;f<c.length;f++)if(d==c[f]){l.push(28);break}if(0==l.length){for(var p=0;p<s.length;p++)if(d==s[p]){l.push(22);break}for(var u=0;u<h.length;u++)if(d==h[u]){l.push(30);break}}var m=null;m=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab);var g=0;g=t<=6?-(t-1)/2*110+110*d:640/(t-1)*d-320,m.position=cc.v2(g,0==window.mainLayer.roundId?-120:600),m.getComponent("Dice").init(d,l),this.boxDice.addChild(m),this.diceList.push(m)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),.5)},initCards:function(){this.cardList=[];var t=this.deck;0==this.index&&4==c.data.heroId&&(t=this.deckArray);for(var e=Math.min(t.length,6),i=this.equip.checkWithTrigger(66)?0:this.buff.silence,o=this.equip.checkWithTrigger(62)?0:this.buff.burn,s=0;s<e;s++){var n=null,r=a.get("cfg_card",t[s]).element;this.buff.silenceDark&&6==r?n=25:Math.random()<i/(e-s)?(n=25,i--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==r?n=21:Math.random()<o/(e-s)&&(n=21,o--,this.buff.removeBuff(21,1)),this.drawCard(t[s],n)}0==this.index&&4==c.data.heroId&&this.deckArray.splice(0,e)},drawCard:function(t,e,i){var c=this.getEmptyIndex();if(!(c<0)){var o=null;return(o=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(t,c,e,0),o.getComponent("Card").isTemp=i,this.boxCard.addChild(o,100),this.cardList.push(o),cc.audioEngine.playEffect(window.sound.drawSound),o}},patchCard:function(t,e,i){var o=this.buff,s=null;t=t||c.getRandomCardId();var n=a.get("cfg_card",t).element;o.silenceDark&&6==n?s=25:o.silence>0&&!this.equip.checkWithTrigger(66)?(s=25,o.removeBuff(25,1)):o.burnIce&&2==n?s=21:o.burn>0&&!this.equip.checkWithTrigger(62)&&(s=21,o.removeBuff(21,1));var r=this.drawCard(t,s,!e);if(r)return r.getComponent("Card").initBuff(),i&&r.getComponent("Card").disCost(),this.checkCardsRequire(),this.host.checkBtnRoll&&this.host.checkBtnRoll(),this.equip.trigger(119),r},suppleCard:function(){if(!(this.deckArray.length<=0)){var t=this.deckArray[0];this.patchCard(t,!0)&&this.deckArray.shift()}},roll:function(t,e){for(var i=0;i<this.diceList.length;i++){var o=this.diceList[i].getComponent("Dice");1==t?0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.lastDices&&this.lastDices[i]?o.roll(this.lastDices[i]):o.roll():o.freeze||o.lock||o.temp||(e?(o.holded&&o.hold(),o.roll(e)):o.holded||o.roll(),o.initBuff())}this.endRoll(t),t?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound)},endRoll:function(t){if(t)this.scheduleOnce(function(){this.refreshCardBuff(),this.checkElement(),0==this.index&&3==c.data.heroId&&2==c.data.difficulty||this.rollCount--}.bind(this),.2);else{this.checkElement();for(var e=0,i=0;i<6;i++)this.elementList[i]>0&&e++;if(e>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.rollCount--,this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),0==this.index&&2==c.data.heroId&&4==c.data.difficulty&&this.opponent.host.exRollCount++,this.opponent.equip.trigger(176),0==this.index)if(2==c.data.heroId){if(3==c.data.difficulty)this.randomCard&&(this.randomCard.getComponent("Card").discard(!0),this.randomCard=this.patchCard(),this.randomCard.getComponent("Card").discribeRandom());else if(5==c.data.difficulty){for(var o=[],a=0;a<this.diceList.length;a++){var s=this.diceList[a].getComponent("Dice");s.blind||s.lock||o.push(s)}if(o.length>0){var n=o[Math.floor(Math.random()*o.length)];n.buffList.push(30),n.blind=!0,n.markBlind.active=!0}else window.player.buff.addBuff(30,1)}}else 4==c.data.heroId&&5==c.data.difficulty&&Math.random()<.5&&this.buff.addBuff(27,1)}},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var t=0;t<this.diceList.length;t++){var e=this.diceList[t].getComponent("Dice");e.lock||this.elementList[e.element-1]++}if(this.cardAbledCount=this.checkCardsRequire(),this.chestList)for(var i=0;i<3;i++)this.chestList[i]&&this.chestList[i].getComponent("Chest").checkRequire()},refreshCardBuff:function(){for(var t=0;t<this.cardList.length;t++)this.cardList[t].getComponent("Card").initBuff();this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2),this.opponent.equip.trigger(170)},refreshDiceBuff:function(){for(var t=0;t<this.diceList.length;t++)this.diceList[t].getComponent("Dice").initBuff();if(this.checkElement(),1==this.index&&1==c.data.heroId&&4==c.data.difficulty&&this.cardList.length<6){var e=c.getRandomCardId(null,3,3);this.patchCard(e)}else 0==this.index&&2==c.data.heroId&&3==c.data.difficulty&&(this.randomCard=this.patchCard(),this.randomCard.getComponent("Card").discribeRandom());for(var i=0,o=0;o<6;o++)this.elementList[o]>0&&i++;i>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.cardAbledCount<=0&&this.equip.trigger(45);for(var a=48;a<=53;a++)this.equip.trigger(a);this.equip.trigger(93),this.equip.trigger(128),this.equip.trigger(174),this.host.checkBtnRoll&&(this.host.checkBtnRoll(!0),this.diceUsabld=!0,this.cardUsabled=!0)},createExDice:function(t,e){var i=[];this.buff.lock>0?(i.push(28),this.buff.removeBuff(28,1)):(this.buff.freeze>0&&!this.equip.checkWithTrigger(63)&&(i.push(22),this.buff.removeBuff(22,1)),this.buff.blind>0&&(i.push(30),this.buff.removeBuff(30,1)));var c=null;c=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab),this.diceList.length<=5?c.x=this.diceList.length/2*110:c.x=320,c.getComponent("Dice").init(this.diceList.length-1,i),this.boxDice.addChild(c),this.diceList.push(c),c.getComponent("Dice").roll(t),c.getComponent("Dice").initBuff(),t&&!e&&c.getComponent("Dice").doTemp();for(var o=0;o<this.diceList.length;o++){var a=this.diceList[o];a.stopAllActions(),a.opacity=255;var s=0;s=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*o:640/(this.diceList.length-1)*o-320,a.runAction(cc.moveTo(.2,cc.v2(s,0)))}this.checkElement(),this.extraDice++,this.host.txtExDice.string="(+"+this.extraDice+")"},endRound:function(){for(var t=this.cardList.length-1;t>=0;t--){if(0==this.index)if(3==c.data.heroId&&4==c.data.difficulty){if(this.bag.length>0){var e=this.deck.indexOf(this.cardList[t].getComponent("Card").cfgId);if(e>=0){var i=Math.floor(Math.random()*this.bag.length),o=this.bag.splice(i,1);this.deck.splice(e,1,o),this.bag.push(this.cardList[t].getComponent("Card").cfgId)}}}else 4==c.data.heroId&&2==c.data.difficulty&&this.deckArray.unshift(this.cardList[t].getComponent("Card").cfgId);this.cardList[t].getComponent("Card").remove(!0)}this.lastDices=[];for(var a=0;a<this.diceList.length;a++)0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.lastDices.push(this.diceList[a].getComponent("Dice").element),this.diceList[a].getComponent("Dice").remove();if(0==this.index&&4==c.data.heroId&&2==c.data.difficulty&&(this.deckArray=this.deckArray.concat(this.cemetery),this.cemetery=[]),this.chestList)for(var s=0;s<3;s++)this.chestList[s]&&this.chestList[s].getComponent("Chest").remove();this.host.endRound(),this.scheduleOnce(function(){window.mainLayer.gameOver||(this.buff.exRound>0?(this.startRound(),this.buff.removeBuff(101,1)):window.mainLayer.doRound())}.bind(this),.5),this.extraDice=0,this.host.txtExDice.string="",this.settleBuff(),this.settleEquip()},checkCardsRequire:function(){for(var t=0,e=0;e<this.cardList.length;e++){this.cardList[e].getComponent("Card").checkRequire()&&t++}return t},checkGameBegin:function(){for(var t=[6,12,13,14,15,16,17,18,19,20,21,30,37,44,86,91,96,114,124],e=0;e<t.length;e++)this.equip.trigger(t[e]);this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),c.data.roomType>=7&&this.equip.trigger(61),0==this.index&&c.data.debuff>0&&this.host.onHurt(5*c.data.debuff,1,7,2)},checkStart:function(){this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]);for(var t=[5,9,25,30,84,105,111,121,126,129,142,143,145,146,147,152,155,160,162,165,168],e=0;e<t.length;e++)this.equip.trigger(t[e]);if(this.dmgRound=0,this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var i=this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?2:1);this.host.onHurt(i,1,26,0),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.removeBuff(102,1)},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.removeBuff(29,this.buff.table[29]),this.buff.removeBuff(30,this.buff.table[30]),this.buff.table[23]>0&&this.buff.removeBuff(23,1),this.buff.table[24]>0&&this.buff.removeBuff(24,1);for(var t=0;t<4;t++)this.buff.removeBuff(103+t,this.buff.tempBuff[t]),this.buff.tempBuff[t]=0;this.buff.multiCast=this.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1,this.buff.selfHarmCast=this.buff.selfHarmCastMax=0},settleEquip:function(){for(var t=[2,3,27,57,59,60,104,110,138,148,150,151,156,161,11],e=0;e<t.length;e++)this.equip.trigger(t[e]);this.opponent.equip.trigger(118),this.equip.doDisabled(139),this.equip.doDisabled(140),this.cardPlayedRound=0,this.atkRound=0,this.dmgRound=0,this.createDiceRound=[0,0,0,0,0,0],this.equip.swiftGlove=!1,this.equip.luckDice=!1,this.equip.luckFlag=!1,this.equip.suckRemainder=0,this.equip.armorRemainder=0},onHurt:function(t,e,i,c){if(1==c){if(i<=6){this.equip.checkWithTrigger(130)&&(t*=.5);this.equip.checkWithTrigger([133,132,135,134,137,136][i-1])&&(t*=2)}else this.equip.checkWithTrigger(131)&&(t*=.5);if(this.buff.frail>0&&0==e&&!this.equip.checkWithTrigger(64)){var o=.5;this.opponent.equip.checkWithTrigger(54)&&(o+=.25),this.equip.checkWithTrigger(56)&&(o-=.25),this.equip.checkWithTrigger(113)&&(o*=2),this.opponent.equip.checkWithTrigger(113)&&(o*=2),t*=o+1}this.host.hp<this.host.hpMax/2&&this.opponent.equip.checkWithTrigger(154)&&(t*=2),t=Math.floor(t),t+=this.opponent.buff.atkAdd,this.opponent.equip.checkWithTrigger(21),this.opponent.equip.checkWithTrigger(147),this.opponent.host.hp<.3*this.opponent.host.hpMax&&this.opponent.equip.checkWithTrigger(75),i<=6?0==this.round&&this.equip.checkWithTrigger(139)?t=0:this.equip.checkWithTrigger(i+131)&&(t=0):0==this.round&&this.equip.checkWithTrigger(140)&&(t=0),t>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),t=1),t>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),t=1),t>0&&this.buff.hurtReduce>0&&(t=Math.max(0,t-this.buff.hurtReduce),this.equip.checkWithTrigger(114),this.equip.checkWithTrigger(124)),t>4&&this.equip.checkWithTrigger(125)&&(t=4);var a=!1;if(t>=this.host.hp+this.host.armor&&this.host.hp%2==1&&this.equip.checkWithTrigger(179)&&(a=!0,t=0),9==i&&t>0&&this.opponent.host.onHeal(t),this.opponent.equip.suckRemainder+=t,this.opponent.equip.trigger(23),this.opponent.equip.armorRemainder+=t,this.opponent.equip.trigger(164),this.equip.feedBack>0&t>0){var s=0;this.equip.feedBack>t?(s=t,this.equip.feedBack-=t,t=0):(s=this.equip.feedBack,t-=this.equip.feedBack,this.equip.feedBack=0),this.equip.checkWithTrigger(146),this.equip.refreshItemNum(146,this.equip.feedBack),this.opponent.host.onHurt(s,2,16)}this.buff.atkBack>0&&0==e&&t>0&&this.opponent.host.onHurt(this.buff.atkBack,1,16)}if(this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(t=0),t>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(t,2,16),1==c&&(this.opponent.dmgRound+=t),a?this.assertHpChange("MISS",2):this.assertHpChange("-"+t,0),this.anim.show(i),this.host.armor>0){if(this.host.armor>=t)return void this.updateArmor(-t);t-=this.host.armor,this.updateArmor(-this.armor)}this.host.hp-=t,this.host.hp<=0&&this.buff.undead>0&&(this.anim.show(201),this.host.hp=1),1==c&&t>0&&this.equip.checkWithTrigger(175)&&this.updateArmor(t),this.host.hp<=0&&this.equip.trigger(10),this.host.hp<=0&&this.equip.trigger(158),this.equip.trigger(75),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},updateArmor:function(t){var e=this.host.armor;this.host.armor+=t,this.host.armor>0?(this.host.boxArmor.active=!0,this.host.txtArmor.string=this.host.armor,this.host.stripHp.node.color=cc.color(24,136,176),this.host.barHp.color=cc.color(92,214,255)):(this.host.armor=0,this.host.boxArmor.active=!1,this.host.stripHp.node.color=cc.color(172,45,56),this.host.barHp.color=cc.color(252,94,108)),t>0?this.anim.show(11):e>this.host.armor&&this.equip.checkWithTrigger(167)&&this.opponent.host.onHurt(e-this.host.armor,2)},onHeal:function(t){if(this.equip.checkWithTrigger(122)){var e=Math.min(t,this.host.hpMax-this.host.hp);this.opponent.host.onHurt(e,2)}this.host.hp+=t,this.equip.trigger(102),this.equip.trigger(123),this.anim.show(12),this.equip.trigger(75)},assertHpChange:function(t,e){this.showQueue.push([t,e]),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var t=this.showQueue[0],e=t[0],i=t[1],c=[cc.Color.WHITE,cc.color(139,255,70),cc.color(255,40,40),cc.color(60,247,255)],o=cc.instantiate(this.host.txtNum);o.getComponent(cc.Label).string=e,o.color=c[i],o.position=this.host.txtNum.position,this.node.addChild(o),o.scale=0;var a=cc.spawn(cc.moveBy(.1,cc.v2(30,10)),cc.scaleTo(.1,1.1));a=cc.spawn(cc.moveBy(.05,cc.v2(0,0==this.index?0:-10)),cc.scaleTo(.05,1));o.runAction(cc.sequence(a,a,cc.moveBy(.05,cc.v2(13+10*Math.random(),3+5*Math.random())),cc.moveBy(.1,cc.v2(3+10*Math.random(),-3-10*Math.random())),cc.fadeOut(.5),cc.callFunc(function(){o.destroy()}.bind(this)))),o.runAction(cc.sequence(cc.delayTime(.15),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this)))),"MISS"==e&&cc.audioEngine.playEffect(window.sound.missSound)},getEmptyIndex:function(){for(var t=0;t<6;t++){var e=!1;if(this.chestList&&this.chestList[t%3]&&(e=!0),!e)for(var i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==t){e=!0;break}}if(!e)return t}return-1},addRollCount:function(){if(0==this.index&&2==c.data.heroId){var t=2==c.data.difficulty?0:1;if(this.rollCount>=t)return}this.rollCount++,this.host.checkBtnRoll&&this.host.checkBtnRoll()},deleteDice:function(t){for(var e=[],i=0;i<this.diceList.length;i++){var c=this.diceList[i].getComponent("Dice");if(!c.lock)if(7==t)e.push(this.diceList[i]);else if(c.element==t){this.dicePool.put(this.diceList[i]),this.diceList.splice(i,1);break}}if(7==t&&e.length>0){var o=e[Math.floor(Math.random()*e.length)],a=this.diceList.indexOf(o);a>=0&&(this.dicePool.put(this.diceList[a]),this.diceList.splice(a,1))}for(var s=0;s<this.diceList.length;s++){var n=this.diceList[s];n.stopAllActions(),n.opacity=255;var r=0;r=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*s:640/(this.diceList.length-1)*s-320,n.runAction(cc.moveTo(.2,cc.v2(r,0)))}this.checkElement(),this.host.checkBtnRoll()},createChest:function(t){for(var e=-1,i=2;i>=0;i--)if(!this.chestList[i]){e=i;break}if(e>=0){var c=cc.instantiate(this.chestPrefab);c.getComponent("Chest").init(e),this.boxCard.addChild(c,100),this.chestList[e]=c,t&&c.getComponent("Chest").checkRequire()}}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],PotionCommodity:[function(t,e,i){"use strict";cc._RF.push(e,"85c55EVbbNKe72lZU+lcHho","PotionCommodity"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,txtName:cc.Label},init:function(t){cc.loader.loadRes("Texture/UI/image_potion"+t,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)),this.txtName.string="\u751f\u547d +"+10*t}}),cc._RF.pop()},{}],PrepareLayer:[function(t,e,i){"use strict";cc._RF.push(e,"c0348borGFFHIk076MyCFu2","PrepareLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{btns:[cc.Node],boxSelected:cc.Node,edges:[cc.Node],boxDesc:cc.Sprite,txtName:cc.Label,txtDesc:cc.Label,txtDifficulty:cc.Label,btnDifficulty:[cc.Button],markDifficulty:cc.Node,btnStart:cc.Button,tree:cc.Node,descNode:cc.Node,characterNode:cc.Node,figure:cc.Node,figureNode:cc.Node,mask:cc.Node,endPrefab:cc.Prefab,soundPrefab:cc.Prefab},onLoad:function(){this.abled=!1,this.heroId=1,this.difficultyId=1,this.refreshInfo();for(var t=0;t<4;t++){var e=this.edges[t].position;this.edges[t].runAction(cc.sequence(cc.moveTo(.3,e.mul(1.1)),cc.moveTo(.3,e)).repeatForever())}this.tree.getComponent(cc.Widget).left=-300,this.characterNode.getComponent(cc.Widget).bottom=-135,this.descNode.getComponent(cc.Widget).bottom=-.08,this.figure.x+=550,this.btnStart.node.x+=200;for(var i=0;i<5;i++){this.btnDifficulty[i].node.x-=450;var c=i<2?.1:0;this.btnDifficulty[i].node.runAction(cc.sequence(cc.delayTime(c),cc.moveBy(.2,cc.v2(450,0))))}var o=cc.winSize.height/cc.winSize.width*750;this.btnStart.node.runAction(cc.moveBy(.2,cc.v2(-200,0))),this.characterNode.runAction(cc.moveBy(.2,cc.v2(0,154))),this.descNode.runAction(cc.sequence(cc.delayTime(.1),cc.moveTo(.2,cc.v2(0,.182*o-o/2)))),this.figure.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.15,cc.v2(-550,0)))),this.tree.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.15,cc.v2(300,0)),cc.callFunc(function(){this.tree.getComponent(cc.Widget).left=0,this.characterNode.getComponent(cc.Widget).bottom=19,this.descNode.getComponent(cc.Widget).bottom=.182,this.markDifficulty.active=!0,this.abled=!0}.bind(this)))),this.figure.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever());var a=cc.instantiate(this.soundPrefab);this.node.addChild(a),window.sound=a.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmPrepare,!0)},goBattle:function(){this.btnStart.interactable=!1,c.data.heroId=this.heroId,c.data.difficulty=this.difficultyId,c.data.startTime=Date.now(),c.data.restartCount=1==this.difficultyId?999:2==this.difficultyId?3:1,cc.audioEngine.playEffect(window.sound.btnStart),c.begin=!0,cc.director.loadScene("helloworld")},selectCharacter:function(t,e){parseInt(e)+1!=this.heroId&&this.abled&&(this.btns[this.heroId-1].scale=1,this.heroId=parseInt(e)+1,this.boxSelected.x=120*e-300,this.btns[e].scale=1.19,this.refreshInfo(),this.changeFigure(),cc.audioEngine.playEffect(window.sound.btn2))},refreshInfo:function(){var t=[cc.color(116,164,255),cc.color(182,93,255),cc.color(255,247,121),cc.color(107,255,153),cc.color(255,84,80),cc.color(255,165,87)];this.boxSelected.color=t[this.heroId-1];for(var e=0;e<4;e++)this.edges[e].color=t[this.heroId-1];var i=o.get("cfg_hero",this.heroId);this.txtName.string=i.name,this.txtDesc.string=i.desc,this.refreshDifficulty(),cc.loader.loadRes("Texture/UI/prepare/box_desc"+this.heroId,cc.SpriteFrame,function(t,e){this.boxDesc.spriteFrame=e}.bind(this)),this.btnStart.interactable=this.heroId<=4},selectDifficulty:function(t,e){this.btnDifficulty[this.difficultyId-1].interactable=!0,this.difficultyId=parseInt(e)+1,this.btnDifficulty[e].interactable=!1,this.markDifficulty.position=this.btnDifficulty[e].node.position,this.refreshDifficulty(),cc.audioEngine.playEffect(window.sound.btn1)},refreshDifficulty:function(){var t=o.get("cfg_hero",this.heroId);this.txtDifficulty.string=t["difficulty"+this.difficultyId],1==this.difficultyId?this.mask.active=!1:(cc.loader.loadRes("Texture/UI/prepare/mask"+this.difficultyId,cc.SpriteFrame,function(t,e){this.mask.getComponent(cc.Sprite).spriteFrame=e}.bind(this)),this.mask.active=!0,this.mask.stopAllActions(),this.mask.runAction(cc.sequence(cc.fadeTo(.5,127.5),cc.fadeIn(.5)).repeatForever()))},changeFigure:function(){this.abled=!1;var t=cc.instantiate(this.figure);t.opacity=1,t.position=cc.v2(650,-250),this.figureNode.addChild(t),t.runAction(cc.spawn(cc.moveBy(.2,cc.v2(-550,0)),cc.fadeIn(.2))),this.heroId<=4?(t.color=cc.Color.WHITE,t.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever())):t.color=cc.Color.BLACK,this.figure.runAction(cc.sequence(cc.spawn(cc.moveBy(.2,cc.v2(-550,0)),cc.fadeOut(.2)),cc.callFunc(function(){this.figure.destroy(),this.figure=t,this.abled=!0}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],RequireRound:[function(t,e,i){"use strict";cc._RF.push(e,"3a0eeaFa/FFsJmcvXZBEaHe","RequireRound"),cc.Class({extends:cc.Component,properties:{circle:cc.Sprite,sprite:cc.Sprite,markRight:cc.Node},init:function(t,e){var i=[cc.color(165,56,77),cc.color(90,109,149),cc.color(64,107,80),cc.color(157,103,67),cc.color(171,137,65),cc.color(95,77,139),cc.color(160,160,160)];this.node.color=i[e-1],this.hide=!1,this.unCost=!1,this.satisfied=!1,t>0&&(this.element=t,this.refreshElement())},refreshElement:function(t){t&&(this.element=t),cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(t,e){this.unCost||(this.sprite.node.active=!0,this.sprite.spriteFrame=e)}.bind(this))},refreshSatisfy:function(t){if(this.satisfied=t,this.satisfied&&!this.unCost&&this.element){var e=[cc.color(255,56,50),cc.color(44,180,255),cc.color(0,247,118),cc.color(255,150,82),cc.color(255,251,75),cc.color(191,127,228)];this.sprite.node.color=e[this.element-1]}else this.sprite.node.color=cc.color(255,255,255)},hideElement:function(){this.element=null,this.sprite.node.active=!1},disCost:function(){this.unCost=!0,cc.loader.loadRes("Texture/battle/image_requireLine2",cc.SpriteFrame,function(t,e){this.circle.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/battle/unelement"+this.element,cc.SpriteFrame,function(t,e){this.sprite.node.active&&(this.sprite.spriteFrame=e)}.bind(this)),this.refreshSatisfy(!0)},bingo:function(){this.hideElement(),this.markRight.active=!0}}),cc._RF.pop()},{}],Room:[function(t,e,i){"use strict";cc._RF.push(e,"20286qrg/RMq6rq0m6qk3EY","Room");var c=t("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Sprite,circle:cc.Sprite,doorPrefab:cc.Prefab,btnCamp:cc.Node,btnNpc:cc.Node,npcFigure:cc.Sprite,btnTreasure:cc.Node,btnShop:cc.Node,btnTavern:cc.Node,monsterNode:cc.Node,monsterFigure:cc.Sprite,decoration:cc.Node,boxTip:cc.Node,imageBox:cc.Sprite,crystal:cc.Node},init:function(t){window.room=this,this.pos=c.data.heroPos,this.abled=!1,this.isNewRoom=t,t?this.initFloorConfig():this.typeList=c.data.historyPath[c.data.floor-1],this.initDoors(),this.initRoom(),t||this.initHero(),this.initMap()},initHero:function(){this.hero=window.homeLayer.hero,window.homeLayer.refreshPath();var t=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)],e=[cc.v2(0,100),cc.v2(80,0),cc.v2(0,-60),cc.v2(-80,0)];this.isNewRoom?(this.hero.position=t[this.pos],this.hero.runAction(cc.sequence(cc.moveTo(.25,1==c.data.floor?cc.v2():e[this.pos]),cc.callFunc(function(){this.doors[this.pos].close(!0),1!=c.data.roomType&&c.data.roomType<7&&(this.abled=!0)}.bind(this)),cc.delayTime(.3),cc.callFunc(function(){(1==c.data.roomType||c.data.roomType>=7)&&window.homeLayer.goBattle()}.bind(this)))),this.checkEquip()):(this.abled=!0,this.doors[this.pos].close(!1),c.data.roomType>1&&c.data.roomType<7&&(this.hero.position=e[this.pos])),0==this.pos?this.hero.zIndex--:2==this.pos&&this.hero.zIndex++},initDoors:function(){this.doors=[];for(var t=[cc.v2(0,276),cc.v2(276,0),cc.v2(0,-276),cc.v2(-276,0)],e=0;e<4;e++){var i=this.typeList[e];if(-2==i&&(i=c.data.roomType),i>=0){var o=cc.instantiate(this.doorPrefab);o.getComponent("Door").init(i,e),o.rotation=90*e,o.position=t[e],o.zIndex=20,this.node.addChild(o),this.doors[e]=o.getComponent("Door")}}},initRoom:function(){1==c.data.roomType||c.data.roomType>=7?this.isNewRoom&&(this.monsterNode.active=!0,this.monsterNode.zIndex=10,cc.loader.loadRes("Texture/monster/figure/"+c.monsterId,cc.SpriteFrame,function(t,e){this.monsterFigure&&(this.monsterFigure.spriteFrame=e)}.bind(this)),this.monsterNode.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())):c.data.roomType>0&&this.initAlter()},gotoDoor:function(t){if(t!=this.pos&&this.abled){this.abled=!1;var e,i=[cc.v2(0,250),cc.v2(250,0),cc.v2(0,-250),cc.v2(-250,0)];if(c.tempData=JSON.parse(JSON.stringify(c.data)),c.data.heroPos=(parseInt(t)+2)%4,c.data.floor++,c.data.castle<3&&c.data.floor>12){c.data.floor=1,c.data.castle++,c.data.historyPath=[],c.data.historyChoose=[0],c.data.floorBeats=[],c.data.monsterList=[];for(var o=window.homeLayer.pathList,a=0;a<o.length;a++)o[a].destroy();window.homeLayer.initPath()}else if(3==c.data.castle&&c.data.floor>13)return void window.homeLayer.openComplete();if(c.data.roomType=this.typeList[t],c.data.historyChoose[c.data.floor-1]=c.data.roomType,(1==c.data.roomType||c.data.roomType>=7)&&(c.monsterId=this.checkMonster()),c.data.heroPos==this.pos&&this.hero.position.mag()>1)if(0==t||2==t)e=cc.sequence(cc.moveBy(.1,cc.v2(80*-c.data.face,0)),cc.moveBy(.2,cc.v2(0,0==t?160:-160)),cc.callFunc(function(){c.data.face=-c.data.face,this.hero.scaleX=c.data.face,this.hero.zIndex=0==t?9:11}.bind(this)),cc.moveBy(.1,cc.v2(80*c.data.face,0)),cc.moveTo(.1,i[t]));else{var s=Math.random()<.5?1:-1;e=cc.sequence(cc.moveBy(.1,cc.v2(0,80*s)),cc.moveBy(.2,cc.v2(1==t?160:-160,0)),cc.callFunc(function(){this.hero.zIndex=1==s?9:11}.bind(this)),cc.moveBy(.1,cc.v2(0,80*-s)),cc.moveTo(.1,i[t]))}else e=cc.moveTo(.25,i[t]),0==t?this.hero.zIndex=9:2==t&&(this.hero.zIndex=11);this.hero.runAction(cc.sequence(e,cc.callFunc(function(){window.homeLayer.changeRoom(t)}.bind(this)))),1==t?this.hero.scaleX=c.data.face=-1:3==t&&(this.hero.scaleX=c.data.face=1)}},initAlter:function(){2==c.data.roomType?(this.btnCamp.active=!0,c.data.floorBeats[c.data.floor-1]?(this.crystal.active=!1,cc.loader.loadRes("Texture/map/alter/water2",cc.SpriteFrame,function(t,e){this.btnCamp.getComponent(cc.Sprite).spriteFrame=e}.bind(this))):this.crystal.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,20)),cc.moveBy(.5,0,-20)).repeatForever())):3==c.data.roomType?(this.btnTreasure.active=!0,this.btnTreasure.zIndex=10,c.data.floorBeats[c.data.floor-1]&&cc.loader.loadRes("Texture/map/alter/treasure2",cc.SpriteFrame,function(t,e){this.imageBox.spriteFrame=e}.bind(this))):4==c.data.roomType?(this.btnNpc.active=!0,this.btnNpc.zIndex=10,cc.loader.loadRes("Texture/npc/alter/"+c.data.eventIds[c.data.castle-1],cc.SpriteFrame,function(t,e){this.npcFigure.spriteFrame=e}.bind(this)),this.btnNpc.stopAllActions(),this.btnNpc.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())):5==c.data.roomType?(this.btnShop.active=!0,this.btnShop.zIndex=10):6==c.data.roomType&&(this.btnTavern.active=!0,this.btnTavern.zIndex=10,this.btnTavern.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever()))},openAlter:function(){5!=c.data.roomType&&c.data.floorBeats[c.data.floor-1]?4!=c.data.roomType||this.boxTip.active||(this.boxTip.active=!0,this.boxTip.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){this.boxTip.active=!1}.bind(this))))):window.homeLayer.openAlter()},checkEquip:function(){3==c.data.roomType&&c.data.equip.indexOf(42)>=0&&(c.data.copper+=50)},initFloorConfig:function(){if(c.data.historyPath[c.data.floor-1]&&c.data.historyPath[c.data.floor-1].indexOf(-2)==this.pos)this.typeList=c.data.historyPath[c.data.floor-1];else{var t=c.data.floorQuests[c.data.castle-1][c.data.floor-1].concat();if(1==t.length)this.typeList=[-1,-1,-1,-1],this.typeList[this.pos]=-2,this.typeList[(this.pos+2)%4]=t[0];else{for(;t.length<3;)t.splice(Math.floor(Math.random()*(t.length+1)),0,-1);t.splice(this.pos,0,-2),this.typeList=t}if(c.data.historyPath[c.data.floor-1]=this.typeList,5==c.data.roomType){for(var e=[],i=[],o=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];e.length<3;){for(var a=0,s=Math.random(),n=0,r=0;r<3;r++)if(s<(n+=o[c.data.castle-1][r])){a=r+1;break}for(var h=c.getNewCardId(a),d=!1,l=0;l<e.length;l++)if(h==e[l]){d=!0;break}d||e.push(h)}for(o=[[.4,.3,.3],[.3,.4,.3],[.2,.4,.4]];i.length<3;){for(var f=0,p=Math.random(),u=0,m=0;m<3;m++)if(p<(u+=o[c.data.castle-1][m])){f=m+1;break}for(var g=c.getNewItemId(1,f),w=!1,v=0;v<i.length;v++)if(g==i[v]){w=!0;break}w||i.push(g)}c.data.shopIds=e.concat(i,[1,2,3]),c.data.itemEffect.vip1&&(c.data.discountItem=Math.floor(3*Math.random())),c.data.itemEffect.vip2&&(c.data.discountCard=Math.floor(3*Math.random()))}}},checkMonster:function(){if(c.data.monsterList[c.data.floor-1]||(c.data.monsterList[c.data.floor-1]=[0,0,0,0]),!c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]){var t=2*(c.data.castle-1)+(c.data.floor<=6?1:2),e=7==c.data.roomType?1:8==c.data.roomType?2:0;13==c.data.floor&&(t=7,e=3),c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]=c.getNewMonsterId(t,e)}return c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]},initMap:function(){var t=this;cc.loader.loadRes("Texture/scene/map"+c.data.castle,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/map/castle"+c.data.castle,cc.SpriteFrame,function(t,e){this.circle.spriteFrame=e}.bind(this));for(var e=0;e<4;e++)for(var i=0;i<5;){var o=0;o=e%2==0?155*-Math.random()-220:155*Math.random()+220;var a=0,s=cc.winSize.height/cc.winSize.width*750;a=e<2?Math.random()*(s/2-130)+130:-Math.random()*(s/2-130)-130,cc.v2(o,a).mag()>=410&&function(){var e=cc.instantiate(t.decoration);e.scaleX=Math.random()<.5?1:-1,e.position=cc.v2(o,a),t.bg.node.addChild(e),i++,cc.loader.loadRes("Texture/map/outside/"+Math.floor(19*Math.random()+1),cc.SpriteFrame,function(t,i){e&&(e.getComponent(cc.Sprite).spriteFrame=i)}.bind(t))}()}for(var n=Math.floor(5*Math.random()+1),r=0;r<n;){var h=180*Math.random(),d=180*Math.random();cc.v2(h,d).mag()<=180&&function(){var e=cc.instantiate(t.decoration);e.scaleX=Math.random()<.5?1:-1,e.position=cc.v2(h,d),t.circle.node.addChild(e),r++,cc.loader.loadRes("Texture/map/inside/"+Math.floor(10*Math.random()+1),cc.SpriteFrame,function(t,i){e&&(e.getComponent(cc.Sprite).spriteFrame=i)}.bind(t))}()}}}),cc._RF.pop()},{Game:"Game"}],ShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"47158KpbiJMF46lKbQmGdRL","ShopItem");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,potionPrefab:cc.Prefab,txtCost:cc.Label,txtDiscount:cc.Node,iconNode:cc.Node,markDelete:cc.Node},init:function(t,e,i){this.cfgId=t,this.type=e;var c=void 0;0==e?((c=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(t),this.cost=3*o.get("cfg_card",t).value):1==e?((c=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(t),this.cost=6*o.get("cfg_item",t).value):2==e?((c=cc.instantiate(this.potionPrefab)).getComponent("PotionCommodity").init(t),this.cost=1==t?20:50):(this.markDelete.active=!0,this.cost=50),c&&(c.position=cc.v2(0,1==e?20:10),this.iconNode.addChild(c),this.item=c),i&&(this.txtDiscount.active=!0,this.cost=Math.ceil(.3*this.cost),this.txtCost.node.color=cc.Color.BLACK.fromHEX("#54EAD0"),this.txtCost.getComponent(cc.LabelOutline).color=cc.Color.BLACK.fromHEX("#54EAD0")),this.txtCost.string=this.cost},buy:function(){if(c.data.copper>=this.cost){c.data.copper-=this.cost,0==this.type?window.homeLayer.getCard(this.cfgId):1==this.type?c.getItem(this.cfgId):2==this.type?c.data.hp=Math.min(c.data.hp+10*this.cfgId,c.data.hpMax):window.homeLayer.openDelete();var t=3==this.type?8:c.data.shopIds.indexOf(this.cfgId,3*this.type);c.data.shopIds[t]=0,this.node.destroy(),window.homeLayer.refreshHeroData(),cc.audioEngine.playEffect(window.sound.buy)}else{(this.item||this.markDelete).runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound)}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(t,e,i){"use strict";cc._RF.push(e,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{boxs:[cc.Node],shopItemPrefab:cc.Prefab,curtain:cc.Node,title:cc.Node},onLoad:function(){window.shopLayer=this,this.initCards(),this.initEquip(),this.initPotions(),4==c.data.heroId&&this.initDelete(),this.curtain.runAction(cc.moveTo(.15,cc.v2(0,-17))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.moveTo(.25,cc.v2(9,-35)))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.skewTo(.2,2,0),cc.skewTo(.2,-2,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,0,0))),cc.audioEngine.playEffect(window.sound.shopOpen)},initCards:function(){for(var t=0;t<3;t++){var e=c.data.shopIds[t];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,0,t==c.data.discountCard),i.position=cc.v2(t%3*245-245,0),this.boxs[0].addChild(i)}}this.boxs[0].x=-750,this.boxs[0].y+=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[0].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0))))},initEquip:function(){for(var t=0;t<3;t++){var e=c.data.shopIds[t+3];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,1,t==c.data.discountItem),i.position=cc.v2(t%3*245-245,0),this.boxs[1].addChild(i)}}this.boxs[1].x=750,this.boxs[1].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0))))},initPotions:function(){for(var t=0;t<2;t++){var e=c.data.shopIds[t+6];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,2),i.position=cc.v2(t%3*245-245,0),this.boxs[2].addChild(i)}}this.boxs[2].x=-750,this.boxs[2].y-=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[2].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.2,cc.v2(750,0))))},initDelete:function(){if(c.data.shopIds[8]>0){var t=cc.instantiate(this.shopItemPrefab);t.getComponent("ShopItem").init(3,3),t.position=cc.v2(245,0),this.boxs[2].addChild(t)}},close:function(){this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0)))),this.boxs[0].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0)))),this.title.runAction(cc.moveTo(.2,cc.v2(9,230))),this.curtain.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.1,cc.v2(0,43)))),this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4),window.shopLayer=null,cc.audioEngine.playEffect(window.sound.shopClose)}}),cc._RF.pop()},{Game:"Game"}],SkillManager:[function(t,e,i){"use strict";cc._RF.push(e,"f9b8a6FzCFFt4zg92Jc9Ljj","SkillManager");var c=t("Game"),o={doCast:function(t){var e=window.mainLayer.hero,i=window.mainLayer.enemy;if(1==c.data.heroId)0==t?i.onHurt(5,4):1==t&&e.buff.addBuff(107,1);else if(2==c.data.heroId){if(0==t){for(var o=[],a=e.player.cardList.length-1;a>=0;a--){var s=e.player.cardList[a].getComponent("Card");s.unCost||s.isCopy||s.silence||o.push(a)}if(o.length>0){var n=Math.floor(o.length*Math.random());e.player.cardList[o[n]].getComponent("Card").disCost(),o.splice(n,1)}e.player.checkCardsRequire()}else if(1==t)for(var r=e.player.cardList.length,h=0;h<6-r;h++)e.player.patchCard()}else if(3==c.data.heroId){if(0==t)e.player.rollCount++,e.player.roll();else if(1==t)for(var d=0;d<6;d++)e.player.elementList[d]>0&&i.buff.addBuff(21+d,e.player.elementList[d])}else if(4==c.data.heroId){if(0==t){for(var l=e.player.cardList.length,f=[],p=l-1;p>=0;p--){var u=e.player.cardList[p].getComponent("Card");f.push(u.cfgId),u.discard(!0)}for(var m=Math.min(e.player.deckArray.length,l),g=0;g<m;g++)e.player.suppleCard();for(var w=0;w<f.length;w++)e.player.deckArray.push(f[w]);if(e.player.deckArray.sort(function(){return.5-Math.random()}),m<l)for(var v=0;v<l-m;v++)e.player.suppleCard();e.scheduleOnce(function(){window.mainLayer.hero.checkBtnRoll(!0)},.3)}else if(1==t){for(var y=0;y<2;y++)e.player.createExDice();window.mainLayer.hero.checkBtnRoll(!0)}}else if(5==c.data.heroId)if(0==t)e.player.createExDice();else if(1==t){for(var b=e.player.cardList.length-1;b>=0;b--)e.player.cardList[b].getComponent("Card").discard();e.player.cardList=[],e.player.createChest(!0)}},doCastTavern:function(t){0==t?window.player.addRollCount():1==t&&window.player.changeAllCards()}};e.exports=o,cc._RF.pop()},{Game:"Game"}],SkillTavern:[function(t,e,i){"use strict";cc._RF.push(e,"9a0667w2/RNgIs9zTdi7tpI","SkillTavern");var c=t("SkillManager");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,btn:cc.Button,txtName:cc.Label,mask:cc.Node},init:function(t){this.index=t;this.txtName.string=["\u8865\u6295","\u6362\u724c"][t],cc.loader.loadRes("Texture/hero/skill/"+(t+1),cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this))},check:function(){this.btn.interactable=window.tavernLayer.power>0,this.btn.interactable?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!0)},doSkill:function(){window.tavernLayer.costPower(),c.doCastTavern(this.index)}}),cc._RF.pop()},{SkillManager:"SkillManager"}],Skill:[function(t,e,i){"use strict";cc._RF.push(e,"84424zovvVHiZ6bvX7VE49L","Skill");var c=t("Game"),o=t("SkillManager");cc.Class({extends:cc.Component,properties:{txtCost:cc.Label,icon:cc.Sprite,btn:cc.Button,txtName:cc.Label,mask:cc.Node},init:function(t){if(this.index=t,this.unlock=!0,this.abled=!0,this.cost=10*(t+1),1==t&&c.data.level<3&&(this.unlock=!1),this.unlock){var e=[["\u731b\u51fb","\u72c2\u6012"],["\u8ff7\u9b42","\u5927\u6ee1\u8d2f"],["\u91cd\u63b7","\u6536\u5272"],["\u6362\u724c","\u751f\u673a"],["\u521b\u9020","\u5927\u6ee1\u8d2f"]][c.data.heroId-1];this.txtName.string=e[t],this.txtCost.string=this.cost,cc.loader.loadRes("Texture/hero/skill/"+(2*c.data.heroId-1+t),cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this))}else this.txtName.string="3\u7ea7\u89e3\u9501",cc.loader.loadRes("Texture/battle/mark_skill",cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this));this.check()},check:function(){this.unlock?177==window.mainLayer.enemy.equipList[0]?this.btn.interactable=!1:this.abled&&window.mainLayer.hero.power>=this.cost?this.btn.interactable=!0:this.btn.interactable=!1:this.btn.interactable=!1,this.btn.interactable?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=this.unlock)},doSkill:function(){0==window.mainLayer.roundId&&(this.abled=!1,window.mainLayer.hero.addPower(-this.cost),o.doCast(this.index))}}),cc._RF.pop()},{Game:"Game",SkillManager:"SkillManager"}],Sound:[function(t,e,i){"use strict";cc._RF.push(e,"77726IJdzpF843mufBZFnYQ","Sound"),cc.Class({extends:cc.Component,properties:{btn1:{type:cc.AudioClip,default:null},btn2:{type:cc.AudioClip,default:null},btnStart:{type:cc.AudioClip,default:null},selectSound:{type:cc.AudioClip,default:null},levelUpSound:{type:cc.AudioClip,default:null},endRound:{type:cc.AudioClip,default:null},copperSound:{type:cc.AudioClip,default:null},blackSound:{type:cc.AudioClip,default:null},delete:{type:cc.AudioClip,default:null},shopOpen:{type:cc.AudioClip,default:null},shopClose:{type:cc.AudioClip,default:null},buy:{type:cc.AudioClip,default:null},fireSound:{type:cc.AudioClip,default:null},iceSound:{type:cc.AudioClip,default:null},windSound:{type:cc.AudioClip,default:null},earthSound:{type:cc.AudioClip,default:null},lightSound:{type:cc.AudioClip,default:null},darkSound:{type:cc.AudioClip,default:null},atkSound:{type:cc.AudioClip,default:null},armorSound:{type:cc.AudioClip,default:null},healSound:{type:cc.AudioClip,default:null},dodgeSound:{type:cc.AudioClip,default:null},frailSound:{type:cc.AudioClip,default:null},weakSound:{type:cc.AudioClip,default:null},silenceSound:{type:cc.AudioClip,default:null},poisonSound:{type:cc.AudioClip,default:null},curseSound:{type:cc.AudioClip,default:null},lockSound:{type:cc.AudioClip,default:null},blindSound:{type:cc.AudioClip,default:null},reviveSound:{type:cc.AudioClip,default:null},undeadSound:{type:cc.AudioClip,default:null},burnSound:{type:cc.AudioClip,default:null},counterSound:{type:cc.AudioClip,default:null},errorSound:{type:cc.AudioClip,default:null},discardSound:{type:cc.AudioClip,default:null},missSound:{type:cc.AudioClip,default:null},bagOpenSound:{type:cc.AudioClip,default:null},bagCloseSound:{type:cc.AudioClip,default:null},rollSound:{type:cc.AudioClip,default:null},rollSound2:{type:cc.AudioClip,default:null},holdSound:{type:cc.AudioClip,default:null},drawSound:{type:cc.AudioClip,default:null},treasureSound:{type:cc.AudioClip,default:null},win:{type:cc.AudioClip,default:null},reward:{type:cc.AudioClip,default:null},lose:{type:cc.AudioClip,default:null},bingo:{type:cc.AudioClip,default:null},end:{type:cc.AudioClip,default:null},cheer:{type:cc.AudioClip,default:null},bgmTavetn:{type:cc.AudioClip,default:null},bgmPrepare:{type:cc.AudioClip,default:null},bgmYahtzee:{type:cc.AudioClip,default:null},bgmMap:{type:[cc.AudioClip],default:[]},bgmBattle:{type:[cc.AudioClip],default:[]},bgmBoss:{type:[cc.AudioClip],default:[]},bgmBossBig:{type:cc.AudioClip,default:null},bgmComplete:{type:cc.AudioClip,default:null},monsterSound:{type:[cc.AudioClip],default:[]},wolfSound:{type:cc.AudioClip,default:null}}}),cc._RF.pop()},{}],TavernLayer:[function(t,e,i){"use strict";cc._RF.push(e,"f73f9BbTilOdoWM2Ad26x3Z","TavernLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{enemyNode:cc.Node,endPrefab:cc.Prefab,mask:cc.Node,stripHp:cc.ProgressBar,txtHp:cc.Label,stripEnergy:cc.ProgressBar,txtEnergy:cc.Label,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,skillPrefab:cc.Prefab,skillNode:cc.Node,soundPrefab:cc.Prefab},onLoad:function(){window.tavernLayer=this,this.gameOver=!1,this.mask.active=!0,this.mask.zIndex=1e3,this.schedule(this.updateMask,0),this.enemyNode.scaleX=.8,this.enemyNode.scaleY=1.2,this.enemyNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,-250)),cc.scaleTo(.3,1.2,.8)),cc.scaleTo(.2,1),cc.callFunc(function(){this.enemyNode.runAction(cc.sequence(cc.scaleTo(.2,.98,1.02),cc.scaleTo(.4,1.02,.98),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this)))),this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax;this.txtName.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtLevel.string="Lv."+c.data.level,this.txtCopper.string=c.data.copper,this.initSkills();var t=cc.instantiate(this.soundPrefab);this.node.addChild(t),window.sound=t.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmTavetn,!0)},initSkills:function(){this.power=1,this.btnSkills=[];for(var t=0;t<2;t++){var e=cc.instantiate(this.skillPrefab);e.position=cc.v2(0==t?127:285,31),e.getComponent("SkillTavern").init(t),this.skillNode.addChild(e),this.btnSkills.push(e)}},costPower:function(){this.power=0,this.txtEnergy.string="0/1",this.stripEnergy.progress=0;for(var t=0;t<2;t++)this.btnSkills[t].getComponent("SkillTavern").check()},showEnd:function(t){if(!this.gameOver){this.gameOver=!0;var e=cc.instantiate(this.endPrefab);e.getComponent("EndTavernLayer").init(t),this.node.addChild(e)}},roll:function(){window.player.roll()},checkRewards:function(){var t=window.player.checkRewards();this.showEnd(t)},updateMask:function(){this.mask.width+=60,this.mask.height+=60,this.mask.width>=cc.winSize.width&&this.mask.height>=cc.winSize.height&&(this.unschedule(this.updateMask),this.mask.active=!1)}}),cc._RF.pop()},{Game:"Game"}],TreasureLayer:[function(t,e,i){"use strict";cc._RF.push(e,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{treasurePrefab:cc.Prefab,btnGets:[cc.Node],btnClose:cc.Node,boxNode:cc.Node,btnNode:cc.Node,mask:cc.Node},init:function(){window.treasureLayer=this;for(var t=0,e=[[.4,.3,.3],[.3,.4,.3],[.2,.4,.4]],i=Math.random(),o=0,a=0;a<3;a++)if(i<(o+=e[c.data.castle-1][a])){t=a+1;break}5==c.data.roomType?t++:c.data.itemEffect.vase>0&&(c.data.itemEffect.vase--,t++),t=Math.min(t,3),this.cfgIdList=[];var s=1;c.data.itemEffect.flagon>0&&(c.data.itemEffect.flagon--,s=2);var n=c.getNewItemId(0,t);if(this.cfgIdList.push(n),2==s){for(var r=0;r<=0;){var h=c.getNewItemId(0,t);h!=n&&(r=h)}this.cfgIdList.push(r)}this.initItem(),this.btnNode.active=!1,this.scheduleOnce(function(){this.btnNode.active=!0,this.btnNode.opacity=10,this.btnNode.y-=150,this.btnNode.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10)))))}.bind(this),.8)},initItem:function(){var t;(this.itemList=[],this.gotList=[],1==this.cfgIdList.length)?((t=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),this.boxNode.addChild(t),this.itemList.push(t)):((t=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[0]),t.position=cc.v2(180,0),this.boxNode.addChild(t),this.itemList.push(t),(t=cc.instantiate(this.treasurePrefab)).getComponent("Treasure").init(this.cfgIdList[1]),t.position=cc.v2(-180,0),this.boxNode.addChild(t),this.itemList.push(t),this.btnGets[1].active=!0,this.btnGets[0].position=cc.v2(180,30),this.btnClose.position=cc.v2(0,-100))},onGet:function(t,e){c.getItem(this.cfgIdList[e]),this.gotList.push(this.itemList[e]),this.btnGets[e].active=!1,this.gotList.length>=this.cfgIdList.length&&this.close()},onGiveUp:function(){this.close()},close:function(){c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.treasureLayer=null;for(var t=0;t<this.itemList.length;t++)this.itemList[t].opacity=1;if(this.gotList.length>0){this.mask.runAction(cc.fadeOut(.2)),this.btnNode.active=!1;for(var e=0;e<this.gotList.length;e++)this.gotList[e].getComponent("Treasure").got();this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4)}else this.node.destroy()}}),cc._RF.pop()},{Game:"Game"}],Treasure:[function(t,e,i){"use strict";cc._RF.push(e,"ab4bd76AwVKk6GKzcwjcSfb","Treasure");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,icon:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,infoNode:cc.Node,mask:cc.Node,anmation:cc.Node},init:function(t){var e=o.get("cfg_item",t);this.txtName.string=e.name;this.txtName.node.color=cc.Color.BLACK.fromHEX(["#31BEFF","#B689FF","#FF7F18"][e.quality-1]),this.txtDesc.string=c.analysisDesc(e.desc1),cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+e.quality,cc.SpriteFrame,function(t,e){this.boxIcon.spriteFrame=e}.bind(this)),this.doAction()},doAction:function(){this.mask.opacity=this.infoNode.opacity=this.boxIcon.node.opacity=1;var t=cc.spawn(cc.moveTo(.4,cc.v2(0,173)),cc.sequence(cc.scaleTo(.2,.8,1.1),cc.scaleTo(.2,1)));this.mask.runAction(cc.sequence(cc.delayTime(.5),cc.fadeIn(0),t,cc.fadeOut(.3))),this.boxIcon.node.runAction(cc.sequence(cc.delayTime(.9),cc.fadeIn(0))),this.infoNode.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.3))),cc.audioEngine.playEffect(window.sound.treasureSound)},got:function(){this.node.opacity=255,this.anmation.active=!1,this.infoNode.active=!1;var t=cc.winSize.height/cc.winSize.width*750;this.boxIcon.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveTo(.3,cc.v2(211-this.node.x,-t/2-80+115+33-70))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Utils:[function(t,e,i){"use strict";cc._RF.push(e,"85bfaYPayFNlrAFvtzNUMAc","Utils");var c={numberFormat:function(t){return t/1e13>=1?Math.floor(t/1e12)+"T":t/1e10>=1?Math.floor(t/1e9)+"B":t/1e7>=1?Math.floor(t/1e6)+"M":t/1e4>=1?Math.floor(t/1e3)+"K":t},timeFormat:function(t,e){var i=Math.round(t/1e3),c=i%60,o=e>1?Math.floor(i/60)%60:Math.floor(i/60),a=3==e?Math.floor(i/3600)%24:Math.floor(i/3600),s=Math.floor(i/86400),n=function(t){return t<10?"0"+t:t};return 1==e?n(o)+":"+n(c):2==e?n(a)+":"+n(o)+":"+n(c):s+"\u5929"+a+"\u65f6"+o+"\u5206"},getDifferentRandomNum:function(t,e,i){e=e||1,i=i||0;for(var c=[];c.length<t;){for(var o=Math.floor(Math.random()*(e-i+1))+i,a=!1,s=0;s<c.length;s++)if(c[s]-o==0){a=!0;break}a||c.push(o)}return c},createImage:function(t,e){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var t=new cc.Texture2D;t.initWithElement(i),t.handleLoadedTexture(),e.spriteFrame=new cc.SpriteFrame(t)}catch(t){cc.log(t),e.node.active=!1}},i.src=t}catch(t){cc.log(t),e.node.active=!1}else try{cc.loader.load({url:t,type:"jpg"},function(t,i){e.spriteFrame=new cc.SpriteFrame(i)})}catch(t){cc.log(t),e.node.active=!1}},substring:function(t,e){if(t.replace(/[\u4e00-\u9fa5]/g,"**").length<=e)return t;for(var i=0,c="",o=0;o<t.length&&(/[\u4e00-\u9fa5]/.test(t[o])?i+=2:i+=1,!(i>e));o++)c+=t[o];return c},getMd5Url:function(t){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(t)):cc.url.raw(t)},numToStr:function(t,e){e=e||1;for(var i=""+t,c=1;c<=e;c++)t<Math.pow(10,c)&&(i="0"+i);return i}};e.exports=c,cc._RF.pop()},{}],Yahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label,boxDesc:cc.Node,txtNameHero:cc.Label,txtNameEnemy:cc.Label,soundPrefab:cc.Prefab},onLoad:function(){window.yahtzeeLayer=this,this.descOpen=!0;this.txtNameHero.string=["\u5192\u9669\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9b54\u6cd5\u5e08","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtNameEnemy.string=o.get("cfg_event",c.data.eventIds[c.data.castle-1]).name;var t=cc.instantiate(this.soundPrefab);this.node.addChild(t),window.sound=t.getComponent("Sound"),cc.audioEngine.playMusic(window.sound.bgmYahtzee,!0)},start:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),this.roundId=1,this.hostId=0,this.doRound(),this.boxDesc.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(this.openDesc,this)))},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,window.player.startRound()},endRound:function(){for(var t=this,e=function(e){var i=t.hero.diceList[e];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,300)),cc.delayTime(1.5),cc.callFunc(function(){this.hero.dicePool.put(i)}.bind(t))))},i=0;i<5;i++)e(i);var c=function(e){var i=t.enemy.diceList[e];i.runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-300)),cc.delayTime(1.5),cc.callFunc(function(){this.enemy.dicePool.put(i)}.bind(t))))};for(i=0;i<5;i++)c(i);this.scheduleOnce(function(){this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.hero.doWin():this.hero.score<this.enemy.score?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),1.5),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(t){var e=cc.instantiate(this.endPrefab);e.getComponent("EndYahtzeeLayer").init(t),this.node.addChild(e)},openDesc:function(){this.boxDesc.stopAllActions(),this.descOpen?(this.descOpen=!1,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-428,93)))):(this.descOpen=!0,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-279,93))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardChangeLayer","CardCollection","CardDeleteLayer","CardManager","CardTavern","Chest","ChooseDiceLayer","CompleteLayer","Config","Dice","DiceChoose","DiceTavern","DiceYahtzee","DmgAnimation","Door","Edit","EditEndLayer","EndLayer","EndTavernLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","HelloWorld","Hero","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerTavern","PlayerYahtzee","PotionCommodity","PrepareLayer","RequireRound","Room","ShopItem","ShopLayer","Skill","SkillManager","SkillTavern","Sound","TavernLayer","Treasure","TreasureLayer","Utils","Yahtzee"]);