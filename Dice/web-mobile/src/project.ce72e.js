window.__require=function t(e,i,c){function o(a,s){if(!i[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var d="function"==typeof __require&&__require;if(!s&&d)return d(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+a+"'")}}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){return o(e[a][1][t]||t)},h,h.exports,t,e,i,c)}return i[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<c.length;a++)o(c[a]);return o}({AIYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"f539fwGMytAI5QBpzVwwts6","AIYahtzee"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("PlayerYahtzee")},check:function(){for(var t=[0,0,0,0,0,0],e=0;e<5;e++){var i=this.player.diceList[e].getComponent("DiceYahtzee");t[i.element-1]++}for(var c=-1,o=-1,n=0;n<6;n++)t[n]>(t[c]||0)&&(c=n);for(var a=0;a<6;a++)a!=c&&t[a]>(t[o]||0)&&(o=a);this.scheduleOnce(function(){t[c]>1?t[c]==t[o]?this.hold(c,o):this.hold(c):1==this.player.rollCount?this.player.recycle():this.player.roll()}.bind(this),.8)},hold:function(t,e){for(var i=0,c=0;c<5;c++){var o=this.player.diceList[c].getComponent("DiceYahtzee");o.holded?o.element!=t+1&&null!=e&&o.element!=e+1&&(o.doHold(),i++):(o.element==t+1||null!=e&&o.element==e+1)&&(o.doHold(),i++)}var n=i<=0?.3:.8;this.scheduleOnce(function(){this.player.roll()}.bind(this),n)}}),cc._RF.pop()},{}],AI:[function(t,e,i){"use strict";cc._RF.push(e,"6487boeVqBBxohhnx9DSKEj","AI"),cc.Class({extends:cc.Component,onLoad:function(){this.player=this.getComponent("Player"),this.host=this.getComponent("Enemy"),this.castList=[]},check:function(){window.mainLayer.gameOver||this.checkCards()},checkCards:function(){this.checkUsableToken();for(var t=1,e=100,i=null,c=0;c<this.cards.length;c++){var o=this.cards[c].getComponent("Card");o.usable&&(o.cfg.priority<e||o.cfg.priority==e&&o.rate>t)&&(t=o.rate,e=o.cfg.priority,i=o)}i?i.cast():this.player.rollCount>0&&this.cards.length>0?this.scheduleOnce(function(){this.checkDice()}.bind(this),.8):this.scheduleOnce(function(){this.player.endRound()}.bind(this),.6)},checkDice:function(){if(!window.mainLayer.gameOver)if(this.cards.length<=0)this.scheduleOnce(function(){this.check()}.bind(this),1);else{for(var t=[0,0,0,0,0,0],e=0;e<this.cards.length;e++){var i=this.cards[e].getComponent("Card");(m=i.require.split(";")).length>1&&t[m[0]-1]++;for(var c=["A","B","C","D","E","F"],o=0;o<6;o++)if(i.cfg.desc.indexOf(c[o])>=0){t[o]++;break}}for(var n=!1,a=0;a<6;a++)if(t[a]>0){n=!0;break}for(var s=[],r=0;r<this.cards.length;r++){var d=this.cards[r].getComponent("Card"),h=[0,0,0,0,0,0];if(d.require>=101&&d.require<=105){for(var l=0,u=0,f=0;f<6;f++)(!n||t[f]>0)&&this.player.elementList[f]>l&&(l=this.player.elementList[f],u=f+1);if(h=[-100,-100,-100,-100,-100,-100],l>=n||2){h[u-1]=[2,3,3,4,5][d.require-101]-l}}else{var p=[0,0,0,0,0,0];if(106==d.require||107==d.require)p=[1,1,1,1,1,1];else for(var m=d.require.split(";"),g=0;g<m.length;g++)p[m[g]-1]++;for(var y=["A","B","C","D","E","F"],v=0;v<6;v++){var w=p[v];d.cfg.desc.indexOf(y[v])>=0&&(w=this.player.elementList[v]+1),h[v]=w-this.player.elementList[v]}}s.push(h)}for(var b=100,C=0,x=0,L=1,k=0;k<s.length;k++){for(var T=s[k],B=0,I=0,A=0;A<T.length;A++)B+=T[A]<-10?0:Math.abs(T[A]),I+=T[A];(B<b||B==b&&I>C||B==b&&I==C&&this.cards[k].getComponent("Card").rate<L)&&(b=B,C=I,x=k,L=this.cards[k].getComponent("Card").rate)}for(var E=s[x],q=0;q<6;q++)if(0!=E[q]){var N=E[q]+this.player.elementList[q]-this.player.holdList[q];if(N>0)for(var F=0;F<this.dices.length;F++){var S=this.dices[F].getComponent("Dice");if(S.element==q+1&&!(S.holded||S.lock||S.freeze||S.temp)&&(S.hold(),0==--N))break}else if(N<0)for(var R=0;R<this.dices.length;R++){var M=this.dices[R].getComponent("Dice");if(M.element==q+1&&M.holded&&!M.lock&&!M.freeze&&!M.temp&&(M.hold(),0==++N))break}}this.player.roll();for(var D=!1,P=0;P<this.dices.length;P++){var O=this.dices[P].getComponent("Dice");if(!(O.holded||O.lock||O.freeze||O.temp)){D=!0;break}}this.scheduleOnce(function(){D?this.check():this.player.endRound()}.bind(this),1)}},checkUsableToken:function(){this.cards=[];for(var t=0;t<this.player.cardList.length;t++){var e=this.player.cardList[t].getComponent("Card");e.silence||e.burn&&!(window.mainLayer.enemy.hp>3)||this.cards.push(e)}this.dices=[];for(var i=0;i<this.player.diceList.length;i++){var c=this.player.diceList[i];c.lock||this.dices.push(c)}},insertAndCast:function(t){}}),cc._RF.pop()},{}],Buff:[function(t,e,i){"use strict";cc._RF.push(e,"76faa8y1jVIcqDL176r9ktK","Buff");var c=t("Game");cc.Class({extends:cc.Component,properties:{buffBox:cc.Node,txtBuff:cc.RichText},init:function(){this.player=this.getComponent("Player"),this.opponent=this.player.opponent,this.buffList=[],this.multiCast=0,this.multiCastMax=0,this.selfHarmCast=0,this.selfHarmCastMax=0,this.elementRoundCasted=[0,0,0,0,0,0],this.iteraList=[0,0,0,0,0,0,0,0],this.iteraList2=[0,0,0,0,0,0],this.burnIce=!1,this.silenceDark=!1,this.atkAd3=!1,this.creatDiceFire=0,this.exCreateDice=0,this.tempBuff=[0,0,0,0],this.doubleWind=!1,this.darkRedice=0,this.table={};for(var t=[13,21,22,23,24,25,26,27,28,29,30,101,102,103,104,105,106,107,108],e=0;e<t.length;e++)this.table[t[e]]=0;this.quote(),this.refreshBuff()},addBuff:function(t,e){if(!(e<=0||t>=21&&t<=26&&this.player.equip.trigger(t+41)||27==t&&this.player.equip.trigger(107))){if(13==t)this.player.anim.show(13);else if(t>=21&&t<=30){if(this.immunity>0)return this.removeBuff(105,1),this.player.equip.doTrigger(37),void this.player.assertHpChange("MISS",3);if(t<=26){if(this.opponent.equip.checkWithTrigger(t+10))e+=26==t?2:1;23==t&&this.opponent.equip.trigger(68)}this.player.anim.show(t)}this.table[t]+=e,this.quote();for(var i=!1,c=0;c<this.buffList.length;c++)if(this.buffList[c]==t){i=!0;break}i||this.buffList.push(t),this.refreshBuff()}},removeBuff:function(t,e){if(!(e<=0)){if(this.table[t]-=e,this.table[t]<=0){this.table[t]=0;var i=this.buffList.indexOf(t);null!=i&&this.buffList.splice(i,1)}this.quote(),this.refreshBuff()}},quote:function(){this.dodge=this.table[13],this.burn=this.table[21],this.freeze=this.table[22],this.frail=this.table[23],this.weak=this.table[24],this.silence=this.table[25],this.poison=this.table[26],this.curse=this.table[27],this.lock=this.table[28],this.chaos=this.table[29],this.blind=this.table[30],this.exRound=this.table[101],this.undead=this.table[102],this.atkBack=this.table[103],this.atkAdd=this.table[104],this.immunity=this.table[105],this.hurtReduce=this.table[106],this.doubleDmg=this.table[107],this.doubleCast=this.table[108]},refreshBuff:function(){var t="",e={13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",29:"\u6df7\u4e71",30:"\u76f2\u76ee",101:"\u989d\u5916\u56de\u5408",102:"\u4e0d\u6b7b",103:"\u53cd\u4f24",104:"\u4f24\u5bb3\u63d0\u5347",105:"\u514d\u75ab",106:"\u53d7\u4f24\u51cf\u514d",107:"\u53cc\u500d\u4f24\u5bb3",108:"\u91cd\u590d\u884c\u52a8"},i={13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1",101:"FFF830",102:"FF5567",103:"FF5567",104:"FFF830",105:"42EBFF",106:"FF5567",107:"F15162",108:"E2BD6D"};if(1==this.buffList.length){var c=this.buffList[0];t+="<img src='"+this.getBuffImg(c)+"'/>",t+="<color="+i[c]+">"+e[c]+this.table[c]+"</c>"}else for(var o=0;o<this.buffList.length;o++){var n=this.buffList[o];t+="<img src='"+this.getBuffImg(n)+"'/>",t+="<color="+i[n]+">"+this.table[n]+"</c>  "}if(this.player.host.txtBuff.string=t,this.buffBox.active){t="";var a=40;this.opponent.equip.check(54)&&(a+=20),this.player.equip.check(56)&&(a-=20),this.player.equip.check(113)&&(a*=2),this.opponent.equip.check(113)&&(a*=2);for(var s={13:"\u8eb2\u907f\u5bf9\u624b\u4f7f\u7528\u7684\u653b\u51fb\u724c\uff0c\u89e6\u53d1\u540e\u5c42\u6570-1",21:"\u4f7f\u7528\u71c3\u70e7\u7684\u5361\u724c\u65f6\uff0c\u53d7\u52303\u706b\u4f24\u5bb3",22:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u88ab\u91cd\u63b7",23:"\u989d\u5916\u627f\u53d7"+a+"%\u7684\u5361\u724c\u4f24\u5bb3\uff0c \u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",24:"\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u51cf\u5c11"+(this.opponent.equip.check(55)?50:30)+"%\uff0c \u56de\u5408\u7ed3\u675f\u65f6\u5c42\u6570-1",25:"\u4f7f\u5361\u724c\u65e0\u6cd5\u4f7f\u7528",26:"\u56de\u5408\u5f00\u59cb\u65f6\u53d7\u5230\u4e2d\u6bd2\u5c42\u6570\u7684\u4f24\u5bb3\uff0c\u4e2d\u6bd2\u5c42\u6570-1",27:"\u4f7f\u7528\u5361\u724c\u65f6\u670950%\u6982\u7387\u65e0\u6548\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",28:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u4f7f\u7528",29:"\u4f7f\u7528\u653b\u51fb\u724c\u65f6\u670950%\u6982\u7387\u653b\u51fb\u81ea\u8eab\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",30:"\u4f7f\u9ab0\u5b50\u7684\u5143\u7d20\u65e0\u6cd5\u88ab\u67e5\u770b",101:"\u56de\u5408\u7ed3\u675f\u65f6\u5f00\u59cb\u989d\u5916\u7684\u5df1\u65b9\u56de\u5408\uff0c\u5c42\u6570-1",102:"\u751f\u547d\u65e0\u6cd5\u51cf\u5c11\u52301\u4ee5\u4e0b\uff0c\u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",103:"\u53d7\u5230\u5361\u724c\u4f24\u5bb3\u65f6\uff0c\u4f7f\u5bf9\u624b\u627f\u53d7\u53cd\u4f24\u5c42\u6570\u7684\u4f24\u5bb3",104:"\u589e\u52a0\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3",105:"\u514d\u9664\u83b7\u5f97\u8d1f\u9762\u72b6\u6001",106:"\u51cf\u5c11\u53d7\u5230\u7684\u5361\u724c\u4f24\u5bb3",107:"\u4e0b\u4e00\u5f20\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u7ffb\u500d",108:"\u4e0b\u4e00\u5f20\u5361\u724c\u989d\u5916\u4f7f\u7528\u4e00\u6b21\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1"},r=0;r<this.buffList.length;r++){var d=this.buffList[r];t+="<img src='"+this.getBuffImg(d)+"'/>",t+="<color="+i[d]+">"+e[d]+": "+s[d]+"</c>",r!=this.buffList.length-1&&(t+="\r\n")}this.txtBuff.string=t,this.buffBox.height=14+30*this.buffList.length,this.buffBox.width=this.txtBuff.node.width+20,this.txtBuff.node.x=-this.txtBuff.node.width/2}},getBuffImg:function(t){var e={13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind",101:"exRound",102:"undead",103:"atkback",104:"atkAdd",105:"immunity",106:"hurtReduce",107:"doubleDmg",108:"doubleAction"}[t];if(23==t){var i=0;(this.opponent.equip.check(54)||this.opponent.equip.check(113)||this.player.equip.check(113))&&i++,this.player.equip.check(56)&&i--,i>0?e="frailPlus":i<0&&(e="frailMinus")}else 24==t&&this.opponent.equip.check(55)&&(e="weakPlus");return e},openBuffList:function(){if(0!=this.buffList.length){if(window.mainLayer.buffTip){if(window.mainLayer.buffTip==this)return void this.hideTip();window.mainLayer.buffTip.hideTip()}this.buffBox.active=!0,this.refreshBuff(),window.mainLayer.buffTip=this,this.scheduleOnce(this.hideTip,5),2==c.data.guide[2]&&window.guide&&window.guide.close()}},hideTip:function(){this.unscheduleAllCallbacks(),this.buffBox.active=!1,window.mainLayer.buffTip=null}}),cc._RF.pop()},{Game:"Game"}],CampLayer:[function(t,e,i){"use strict";cc._RF.push(e,"b0d89nUwu5Nl4dwKJDLgM6m","CampLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,boxHeal:cc.Node,boxCopper:cc.Node,boxDelete:cc.Node,boxEquip:cc.Node,settleBoardPrefab:cc.Prefab,itemPrefab:cc.Prefab,markDelete:cc.Node,btns:[cc.Node],mask:cc.Node},onLoad:function(){window.campLayer=this,this.initHp(),this.initCopper(),this.boxList=[this.boxHeal,this.boxCopper],c.data.equip.indexOf(38)>=0&&(this.initEquip(),this.boxList.push(this.boxEquip)),4==c.data.heroId&&(this.boxDelete.active=!0,this.boxList.push(this.boxDelete),this.markDelete.opacity=0,this.markDelete.y-=50,this.markDelete.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),this.markDelete.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever())),this.boxList.length<=2?(this.title.y-=150,this.boxHeal.y-=230,this.boxCopper.y-=230):3==this.boxList.length&&(this.boxList[2].x=0);for(var t=0;t<4;t++)this.btns[t].zIndex=10;cc.audioEngine.playEffect(window.sound.camp)},initHp:function(){this.hp=Math.floor(.5*c.data.hpMax);var t=cc.instantiate(this.settleBoardPrefab);t.getComponent("SettleBoard").init(3,this.hp,-1),t.y=110,this.boxHeal.addChild(t);var e=t.getComponent("SettleBoard").txtCount;c.data.equip.indexOf(39)>=0&&(this.hp=c.data.hpMax-c.data.hp,e.node.color=cc.color(255,230,62),e.string="\u751f\u547d\u56de\u6ee1"),t.opacity=0,t.y-=50,t.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),t.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever())},initCopper:function(){this.copper=7*(c.data.castle+3);var t=cc.instantiate(this.settleBoardPrefab);t.y=110,this.boxCopper.addChild(t),this.copperCard=t,c.data.equip.indexOf(39)>=0&&(this.copper*=2,t.getComponent("SettleBoard").txtCount.node.color=cc.color(255,230,62)),t.getComponent("SettleBoard").init(1,this.copper,-1),t.opacity=0,t.y-=50,t.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),t.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever())},initEquip:function(){this.boxEquip.active=!0,this.equipId=c.getNewItemId(0);var t=cc.instantiate(this.itemPrefab);t.getComponent("ItemCommodity").init(this.equipId),t.y=145,this.boxEquip.addChild(t),this.equipCard=t,t.opacity=0,t.y-=50,t.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),t.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever())},onHeal:function(){c.data.hp=Math.min(c.data.hp+this.hp,c.data.hpMax),cc.audioEngine.playEffect(window.sound.healSound),this.close(.2),window.homeLayer.healAnimation.playAnimation("play0",1),this.title.active=this.boxHeal.active=this.boxCopper.active=this.boxDelete.active=this.boxEquip.active=!1},onCopper:function(){c.updateCopper(this.copper),cc.audioEngine.playEffect(window.sound.copperSound),this.close(.4),this.copperCard.position=this.copperCard.position.add(this.boxCopper.position),this.copperCard.parent=this.node,this.title.active=this.boxHeal.active=this.boxCopper.active=this.boxDelete.active=this.boxEquip.active=!1,this.copperCard.getComponent("SettleBoard").got()},onDelete:function(){window.homeLayer.openDelete(),this.close(0)},onEquip:function(){this.equipCard.position=this.equipCard.position.add(this.boxEquip.position),this.equipCard.parent=this.node,this.title.active=this.boxHeal.active=this.boxCopper.active=this.boxDelete.active=this.boxEquip.active=!1,this.equipCard.getComponent("ItemCommodity").got(),cc.audioEngine.playEffect(window.sound.selectSound),c.getItem(this.equipId),this.close(.4)},close:function(t){c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.room.doReady(),window.room.hero.centerial(),window.campLayer=null,this.mask.runAction(cc.fadeOut(.2)),this.scheduleOnce(function(){this.node.destroy(),window.homeLayer.refreshHeroData()}.bind(this),t)}}),cc._RF.pop()},{Game:"Game"}],CardBagLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2534fgAL1FKcLXmME7NK5RR","CardBagLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,boxDeck:cc.Node,content:cc.Node,mask:cc.Node,scrollView:cc.Node,boxRandom:cc.Node,animation:dragonBones.ArmatureDisplay,btnClose:cc.Node,cardNode:cc.Node},onLoad:function(){window.bagLayer=this,this.animation.node.zIndex=10,this.scrollView.zIndex=this.cardNode.zIndex=1,this.mask.runAction(cc.fadeTo(.1,210)),this.initDeck(),this.initBag(),c.newCard&&(c.newCard=!1,window.homeLayer.refreshHeroData()),cc.audioEngine.playEffect(window.sound.bagOpenSound)},start:function(){this.animation.timeScale=1.5,this.animation.playAnimation("play0",1),this.scheduleOnce(function(){this.animation.node.zIndex=0,this.scrollView.runAction(cc.fadeIn(.15)),this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(-130,0)),cc.moveBy(.1,cc.v2(10,0)))),window.guide&&window.guide.close(),c.data.deck.length+c.data.cardBag.length>=7&&!c.guiding&&1==c.data.guide[5]&&window.homeLayer.showGuide(5)}.bind(this),.8)},initDeck:function(){this.deck=[];for(var t=0;t<c.data.deck.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.deck[t],0),e.position=cc.v2(t%3*247-247,79-216*Math.floor(t/3)),this.cardNode.addChild(e),this.deck[t]=e}2==c.data.heroId&&3==c.data.difficulty&&(this.boxRandom.active=!0)},initBag:function(){c.data.cardBag.sort(function(t,e){return o.get("cfg_card",t).element==o.get("cfg_card",e).element?t-e:o.get("cfg_card",t).element-o.get("cfg_card",e).element}),this.bagList=[];for(var t=0;t<c.data.cardBag.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.cardBag[t],1),e.position=cc.v2(t%3*248-248,-108-216*Math.floor(t/3)),this.content.addChild(e),this.bagList.push(e)}this.content.height=Math.max(216*Math.ceil(c.data.cardBag.length/3)+20,530)},equip:function(t){for(var e=-1,i=2==c.data.heroId&&3==c.data.difficulty?5:6,o=0;o<i;o++)if(null==this.deck[o]){e=o;break}if(e>=0){t.parent=this.cardNode,t.position=cc.v2(e%3*248-248,79-216*Math.floor(e/3)),t.getComponent("CardCollection").colletType=0;var n=t.getComponent("CardCollection").cfgId;this.deck[e]=t;var a=c.data.cardBag.indexOf(n);c.data.cardBag.splice(a,1);a=this.bagList.indexOf(t);this.bagList.splice(a,1),this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)}},unEquip:function(t){var e=this.deck.indexOf(t);this.deck[e]=null;for(var i=c.data.cardBag.length,n=t.getComponent("CardCollection").cfgId,a=0;a<c.data.cardBag.length;a++)if(o.get("cfg_card",n).element<o.get("cfg_card",c.data.cardBag[a]).element||o.get("cfg_card",n).element==o.get("cfg_card",c.data.cardBag[a]).element&&n<c.data.cardBag[a]){i=a;break}c.data.cardBag.splice(i,0,n),this.bagList.splice(i,0,t),t.parent=this.content,t.position=cc.v2(i%3*248-248,-108-216*Math.floor(i/3)),t.getComponent("CardCollection").colletType=1,this.refreshBag(),cc.audioEngine.playEffect(window.sound.btn1)},refreshBag:function(){for(var t=0;t<this.bagList.length;t++)this.bagList[t].runAction(cc.moveTo(.15,cc.v2(t%3*248-248,-108-216*Math.floor(t/3))));this.content.height=Math.max(216*Math.ceil(c.data.cardBag.length/3)+20,530)},close:function(){c.data.deck=[];for(var t=0;t<6;t++)null!=this.deck[t]&&c.data.deck.push(this.deck[t].getComponent("CardCollection").cfgId);this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(120,0)),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.bagCloseSound)}.bind(this)))),this.mask.runAction(cc.sequence(cc.delayTime(1),cc.fadeOut(.2))),this.scrollView.active=!1,this.animation.node.zIndex=10,this.animation.timeScale=-1.5,this.animation.playAnimation("play0",1),this.boxDeck.runAction(cc.sequence(cc.delayTime(.8),cc.moveBy(.2,cc.v2(0,cc.winSize.height/cc.winSize.width*750/2)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null,window.homeLayer.btnDeck.interactable=!0}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardBagMageLayer:[function(t,e,i){"use strict";cc._RF.push(e,"9c13cGNBSlDIYkB1fQUoF3z","CardBagMageLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,box:cc.Node,content:cc.Node,mask:cc.Node,btnClose:cc.Node},onLoad:function(){window.bagLayer=this,this.box.opacity=0,this.mask.runAction(cc.fadeTo(.15,210)),this.box.runAction(cc.sequence(cc.delayTime(.01),cc.moveBy(0,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.fadeIn(0),cc.moveTo(.35,cc.v2(0,0)),cc.callFunc(function(){this.btnClose.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveBy(.2,cc.v2(0,-130)),cc.moveBy(.1,cc.v2(0,10)))))}.bind(this)))),this.initBag(),c.newCard&&(c.newCard=!1,window.homeLayer.refreshHeroData()),cc.audioEngine.playEffect(window.sound.bagOpenSound),window.guide&&window.guide.close()},initBag:function(){c.data.cardBag.sort(function(t,e){return o.get("cfg_card",t).element==o.get("cfg_card",e).element?t-e:o.get("cfg_card",t).element-o.get("cfg_card",e).element}),this.bagList=[];for(var t=0;t<c.data.cardBag.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.cardBag[t]),e.position=cc.v2(t%3*248-248,-116-207*Math.floor(t/3)),this.content.addChild(e),this.bagList.push(e)}this.content.height=Math.max(207*Math.ceil(c.data.cardBag.length/3)+20,1140)},close:function(){this.btnClose.runAction(cc.sequence(cc.spawn(cc.fadeOut(.2),cc.moveBy(.2,cc.v2(0,120))),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.bagCloseSound)}.bind(this)))),this.mask.runAction(cc.sequence(cc.delayTime(.3),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.25,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.bagLayer=null,window.homeLayer.btnDeck.interactable=!0}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardChangeLayer:[function(t,e,i){"use strict";cc._RF.push(e,"0efbet/DcpBqY6/+LvJ5kbp","CardChangeLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,mask:cc.Node,cardNode:cc.Node,boxes:[cc.Node],masks:[cc.Node],labels:[cc.Node],btns:[cc.Node],cardPrefab:cc.Prefab,btnClose:cc.Node},init:function(t,e,i){window.changeLayer=this,this.cfgId=t,this.cfgId2=e,this.closeFunc=i,this.count=e?2:1,this.index=0,this.initDeck(),this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound),this.mask.runAction(cc.fadeTo(.2,210)),this.bg.y+=cc.winSize.height,this.bg.runAction(cc.moveTo(.2,cc.v2(0,0))),this.btnClose.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-130,0)),cc.moveBy(.1,cc.v2(10,0))))},initDeck:function(){this.deckList=[];for(var t=0;t<c.data.deck.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.deck[t]),e.getComponent("CardCollection").txtChosen.active=!0,e.getComponent("CardCollection").txtChosen.y+=20,e.position=cc.v2(t%3*250-250,380-268*Math.floor(t/3)),this.cardNode.addChild(e),this.deckList.push(e),this.btns[t].zIndex=10}},initCards:function(){this.cardList=[];var t=cc.instantiate(this.cardPrefab);if(t.getComponent("CardCollection").init(this.cfgId),t.position=cc.v2(0,5),this.boxes[0].addChild(t),this.cardList.push(t),this.cfgId2){this.boxes[0].x=-185,this.boxes[1].active=!0;var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(this.cfgId2),e.position=cc.v2(0,5),this.boxes[1].addChild(e),this.cardList.push(e)}},onChange:function(t,e){if(!(this.index>=this.count)){if(this.index++,this.index==this.count)for(var i=0;i<this.deckList.length;i++)this.deckList[i].getComponent("CardCollection").txtChosen.active=!0;this.deckList[e].active=!1,this.labels[this.index-1].active=!1,this.masks[this.index-1].active=!1,this.index<this.count&&(this.masks[1].active=!1);var o=this.cardList[this.index-1];o.position=o.parent.position.add(cc.v2(0,-388)),o.parent=this.cardNode,o.runAction(cc.sequence(cc.moveTo(.2,cc.v2(e%3*250-250,380-268*Math.floor(e/3))),cc.callFunc(function(){this.index<this.count?(o.getComponent("CardCollection").txtChosen.active=!0,o.getComponent("CardCollection").txtChosen.y+=20):this.scheduleOnce(function(){this.close()}.bind(this),.3)}.bind(this)))),this.deckList[e]=o,c.data.deck[e]=1==this.index?this.cfgId:this.cfgId2,cc.audioEngine.playEffect(window.sound.bingo)}},close:function(){cc.audioEngine.playEffect(window.sound.bagCloseSound),this.btnClose.runAction(cc.moveBy(.2,cc.v2(120,0))),this.mask.runAction(cc.fadeOut(.2)),this.bg.runAction(cc.sequence(cc.moveTo(.2,cc.v2(0,cc.winSize.height)),cc.callFunc(function(){this.node.destroy(),window.changeLayer=null,this.closeFunc&&this.closeFunc()}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}],CardCollection:[function(t,e,i){"use strict";cc._RF.push(e,"a28bfVp4ABL54sr47isHV8F","CardCollection");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,btn:cc.Button,title:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,markDelete:cc.Node,mask:cc.Node,txtChosen:cc.Node,tipNode:cc.Node,tip:cc.Node,txtEmpty:cc.Node,nail:cc.Node},init:function(t,e){if(t<=0)this.btn.node.active=!1,this.markDelete.active=!0,this.txtEmpty.active=!0;else{this.cfgId=t,this.cfg=o.get("cfg_card",t);var i=[cc.color(117,29,28),cc.color(28,50,133),cc.color(15,97,51),cc.color(148,78,29),cc.color(153,123,33),cc.color(92,45,115),cc.color(91,91,91)],n=[cc.color(203,44,46),cc.color(22,104,224),cc.color(0,183,79),cc.color(230,121,30),cc.color(188,160,0),cc.color(169,80,228),cc.color(133,133,133)],a=[cc.color(205,48,39),cc.color(25,84,218),cc.color(0,158,64),cc.color(229,104,24),cc.color(184,144,0),cc.color(152,63,225),cc.color(119,119,119)];this.element=this.cfg.element,this.btn.node.color=i[this.element-1],this.title.color=n[this.element-1],this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=a[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.txtDesc.string=c.analysisDesc(this.cfg.desc1,0,this.cfg.exile),this.requireNode.y=2,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5);var s=this.cfg.require;if(s>=101&&s<=107){this.txtRequire.string=["\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][s-101];for(var r=[[17,-17],[-30,-56,56,30],[35,0,-35],[52,17,-17,-52]][s-101],d=0;d<r.length;d++)this.createCircle(0,r[d])}else{this.requireNode.y-=10;for(var h=s.split(";"),l=(r=[[0],[-29,29],[-52,0,52],[-78,-26,26,78]][h.length-1],0);l<h.length;l++)this.createCircle(parseInt(h[l]),r[l])}null==e?this.clickabled=!1:(this.clickabled=!0,this.colletType=e)}},createCircle:function(t,e){var i=cc.instantiate(this.requirePrefab);i.getComponent("RequireRound").init(t,this.element),i.position=cc.v2(e,24),this.requireNode.addChild(i),t>0&&i.getComponent("RequireRound").refreshSatisfy(!0)},changeCollectType:function(){this.clickabled&&(0==this.colletType?1==c.data.heroId&&3==c.data.difficulty||window.bagLayer.unEquip(this.node):1==this.colletType?window.bagLayer.equip(this.node):2==this.colletType?window.deleteLayer.confirm(this.cfgId):3==this.colletType&&(this.clickabled=!1,window.treasureChest?window.treasureChest.chooseCard(this.cfgId):window.levelUpLayer&&window.levelUpLayer.choose(this.cfgId)))},runOut:function(t,e){this.clickabled=!1,this.btn.node.opacity=1,this.mask.active=!0,this.node.opacity=1,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*e),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,t),cc.scaleTo(.2,1)),cc.callFunc(function(){this.btn.node.opacity=255,this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},enableChoosen:function(){this.clickabled=!0,this.txtChosen.active=!0,this.txtChosen.opacity=0,this.txtChosen.y-=50,this.txtChosen.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))),cc.callFunc(function(){this.showTip()}.bind(this))))},showTip:function(){for(var t=this,e=[],i=this.cfg.desc1.split("#"),o=0;o<i.length;o++){var n=parseInt(i[o]);(13==n||n>=21&&n<=30)&&e.push(n)}this.tips=[];for(var a=0,s=function(i){var o=e[i],n=cc.instantiate(t.tip);n.active=!0;var s=n.getChildren()[0];n.position=cc.v2(0,30),t.tipNode.addChild(n),t.tips.push(n),n.runAction(cc.sequence(cc.delayTime(.2*i),cc.moveTo(.2,cc.v2(0,115+a)),cc.callFunc(function(){s.runAction(cc.fadeIn(.2))}.bind(t)))),s.getComponent(cc.RichText).string=c.analysisTip(o),n.height=10+s.height,a+=n.height+10},r=0;r<e.length;r++)s(r)},hideTip:function(){if(this.tips)for(var t=0;t<this.tips.length;t++)this.tips[t].runAction(cc.fadeOut(.2));this.txtChosen.active&&this.txtChosen.runAction(cc.fadeOut(.2))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardDeleteLayer:[function(t,e,i){"use strict";cc._RF.push(e,"ba205encTVLE4/a2/Sy3k6o","CardDeleteLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,content:cc.Node,confirmNode:cc.Node},onLoad:function(){window.deleteLayer=this,this.initCards(),cc.audioEngine.playEffect(window.sound.bagOpenSound)},initCards:function(){c.data.cardBag.sort(function(t,e){return o.get("cfg_card",t).element==o.get("cfg_card",e).element?t-e:o.get("cfg_card",t).element-o.get("cfg_card",e).element});for(var t=0;t<c.data.cardBag.length;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(c.data.cardBag[t],2),e.position=cc.v2(t%3*247-247,-120-210*Math.floor(t/3)),this.content.addChild(e)}this.contentHeight=cc.winSize.height/cc.winSize.width*750-1334+1120,this.content.height=Math.max(210*Math.ceil(c.data.cardBag.length/3)+20,this.contentHeight)},confirm:function(t){this.cardId=t,this.confirmNode.active=!0;var e=cc.instantiate(this.cardPrefab);e.getComponent("CardCollection").init(t),e.getComponent("CardCollection").markDelete.active=!0,e.position=cc.v2(0,100),this.confirmNode.addChild(e),cc.audioEngine.playEffect(window.sound.btn1)},doCancel:function(){this.confirmNode.active=!1},doDelete:function(){var t=c.data.cardBag.indexOf(this.cardId);c.data.cardBag.splice(t,1),this.close(),cc.audioEngine.playEffect(window.sound.delete)},close:function(){this.node.destroy(),window.deleteLayer=null}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],CardManager:[function(t,e,i){"use strict";cc._RF.push(e,"0cd22DS0RpC5p0+WtMO4gQ6","CardManager");var c=t("Game"),o=t("Config"),n={doCast:function(t,e){this.cfgId=t;var i=o.get("cfg_card",t);if(this.desc=i.desc,this.card=e,this.chaos=!1,1==i.target1||1==i.target2||1==i.target3)if(window.player.atkPlayed++,window.player.buff.chaos>0&&Math.random()<.5)window.player.buff.removeBuff(29,1),this.chaos=!0;else if(window.opponent.buff.dodge>0)return window.opponent.buff.removeBuff(13,1),window.opponent.assertHpChange("MISS",2),void window.opponent.equip.trigger(109);i.effect1>0&&(this.doEffect(i.effect1,i.num1,i.target1),!window.mainLayer.gameOver&&i.effect2>0&&(this.doEffect(i.effect2,i.num2,i.target2),!window.mainLayer.gameOver&&i.effect3>0&&this.doEffect(i.effect3,i.num3,i.target3))),this.doSpecial(t)},doEffect:function(t,e,i){1==i&&this.chaos&&(i=2);var c=null,o=(c=0==window.mainLayer.roundId&&1==i||1==window.mainLayer.roundId&&2==i?window.mainLayer.enemy:window.mainLayer.hero).buff,n=window.player.buff,a=0,s=1;if((e+="")<0){for(var r=["A","B","C","D","E","F"],d=0,h=0;h<6;h++)if(this.desc.indexOf(r[h])>=0){d=h;break}a=window.player.elementList[d]*Math.abs(parseInt(e))}else{var l=e.split(";");if(8==t)a=parseInt(l[0]),s=parseInt(l[1]);else if(1==l.length)a=parseInt(e);else{var u=parseInt(l[0]),f=parseInt(l[1]);a=3==t&&window.player.equip.checkWithTrigger(120)?f:Math.floor(Math.random()*(f-u+1))+u}}if(t<10){if(1==i){if(a*=Math.pow(2,n.doubleDmg),n.removeBuff(107,n.doubleDmg),window.player.equip.wolfBlood&&n.addBuff(107,1),n.weak>0){var p=.7;window.opponent.equip.checkWithTrigger(55)&&(p=.5),a=Math.round(a*p)}1==window.player.atkPlayed&&window.player.equip.checkWithTrigger(100)&&(a*=2)}if(1==s)c.onHurt(a,0,t,i);else for(var m=0;m<s;m++)c.scheduleOnce(function(){c.onHurt(a,0,t,i)}.bind(this),.1*m)}else 11==t?c.player.updateArmor(a):12==t?c.onHeal(a):14==t?c.addPower&&c.addPower(a):(13==t||t>=21)&&o.addBuff(t,a)},doSpecial:function(t){var e=window.opponent.buff,i=window.player.buff;if(132==t)this.doEffect(11,window.host.armor,2);else if(133==t)this.doEffect(7,Math.floor(window.host.armor/2),1);else if(134==t)this.doEffect(7,2*window.host.armor,1),window.player.updateArmor(-window.host.armor);else if(135==t)this.doEffect(7,window.host.hpMax-window.host.hp,1);else if(136==t)this.doEffect(11,window.host.hpMax-window.host.hp,2);else if(137==t)this.doEffect(7,Math.floor(window.host.hp/2),1);else if(138==t)i.addBuff(102,2);else if(139==t)i.addBuff(101,1);else if(140==t)window.player.rollCount++,window.player.roll(!1,Math.floor(6*Math.random())+1);else if(141==t)null!=window.host.power&&(this.doEffect(7,2*window.host.power,1),window.host.addPower(-window.host.power));else if(142==t)null!=window.host.power&&(this.doEffect(11,window.host.power,2),window.host.addPower(-window.host.power));else if(143==t)null!=window.host.power&&(this.doEffect(12,window.host.power,2),window.host.addPower(-window.host.power));else if(144==t)this.doEffect(7,2*e.poison,1);else if(145==t)this.doEffect(7,4*e.poison,1),e.removeBuff(26,e.table[26]);else if(146==t)e.addBuff(26,e.poison);else if(147==t){for(var n=window.player.deck,a=0,s=0;s<n.length;s++){var r=o.get("cfg_card",n[s]);23!=r.effect1&&23!=r.effect2&&23!=r.effect3||a++}var d=20+4*a;this.doEffect(3,"4;"+d,1)}else if(148==t){var h=e.weak>0?20:10;this.doEffect(4,h,1)}else if(149==t)e.poison>0&&this.doEffect(26,2,1);else if(150==t){h=e.burn>0?16:8;this.doEffect(1,h,1)}else if(151==t)e.freeze>0&&this.doEffect(22,1,1);else if(152==t)e.silence>0&&this.doEffect(25,1,1);else if(t>=153&&t<=158){var l=[2,3,5,0,1,4][t-153];window.player.elementList[l]>=[2,2,2,3,3,3][t-153]&&this.doEffect(l+21,[1,1,2,2,2,1][t-153],1)}else if(t>=159&&t<=162)e.addBuff(Math.floor(10*Math.random())+21,162==t?2:1);else if(t>=163&&t<=166)this.doEffect(108,1,2);else if(167==t)i.multiCast++,i.multiCastMax++;else if(t>=168&&t<=171)this.doEffect(107,1,2);else if(172==t)this.doEffect(22,window.opponent.diceCount+window.opponent.extraDice-e.freeze,1);else if(173==t)this.doEffect(21,window.opponent.deck.length-e.burn,1);else if(174==t)this.doEffect(1,6*e.burn,1);else if(175==t)this.doEffect(7,6*e.freeze,1);else if(176==t)this.doEffect(7,6*e.silence,1);else if(177==t)this.doEffect(7,4*e.frail,1);else if(178==t)this.doEffect(7,4*e.weak,1);else if(t>=179&&t<=182){h=(u=[1,6,6,10])[t-179]+(f=[3,2,3,4])[t-179]*(i.iteraList[t-179]-1);this.doEffect(7,h,1)}else if(t>=183&&t<=186){var u=[8,13,15,21],f=[3,3,4,5];a=Math.min(i.iteraList[t-179]-1,[2,4,3,4][t-183]),h=u[t-183]-f[t-183]*a;this.doEffect(7,h,1)}else if(187==t)this.doEffect(11,6+2*i.elementRoundCasted[3],2);else if(188==t)this.doEffect(12,6+2*i.elementRoundCasted[4],2);else if(189==t)this.doEffect(26,2*i.elementRoundCasted[5],1);else if(190==t)this.doEffect(1,12+3*i.elementRoundCasted[0],1);else if(191==t)this.doEffect(2,10+3*i.elementRoundCasted[1],1);else if(192==t)this.doEffect(3,12+3*i.elementRoundCasted[2],1);else if(193==t){if((a=Math.min(window.opponent.deck.length,6))>0){var p=Math.floor(Math.random()*a),m=window.opponent.deck[p];window.opponent.deck.splice(p,1),window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(194==t){if((a=Math.min(window.opponent.deck.length,6))>0){p=Math.floor(Math.random()*a),m=window.opponent.deck[p];window.player.patchCard(m,!0),window.player.deck.push(m)}}else if(195==t){if((a=Math.min(window.opponent.deck.length,6))>0){p=Math.floor(Math.random()*a),m=window.opponent.deck[p];window.player.patchCard(m)}}else if(196==t){var g=c.getRandomCardId(2);window.player.patchCard(g,!0),window.player.deck.push(g)}else if(197==t){g=c.getRandomCardId(2);window.player.patchCard(g,null,!0)}else if(198==t||376==t){var y=function(){var t=window.player.patchCard();t&&(2!=t.getComponent("Card").element&&window.player.cardList.length<6?t.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){y()}.bind(this)))):window.player.scheduleOnce(function(){1==window.mainLayer.roundId&&(window.mainLayer.gameOver||window.mainLayer.enemy.ai.check())}.bind(this),.8))}.bind(this);y()}else if(199==t)window.player.diceCount++,window.player.createExDice();else if(200==t)window.player.createExDice(),window.player.scheduleOnce(function(){window.player.createExDice()}.bind(this),.4);else if(201==t){for(var v=21;v<=30;v++)i.removeBuff(v,i.table[v]);for(var w=0;w<window.player.cardList.length;w++)window.player.cardList[w].getComponent("Card").clear();for(var b=0;b<window.player.diceList.length;b++)window.player.diceList[b].getComponent("Dice").clear();window.player.checkElement()}else if(202==t){for(var C=0,x=21;x<=30;x++)e.table[x]>0&&C++;this.doEffect(7,6*C,1)}else if(203==t)window.player.addRollCount();else if(204==t)window.player.rollCount++,window.player.roll();else if(205==t){if(window.player.cardList.length>0){p=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[p].getComponent("Card").discard(),this.doEffect(7,15,1)}}else if(206==t||207==t){if(window.player.cardList.length>0){p=Math.floor(Math.random()*window.player.cardList.length);window.player.cardList[p].getComponent("Card").discard(null,!0),this.doEffect(7,206==t?25:30,1)}}else if(208==t){this.doEffect(7,5*window.player.cardList.length,1);for(var L=[],k=0;k<window.player.cardList.length;k++)L.push(window.player.cardList[k].getComponent("Card"));for(var T=0;T<L.length;T++)L[T].discard()}else if(t>=209&&t<=214){u=214==t?2:1;this.doEffect(t-209+21,u+i.iteraList2[t-209]-1,1)}else if(215==t)window.opponent.buff.burnIce=!0;else if(216==t)window.opponent.buff.silenceDark=!0;else if(217==t)c.data.hpMax+=2,window.host.hpMax+=2,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(218==t){g=c.getRandomCardId(2);window.player.patchCard(g)}else if(219==t)window.player.patchCard();else if(220==t)this.doEffect(3,2*window.player.atkRound-1,1);else if(221==t)i.selfHarmCast++,i.selfHarmCastMax++;else if(222==t)window.host.hpMax+=20,window.host.hp+=20,window.host.txtHp.string=window.host.hp+"/"+window.host.hpMax,window.host.stripHp.progress=window.host.hp/window.host.hpMax;else if(225==t||226==t)window.player.elementList[t-223]>=2&&this.doEffect(7,4,1);else if(227==t||228==t)window.player.elementList[t-225]>=3&&this.doEffect(11,4,2);else if(229==t)window.player.createExDice(3);else if(230==t)window.player.createExDice(4);else if(231==t)1==window.player.cardPlayedRound&&this.doEffect(23,1,1);else if(234==t){d=e.frail>0?30:20;this.doEffect(3,"4;"+d,1)}else if(235==t)i.creatDiceFire++;else if(236==t)window.player.addRollCount();else if(237==t)this.doEffect(7,Math.floor(window.host.hp/2),2),this.doEffect(7,Math.min(30,Math.floor(window.opponent.host.hp/2)),1);else if(238==t)this.doEffect(7,6+6*window.player.createDiceRound[4],1);else if(239==t)i.exCreateDice++;else if(342==t)e.weak>0&&this.doEffect(12,6,2);else if(382==t){window.player.addRollCount();L=[];for(var B=0;B<window.player.cardList.length;B++)L.push(window.player.cardList[B].getComponent("Card"));a=Math.min(L.length,3);for(var I=0;I<a;I++){L[S=Math.floor(Math.random()*L.length)].discard(),L.splice(S,1)}}else if(391==t){this.doEffect(11,5*window.player.cardList.length,2);L=[];for(var A=0;A<window.player.cardList.length;A++)L.push(window.player.cardList[A].getComponent("Card"));for(var E=0;E<L.length;E++)L[E].discard(null,!0)}else if(392==t)window.player.delayCard.push(392);else if(393==t){for(var q=0;q<window.player.diceList.length;q++)window.player.legacyDice.push(window.player.diceList[q].getComponent("Dice").element),window.player.dicePool.put(window.player.diceList[q]);window.player.diceList=[],window.player.checkElement(),window.host.checkBtnRoll()}else if(394==t)window.player.delayCard.push(394);else if(395==t){L=[];for(var N=0;N<window.player.cardList.length;N++)L.push(window.player.cardList[N].getComponent("Card"));a=Math.min(L.length,2);for(var F=0;F<a;F++){var S;L[S=Math.floor(Math.random()*L.length)].discard(null,!0),L.splice(S,1),window.player.createExDice()}}else if(396==t)window.player.delayCard.push(396);else if(397==t)for(var R=0;R<2;R++)window.player.createExDice(),window.player.deck.push(224),window.player.deckArray&&window.player.deckArray.push(224);else if(398==t)this.doEffect(7,5*window.player.diceList.length,1);else if(399==t){L=[];for(var M=0;M<window.player.cardList.length;M++){var D=window.player.cardList[M].getComponent("Card");1==D.element&&L.push(D)}if(L.length>0){var P=L[Math.floor(Math.random()*L.length)];this.doCast(P.cfgId)}}else if(400==t){L=[];for(var O=0;O<window.player.cardList.length;O++){var H=window.player.cardList[O].getComponent("Card");2==H.element&&L.push(H)}if(L.length>0)L[Math.floor(Math.random()*L.length)].discard()}else if(401==t)i.doubleWind=!0;else if(402==t){L=[];for(var _=0;_<window.player.cardList.length;_++){var G=window.player.cardList[_].getComponent("Card");4==G.element&&L.push(G)}if(L.length>0)L[Math.floor(Math.random()*L.length)].discard(null,!0)}else if(403==t){if(U=window.player.deckArray)for(var z=0;z<U.length;z++)if(5==o.get("cfg_card",U[z]).element){window.player.patchCard(U[z],!0)&&U.splice(z,1);break}}else if(405==t)1==window.player.cardPlayedRound&&window.player.createExDice(1,!0);else if(406==t)window.player.diceList.length<=0&&window.player.createExDice(2,!0);else if(407==t){var U;if(U=window.player.deckArray)for(var W=0;W<U.length;W++){var Y=o.get("cfg_card",U[W]);if(11==Y.effect1||11==Y.effect2||11==Y.effect3){window.player.patchCard(U[W],!0)&&U.splice(W,1);break}}}else if(408==t)window.opponent.host.armor>0&&window.opponent.updateArmor(-window.opponent.host.armor);else if(409==t)if(0==window.player.index){for(var X=0;X<=0;){var J=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1,Q=o.get("cfg_item",J);Q.get<3&&(0==Q.hero||4==Q.hero)&&Q.battle&&0==Q.num&&(X=J)}window.player.equip.addEquip(X)}else{var j=Math.floor(Math.random()*Object.keys(o.jsonTable.cfg_item).length)+1;window.player.equip.addEquip(j)}else 410==t&&(0==window.player.index?this.doEffect(7,3*c.data.equip.length,1):this.doEffect(7,3*window.host.equipList.length,1))},doDiscard:function(t){383==t?this.doEffect(1,12,1):384==t?this.doEffect(2,12,1):385==t?this.doEffect(3,12,1):386==t?this.doEffect(11,12,2):387==t?this.doEffect(12,10,2):388==t?this.doEffect(9,8,1):389==t?this.doEffect(22,3,1):390==t&&this.doEffect(27,2,1)},doDelayEffect:function(t){392==t?null!=window.host.power&&this.doEffect(7,2*window.host.power,1):394==t?(window.player.buff.addBuff(104,3),window.player.buff.tempBuff[1]+=3):396==t&&(window.player.extraDice+=2)}};e.exports=n,cc._RF.pop()},{Config:"Config",Game:"Game"}],CardTavern:[function(t,e,i){"use strict";cc._RF.push(e,"a4f5bK9YrVNG5vdkkTG5T0R","CardTavern");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,bgFront:cc.Node,bgBack:cc.Node,bgBase:cc.Node,bgEmpty:cc.Node,txtDesc1:cc.RichText,txtDesc2:cc.RichText,txtRequire:cc.Label,mask:cc.Node,requirePrefab:cc.Prefab,requireNode:cc.Node,circleNode:cc.Node},init:function(t){this.cfgId=t,this.cfg=o.get("cfg_tavern",t),this.require=this.cfg.require,this.initInfo(),cc.loader.loadRes("Texture/UI/tavern/card"+(this.cfgId>=19?2:1),cc.SpriteFrame,function(t,e){this.bgFront.getComponent(cc.Sprite).spriteFrame=e,this.bgBack.getComponent(cc.Sprite).spriteFrame=e,this.bgEmpty.getComponent(cc.Sprite).spriteFrame=e}.bind(this)),this.mask.active=!0,this.usable=!1},initInfo:function(){cc.loader.loadRes("Texture/UI/yahtzee/reward"+this.cfg.icon,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this));var t=c.analysisDesc(this.cfg.desc1);this.txtDesc1.string=this.txtDesc2.string=t,this.circleNode.removeAllChildren(),this.requireCircles=[];var e=this.cfg.require;if(this.requireNode.y=20,this.txtDesc1.node.height<30?this.requireNode.y-=10:this.txtDesc1.node.height<50&&(this.requireNode.y-=5),e>=100&&e<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][e-100];for(var i=[[0],[17,-17],[-30,-56,56,30],[35,0,-35],[52,17,-17,-52]][e-100],o=0;o<i.length;o++)this.createCircle(0,i[o])}else{this.txtRequire.string="",this.requireNode.y-=10;for(var n=e.split(";"),a=(i=[[0],[-29,29],[-52,0,52],[-78,-26,26,78]][n.length-1],0);a<n.length;a++){this.createCircle(parseInt(n[a]),i[a]).zIndex=4-a}}},createCircle:function(t,e){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(t,this.cfgId>=19?-2:-1),i.position=cc.v2(e,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},checkRequire:function(){if(this.usable)return!0;var t=!1,e=window.player.elementList.concat();if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],c=102==this.require?2:1,o=[],n=0;n<6;n++)e[n]>=i[this.require-100]&&(c--,o.push(n+1)),102==this.require&&e[n]>=4&&(c-=2,o.push(n+1),o.push(n+1));if(c<=0&&(t=!0),102!=this.require){var a=0,s=this.requireCircles[0].getComponent("RequireRound").element;if(s)o.indexOf(s)<0&&(a=o.length>0?1:-1);else o.length>0&&(a=1);for(var r=0;r<this.requireCircles.length;r++){var d=this.requireCircles[r].getComponent("RequireRound");1==a?(d.refreshElement(o[0]),d.refreshSatisfy(!0)):-1==a&&d.hideElement()}}else{var h,l=[null,null],u=[0,0],f=this.requireCircles[0].getComponent("RequireRound").element,p=this.requireCircles[2].getComponent("RequireRound").element;if(f)(h=o.indexOf(f))>=0&&(l[0]=0,o.splice(h,1),u[0]=f);if(p)(h=o.indexOf(p))>=0&&(l[1]=0,o.splice(h,1),u[1]=f);for(var m=0;m<2;m++){if(null==l[m])(0==m?f:p)?o.length>0?(l[m]=1,u[m]=o[0],o.splice(0,1)):l[m]=-1:o.length>0?(l[m]=1,u[m]=o[0],o.splice(0,1)):l[m]=0}for(var g=0;g<this.requireCircles.length;g++){var y=this.requireCircles[g].getComponent("RequireRound"),v=g<2?0:1;1==l[v]?(y.refreshElement(u[v]),y.refreshSatisfy(!0)):-1==l[v]&&y.hideElement()}}}else{for(var w=[0,0,0,0,0,0],b=this.require.split(";"),C=0;C<b.length;C++)w[b[C]-1]++;t=!0;for(var x=0;x<6;x++)if(e[x]<w[x]){t=!1;break}for(var L=0;L<this.requireCircles.length;L++){var k=this.requireCircles[L].getComponent("RequireRound");e[k.element-1]>0?(k.refreshSatisfy(!0),e[k.element-1]--):k.refreshSatisfy(!1)}}return this.usable=t,t?(this.mask.active=!1,this.bingo(),cc.audioEngine.playEffect(window.sound.bingo)):this.mask.active=!0,t},bingo:function(){this.scheduleOnce(function(){this.bgFront.runAction(cc.scaleTo(.2,1,0)),this.bgBack.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.2,1,1),cc.scaleTo(.2,1,.8),cc.scaleTo(.2,1,1))),this.bgBase.runAction(cc.sequence(cc.scaleTo(.2,1,.1),cc.scaleTo(.2,1,1),cc.scaleTo(.2,1,.85),cc.scaleTo(.2,1,1)))}.bind(this),.1)},change:function(t){this.bgEmpty.active=!0,this.bgFront.stopAllActions(),this.bgBack.stopAllActions(),this.usable?(this.bgFront.scaleY=0,this.bgFront.runAction(cc.sequence(cc.delayTime(.75),cc.scaleTo(.15,1,1),cc.scaleTo(.15,1,.8),cc.scaleTo(.15,1,1))),this.bgBack.runAction(cc.scaleTo(.15,1,0))):(this.bgFront.runAction(cc.sequence(cc.scaleTo(.15,1,0),cc.delayTime(.6),cc.scaleTo(.15,1,1),cc.scaleTo(.15,1,.8),cc.scaleTo(.15,1,1))),this.bgBack.scaleY=0),this.bgEmpty.runAction(cc.sequence(cc.delayTime(.15),cc.sequence(cc.scaleTo(.15,1,1),cc.scaleTo(.15,1,0)).repeat(3))),this.bgBase.runAction(cc.sequence(cc.sequence(cc.scaleTo(.15,1,.1),cc.scaleTo(.15,1,1)).repeat(3),cc.scaleTo(.15,1,.85),cc.scaleTo(.15,1,1))),this.scheduleOnce(function(){this.cfgId=t,this.cfg=o.get("cfg_tavern",t),this.require=this.cfg.require,this.initInfo(),this.mask.active=!0,this.usable=!1}.bind(this),.15),this.scheduleOnce(function(){this.checkRequire()}.bind(this),1.2)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Card:[function(t,e,i){"use strict";cc._RF.push(e,"cfa35/uH59ANIsjw79G+feg","Card");var c=t("Game"),o=t("Config"),n=t("CardManager");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Label,txtTitle2:cc.Label,txtDesc:cc.RichText,txtRequire:cc.Label,mask:cc.Node,btn:cc.Button,title:cc.Node,fires:dragonBones.ArmatureDisplay,nodeSilence:cc.Node,markSilence:cc.Node,markDelete:cc.Node,animationCursed:cc.Node,animationDiscard:dragonBones.ArmatureDisplay,animationCounter:cc.Node,requirePrefab:cc.Prefab,titles:[cc.Node],requireNode:cc.Node,circleNode:cc.Node,maskWhite:cc.Node,maskBlack:cc.Node},init:function(t,e,i,n){this.cfgId=t,this.index=e,this.buffId=i,this.pos=cc.v2(e%3,Math.floor(e/3)),this.delta=0==window.mainLayer.roundId?1:-1,this.node.position=cc.v2(248*this.pos.x-248,99-210*this.pos.y-500*this.delta),this.node.zIndex=2-this.pos.y,this.btn.interactable=!1,this.node.opacity=1,this.cfg=o.get("cfg_card",t),this.element=this.cfg.element,this.initInfo(),this.mask.active=!0,this.btn.node.active=!0,this.nodeSilence.active=this.fires.node.active=this.animationCursed.active=this.animationDiscard.node.active=this.animationCounter.active=this.markDelete.active=!1,this.isRemove=this.cfg.exile,this.usable=!1,this.isCopy=!1,this.isTemp=!1,this.hasCopy=!1,this.unCost=!1,this.rate=1;var a=this.require=this.cfg.require;if(a>=100&&a<=107){this.rate=[1,1/6,1/72,1/36,1/216,1/1296,1/216,1/1296][a-100]}else{this.rate=[1/6,1/36,1/216,1/1296,1/7776][a.split(";").length-1]}0==window.mainLayer.roundId&&4==c.data.heroId&&this.disCost(!0),n||this.show()},show:function(){var t=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,99-210*this.pos.y+20*this.delta)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.2*this.pos.y),t,cc.moveBy(.05,cc.v2(0,20*-this.delta)))),cc.audioEngine.playEffect(window.sound.drawSound)},initInfo:function(){var t=[cc.color(117,29,28),cc.color(28,50,133),cc.color(15,97,51),cc.color(148,78,29),cc.color(153,123,33),cc.color(92,45,115),cc.color(91,91,91)],e=[cc.color(203,44,46),cc.color(22,104,224),cc.color(0,183,79),cc.color(230,121,30),cc.color(188,160,0),cc.color(169,80,228),cc.color(133,133,133)],i=[cc.color(205,48,39),cc.color(25,84,218),cc.color(0,158,64),cc.color(229,104,24),cc.color(184,144,0),cc.color(152,63,225),cc.color(119,119,119)];this.btn.node.color=t[this.element-1],this.title.color=e[this.element-1],this.titles[0].active=!1,this.titles[1].active=!1,this.cfg.quality>1&&(this.titles[this.cfg.quality-2].active=!0,this.titles[this.cfg.quality-2].color=i[this.element-1]),this.txtTitle.string=this.txtTitle2.string=this.cfg.name,this.initDesc(),this.circleNode.removeAllChildren(),this.requireCircles=[];var c=this.cfg.require;if(this.requireNode.y=2,this.txtDesc.node.height<25?this.requireNode.y-=10:this.txtDesc.node.height<45&&(this.requireNode.y-=5),c>=100&&c<=107){this.txtRequire.string=["","\u4e00\u5bf9","\u4e24\u5bf9","3\u4e2a\u76f8\u540c","4\u4e2a\u76f8\u540c"][c-100];for(var o=[[0],[17,-17],[-30,-56,56,30],[35,0,-35],[52,17,-17,-52]][c-100],n=0;n<o.length;n++)this.createCircle(0,o[n])}else{this.txtRequire.string="",this.requireNode.y-=10;for(var a=c.split(";"),s=(o=[[0],[-29,29],[-52,0,52],[-78,-26,26,78]][a.length-1],0);s<a.length;s++){this.createCircle(parseInt(a[s]),o[s]).zIndex=4-s}}},initWithCopy:function(t,e){this.cfgId=t,this.pos=e,this.isCopy=!0,this.isTemp=!0,this.cfg=o.get("cfg_card",t),this.require=this.cfg.require,this.initBuff(),this.initDesc()},remove:function(t){this.usable=!1,this.btn.interactable=!1;var e=t?.3:0;this.scheduleOnce(function(){if(this.node.zIndex=0,0==window.mainLayer.roundId){var t=cc.moveBy(.2,cc.v2(0,500*-this.delta));this.node.runAction(cc.sequence(cc.delayTime(.15*(1-this.pos.y)),cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}else{t=cc.spawn(cc.moveBy(.2,cc.v2(0,500*-this.delta)),cc.fadeOut(.25));this.node.runAction(cc.sequence(cc.delayTime(.15*this.pos.y),cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.cardPool.put(this.node)}.bind(this))))}var e=window.player.cardList.indexOf(this.node);e>=0&&(window.player.cardList.splice(e,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}.bind(this),e)},createCircle:function(t,e){var i=cc.instantiate(this.requirePrefab);return i.getComponent("RequireRound").init(t,this.element),i.position=cc.v2(e,24),this.circleNode.addChild(i),this.requireCircles.push(i),i},initBuff:function(){6==this.element&&window.opponent.equip.checkWithTrigger(172)&&window.mainLayer.hero.round%2==1&&(this.buffId=25);var t=this.buffId;this.burn=21==t,this.burn?(this.fires.node.active=!0,this.fires.playAnimation("play0",0),cc.audioEngine.playEffect(window.sound.burnSound)):this.fires.node.active=!1,this.silence=25==t,this.silence?(this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1,this.nodeSilence.active=!0}.bind(this)))),this.markSilence.stopAllActions(),this.markSilence.y=130,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5))),cc.audioEngine.playEffect(window.sound.blackSound)):this.nodeSilence.active=!1},checkRequire:function(){var t=!1,e=window.player.elementList.concat();if(0==window.player.index&&4==c.data.heroId)t=this.element<7?e[this.element-1]>0:window.player.diceList.length>0;else if(this.require>=100&&this.require<=105){for(var i=[1,2,2,3,4,5],o=102==this.require?2:1,n=[],a=0;a<6;a++)e[a]>=i[this.require-100]&&(o--,n.push(a+1)),102==this.require&&e[a]>=4&&(o-=2,n.push(a+1),n.push(a+1));if(o<=0&&(t=!0),102!=this.require){var s=0,r=this.requireCircles[0].getComponent("RequireRound").element;if(r)n.indexOf(r)<0&&(s=n.length>0?1:-1);else n.length>0&&(s=1);for(var d=0;d<this.requireCircles.length;d++){var h=this.requireCircles[d].getComponent("RequireRound");1==s?(h.refreshElement(n[0]),h.refreshSatisfy(!0)):-1==s&&h.hideElement()}}else{var l,u=[null,null],f=[0,0],p=this.requireCircles[0].getComponent("RequireRound").element,m=this.requireCircles[2].getComponent("RequireRound").element;if(p)(l=n.indexOf(p))>=0&&(u[0]=0,n.splice(l,1),f[0]=p);if(m)(l=n.indexOf(m))>=0&&(u[1]=0,n.splice(l,1),f[1]=p);for(var g=0;g<2;g++){if(null==u[g])(0==g?p:m)?n.length>0?(u[g]=1,f[g]=n[0],n.splice(0,1)):u[g]=-1:n.length>0?(u[g]=1,f[g]=n[0],n.splice(0,1)):u[g]=0}for(var y=0;y<this.requireCircles.length;y++){var v=this.requireCircles[y].getComponent("RequireRound"),w=y<2?0:1;1==u[w]?(v.refreshElement(f[w]),v.refreshSatisfy(!0)):-1==u[w]&&v.hideElement()}}}else{for(var b=[0,0,0,0,0,0],C=this.require.split(";"),x=0;x<C.length;x++)b[C[x]-1]++;t=!0;for(var L=0;L<6;L++)if(e[L]<b[L]){t=!1;break}for(var k=0;k<this.requireCircles.length;k++){var T=this.requireCircles[k].getComponent("RequireRound");e[T.element-1]>0?(T.refreshSatisfy(!0),e[T.element-1]--):T.refreshSatisfy(!1)}}return this.unCost&&(t=!0),this.silence&&(t=!1),224==this.cfgId&&(t=!1),this.usable=t,t?(this.mask.active=!1,this.btn.interactable=!0):this.silence?(this.mask.active=!1,this.btn.interactable=!0):(this.mask.active=!0,this.btn.interactable=!1),t},doCast:function(){this.usable&&0==window.mainLayer.roundId&&(window.player.cardPlayedRound>=5&&window.player.equip.checkWithTrigger(85)?(this.btn.node.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound),cc.log("\u6700\u591a\u4f7f\u75285\u5f20\u724c")):this.silence?(this.markSilence.stopAllActions(),this.markSilence.y=90,this.markSilence.runAction(cc.sequence(cc.fadeIn(0),cc.moveBy(.5,cc.v2(0,15)),cc.delayTime(.5),cc.fadeOut(.5)))):(this.cast(),window.guide&&window.guide.close()))},cast:function(){if(0==window.mainLayer.roundId){if(this.cfgId>=205&&this.cfgId<=208&&!window.player.cardUsabled)return}else if(!window.player.cardUsabled)return;this.burn&&window.host.onHurt(3,1,21,0);var t=!1,e=!1;if(0==window.player.cardPlayedRound&&window.opponent.equip.trigger(127)?(e=!0,t=!0):window.player.buff.curse&&Math.random()<.5&&(t=!0,window.player.buff.removeBuff(27,1),window.opponent.equip.trigger(108)),this.btn.interactable=!1,window.player.cardUsabled=!1,t)this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){this.maskWhite.active=!1;var t=cc.instantiate(e?this.animationCounter:this.animationCursed);t.active=!0,t.parent=window.player.boxCard,t.position=this.node.position.add(cc.v2(10,-10)),t.zIndex=100,t.getComponent(dragonBones.ArmatureDisplay).playAnimation("play0"),t.getComponent(dragonBones.ArmatureDisplay).on(dragonBones.EventObject.LOOP_COMPLETE,function(){t.destroy()}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(e?0:.1),cc.callFunc(function(){this.maskBlack.active=!1,this.endCast(),198!=this.cfgId&&376!=this.cfgId||1!=window.mainLayer.roundId||this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.5)}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(e?window.sound.counterSound:window.sound.curseSound),window.player.equip.luckyCard>0&&(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43)),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1));else{this.node.zIndex=200;var i=1==this.cfg.target1||1==this.cfg.target2||1==this.cfg.target3?1:2,o=window.player.index+1==i?1:-1,a=cc.spawn(cc.moveBy(.05,cc.v2(0,-20*o)),cc.scaleTo(.05,1)),s=cc.moveBy(.35,cc.v2(0,1100*o)).easing(cc.easeIn(1.5));this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),a,s,cc.callFunc(function(){window.mainLayer.gameOver||(n.doCast(this.cfgId,this),this.endCast())}.bind(this))))}if(!this.isCopy){var r=window.player.cardList.indexOf(this.node);r>=0&&(window.player.cardList.splice(r,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll())}this.cfgId>=179&&this.cfgId<=186?window.player.buff.iteraList[this.cfgId-179]++:this.cfgId>=209&&this.cfgId<=214&&window.player.buff.iteraList2[this.cfgId-209]++;for(var d=0;d<3;d++)if(this.cfg["effect"+(d+1)]<10&&1==this.cfg["target"+(d+1)]){var h=1;8==this.cfg["effect"+(d+1)]&&(h=parseInt(this.cfg["num"+(d+1)].split(";")[1])),window.player.atkRound+=h}for(var l=0;l<window.player.cardList.length;l++){var u=window.player.cardList[l].getComponent("Card");(u.cfgId>=179&&u.cfgId<=186||u.cfgId>=209&&u.cfgId<=214||220==u.cfgId)&&u.initDesc(),232==u.cfgId&&Math.random()<.2&&window.opponent.buff.addBuff(23,1)}t||this.isCopy||(this.cfgId<163||this.cfgId>166)&&(3==this.element&&window.player.buff.doubleWind?(this.reuse(),window.player.buff.doubleWind=!1):233==this.cfgId&&window.opponent.buff.frail>0?this.reuse():window.player.buff.selfHarmCast>0&&this.cfg.effect1<10&&2==this.cfg.target1?(window.player.buff.selfHarmCast--,this.reuse()):window.player.buff.doubleCast>0?(window.player.buff.removeBuff(108,1),this.reuse()):window.player.equip.luckyCard>0?(9==window.player.cardPlayed&&(window.player.equip.luckyCard--,window.player.equip.doTrigger(43),this.reuse()),window.player.equip.refreshItemNum(43,window.player.cardPlayed+1)):window.player.buff.multiCast>0&&(window.player.buff.multiCast<window.player.buff.multiCastMax||Math.random()<.3)&&167!=this.cfgId?(window.player.buff.multiCast--,this.reuse()):Math.random()<.1&&window.player.equip.checkWithTrigger(117)?this.reuse():Math.random()<.3&&window.player.equip.checkWithTrigger(149)&&this.reuse()),this.isRemove&&this.doDelete(),this.isCopy||(window.player.cardPlayed++,window.player.cardPlayedRound++),0==window.player.index&&(4==c.data.heroId?(window.player.deleteDice(this.element),2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId))):2==c.data.heroId&&window.player.randomCard&&window.player.randomCard==this.node&&(window.player.randomCard=null))},endCast:function(){if(!this.isCopy){var t=window.player.equip;if(t.trigger(1),t.trigger(4),t.trigger(97),t.trigger(153),t.trigger(169),this.cfg.element<=6&&t.trigger(this.cfg.element+77),2==this.cfg.element&&t.trigger(157),window.opponent.equip.trigger(24),window.opponent.equip.trigger(166),window.player.cardPlayed%4==0&&window.opponent.equip.trigger(144),this.isRemove&&window.player.equip.trigger(183),0==window.player.index&&(2==c.data.heroId?2==c.data.difficulty?(window.player.rollCount++,window.player.roll()):window.player.addRollCount():4==c.data.heroId&&(window.player.suppleCard(),c.data.cardPlayed[this.cfgId]?c.data.cardPlayed[this.cfgId]++:c.data.cardPlayed[this.cfgId]=1)),window.player.buff.multiCastMax>0&&window.player.buff.multiCast<=0&&(window.player.buff.multiCast=window.player.buff.multiCastMax),window.player.buff.selfHarmCastMax>0&&window.player.buff.selfHarmCast<=0&&(window.player.buff.selfHarmCast=window.player.buff.selfHarmCastMax),window.player.buff.elementRoundCasted[this.cfg.element-1]++,window.player.equip.elementPlayed[this.cfg.element-1]++,window.player.equip.trigger(184),window.player.equip.trigger(185),6==this.element&&window.player.buff.darkRedice>0)for(var e=0;e<window.player.buff.darkRedice;e++)window.player.createExDice(6,!0);window.player.buff.darkRedice=0,404==this.cfgId&&window.player.buff.darkRedice++}window.player.cardPool.put(this.node),window.player.cardUsabled=!0,1!=window.mainLayer.roundId||this.hasCopy||198!=this.cfgId&&376!=this.cfgId&&this.scheduleOnce(function(){window.mainLayer.gameOver||window.mainLayer.enemy.ai.check()}.bind(this),.6),3==c.data.guide[1]&&2==window.player.cardPlayedRound?window.mainLayer.showGuide(1):0==c.data.guide[2]&&3==window.player.cardPlayedRound&&window.mainLayer.showGuide(2)},discard:function(t,e){this.btn.interactable=!1,this.btn.node.active=!1,this.maskWhite.active=!0,this.maskWhite.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskWhite.active=!1,this.animationDiscard.node.active=!0,this.animationDiscard.playAnimation("play0"),this.animationDiscard.on(dragonBones.EventObject.LOOP_COMPLETE,function(){window.player.cardPool.put(this.node)}.bind(this)),this.maskBlack.active=!0,this.maskBlack.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.maskBlack.active=!1}.bind(this))))}.bind(this)))),cc.audioEngine.playEffect(window.sound.discardSound);var i=window.player.cardList.indexOf(this.node);i>=0&&(window.player.cardList.splice(i,1),0==window.mainLayer.roundId&&window.mainLayer.hero.checkBtnRoll()),e?(this.markDelete.active=!0,this.markDelete.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,-15)),cc.delayTime(.5),cc.fadeOut(.5)))):4==c.data.heroId&&2==c.data.difficulty&&(this.isRemove||this.isCopy||this.isTemp||window.player.cemetery.push(this.cfgId)),t||e?e&&this.doDelete():(n.doDiscard(this.cfgId),window.player.equip.trigger(22),window.player.equip.trigger(182)),0==window.player.index&&4==c.data.heroId&&window.player.suppleCard()},doDelete:function(){if(window.player.equip.trigger(69),window.player.equip.trigger(70),window.player.equip.trigger(181),!this.isTemp){var t=window.player.deck.indexOf(this.cfgId);t>=0&&window.player.deck.splice(t,1)}},reuse:function(){var t=cc.instantiate(this.node);t.position=this.node.position,window.player.boxCard.addChild(t,this.node.zIndex-1),t.getComponent("Card").initWithCopy(this.cfgId,this.pos),this.hasCopy=!0,t.runAction(cc.sequence(cc.delayTime(.8),cc.callFunc(function(){t.getComponent("Card").cast()}.bind(this))))},clear:function(){this.buffId=null,this.initBuff()},initDesc:function(){var t=c.analysisDesc(this.cfg.desc1,0,this.cfg.exile);if(147==this.cfgId){for(var e=window.player.deck,i=0,n=0;n<e.length;n++){var a=o.get("cfg_card",e[n]);23!=a.effect1&&23!=a.effect2&&23!=a.effect3||i++}t+="<color=#CA9300>  (\u4e0a\u9650"+(20+4*i)+")</c>"}else if(this.cfgId>=179&&this.cfgId<=182){var s=[3,2,3,4];t+="<color=#CA9300>  (\u5f53\u524d"+((r=[1,6,6,10])[this.cfgId-179]+s[this.cfgId-179]*window.player.buff.iteraList[this.cfgId-179])+")</c>"}else if(this.cfgId>=183&&this.cfgId<=186){var r=[8,13,15,21];s=[3,3,4,5],i=Math.min(window.player.buff.iteraList[this.cfgId-179],[2,4,3,4][this.cfgId-183]);t+="<color=#CA9300>  (\u5f53\u524d"+(r[this.cfgId-183]-s[this.cfgId-183]*i)+")</c>"}else if(this.cfgId>=209&&this.cfgId<=214){t+="<color=#CA9300>  (\u5f53\u524d"+((r=214==this.cfgId?2:1)+window.player.buff.iteraList2[this.cfgId-209])+")</c>"}else 220==this.cfgId?t+="<color=#CA9300>  (\u5f53\u524d"+(2*window.player.atkRound+1)+")</c>":238==this.cfgId&&(t+="<color=#CA9300>  (\u5f53\u524d"+(6+6*window.player.createDiceRound[4])+")</c>");this.txtDesc.string=t},disCost:function(t){t||(this.unCost=!0);for(var e=0;e<this.requireCircles.length;e++){var i=this.requireCircles[e].getComponent("RequireRound");i.disCost(),this.require>=100&&this.require<=105&&i.hideElement()}},discribeRandom:function(){this.txtTitle.string=this.txtTitle2.string=this.cfg.name+"*"}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game"}],Chess:[function(t,e,i){"use strict";cc._RF.push(e,"52ab21v1YlCW5nnj9YYUNmp","Chess");var c=t("Utils"),o=t("Game");cc.Class({extends:cc.Component,properties:{figureNode:cc.Node,animations:[dragonBones.ArmatureDisplay],waterNode:cc.Node,waterFigures:[cc.Sprite]},onLoad:function(){this.speed=600,this.node.scale=1.1,this.distances=[0,100,80,110,100,150,150,100,100],this.animation=this.animations[o.data.heroId-1];for(var t=0;t<4;t++)t==o.data.heroId-1?this.animations[t].node.active=!0:this.animations[t].node.active=!1;cc.loader.loadRes("Texture/hero/water/water"+o.data.heroId+"3",cc.SpriteFrame,function(t,e){this.waterFigures[0].spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/hero/water/water"+o.data.heroId+"2",cc.SpriteFrame,function(t,e){this.waterFigures[1].spriteFrame=e,this.waterFigures[3].spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/hero/water/water"+o.data.heroId+"1",cc.SpriteFrame,function(t,e){this.waterFigures[2].spriteFrame=e}.bind(this))},come:function(t,e){this.from=t,this.roomType=o.data.roomType,this.node.position=c.getDirectionVector(t,320);var i=c.getDirectionVector(t,this.distances[this.roomType]);this.refreshDiration(t,1),this.doMove(320/this.speed,i,e)},stay:function(t){this.from=t,this.roomType=o.data.roomType;this.node.position=c.getDirectionVector(t,[0,0,0,120,100,160,160,0,0][this.roomType]),this.refreshDiration(t,1),this.doStop()},doMove:function(t,e,i){1==this.direction?(this.animation.node.scaleX=-1,this.animation.playAnimation("Crun")):(this.animation.node.scaleX=1,0==this.direction?this.animation.playAnimation("Brun"):2==this.direction?this.animation.playAnimation("Frun"):this.animation.playAnimation("Crun")),this.node.runAction(cc.sequence(cc.moveTo(t,e),cc.callFunc(function(){i&&i(),this.doStop()}.bind(this))))},doStop:function(){1==this.direction?(this.animation.node.scaleX=-1,this.animation.playAnimation("Cstand")):(this.animation.node.scaleX=1,0==this.direction?this.animation.playAnimation("Bstand"):2==this.direction?this.animation.playAnimation("Fstand"):this.animation.playAnimation("Cstand"))},leave:function(t,e){this.farward=t,this.callBack=e;var i=c.getDirectionVector(t,320);if(this.roomType<=2||this.roomType>=7)this.refreshDiration(t),this.doMove(320/this.speed,i,e);else{if(this.from==(t+2)%4)if(0==t||2==t){var o=Math.random()<.5?1:3;this.stepList=[o,t,t,4-o]}else this.stepList=[2,t,t,0];else this.stepList=[t,(this.from+2)%4];this.doStep()}},doStep:function(){if(this.stepList.length>0)this.walk(this.stepList.shift());else{this.refreshDiration(this.farward);var t=c.getDirectionVector(this.farward,320),e=t.sub(this.node.position).mag();this.doMove(e/this.speed,t,this.callBack)}},walk:function(t){var e=this.distances[this.roomType];this.refreshDiration(t),this.doMove(e/this.speed*1.2,this.node.position.add(c.getDirectionVector(t,e)),function(){this.doStep()}.bind(this))},refreshDiration:function(t,e){var i=e?(t+2)%4:t;this.refreshFace(i),0==t?this.node.zIndex--:2==t&&this.node.zIndex++},refreshFace:function(t){if(2==this.roomType)for(var e=0;e<4;e++)this.waterFigures[e].node.active=t==e;this.direction=t},centerial:function(){var t=this.node.position.mag()/this.speed;this.doMove(t,cc.v2())},update:function(){2==this.roomType&&(this.figureNode.active?this.node.position.mag()<140&&(this.figureNode.active=!1,this.waterNode.active=!0):this.waterNode.active&&this.node.position.mag()>140&&(this.figureNode.active=!0,this.waterNode.active=!1))}}),cc._RF.pop()},{Game:"Game",Utils:"Utils"}],Chest:[function(t,e,i){"use strict";cc._RF.push(e,"282832AcdZFNov+QpH9gQcZ","Chest");var c=t("Utils");cc.Class({extends:cc.Component,properties:{txtRequire:cc.RichText,btn:cc.Button},init:function(t){this.index=t,this.node.position=cc.v2(240*t-240,-500),this.btn.node.color=cc.Color.GRAY,this.node.opacity=1;var e=cc.spawn(cc.moveTo(.25,cc.v2(this.node.x,20)),cc.fadeIn(.15));this.node.runAction(cc.sequence(cc.delayTime(.3),e,cc.moveBy(.05,cc.v2(0,-20)))),this.satisfied=[!1,!1,!1,!1,!1,!1],this.requireList=c.getDifferentRandomNum(4,6,1),this.refreshRequire()},refreshRequire:function(){this.usable=!0;for(var t="",e=["\u706b","\u6c34","\u98ce","\u571f","\u5149","\u6697"],i=0;i<this.requireList.length;i++){var c=this.requireList[i];this.satisfied[c-1]?t+="<color=#EBC82E>"+e[c-1]+"</c>":(t+="<color=#000000>"+e[c-1]+"</c>",this.usable=!1)}this.txtRequire.string=t,this.usable&&(this.btn.interactable=!0,this.btn.node.color=cc.Color.WHITE)},remove:function(){this.btn.interactable=!1;var t=cc.moveBy(.2,cc.v2(0,-500));this.node.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.1,cc.v2(0,20)),t,cc.callFunc(function(){this.node.destroy()}.bind(this)))),window.player.chestList[this.index]=null},checkRequire:function(){for(var t=window.player.elementList,e=0;e<6;e++)t[e]>0&&!this.satisfied[e]&&(this.satisfied[e]=!0);this.refreshRequire()},doCast:function(){this.remove();for(var t=0;t<6;t++)window.player.patchCard()}}),cc._RF.pop()},{Utils:"Utils"}],ChooseDiceLayer:[function(t,e,i){"use strict";cc._RF.push(e,"a7b85fk8JhBnoBwYoqOsmoi","ChooseDiceLayer"),cc.Class({extends:cc.Component,properties:{mask:cc.Node,diceNode:cc.Node,dice:cc.Prefab},onLoad:function(){window.chooseDiceLayer=this,this.mask.opacity=10,this.mask.runAction(cc.fadeTo(.2,120)),this.createDice()},createDice:function(){var t=[];for(window.player.buff.creatDiceFire>0&&(t.push(1),window.player.buff.creatDiceFire--);t.length<3;){var e=Math.floor(6*Math.random())+1;t.indexOf(e)<0&&t.push(e)}for(var i=0;i<3;i++){var c=cc.instantiate(this.dice);c.x=425,this.diceNode.addChild(c),c.getComponent("DiceChoose").init(t[i],i)}},close:function(){window.chooseDiceLayer=null,this.node.destroy()}}),cc._RF.pop()},{}],CompleteLayer:[function(t,e,i){"use strict";cc._RF.push(e,"137d1d4ppZM6ZQ8/MhO2Xgg","CompleteLayer");var c=t("Game"),o=t("Utils"),n=t("Config");cc.Class({extends:cc.Component,properties:{txtDuration:cc.Label,heads:[cc.Sprite],txtTime:cc.Label,cardPrefab:cc.Prefab,cardNode:cc.Node,itemNode:cc.Node,btnShare:cc.Node,btnRestart:cc.Node,itemPrefab:cc.Prefab,txtScore:cc.Label,heroCardPrefab:cc.Prefab,bg:cc.Node,box:cc.Node,scoreNode:cc.Node,timeNode:cc.Node,title:cc.Node,monstersNode:cc.Node},onLoad:function(){window.completeLayer=this;var t=new Date,e=t.getTime()-c.data.startTime;c.data.duration+=e,c.data.totalTime+=e,c.data.startTime=0,c.saveData(),this.txtScore.string=c.score,this.txtDuration.string=o.timeFormat(c.data.duration,2);var i=function(t){return t<10?"0"+t:t};this.txtTime.string=t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate())+" "+i(t.getHours())+":"+i(t.getMinutes()),this.initMonster(),this.initDeck(),this.initEquip(),this.btnRestart.y-=280,this.btnRestart.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(0,280))));var n=cc.instantiate(this.heroCardPrefab);n.getComponent("HeroCard").init(c.data.heroId,c.data.difficulty),n.scale=.65,n.position=cc.v2(-198,390),this.box.addChild(n),cc.audioEngine.playEffect(window.sound.cheer),this.doActions()},doActions:function(){this.bg.x+=750,this.bg.opacity=0,this.bg.runAction(cc.spawn(cc.fadeIn(.25),cc.moveBy(.25,cc.v2(-750,0)))),this.title.x+=350,this.title.opacity=0,this.title.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(-350,0))))),this.scoreNode.x+=350,this.scoreNode.opacity=0,this.scoreNode.runAction(cc.sequence(cc.delayTime(.4),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(-350,0))))),this.monstersNode.x+=350,this.monstersNode.opacity=0,this.monstersNode.runAction(cc.sequence(cc.delayTime(.6),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(-350,0))))),this.timeNode.x+=350,this.timeNode.opacity=0,this.timeNode.runAction(cc.sequence(cc.delayTime(.8),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(-350,0))))),this.cardNode.x+=750,this.cardNode.opacity=0,this.cardNode.runAction(cc.sequence(cc.delayTime(1),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(-750,0))))),this.itemNode.x+=750,this.itemNode.opacity=0,this.itemNode.runAction(cc.sequence(cc.delayTime(1.2),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(-750,0))))),this.btnShare.y-=50,this.btnShare.opacity=1,this.btnShare.runAction(cc.sequence(cc.delayTime(1.5),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))),this.btnRestart.y-=50,this.btnRestart.opacity=1,this.btnRestart.runAction(cc.sequence(cc.delayTime(1.5),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50)))))},initMonster:function(){for(var t=this,e=[],i=0;i<c.data.monsterBeats.length;i++){var o=c.data.monsterBeats[i];n.get("cfg_monster",o).type>=2&&e.push(o)}for(var a=function(i){var c=t.heads[i];cc.loader.loadRes("Texture/monster/head/"+e[i],cc.SpriteFrame,function(t,e){c.spriteFrame=e}.bind(t))},s=0;s<e.length;s++)a(s)},initDeck:function(){if(this.deck=[],4==c.data.heroId){var t=[];for(var e in c.data.cardPlayed){var i=[e,c.data.cardPlayed[e]];t.push(i)}t.sort(function(t,e){return e[1]-t[1]});for(var o=Math.min(t.length,6),n=0;n<o;n++)this.deck.push(t[n][0])}else this.deck=c.data.deck;for(var a=0;a<this.deck.length;a++){var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(this.deck[a]),s.scale=.82,s.position=cc.v2(a%3*208-208,65-178*Math.floor(a/3)),this.cardNode.addChild(s),s.y-=1e3,s.runAction(cc.sequence(cc.delayTime(a<3?.2:0),cc.moveBy(.3,cc.v2(0,1e3))))}},initEquip:function(){for(var t=Math.max(Math.ceil(c.data.equip.length/2),6),e=500/(t-1),i=0;i<c.data.equip.length;i++){var o=c.data.equip[i],n=cc.instantiate(this.itemPrefab);n.getComponent("Item").init(o,null,!0),n.position=cc.v2(i%t*e-250,28-100*Math.floor(i/t)),this.itemNode.addChild(n)}this.itemNode.y-=480,this.itemNode.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.2,cc.v2(0,480))))},restart:function(){window.loadingBrown.doStart(function(){window.completeLayer=null,window.homeLayer=null,window.mainLayer=null,c.setDataToBase(),cc.director.loadScene("cover")}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game",Utils:"Utils"}],Config:[function(t,e,i){"use strict";cc._RF.push(e,"e9b6cHrlOtILogPlENB3GXp","Config");var c={jsonTable:{},load:function(t){for(var e=this,i=["cfg_card","cfg_item","cfg_monster","cfg_event","cfg_hero","cfg_tavern"],c=0,o=function(o){a="Config/"+i[o],cc.loader.loadRes(a,function(e,n){this.jsonTable[i[o]]=n.json,(c+=1)==i.length&&t()}.bind(e))},n=0;n<i.length;n++){var a;o(n)}},get:function(t,e){return this.jsonTable[t][e]}};e.exports=c,cc._RF.pop()},{}],Confirm:[function(t,e,i){"use strict";cc._RF.push(e,"6a327dv6bNOYadBMLYd6D4C","Confirm"),cc.Class({extends:cc.Component,properties:{label:cc.Label,bg:cc.Node,mask:cc.Node},init:function(t,e){window.confirmLayer=this,this.label.string=t,this.callback=e,this.mask.runAction(cc.fadeTo(.2,230)),this.bg.scale=.6,this.bg.runAction(cc.sequence(cc.scaleTo(.2,1.1),cc.scaleTo(.1,1))),this.agree=!1},doOk:function(){this.agree=!0,this.close()},close:function(){cc.audioEngine.playEffect(window.sound.btn1),this.mask.runAction(cc.fadeOut(.2)),this.bg.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,.6),cc.callFunc(function(){this.node.destroy(),window.confirmLayer=null,this.agree&&this.callback()}.bind(this))))}}),cc._RF.pop()},{}],Cover:[function(t,e,i){"use strict";cc._RF.push(e,"ae1236WRt5CIb6OKjZX1HCw","Cover");var c=t("Game");cc.Class({extends:cc.Component,properties:{sky:cc.Node,moon:cc.Node,shadow:cc.Node,smoke:cc.Node,rail2:cc.Node,house2:cc.Node,house1:cc.Node,bg:cc.Node,light:cc.Node,player:cc.Node,player2:cc.Node,table:cc.Node,spider:cc.Node,rail:cc.Node,tree:cc.Node,title:cc.Node,books:[cc.Node],btnStart:cc.Node,btnNew:cc.Node,btnContinue:cc.Node,mask:cc.Node,words:[cc.Node],tip:cc.Node,soundPrefab:cc.Prefab,root:cc.Node,loadingMask:cc.Node,loadingRoll:cc.Node,loadingBrown:cc.Node,settingPrefab:cc.Prefab,confirmPrefab:cc.Prefab,logoMask:cc.Node},onLoad:function(){if(window.cover=this,this.show=!1,this.rate=1,this.node.on(cc.Node.EventType.TOUCH_START,function(){this.rate=2}.bind(this)),this.node.on(cc.Node.EventType.TOUCH_END,function(){this.rate=1}.bind(this)),!window.sound){var t=cc.instantiate(this.soundPrefab);this.root.addChild(t),window.sound=t.getComponent("Sound"),cc.game.addPersistRootNode(this.root),window.loadingMask=this.loadingMask.getComponent("LoadingMask"),window.loadingRoll=this.loadingRoll.getComponent("LoadingRoll"),window.loadingBrown=this.loadingBrown.getComponent("LoadingBrown"),this.root.position=cc.v2(cc.winSize.width/2,cc.winSize.height/2),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(t){t.keyCode!=cc.macro.KEY.backspace&&t.keyCode!=cc.macro.KEY.back||(window.confirmLayer?window.confirmLayer.close():window.settingLayer?window.settingLayer.close():window.cover?window.cover.openSetting():window.homeLayer?window.homeLayer.openSetting():window.mainLayer&&window.mainLayer.openSetting())}.bind(this))}this.doActions()},doActions:function(){this.correctedHeight=(cc.winSize.height/cc.winSize.width*750-1334)/2,this.images=[this.sky,this.moon,this.shadow,this.smoke,this.rail2,this.house2,this.house1,this.bg,this.light,this.player,this.player2,this.table,this.rail,this.tree,this.title],this.pathLength=[556,367,2068,1674,2164,2584,2701,2578,2526,2355,2885,2990,2659,3400,2536],this.tops=[224,557,978,885,892,1187,1290,0,574,-50,-257,-488,865,2358,470],this.speed=.4,this.speedUp=1,c.opening?(this.logoMask.active=!0,this.logoMask.runAction(cc.fadeOut(.3)),this.schedule(this.updateFrame,0),c.opening=!1,this.scheduleOnce(function(){cc.audioEngine.playMusic(window.sound.skySound,!1)}.bind(this),.5),this.scheduleOnce(function(){cc.audioEngine.playMusic(window.sound.coverSound,!0)}.bind(this),5)):(this.doReady(),cc.audioEngine.playMusic(window.sound.coverSound,!0),window.loadingBrown.close())},updateFrame:function(){this.speed>1.2&&(this.speedUp=-1),this.speed+=.7/300*this.speedUp,this.speed=Math.max(.35,this.speed);for(var t=0;t<15;t++)this.images[t].y>=this.tops[t]-this.correctedHeight?(this.images[t].y=this.tops[t]-this.correctedHeight,9!=t||this.show||this.doBtns()):this.images[t].y+=(this.pathLength[t]-this.correctedHeight)/600*this.speed*this.rate},doBtns:function(){this.show=!0;for(var t=0;t<3;t++){this.books[t].runAction(cc.spawn(cc.fadeIn(.25),cc.moveBy(.25,cc.v2(20-20*t,50))))}var e=cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.delayTime(.1),cc.moveBy(.8,cc.v2(0,-5))).repeatForever();this.spider.runAction(cc.sequence(cc.moveBy(.2,cc.v2(0,-130-2*this.correctedHeight)),cc.callFunc(function(){this.spider.runAction(e)}.bind(this)))),this.scheduleOnce(function(){for(var t=0;t<3;t++)this.words[t].y-=40,this.words[t].runAction(cc.spawn(cc.fadeIn(.3),cc.moveBy(.3,cc.v2(0,40))));cc.audioEngine.playEffect(window.sound.bookSound)}.bind(this),.25),this.scheduleOnce(function(){if(c.data.startTime<=0||c.data.rookie){c.guiding=!0,this.btnStart.active=!0,this.btnStart.scale=.5;var t=cc.sequence(cc.scaleTo(.5,1.05),cc.scaleTo(.5,1)).repeatForever();this.btnStart.runAction(cc.sequence(cc.scaleTo(.25,1.1),cc.scaleTo(.5,1),cc.callFunc(function(){this.btnStart.runAction(t)}.bind(this))))}else this.btnNew.active=!0,this.btnNew.scale=.5,this.btnContinue.active=!0,this.btnContinue.scale=.5,this.btnNew.runAction(cc.sequence(cc.scaleTo(.25,1.1),cc.scaleTo(.15,1))),this.btnContinue.runAction(cc.sequence(cc.scaleTo(.25,1.1),cc.scaleTo(.15,1)))}.bind(this),.55)},doReady:function(){this.scheduleOnce(function(){for(var t=0;t<15;t++)this.images[t].y=this.tops[t]-this.correctedHeight;this.doBtns()}.bind(this),.01)},startGame:function(){window.loadingBrown.doStart(function(){this.mask.active=!0,cc.director.loadScene("prepare")}.bind(this)),cc.audioEngine.playEffect(window.sound.finger)},newGame:function(){var t=cc.instantiate(this.confirmPrefab);this.node.addChild(t),t.getComponent("Confirm").init("\u5f53\u524d\u5df2\u6709\u5b58\u6863\uff0c\u6709\u5426\u8986\u76d6\u8fdb\u5ea6\uff1f",function(){window.loadingBrown.doStart(function(){this.mask.active=!0,window.cover=null,cc.director.loadScene("prepare")}.bind(this))}.bind(this)),cc.audioEngine.playEffect(window.sound.finger)},continue:function(){this.mask.active=!0,window.loadingBrown.doStart(function(){window.cover=null,cc.director.loadScene("helloworld",function(){window.loadingBrown.close()}.bind(this))}.bind(this)),cc.audioEngine.playEffect(window.sound.finger)},goGuide:function(){c.tempGuideData=JSON.parse(JSON.stringify(c.data)),this.mask.active=!0,c.setDataToBase(),c.guiding=!0,c.data.guide=[0,0,0,0,0,c.data.guide[5]],c.begin=!0,c.newCard=!1,window.cover=null,window.loadingBrown.doStart(function(){cc.director.loadScene("helloworld",function(){window.loadingBrown.close()}.bind(this))}.bind(this)),cc.audioEngine.playEffect(window.sound.bookOpen)},openSetting:function(){var t=cc.instantiate(this.settingPrefab);this.node.addChild(t,100)},clean:function(){c.setDataToBase(),c.guiding=!0,c.data.guide=[0,0,0,0,0,0],c.data.totalTime=0,c.data.rookie=!0,c.data.clearance=[0,0,0,0,0,0],c.saveData()},showTip:function(t){this.tip.active=!0,this.tip.y=-80,this.tip.opacity=0,this.tip.stopAllActions(),this.tip.runAction(cc.sequence(cc.spawn(cc.moveBy(.5,cc.v2(0,50)),cc.fadeIn(.2)),cc.spawn(cc.moveBy(.5,cc.v2(0,50)),cc.sequence(cc.delayTime(.3),cc.fadeOut(.2)))))}}),cc._RF.pop()},{Game:"Game"}],DiceChoose:[function(t,e,i){"use strict";cc._RF.push(e,"2f252xYsv5IdrGnewf/1jBc","DiceChoose");var c=t("Game");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(t,e){this.element=t,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var i=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=i[this.element-1],this.node.runAction(cc.moveTo(.2,cc.v2(110*e-110,0)))},choose:function(){if(5==c.data.difficulty){var t=Math.floor(10*Math.random())+21;if(21==t){for(var e=[],i=window.player.cardList,o=0;o<i.length;o++){var n=i[o].getComponent("Card");n.burn||n.silence||e.push(n)}if(e.length>0){var a=e[Math.floor(Math.random()*e.length)];a.buffId=21,a.initBuff()}else window.player.buff.addBuff(21,1)}else if(25==t){e=[];for(var s=window.player.cardList,r=0;r<s.length;r++){var d=s[r].getComponent("Card");d.silence||e.push(d)}if(e.length>0){var h=e[Math.floor(Math.random()*e.length)];h.buffId=25,h.initBuff()}else window.player.buff.addBuff(25,1)}else window.player.buff.addBuff(t,1)}for(var l=1+window.player.buff.exCreateDice,u=0;u<l;u++)window.player.createExDice(this.element,!0,!0);window.player.endRoll(),window.player.buff.exCreateDice=0,3==c.data.difficulty&&(window.player.diceCount+=l),window.player.createDiceRound[this.element-1]++;for(var f=0;f<window.player.cardList.length;f++){var p=window.player.cardList[f].getComponent("Card");238==p.cfgId&&p.initDesc()}window.chooseDiceLayer.close()}}),cc._RF.pop()},{Game:"Game"}],DiceTavern:[function(t,e,i){"use strict";cc._RF.push(e,"2a3b72qgEZPdL0PbR9yMWKz","DiceTavern"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,mask:cc.Node},onLoad:function(){this.holded=!1,this.element=0,this.mask.active=!1},roll:function(){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var t=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=t[this.element-1],this.node.y=-200,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20)),cc.moveTo(.1,cc.v2(this.node.x,0)))))},doHold:function(){this.hold()},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)}}),cc._RF.pop()},{}],DiceYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"0732a2IpoZOOqfHG4WHWwqp","DiceYahtzee"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(t,e){this.id=t,this.index=e,this.player=0==e?window.yahtzeeLayer.hero:window.yahtzeeLayer.enemy,this.element=0,this.abled=!1},show:function(){this.abled=!1,this.holded=!1;var t=this.delta=0==this.index?1:-1;this.node.opacity=255,this.node.position=cc.v2(110*this.id-220,-320*t),this.node.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,340*t)),cc.moveBy(.1,cc.v2(0,-20*t))))},roll:function(t){this.abled=!0,this.holded=!1;var e=this.player.holdList.indexOf(this.node);if(e>=0&&this.player.holdList.splice(e,1),!t){this.element=Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var i=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=i[this.element-1]}var c=50*Math.random()+150*this.id-325,o=(420*Math.random()+240)*this.delta,n=150*Math.random()-75;this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(c,o)),cc.rotateTo(.2,n)))},toHold:function(){0==this.index&&this.doHold()},doHold:function(){if(this.abled)if(this.holded){this.roll(!0);for(var t=0;t<this.player.holdList.length;t++)this.player.holdList[t].runAction(cc.moveTo(.1,cc.v2(110*t-220,0)));this.player.txtBtn.string="\u6295\u63b7",cc.audioEngine.playEffect(window.sound.rollSound2)}else this.hold(),cc.audioEngine.playEffect(window.sound.holdSound)},hold:function(){this.holded=!0,this.node.runAction(cc.spawn(cc.moveTo(.2,cc.v2(110*this.player.holdList.length-220,0)),cc.rotateTo(.2,0))),this.player.holdList.push(this.node),this.player.holdList.length>=5&&(this.player.txtBtn.string="\u7ed3\u675f\u56de\u5408")}}),cc._RF.pop()},{}],Dice:[function(t,e,i){"use strict";cc._RF.push(e,"24e6aDXOPZNaoyluEGeZSR/","Dice");var c=t("Game");cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,markIce:cc.Node,markLock:cc.Node,mask:cc.Node,markTemp:cc.Node,markBlind:cc.Node},init:function(t,e){this.id=t,this.holded=!1,this.element=0,this.mask.active=!1,this.temp=!1,this.isRemoved=!1,this.remembered=!1,this.buffList=e,this.markIce.active=this.markLock.active=this.markTemp.active=this.markBlind.active=!1,this.blind=e.indexOf(30)>=0,this.markBlind.active=this.blind},initBuff:function(t){t||(1==this.element&&window.opponent.equip.checkWithTrigger(171)?this.buffList.indexOf(22)<0&&this.buffList.indexOf(28)<0&&this.buffList.push(22):4==this.element&&window.opponent.equip.checkWithTrigger(173)&&window.mainLayer.hero.round%2==1&&this.buffList.indexOf(28)<0&&this.buffList.push(28));var e=this.buffList;this.freeze=e.indexOf(22)>=0,this.markIce.active=this.freeze,this.lock=e.indexOf(28)>=0,this.markLock.active=this.lock},roll:function(t){if(!this.isRemoved){this.element=t||Math.floor(6*Math.random())+1,cc.loader.loadRes("Texture/battle/ebement"+this.element,cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this));var e=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.sprite.node.color=e[this.element-1],this.delta=0==window.mainLayer.roundId?1:-1,this.node.y=300*-this.delta,this.node.opacity=1,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.fadeIn(.15),cc.sequence(cc.moveTo(.15,cc.v2(this.node.x,20*this.delta)),cc.moveTo(.1,cc.v2(this.node.x,0)))))}},doHold:function(){c.guiding&&0==c.data.guide[2]||0!=window.mainLayer.roundId||this.freeze||this.lock||this.temp||window.player.diceUsabld&&(this.hold(),1==c.data.guide[2]&&window.guide&&(window.guide.close(),window.host.checkBtnRoll()))},hold:function(){this.holded?(this.holded=!1,this.mask.active=!1,window.player.holdList[this.element-1]--):(this.holded=!0,this.mask.active=!0,window.player.holdList[this.element-1]++)},remove:function(){this.isRemoved=!0,this.node.stopAllActions();var t=cc.spawn(cc.moveBy(.15,cc.v2(0,250*-this.delta)),cc.fadeOut(.2));this.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,20*this.delta)),t,cc.callFunc(function(){window.player.dicePool.put(this.node)}.bind(this))))},clear:function(){this.buffList=[],this.initBuff(!0),this.markBlind.active=!1},doTemp:function(){this.temp=!0,this.markTemp.active=!0;var t=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)];this.markTemp.color=t[this.element-1]}}),cc._RF.pop()},{Game:"Game"}],DmgAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"267b8j4vWVAPaVTrMCIVdTi","DmgAnimation");t("Utils");cc.Class({extends:cc.Component,properties:{atks:[dragonBones.ArmatureDisplay],heal:dragonBones.ArmatureDisplay,fireAtk:dragonBones.ArmatureDisplay,waterAtk:dragonBones.ArmatureDisplay,windAtk:dragonBones.ArmatureDisplay,earthAtk:dragonBones.ArmatureDisplay,lightAtk:dragonBones.ArmatureDisplay,darkAtk:dragonBones.ArmatureDisplay,armor:dragonBones.ArmatureDisplay,dodge:dragonBones.ArmatureDisplay,frail:dragonBones.ArmatureDisplay,weak:dragonBones.ArmatureDisplay,silence:dragonBones.ArmatureDisplay,poison:dragonBones.ArmatureDisplay,curse:dragonBones.ArmatureDisplay,lock:dragonBones.ArmatureDisplay,atkback:dragonBones.ArmatureDisplay,blind:dragonBones.ArmatureDisplay,undead:dragonBones.ArmatureDisplay,revive:dragonBones.ArmatureDisplay},init:function(t){this.index=t,this.host=0==t?window.mainLayer.hero:window.mainLayer.enemy,this.step=0},show:function(t){var e;if(t<=6){var i=[this.fireAtk,this.waterAtk,this.windAtk,this.earthAtk,this.lightAtk,this.darkAtk];e=i[t-1];i=[window.sound.fireSound,window.sound.iceSound,window.sound.windSound,window.sound.earthSound,window.sound.lightSound,window.sound.darkSound];cc.audioEngine.playEffect(i[t-1])}else if(t>=7&&t<=9)(e=this.atks[this.step%3]).node.rotation=360*Math.random(),cc.audioEngine.playEffect(window.sound.atkSound);else if(t<=16){i=[this.armor,this.heal,this.dodge,null,null,this.atkback];e=i[t-11];i=[window.sound.armorSound,window.sound.healSound,window.sound.dodgeSound,null,null,window.sound.atkSound];cc.audioEngine.playEffect(i[t-11])}else if(t>=21&&t<=30&&29!=t){i=[this.fireAtk,this.waterAtk,this.frail,this.weak,this.silence,this.poison,this.curse,this.lock,null,this.blind];e=i[t-21];i=[window.sound.fireSound,window.sound.iceSound,window.sound.frailSound,window.sound.weakSound,window.sound.silenceSound,window.sound.poisonSound,window.sound.curseSound,window.sound.lockSound,null,window.sound.blindSound];cc.audioEngine.playEffect(i[t-21])}else 201==t?(e=this.undead,cc.audioEngine.playEffect(window.sound.undeadSound)):202==t&&(e=this.revive,cc.audioEngine.playEffect(window.sound.reviveSound));e&&(e.node.active=!0,e.node.zIndex=this.step,e.playAnimation("play0"),e.on(dragonBones.EventObject.LOOP_COMPLETE,function(){e.node.active=!1}.bind(this))),this.host.doShake(t),this.step++}}),cc._RF.pop()},{Utils:"Utils"}],Door:[function(t,e,i){"use strict";cc._RF.push(e,"03087MNqj9O2qA5J4CBmWTy","Door");var c=t("Game");cc.Class({extends:cc.Component,properties:{light:cc.Node,image:cc.Sprite,btn:cc.Button,gate1:cc.Node,gate2:cc.Node,mask:cc.Node,stair:cc.Node,bossLight:cc.Node},init:function(t,e){this.type=t,this.index=e,cc.loader.loadRes("Texture/map/door/door"+t,cc.SpriteFrame,function(t,e){this.image.spriteFrame=e}.bind(this));var i=["ground","battle","camp","treasure","event","shop","tavern","elite","boss"],o=c.data.roomType<=1||c.data.roomType>=7?"castle"+c.data.castle:i[c.data.roomType];cc.loader.loadRes("Texture/map/door/light/"+o,cc.SpriteFrame,function(t,i){this.light.getComponent(cc.Sprite).spriteFrame=i,this.mask.parent=window.room.node,this.mask.rotation=this.node.rotation;var c=[cc.v2(0,-15),cc.v2(-15,0),cc.v2(0,15),cc.v2(15,0)];this.mask.position=this.node.position.add(c[e])}.bind(this)),cc.loader.loadRes("Texture/map/door/gate/"+i[t]+"1",cc.SpriteFrame,function(t,e){this.gate1.getComponent(cc.Sprite).spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/map/door/gate/"+i[t]+"2",cc.SpriteFrame,function(t,e){this.gate2.getComponent(cc.Sprite).spriteFrame=e}.bind(this));var n=[null,null,cc.color(13,120,61),cc.color(234,162,59),cc.color(232,136,45),cc.color(251,230,180),cc.color(186,114,82)],a=[cc.color(93,135,192),cc.color(78,83,125),cc.color(203,158,115),cc.color(203,158,115)],s=n[c.data.roomType]||a[c.data.castle-1];this.mask.color=s},onEvent:function(){c.guiding&&c.data.floor>=7||window.room.gotoDoor(this.index)},open:function(t){t?(this.gate1.runAction(cc.scaleTo(.3,.3,1)),this.gate2.runAction(cc.scaleTo(.3,.3,1)),this.light.runAction(cc.scaleTo(.3,1,1)),8==this.type&&(this.stair.active=!0,this.bossLight.active=!0,this.stair.opacity=0,this.stair.y=25,this.stair.runAction(cc.sequence(cc.delayTime(.1),cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.25,cc.v2(0,-40)),cc.moveBy(.05,cc.v2(0,5)))))))):8==this.type?(this.stair.active=!0,this.bossLight.active=!0,this.stair.y=-10,this.stair.runAction(cc.spawn(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){this.gate1.scaleX=.3,this.gate2.scaleX=.3,this.light.scaleX=1}.bind(this)),cc.fadeOut(.2)),cc.sequence(cc.moveBy(.05,cc.v2(0,-5)),cc.moveBy(.25,cc.v2(0,40)))))):(this.gate1.scaleX=.3,this.gate2.scaleX=.3,this.light.scaleX=1),this.btn.interactable=!0},close:function(t){this.btn.interactable=!1,t?(this.gate1.runAction(cc.scaleTo(.3,1,1)),this.gate2.runAction(cc.scaleTo(.3,1,1)),this.light.runAction(cc.scaleTo(.3,0,1))):(this.gate1.scaleX=1,this.gate2.scaleX=1,this.light.scaleX=0)}}),cc._RF.pop()},{Game:"Game"}],EditEndLayer:[function(t,e,i){"use strict";cc._RF.push(e,"59c2dH9VnhA4aJe05dgG9Jc","EditEndLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{},restart:function(){c.data.deck=c.editCfg.deckHero.split(";"),c.data.equip=c.editCfg.equip.split(";"),c.data.hp=c.data.hpMax,cc.director.loadScene("mainLayer")},back:function(){cc.director.loadScene("edit")}}),cc._RF.pop()},{Game:"Game"}],Edit:[function(t,e,i){"use strict";cc._RF.push(e,"463d3gvgvdIabmN6qTyXAVR","Edit");var c=t("Game");cc.Class({extends:cc.Component,properties:{editHpEnemy:cc.EditBox,editDice:cc.EditBox,editDeckEnemy:cc.EditBox,editEquipEnemy:cc.EditBox,editDeckHero:cc.EditBox,editEquip:cc.EditBox,editId:cc.EditBox,editHpHero:cc.EditBox},onLoad:function(){c.editCfg&&(this.editHpEnemy.string=c.editCfg.hpEnemy,this.editDice.string=c.editCfg.dice,this.editDeckEnemy.string=c.editCfg.deckEnemy,this.editEquipEnemy.string=c.editCfg.equipEnemy,this.editDeckHero.string=c.editCfg.deckHero,this.editEquip.string=c.editCfg.equip,this.editHpHero.string=c.editCfg.hpHero),this.editId.string=c.data.heroId},goBattle:function(){c.editCfg={hpEnemy:this.editHpEnemy.string,dice:this.editDice.string,deckEnemy:this.editDeckEnemy.string,equipEnemy:this.editEquipEnemy.string,deckHero:this.editDeckHero.string,equip:this.editEquip.string,hpHero:this.editHpHero.string};var t=this.editDeckHero.string.split(";");if(4==parseInt(this.editId.string)){c.data.cardBag=[];for(var e=0;e<t.length;e++)c.data.cardBag.push(parseInt(t[e]))}else{c.data.deck=[];for(var i=0;i<t.length;i++)c.data.deck.push(parseInt(t[i]))}var o=this.editEquip.string.split(";");c.data.equip=[];for(var n=0;n<o.length;n++)c.data.equip.push(parseInt(o[n]));c.data.hp=c.data.hpMax=parseInt(c.editCfg.hpHero),c.data.heroId=parseInt(this.editId.string),c.data.level=7,cc.director.loadScene("mainLayer")},goBack:function(){cc.director.loadScene("helloworld")}}),cc._RF.pop()},{Game:"Game"}],EndLayer:[function(t,e,i){"use strict";cc._RF.push(e,"76da3erO9ZIsr/fOEDhJf5d","EndLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{treasurePrefab:cc.Prefab,treasureNode:cc.Node,txtTitle:cc.Label,btnNext:cc.Node,btnOut:cc.Node,mask:cc.Node,cardChangePrefab:cc.Prefab,btnGiveUp:cc.Node,txtCopper:cc.Label},init:function(t){window.endLayer=this,this.isEscape=t,c.data.hp=Math.min(window.mainLayer.hero.hp,c.data.hpMax),c.data.power=window.mainLayer.hero.power;var e=1;4==c.data.castle?e=4:c.data.roomType>=7&&(e=3);var i=cc.instantiate(this.treasurePrefab);i.getComponent("TreasureChest").init(e),this.treasureNode.addChild(i),this.chest=i.getComponent("TreasureChest"),this.player=window.mainLayer.hero.player,this.rewardList=[],this.initCopper(),this.initExp(),this.initHealth(),-1==this.player.equip.feather&&(c.data.itemEffect.feather=-1),-1==this.player.equip.reviveBook&&(c.data.itemEffect.reviveBook=-1),c.data.floorBeats[c.data.floor-1]=!0,c.data.monsterBeats.push(c.monsterId),this.chest.jumpIn(),this.scheduleOnce(function(){this.mask.runAction(cc.fadeTo(.3,210)),this.treasureNode.runAction(cc.sequence(cc.moveTo(.4,cc.v2(0,-250)),cc.delayTime(.1),cc.callFunc(function(){cc.audioEngine.stopMusic(),e<=3?(this.chest.openReward(this.rewardList),this.txtTitle.node.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))):this.chest.openComplete()}.bind(this))))}.bind(this),1),this.scheduleOnce(function(){var t=4==c.data.castle||this.isEscape?this.btnOut:this.btnNext;t.active=!0,t.opacity=1,t.y-=50,t.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2)))}.bind(this),2+.2*this.rewardList.length)},initCopper:function(){var t=window.mainLayer.enemy.cfg.level,e=1;this.player.equip.check(73)&&(e+=.5),this.player.equip.check(90)&&(e=0);var i=[6,8,10,12,14,16,0][t-1]*e;this.isEscape&&(i=0),this.rewardList.push({type:1,value:i})},initExp:function(){var t=window.mainLayer.enemy.cfg.level,e=1==c.data.roomType?t:[3,9,15,27,37,55,100][t-1];this.isEscape&&(e=0),this.rewardList.push({type:2,value:e})},initHealth:function(){var t=0;this.player.equip.check(7)&&(t+=10),this.player.equip.check(8)&&c.data.hp<c.data.hpMax/2&&(t+=20),t>0&&this.rewardList.push({type:3,value:t})},nextStep:function(){var t=!0;c.data.roomType>=7?(this.initEquip(),7==c.data.roomType&&(t=!1),this.scheduleOnce(function(){this.chest.openEquip(this.cfgIdList,t)}.bind(this),.2)):this.player.equip.check(26)?(t=!1,this.scheduleOnce(function(){this.chest.openBoard([{type:4,value:6}])}.bind(this),.2)):(this.initCards(),(1==c.data.heroId&&2==c.data.difficulty||4==c.data.heroId&&4==c.data.difficulty)&&(t=!1),this.scheduleOnce(function(){t&&1==c.data.roomType&&c.data.hp<=.35*c.data.hpMax&&!c.guiding?(this.chest.openBoard([{type:3,value:Math.floor(.35*c.data.hpMax)},null],!0),this.chest.openCard([0,this.cardList[0]],!0)):this.chest.openCard(this.cardList,t)}.bind(this),.2)),this.btnNext.getComponent(cc.Button).interactable=!1,this.btnNext.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,-50)),cc.fadeOut(.2))),this.txtTitle.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){c.data.roomType>=7?this.txtTitle.string=(t?"\u9009\u62e9":"")+"\u88c5\u5907\u5956\u52b1":this.player.equip.check(26)?this.txtTitle.string="\u5973\u738b\u4e4b\u5fc3\u5956\u52b1":this.txtTitle.string=(t?"\u9009\u62e9":"")+"\u5361\u724c\u5956\u52b1",this.txtTitle.node.y-=50}.bind(this)),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))),t||(this.btnOut.active=!0,this.btnOut.opacity=1,this.btnOut.y-=50,this.btnOut.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2)))))},initCards:function(){if(this.cardList=[],1==c.data.heroId&&2==c.data.difficulty){var t=(e=window.mainLayer.enemy.initialDeck)[Math.floor(Math.random()*e.length)];this.cardList.push(t)}else if(4==c.data.heroId&&4==c.data.difficulty){for(var e=window.mainLayer.enemy.initialDeck,i=0;i<2;i++)if(e.length>0){var n=Math.floor(Math.random()*e.length),a=e[n];e.splice(n,1),this.cardList.push(a)}}else{for(var s=0,r=[[.6,.4,0],[.3,.5,.2],[0,.5,.5]],d=Math.random(),h=0,l=0;l<3;l++)if(d<(h+=r[c.data.castle-1][l])){s=l+1;break}for(var u=0;u<=0;){var f=c.getNewCardId(s),p=o.get("cfg_card",f).require;(c.data.castle>1||2==p.split(";").length||p<=102)&&(u=f)}this.cardList.push(u);for(var m=0;m<=0;){var g=c.getNewCardId(s),y=o.get("cfg_card",g).require;g!=u&&(c.data.castle>1||2==y.split(";").length||y<=102)&&(m=g)}this.cardList.push(m),c.guiding&&0==c.data.guide[2]&&(this.cardList=[9,10])}},initEquip:function(){for(var t=8==c.data.roomType?2:0,e=0,i=[[.6,.4,0],[.4,.4,.2],[.1,.6,.3]],o=Math.random(),n=0,a=0;a<3;a++)if(o<(n+=i[c.data.castle-1][a])){e=a+1;break}this.cfgIdList=[];var s=c.getNewItemId(t,e);if(this.cfgIdList.push(s),8==c.data.roomType){for(var r=0;r<=0;){var d=c.getNewItemId(t,e);d!=s&&(r=d)}this.cfgIdList.push(r)}},openCardChange:function(t){var e=cc.instantiate(this.cardChangePrefab);e.getComponent("CardChangeLayer").init(t),this.node.addChild(e,100)},giveUp:function(){c.updateCopper(c.data.roomType>=7?20:10),this.skipReward=!0,this.hideGiveUp(),this.close()},close:function(){this.skipReward||this.chest.getUnchosen(),cc.audioEngine.playEffect(window.sound.back),window.treasureChest=null,window.endLayer=null,this.btnOut.active=!1,window.mainLayer=null,window.loadingMask.close(function(){cc.director.loadScene("helloworld",function(){window.loadingMask.open()}.bind(this))}.bind(this))},showGiveUp:function(){c.guiding||(this.btnGiveUp.runAction(cc.moveBy(.3,cc.v2(-200,0))),this.txtCopper.string="+"+(c.data.roomType>=7?20:10))},hideGiveUp:function(){this.btnGiveUp.stopAllActions(),this.btnGiveUp.runAction(cc.moveBy(.2,cc.v2(200,0)))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndTavernLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2d083apwQNCHIRnqoFt5WSN","EndTavernLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{bg:cc.Node,mask:cc.Node,boxReward:cc.Node,rewardNode:cc.Node,rewardPrefab:cc.Prefab,btn:cc.Node,cardChangePrefab:cc.Prefab,summaryPrefab:cc.Prefab,emptyNode:cc.Node,lights:[cc.Node],shadow:cc.Node,txtBtn:cc.Label},init:function(t){this.rewards=t,this.abled=!1,this.getCardList=[],this.showReward(),this.mask.runAction(cc.fadeTo(.3,210)),this.bg.runAction(cc.sequence(cc.delayTime(.1),cc.moveTo(.2,cc.v2(0,-20)),cc.moveTo(.2,cc.v2(0,0)),cc.callFunc(function(){this.lights[0].active=this.lights[1].active=!0,this.shadow.active=!0}.bind(this)))),this.btn.opacity=1,this.btn.y-=50,this.btn.runAction(cc.sequence(cc.delayTime(1),cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2)),cc.callFunc(function(){this.abled=!0}.bind(this)))),cc.audioEngine.playEffect(window.sound.end)},showReward:function(){if(this.boxes=[],this.rewards.length<=0)this.checkResult(0);else for(var t=0;t<this.rewards.length;t++)this.checkResult(this.rewards[t]);this.boxes.length<=1&&(this.txtBtn.string="\u8fd4 \u56de")},checkResult:function(t){if(t>0){var e=cc.instantiate(this.boxReward);e.active=!0,e.y=8*this.boxes.length-92,e.zIndex=6-this.boxes.length,this.rewardNode.addChild(e),this.boxes.push(e);var i=o.get("cfg_tavern",t).rewardId,c=cc.instantiate(this.rewardPrefab);c.getComponent("Reward").init(i.split(";"),2),e.addChild(c),this.getCardList=this.getCardList.concat(c.getComponent("Reward").getCardList),""==c.getComponent("Reward").txtDesc.string?c.y=-18:c.y=-28}else this.boxReward.active=!0,this.emptyNode.active=!0},doNext:function(){if(this.abled)if(this.abled=!1,this.boxes.length<=1)this.doClose();else{this.bg.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,30)),cc.moveBy(.15,cc.v2(0,-30)))),cc.audioEngine.playEffect(window.sound.btn2);for(var t=0;t<this.boxes.length;t++){var e=this.boxes[t];0==t?e.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.2,cc.v2(0,-1e3)),cc.callFunc(function(){this.boxes.shift(),this.abled=!0,this.boxes.length<=1&&(this.txtBtn.string="\u8fd4 \u56de")}.bind(this)))):e.runAction(cc.sequence(cc.delayTime(.15),cc.moveBy(.15,cc.v2(0,-8))))}}},doClose:function(){if(c.data.hp<=0){var t=cc.instantiate(this.summaryPrefab);t.getComponent("Summary").init(-1),this.node.addChild(t)}else{for(var e=0;e<2;e++)this.getCardList.length>0&&c.data.deck.length<6&&(c.getCard(this.getCardList[0]),this.getCardList.shift());if(this.getCardList.length>0){var i=cc.instantiate(this.cardChangePrefab);i.getComponent("CardChangeLayer").init(this.getCardList[0],this.getCardList[1],this.close.bind(this)),this.node.addChild(i,100)}else this.close()}},close:function(){cc.audioEngine.playEffect(window.sound.back),this.btn.active=!1,window.tavernLayer=null,window.loadingMask.close(function(){cc.director.loadScene("helloworld",function(){window.loadingMask.open()}.bind(this)),c.data.floorBeats[c.data.floor-1]=!0}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EndYahtzeeLayer:[function(t,e,i){"use strict";cc._RF.push(e,"87aceT7E4BBK7fY92/xzCKl","EndYahtzeeLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{figure:cc.Sprite,txtName:cc.Label,bats:cc.Node,dialog:cc.Node,txtDialog:cc.Node,rewardNode:cc.Node,rewardPrefab:cc.Prefab,btn:cc.Node,summaryPrefab:cc.Prefab,cardChangePrefab:cc.Prefab},init:function(t){this.result=t,this.eventId=c.data.eventIds[c.data.castle-1],this.cfg=o.get("cfg_event",this.eventId);var e=t>=0?1:2;this.rewardIds=this.cfg["reward"+e],this.txtName.string=this.cfg["name"+e],cc.loader.loadRes("Texture/npc/"+this.cfg["figure"+e],cc.SpriteFrame,function(t,e){this.figure.spriteFrame=e}.bind(this)),this.figure.node.scale=.8,this.figure.node.runAction(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.1,1))),this.bats.scale=.5,this.bats.opacity=0,this.bats.runAction(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1))),this.dialog.scale=0,this.dialog.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.2,1))),this.txtDialog.runAction(cc.sequence(cc.delayTime(.4),cc.fadeIn(.2))),this.btn.opacity=1,this.btn.y-=50,this.btn.runAction(cc.sequence(cc.delayTime(.4),cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2)))),this.checkResult(),1==e&&c.data.highRecord[8]++,cc.audioEngine.playEffect(window.sound.end)},checkResult:function(){var t=cc.instantiate(this.rewardPrefab);t.getComponent("Reward").init(this.rewardIds.split(";"),1),this.rewardNode.addChild(t),this.reward=t.getComponent("Reward")},doClose:function(){if(c.data.hp<=0){var t=cc.instantiate(this.summaryPrefab);t.getComponent("Summary").init(-1),this.node.addChild(t)}else{var e=this.reward.getCardList;if(e.length>0){var i=cc.instantiate(this.cardChangePrefab);i.getComponent("CardChangeLayer").init(e[0],e[1],this.close.bind(this)),this.node.addChild(i,100)}else this.close()}},close:function(){cc.audioEngine.playEffect(window.sound.back),this.btn.active=!1,window.yahtzeeLayer=null,window.loadingMask.close(function(){cc.director.loadScene("helloworld",function(){window.loadingMask.open()}.bind(this)),c.data.floorBeats[c.data.floor-1]=!0}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Enemy:[function(t,e,i){"use strict";cc._RF.push(e,"dcdbcs6tkpDFZMApS5oUM3A","Enemy");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,txtName:cc.Label,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,figure:cc.Node,figureNode:cc.Node,equipDesc:cc.RichText,centerNode:cc.Node,boxAnmation:dragonBones.ArmatureDisplay},onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip")},init:function(){if(c.editCfg)this.initEdit();else{if(this.cfgId=c.monsterId,this.cfg=o.get("cfg_monster",this.cfgId),this.hpMax=this.cfg.hp,3==c.data.difficulty?1!=c.data.heroId&&4!=c.data.heroId||(this.hpMax=1.1*this.hpMax):4==c.data.difficulty&&(this.hpMax=1.2*this.hpMax),c.data.equip.indexOf(91)>=0&&(this.hpMax=1.15*this.hpMax),1==c.data.roomType&&c.data.itemEffect.pen>0&&(this.hpMax=this.hpMax/2,c.data.itemEffect.pen--),this.hpMax=Math.floor(this.hpMax),c.guiding&&1==c.monsterId)this.hpMax=32;else if(0==this.cfg.type)for(var t=0;t<c.data.monsterBeats.length;t++){var e=c.data.monsterBeats[t];e&&this.cfg.level==o.get("cfg_monster",e).level&&(this.hpMax+=5)}this.hp=this.hpMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=this.cfg.dice,2==c.data.heroId&&4==c.data.difficulty&&this.diceCount++,this.cfg.item>0?this.equipList=[this.cfg.item]:this.equipList=[],this.txtName.string=this.cfg.name+"  Lv."+this.cfg.level,this.initDeck()}this.player.init(1),this.escapeRate=0,this.exRollCount=0,this.ai=this.getComponent("AI"),cc.loader.loadRes("Texture/monster/figure/"+this.cfgId,cc.SpriteFrame,function(t,e){this.figure.getComponent(cc.Sprite).spriteFrame=e,this.figureNode.active=!1}.bind(this))},comeIn:function(){this.figureNode.active=!0,12==this.cfgId||17==this.cfgId||20==this.cfgId||33==this.cfgId||42==this.cfgId||45==this.cfgId||55==this.cfgId||62==this.cfgId||65==this.cfgId||76==this.cfgId||1==this.cfgId?(this.figureNode.scaleX=1.5,this.figureNode.scaleY=.6,this.figureNode.runAction(cc.sequence(cc.scaleTo(.4,.8,1.2),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))):(this.figureNode.y+=250,this.figureNode.scaleX=.8,this.figureNode.scaleY=1.2,this.figureNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,-250)),cc.scaleTo(.3,1.2,.8)),cc.scaleTo(.2,1),cc.callFunc(function(){this.figureNode.runAction(cc.sequence(cc.scaleTo(.2,.99,1.01),cc.scaleTo(.4,1.01,.99),cc.scaleTo(.2,1,1)).repeatForever())}.bind(this))))),this.scheduleOnce(function(){window.sound.monsterSound[this.cfgId-1]&&cc.audioEngine.playEffect(window.sound.monsterSound[this.cfgId-1])}.bind(this),.2)},startRound:function(){if(!window.mainLayer.gameOver){var t=window.mainLayer.boxEnemyRound;t.active=!0,t.y=56,t.opacity=0,t.scale=.2,window.mainLayer.board.scale=1,t.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.fadeIn(.2),cc.scaleTo(.25,1.05)),cc.scaleTo(.1,1),cc.callFunc(function(){this.player.startRound()}.bind(this)),cc.delayTime(.6),cc.moveTo(.3,cc.v2(0,-cc.winSize.height/2+227)),cc.callFunc(function(){this.player.checkStart(),this.scheduleOnce(function(){this.ai.check()}.bind(this),1.5)}.bind(this)))),window.mainLayer.board.runAction(cc.sequence(cc.delayTime(1.35),cc.scaleTo(.3,.488,50/94)))}},endRound:function(){this.exRollCount=0,window.mainLayer.boxEnemyRound.runAction(cc.moveBy(.15,cc.v2(0,-105))),this.equip.check(126)&&(this.escapeRate+=.1,Math.random()<this.escapeRate&&this.escape())},onHurt:function(t,e,i,c){window.mainLayer.gameOver||(i=i||7,c=null!=c?c:1,this.player.onHurt(t,e,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(0),window.mainLayer.endRound(),this.onLose()))},onHeal:function(t){this.equip.checkWithTrigger(76)&&(t=Math.floor(1.5*t)),this.player.onHeal(t),this.player.assertHpChange("+"+t,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},onLose:function(){this.figure.runAction(cc.sequence(cc.delayTime(.4),cc.tintTo(.1,255,56,49),cc.tintTo(.1,255,255,255),cc.tintTo(.1,255,56,49),cc.tintTo(.1,255,255,255),cc.tintTo(.2,0,0,0))),this.centerNode.runAction(cc.sequence(cc.delayTime(.8),cc.scaleTo(.2,1.1),cc.spawn(cc.scaleTo(.3,.4),cc.fadeOut(.4),cc.moveBy(.3,cc.v2(0,-50))))),this.scheduleOnce(function(){this.boxAnmation.playAnimation("play0",1)}.bind(this),1.3)},initDeck:function(){if(0==this.cfg.card1)if(4==c.data.heroId){var t=Math.min(c.data.cardBag.length,6),e=c.data.cardBag.concat();this.deck=[];for(var i=0;i<t;i++){var o=Math.floor(e.length*Math.random()),n=e[o];this.deck.push(n),e.splice(o,1)}}else this.deck=c.data.deck.concat();else{this.deck=[];for(var a=0;a<6;a++){var s=this.cfg["card"+(a+1)];s>0&&this.deck.push(s)}}this.initialDeck=this.deck.concat()},initEdit:function(){this.cfgId=35,this.hp=this.hpMax=parseInt(c.editCfg.hpEnemy),this.txtHp.string=this.hp+"/"+this.hpMax,this.armor=0,this.diceCount=parseInt(c.editCfg.dice),this.txtName.string="\u6211\u7684\u670b\u53cb\u7279\u6717\u666e",this.equipList=""!=c.editCfg.equipEnemy?[c.editCfg.equipEnemy]:[],this.deck=[];for(var t=c.editCfg.deckEnemy.split(";"),e=0;e<t.length;e++)""!=t[e]&&this.deck.push(parseInt(t[e]))},doShake:function(t){var e={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};e[t]&&(this.figure.color=cc.Color.WHITE.fromHEX("#"+e[t]),this.figure.stopAllActions(),this.figure.runAction(cc.sequence(cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(-15,-5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.05,cc.v2(15,5)),cc.moveTo(.05,cc.v2(0,0)),cc.moveTo(.08,cc.v2(-15,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){this.figure.position=cc.v2(0,0),this.figure.color=cc.Color.WHITE}.bind(this)))))},escape:function(){window.mainLayer.showEnd(0,!0)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EquipLayer:[function(t,e,i){"use strict";cc._RF.push(e,"d293cR/UttJqLyCy2iTN7xq","EquipLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab,content:cc.Node,mask:cc.Node,mezz:cc.Node,box:cc.Node,btnClose:cc.Node,tip:cc.Node,scroll:cc.ScrollView},onLoad:function(){window.equipLayer=this,this.box.opacity=0,this.mask.runAction(cc.fadeTo(.15,210)),this.tipList=[],cc.audioEngine.playEffect(window.sound.bagOpenSound)},start:function(){this.box.runAction(cc.sequence(cc.delayTime(.01),cc.moveBy(0,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.fadeIn(0),cc.moveTo(.35,cc.v2(0,0)),cc.callFunc(function(){this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(-130,0)),cc.moveBy(.1,cc.v2(10,0))))}.bind(this)))),this.initItems();for(var t=0;t<5;t++){var e=cc.instantiate(this.mezz);e.position=cc.v2(0,-282-145*t),this.content.addChild(e)}},initItems:function(){for(var t=0;t<c.data.equip.length;t++){var e=cc.instantiate(this.itemPrefab);e.getComponent("ItemCollection").init(c.data.equip[t],t),e.position=cc.v2(0,-65-145*t),this.content.addChild(e,t+1)}this.content.height=Math.max(145*c.data.equip.length+70,1160)},close:function(){this.btnClose.runAction(cc.sequence(cc.moveBy(.2,cc.v2(120,0)),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.bagCloseSound)}.bind(this)))),this.mask.runAction(cc.sequence(cc.delayTime(.3),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.25,cc.v2(0,-cc.winSize.height/cc.winSize.width*750)),cc.callFunc(function(){this.node.destroy(),window.equipLayer=null,window.homeLayer.btnEquip.interactable=!0}.bind(this))))},scrollViewEvent:function(t,e){e==cc.ScrollView.EventType.SCROLL_BEGAN&&this.cleanTip()},cleanTip:function(){this.unschedule(this.cleanTip);for(var t=0;t<this.tipList.length;t++)this.tipList[t].destroy();this.tipList=[]},showTips:function(t,e){if(window.equipLayer.cleanTip(),t.length>0){for(var i=0,o=0;o<t.length;o++){var n=t[o],a=cc.instantiate(this.tip);a.active=!0;var s=a.getChildren()[0];a.y=this.content.y-65-145*e+60+i,this.scroll.node.addChild(a),this.tipList.push(a),s.getComponent(cc.RichText).string=c.analysisTip(n),a.height=10+s.height,i+=a.height+10}this.scheduleOnce(this.cleanTip,5)}}}),cc._RF.pop()},{Game:"Game"}],Equip:[function(t,e,i){"use strict";cc._RF.push(e,"a22ddJNtUJBS6PVq98jP/g9","Equip");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{itemPrefab:cc.Prefab},init:function(){this.player=this.getComponent("Player"),this.host=this.player.host,this.opponent=this.player.opponent,this.index=this.player.index,this.equipList=0==this.index?c.data.equip.concat():this.host.equipList,this.boxEquip=this.host.boxEquip,this.abled=1==this.index||159!=this.opponent.host.equipList[0],this.swiftGlove=!1,this.luckDice=!1,this.luckFlag=!1,this.suckRemainder=0,this.armorRemainder=0,this.magicSheild=0,this.goldArmor=0,this.luckyCard=0,this.feedBack=0,this.feather=0,this.reviveBook=0,this.wolfBlood=!1,this.elementPlayed=[0,0,0,0,0,0],this.initItems()},initItems:function(){if(this.itemList=[],0==this.index){for(var t=0;t<this.equipList.length;t++){if(this.equipList[t]>0)if(o.get("cfg_item",this.equipList[t]).battle){var e=!1;if(10==this.equipList[t]?c.data.itemEffect.feather>0&&(this.feather=1,e=!0):158==this.equipList[t]?c.data.itemEffect.reviveBook>0&&(this.reviveBook=1,e=!0):74==this.equipList[t]?c.data.itemEffect.pen>0&&(e=!0):e=!0,e){var i=cc.instantiate(this.itemPrefab);i.getComponent("Item").init(this.equipList[t],this),this.boxEquip.addChild(i),this.itemList.push(i),this.abled||i.getComponent("Item").doDisabled()}}}for(var n=0;n<this.itemList.length;n++){var a=72;this.itemList.length>10&&(a=648/(this.itemList.length-1)),this.itemList[n].x=a*n-324}}else if(this.equipList.length>0){var s=o.get("cfg_item",this.equipList[0]);this.host.equipDesc.string="<color=#FEF64B>"+s.name+"\uff1a</c>"+c.analysisDesc(s.desc1);var r=cc.instantiate(this.itemPrefab);r.getComponent("Item").init(this.equipList[0],this),r.x=-this.host.equipDesc.node.width/2-25,r.scale=.65,this.boxEquip.addChild(r),this.itemList.push(r),r.getComponent("Item").boxNum.scale=1/.65,10==this.equipList[0]?this.feather=1:158==this.equipList[0]&&(this.reviveBook=1)}else this.boxEquip.active=!1},check:function(t){if(!this.abled)return!1;for(var e=0;e<this.equipList.length;e++)if(this.equipList[e]==t)return!0;return!1},checkWithTrigger:function(t){return!!this.check(t)&&(this.doTrigger(t),!0)},trigger:function(t){var e=!1;if(this.check(t))if(1==t)this.opponent.host.onHurt(1,2),e=!0;else if(2==t)this.player.cardList.length<=0&&(this.player.updateArmor(5),e=!0);else if(3==t)this.player.cardList.length<=0&&(this.host.onHeal(3),e=!0);else if(4==t)this.player.cardList.length<=0&&!this.swiftGlove&&(this.swiftGlove=!0,this.player.patchCard(),this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),e=!0);else if(5==t)this.opponent.buff.addBuff(26,2),e=!0;else if(6==t)this.player.buff.addBuff(13,1),e=!0;else if(7==t)this.host.onHeal(10),e=!0;else if(8==t)this.host.hp<this.host.hpMax/2&&(this.host.onHeal(20),e=!0);else if(9==t)this.opponent.host.onHurt(6,2),e=!0;else if(10==t)this.feather>0&&(this.player.anim.show(202),this.host.hp=Math.floor(.3*this.host.hpMax),e=!0,this.feather=-1);else if(11==t)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),this.player.updateArmor(-this.host.armor),e=!0);else if(t>=12&&t<=18){this.opponent.buff.addBuff(t+9,[3,2,1,2,1,4,1][t-12]),e=!0}else if(19==t)this.player.extraDice++,e=!0;else if(20==t)this.player.updateArmor(10),e=!0;else if(21==t)this.player.buff.addBuff(104,1);else if(22==t)this.opponent.host.onHurt(5,2),e=!0;else if(23==t){if(this.suckRemainder>=4){var i=Math.floor(this.suckRemainder/4);this.suckRemainder=this.suckRemainder%4,this.host.onHeal(i),e=!0}}else if(24==t)this.opponent.host.onHurt(2,2,1),e=!0;else if(25==t)this.host.hp==this.host.hpMax&&(this.player.extraDice++,e=!0);else if(27==t)this.host.armor<=0&&(this.player.updateArmor(5),e=!0);else if(30==t)3==this.player.round&&(this.player.extraDice++,e=!0);else if(37==t)this.player.buff.addBuff(105,2);else if(44==t)this.player.buff.addBuff(103,3),e=!0;else if(45==t)this.player.createExDice(),e=!0;else if(t>=48&&t<=53)window.mainLayer.hero.round%2==1&&(window.player.createExDice(t-47),e=!0);else if(57==t)this.player.cardList.length>0&&(this.player.extraDice++,e=!0);else if(59==t)this.player.cardList.length>0&&(this.player.updateArmor(3*this.player.cardList.length),e=!0);else if(60==t)this.player.cardList.length>0&&(this.opponent.host.onHurt(3*this.player.cardList.length,2),e=!0);else if(61==t)this.host.onHeal(15),e=!0;else if(68==t)this.opponent.buff.addBuff(24,1),e=!0;else if(69==t)this.opponent.host.onHurt(10,2),e=!0;else if(70==t){var n=c.getRandomCardId();window.player.patchCard(n,!0),window.player.deck.push(n),e=!0}else if(75==t)this.host.hp<.3*this.host.hpMax?this.player.buff.atkAd3||(this.player.buff.addBuff(104,3),this.player.buff.atkAd3=!0):this.player.buff.atkAd3&&(this.player.buff.removeBuff(104,3),this.player.buff.atkAd3=!1);else if(82==t||83==t)this.host.onHeal(2),e=!0;else if(79==t||78==t)this.player.updateArmor(2),e=!0;else if(80==t||81==t)this.opponent.host.onHurt(2,2),e=!0;else if(84==t)this.player.buff.addBuff(27,1),e=!0;else if(86==t)this.host.onHurt(3,2,7,2),e=!0;else if(88==t){var a=4==c.data.heroId?c.data.cardBag:c.data.deck;if(a.length>0){e=!0;for(var s=o.get("cfg_card",a[0]).element,r=1;r<a.length;r++)if(o.get("cfg_card",a[r]).element!=s){e=!1;break}}}else if(89==t)this.player.buff.addBuff(24,2),e=!0;else if(93==t){if(1==this.player.round){window.player.cardList[Math.floor(Math.random()*window.player.cardList.length)].getComponent("Card").discard(!0);for(n=0;n<=0;){var d=c.getRandomCardId();3==o.get("cfg_card",d).quality&&(n=d)}window.player.patchCard(n),e=!0}}else if(96==t)this.opponent.buff.addBuff(26,Math.floor(5*Math.random())+1),e=!0;else if(97==t)this.player.updateArmor(1),e=!0;else if(102==t)this.host.hp>this.host.hpMax&&(this.player.updateArmor(this.host.hp-this.host.hpMax),e=!0);else if(104==t)this.opponent.buff.addBuff(Math.floor(10*Math.random())+21,1),e=!0;else if(105==t)this.host.onHurt(2,2,7,2),e=!0;else if(108==t)Math.random()<.3&&(this.opponent.buff.addBuff(27,1),e=!0);else if(109==t)Math.random()<.3&&(this.player.buff.addBuff(13,1),e=!0);else if(110==t)this.host.onHurt(1,2,7,2),this.opponent.buff.addBuff(26,2),e=!0;else if(111==t)this.host.armor>0&&(this.opponent.host.onHurt(this.host.armor,2),e=!0);else if(114==t)this.player.buff.addBuff(106,1);else if(115==t)this.luckDice||(this.luckDice=!0,this.player.addRollCount(),e=!0);else if(116==t)this.luckFlag||(this.luckFlag=!0,this.opponent.host.onHurt(6,2),e=!0);else if(118==t){for(var h=0,l=0;l<this.opponent.cardList.length;l++){this.opponent.cardList[l].getComponent("Card").burn&&h++}h>0&&(this.opponent.host.onHurt(6*h,2,1),e=!0)}else if(119==t)this.opponent.host.onHurt(5,2),e=!0;else if(121==t){for(var u=[],f=0;f<=this.player.buff.buffList.length;f++){var p=this.player.buff.buffList[f];p>=21&&p<=28&&u.push(p)}if(u.length>0){var m=u[Math.floor(Math.random()*u.length)];this.player.buff.removeBuff(m,this.player.buff.table[m]),e=!0}}else if(122==t)this.opponent.host.onHurt(1,2),e=!0;else if(123==t)this.host.hp>this.host.hpMax&&(this.opponent.host.onHurt(this.host.hp-this.host.hpMax,2),e=!0);else if(124==t)this.player.buff.addBuff(106,2);else if(126==t)c.updateCopper(-10),e=!0;else if(128==t){if(this.player.cardList.length>0&&this.opponent.deck.length>0){var g=Math.floor(Math.random()*this.player.cardList.length),y=(n=this.player.cardList[g].getComponent("Card").cfgId,Math.floor(Math.random()*this.opponent.deck.length)),v=this.opponent.deck[y];this.player.deck[g]=v,this.opponent.deck[y]=n,this.player.cardList[g].getComponent("Card").discard(!0),this.player.patchCard(v)}e=!0}else if(129==t)this.host.onHeal(3),e=!0;else if(138==t)this.opponent.buff.addBuff(29,1),e=!0;else if(142==t)this.player.diceCount++,e=!0;else if(143==t)this.player.updateArmor(this.host.hpMax-this.host.hp),e=!0;else if(144==t)this.opponent.buff.addBuff(27,1),e=!0;else if(145==t){if(1==this.player.round){if(this.opponent.equip.itemList.length>0){var w=this.opponent.equip.itemList[Math.floor(Math.random()*this.opponent.equip.itemList.length)].getComponent("Item");this.addEquip(w.cfgId),this.player.checkGameBegin()}e=!0}}else if(146==t)this.feedBack=5,this.refreshItemNum(146,5),e=!0;else if(147==t)this.player.buff.addBuff(104,1),e=!0;else if(148==t)this.opponent.host.onHurt(2*this.player.round,2,1),e=!0;else if(150==t)this.player.updateArmor(3),e=!0;else if(151==t)0==this.player.cardPlayedRound&&(this.player.extraDice+=2,e=!0);else if(152==t)null!=this.host.power&&(this.host.addPower(5),e=!0);else if(153==t)Math.random()<.1&&(this.player.patchCard(),e=!0);else if(155==t)this.opponent.host.armor>0&&(this.opponent.updateArmor(-this.opponent.host.armor),e=!0);else if(156==t)this.player.updateArmor(this.player.dmgRound),e=!0;else if(157==t)Math.random()<.3&&(this.player.patchCard(c.getRandomCardId(2)),e=!0);else if(158==t)this.reviveBook>0&&(this.player.anim.show(202),this.host.hp=this.host.hpMax,e=!0,this.reviveBook=-1);else if(160==t)!this.wolfBlood&&this.host.hp<50&&(this.wolfBlood=!0,this.host.onHeal(Math.floor(this.host.hpMax/2)),this.player.buff.addBuff(107,1),1==this.player.index&&cc.loader.loadRes("Texture/monster/figure/999",cc.SpriteFrame,function(t,e){this.host.figure.getComponent(cc.Sprite).spriteFrame=e,this.host.figure.scale=.5,this.host.figure.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.1,1))),cc.audioEngine.playEffect(window.sound.wolfSound)}.bind(this)),e=!0);else if(161==t)this.opponent.buff.addBuff(30,3),e=!0;else if(162==t)this.host.power&&(this.opponent.host.onHurt(this.host.power,2),e=!0);else if(164==t)this.armorRemainder>=3&&(this.player.updateArmor(Math.floor(this.armorRemainder/3)),this.armorRemainder=this.armorRemainder%3,e=!0);else if(165==t){(x=Math.random())<1/3?this.opponent.host.onHurt(7,2):x<2/3?this.opponent.buff.addBuff(26,4):this.player.buff.addBuff(27,1),e=!0}else if(166==t){if(this.refreshItemNum(166,this.opponent.cardPlayed%5),this.opponent.cardPlayed%5==0){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}e=!0}}else if(168==t)this.host.armor>0&&(this.host.onHeal(Math.floor(this.host.armor/2)),e=!0);else if(169==t){if(this.player.cardList.length<=0){for(var b=0;b<6;b++)this.player.patchCard();this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),e=!0}}else if(170==t){if(this.opponent.cardList.length>0){g=Math.floor(Math.random()*this.opponent.cardList.length);this.opponent.cardList[g].getComponent("Card").discard()}e=!0}else if(174==t){if((h=this.player.cardList.length-this.player.cardAbledCount)>0){for(var C=0;C<h;C++)this.opponent.host.onHurt(3,2);e=!0}}else if(176==t)this.opponent.host.onHurt(3,2);else if(181==t)this.player.createExDice(),e=!0;else if(182==t)this.player.updateArmor(5),e=!0;else if(183==t){var x;(x=Math.random())<1/6?this.host.onHeal(6):x<2/6?this.player.updateArmor(6):x<.5?this.player.buff.addBuff(105,1):x<4/6?this.player.buff.addBuff(13,1):x<5/6?this.player.buff.addBuff(107,1):this.player.buff.addBuff(108,1),e=!0}else 184==t?this.elementPlayed[1]>=3&&(this.elementPlayed[1]-=3,this.player.createExDice(),e=!0):185==t?this.elementPlayed[2]>=3&&(this.elementPlayed[2]-=3,this.player.buff.addBuff(107,1),e=!0):e=!0;return e&&this.doTrigger(t),e},doTrigger:function(t){for(var e=0;e<this.itemList.length;e++){var i=this.itemList[e].getComponent("Item");if(i.cfgId==t&&!i.isRemoved){i.trigger();break}}},refreshItemNum:function(t,e){for(var i=0;i<this.itemList.length;i++){var c=this.itemList[i].getComponent("Item");if(c.cfgId==t){c.txtCount.string=e;break}}},doDisabled:function(t){for(var e=0;e<this.itemList.length;e++){var i=this.itemList[e].getComponent("Item");if(i.cfgId==t){i.doDisabled();break}}},doAbled:function(t){for(var e=0;e<this.itemList.length;e++){var i=this.itemList[e].getComponent("Item");if(i.cfgId==t){i.doAbled();break}}},addEquip:function(t){if(0==this.index){this.equipList.push(t);var e=cc.instantiate(this.itemPrefab);e.getComponent("Item").init(t,this),this.boxEquip.addChild(e),this.itemList.push(e);for(var i=0;i<this.itemList.length;i++){var n=72;this.itemList.length>10&&(n=648/(this.itemList.length-1)),this.itemList[i].x=n*i-324}}else{this.equipList[0]=t,this.itemList[0].getComponent("Item").refresh(t);var a=o.get("cfg_item",t);this.host.equipDesc.string="<color=#FEF64B>"+a.name+"\uff1a</c>"+c.analysisDesc(a.desc1),this.itemList[0].x=-this.host.equipDesc.node.width/2-25}}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],EventLayer:[function(t,e,i){"use strict";cc._RF.push(e,"0d029pbdspBQZQHImTjZ76I","EventLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtTitle:cc.Node,boxes:[cc.Node],masks:[cc.Node],txtNames:[cc.Label],figures:[cc.Sprite],txtDescs:[cc.Label],txtResults:[cc.Node],txtInfo:cc.Node,btnLeave:cc.Node,btnPlay:cc.Node,book:cc.Node},onLoad:function(){var t=this;window.eventLayer=this,this.cfgId=c.data.eventIds[c.data.castle-1];for(var e=o.get("cfg_event",this.cfgId),i=function(i){t.txtNames[i].string=e["name"+(i+1)],t.txtDescs[i].string=e["result"+(i+1)];var c=t.figures[i];cc.loader.loadRes("Texture/npc/"+e["figure"+(i+1)],cc.SpriteFrame,function(t,e){c.spriteFrame=e}.bind(t))},n=0;n<2;n++)i(n);this.btnLeave.opacity=1,this.btnPlay.opacity=1,this.txtTitle.opacity=0,this.btnLeave.y-=100,this.btnPlay.y-=100,this.txtTitle.y-=50,this.book.scale=0,this.book.y+=265;for(n=0;n<2;n++)this.masks[n].active=!0,this.boxes[n].scale=.7,this.boxes[n].opacity=0,this.boxes[n].position=cc.v2(200*n-100,-25);this.txtTitle.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50)))),this.book.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,1),cc.moveBy(.2,cc.v2(0,-265))),cc.callFunc(function(){for(var t=this,e=function(e){var i=e;t.boxes[i].runAction(cc.sequence(cc.delayTime(.2*i),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,cc.v2(326*i-163,112)),cc.scaleTo(.2,1)),cc.callFunc(function(){this.masks[i].runAction(cc.fadeOut(.2)),this.txtResults[i].runAction(cc.sequence(cc.delayTime(.1),cc.fadeIn(.2)))}.bind(t)),cc.delayTime(.2*i),cc.callFunc(function(){this.boxes[i].runAction(cc.sequence(cc.moveBy(.4,cc.v2(0,-5)),cc.moveBy(.8,cc.v2(0,10)),cc.moveBy(.4,cc.v2(0,-5))).repeatForever())}.bind(t))))},i=0;i<2;i++)e(i)}.bind(this)))),this.txtInfo.runAction(cc.sequence(cc.delayTime(.8),cc.fadeIn(.2),cc.callFunc(function(){this.btnLeave.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,100)))),this.btnPlay.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,100))))}.bind(this)))),c.guiding&&(this.btnLeave.active=!1,this.btnPlay.x=0),cc.audioEngine.playEffect(window.sound.event)},onBattle:function(){cc.audioEngine.playEffect(window.sound.back),window.loadingRoll.doStart(function(){window.homeLayer=null,window.eventLayer=null,cc.director.loadScene("yahtzee")}.bind(this))},close:function(){this.node.destroy(),c.data.floorBeats[c.data.floor-1]=!0,window.eventLayer=null,window.room.initAlter(),window.room.doReady()}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Fort:[function(t,e,i){"use strict";cc._RF.push(e,"b1ae2I8ixdLDJnIKckBasJM","Fort"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite},init:function(t,e){this.id=t,0==t?cc.loader.loadRes("Texture/UI/map/fort_home1",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)):8==t?cc.loader.loadRes("Texture/UI/map/fort_boss1",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)):cc.loader.loadRes("Texture/UI/map/fort_room"+(1==e?3:1),cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this))},show:function(){0==this.id?cc.loader.loadRes("Texture/UI/map/fort_home2",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)):8==this.id?cc.loader.loadRes("Texture/UI/map/fort_boss2",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)):cc.loader.loadRes("Texture/UI/map/fort_room2",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this))},hide:function(){0==this.id?cc.loader.loadRes("Texture/UI/map/fort_home1",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)):8==this.id?cc.loader.loadRes("Texture/UI/map/fort_boss1",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this)):cc.loader.loadRes("Texture/UI/map/fort_room3",cc.SpriteFrame,function(t,e){this.sprite.spriteFrame=e}.bind(this))}}),cc._RF.pop()},{}],Game:[function(t,e,i){"use strict";cc._RF.push(e,"f5308O6zsVOxr+EKRsyR7ba","Game");var c=t("Config"),o={opening:!1,version:0,heroUnlock:!0,guiding:!1,getData:function(t){if(void 0!=window.wx)wx.getStorage({key:"dice",success:function(e){cc.log("getStorageSuccess:"+e.data),void 0!=e.data?(o.data=JSON.parse(e.data),this.checkCompatible(),t()):(this.setDataToBase(),t())}.bind(this),fail:function(){this.setDataToBase(),t()}.bind(this)});else{var e=cc.sys.localStorage.getItem("dice");void 0!=e?(o.data=JSON.parse(e),this.checkCompatible()):this.setDataToBase(),t()}},setDataToBase:function(){var t=!0,e=[0,0,0,0,0,0],i=0,c=[0,0,0,0,0,0],n=!0,a=!0;o.data&&(e=o.data.guide,i=o.data.totalTime,c=o.data.clearance,t=o.data.rookie,n=o.data.music,a=o.data.sound),o.data={heroId:1,difficulty:1,deck:[],cardBag:[],equip:[],hp:35,hpMax:35,power:0,powerMax:20,heroPos:2,exp:0,level:1,castle:1,floor:1,roomType:0,copper:99,debuff:0,shopIds:[],eventIds:[],monsterList:[],historyPath:[],historyChoose:[0],floorBeats:[],specialRoomIds:[],monsterBeats:[],monsterUnbeats:[],itemEffect:{feather:0,vase:0,flagon:0,pen:0,vip1:!1,vip2:!1,reviveBook:0},startTime:0,duration:0,face:1,restartCount:0,cardPlayed:{},guide:e,totalTime:i,highRecord:[0,0,0,0,0,0,0,0,0],clearance:c,rookie:t,music:n,sound:a},o.saveData()},saveData:function(){o.version++,void 0!=window.wx?wx.setStorage({key:"dice",data:JSON.stringify(o.data),success:function(){}}):cc.sys.localStorage.setItem("dice",JSON.stringify(o.data))},checkCompatible:function(){o.data.clearance||(o.data.clearance=[0,0,0,0,0,0]),o.data.guide.length||(o.data.guide=[0,0,0,0,0,0])},updateCopper:function(t){o.data.copper+=t,o.data.copper=Math.max(o.data.copper,0),t>0&&(o.data.highRecord[4]+=t)},getItem:function(t){if(o.data.equip.push(t),10==t)o.data.itemEffect.feather=1;else if(28==t)o.data.itemEffect.vase=2;else if(29==t)o.data.itemEffect.flagon=2;else if(40==t)o.data.hpMax+=5,o.data.hp+=5;else if(41==t)o.data.hpMax+=10,o.data.hp+=10;else if(46==t)o.data.itemEffect.vip1=!0;else if(47==t)o.data.itemEffect.vip2=!0;else if(71==t)o.updateCopper(100);else if(72==t)o.updateCopper(50),o.data.hpMax+=10,o.data.hp+=10;else if(74==t)o.data.itemEffect.pen+=2;else if(84==t)for(var e=0;e<3;e++)o.getItem(o.getNewItemId(0));else if(87==t)for(var i=0;i<2;i++)o.getItem(o.getNewItemId(0,2));else 92==t?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hp,o.data.hpMax)):95==t?(o.data.hpMax+=10,o.data.hp=o.data.hpMax):105==t?(o.data.hpMax+=20,o.data.hp+=20):106==t?o.data.powerMax+=10:158==t&&(o.data.itemEffect.reviveBook=1);94!=t&&o.data.equip.indexOf(94)>=0&&(o.data.hpMax+=5,o.data.hp+=5),window.homeLayer&&window.homeLayer.refreshHeroData(),o.data.highRecord[6]++},getCard:function(t){var e=5==o.data.heroId?4:2==o.data.heroId&&3==o.data.difficulty?5:6;4!=o.data.heroId&&o.data.deck.length<e?o.data.deck.push(t):(o.data.cardBag.push(t),o.newCard=!0,window.homeLayer&&window.homeLayer.refreshHeroData()),o.data.highRecord[5]++},getNewItemId:function(t,e,i){for(var n=0;n<=0;){var a=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_item).length)+1,s=c.get("cfg_item",a);if(o.data.equip.indexOf(a)<0&&(0==t&&s.get<=1||1==t&&0==s.get||2==t&&3!=s.get)){var r=0;if(e?s.quality==e&&(r=a):r=a,i?s.hero==o.data.heroId&&(n=r):s.hero!=o.data.heroId&&0!=s.hero||(n=r),s.unlock>0){var d=Math.floor((s.unlock-1)/4),h=(s.unlock-1)%4+1;o.data.clearance[d]<h&&(n=0)}}}return n},getNewCardId:function(t,e,i){for(var c=0;c<=0;){var n=o.getRandomCardId(null,e?2:1,t,i);o.data.deck.indexOf(n)<0&&o.data.cardBag.indexOf(n)<0&&(c=n)}return c},getRandomCardId:function(t,e,i,n){for(var a=0;a<=0;){var s=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_card).length)+1,r=c.get("cfg_card",s),d=Math.floor((r.unlock-1)/4),h=(r.unlock-1)%4+1;(n?r.hero==o.data.heroId:r.hero==o.data.heroId||0==r.hero)&&(3==e?r.get<=1:r.get==(e||1))&&(4!=o.data.heroId||r.element<7)&&(0==r.unlock||o.data.clearance[d]>=h)&&(t?r.element==t&&(a=s):i?r.quality==i&&(a=s):a=s)}return a},getNewMonsterId:function(t,e){for(var i=0,n=0;i<=0;){var a=Math.floor(Math.random()*Object.keys(c.jsonTable.cfg_monster).length)+1;o.data.monsterBeats.indexOf(a)<0&&c.get("cfg_monster",a).level==t&&c.get("cfg_monster",a).type==e&&(i=a),o.data.monsterUnbeats.indexOf(a)>=0&&n<500&&(i=0,n++)}return i},deleteItem:function(){var t=Math.floor(Math.random()*o.data.equip.length),e=o.data.equip[t];return o.data.equip.splice(t,1),10==e?o.data.itemEffect.feather=0:28==e?o.data.itemEffect.vase=0:29==e?o.data.itemEffect.flagon=0:40==e?(o.data.hpMax=Math.max(o.data.hpMax-5,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):41==e?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):46==e?o.data.itemEffect.vip1=!1:47==e?o.data.itemEffect.vip2=!1:72==e?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):74==e?o.data.itemEffect.pen=0:92==e?o.data.hpMax+=20:95==e?(o.data.hpMax=Math.max(o.data.hpMax-10,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):105==e?(o.data.hpMax=Math.max(o.data.hpMax-20,1),o.data.hp=Math.min(o.data.hpMax,o.data.hp)):106==e?(o.data.powerMax-=10,o.data.power=Math.min(o.data.powerMax,o.data.power)):158==e&&(o.data.itemEffect.reviveBook=0),e},analysisDesc:function(t,e,i){for(var c="",o=0,n="",a={1:"fire",2:"water",3:"wind",4:"earth",5:"light",6:"dark",7:"atk",9:"suck",11:"armor",12:"heal",13:"dodge",14:"power",15:"heart",16:"atkback",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind"},s={1:"FF3924",2:"1668E0",3:"00B74F",4:"FF7F12",5:"DB9F0F",6:"A950E4",7:1==e?"4A2E2B":"FFFFFF",9:"FF3924",11:"2CB4FF",12:"60E800",13:"DB9F0F",14:"DB9F0F",15:"FF3924",16:"FF3924",21:"FF3924",22:"2CB4FF",23:"FF3924",24:"E6791E",25:"2CB4FF",26:"A950E4",27:"96969E",28:"EDB332",29:"DB9F0F",30:"96969E"},r=0;r<t.length;r++)"#"==t[r]?0==o?(o=1,n="",c+="<img src='"):(c+=a[parseInt(n)],c+="'/>",o=0):"["==t[r]?(n="",0==o&&(o=2,c+="<color=#")):"]"==t[r]?""!=n?(c+=s[parseInt(n)],c+=">",o=-1):(o=0,c+="</c>"):o<=0?t[r]>="A"&&t[r]<="F"?c+=" <img src='dice"+(t[r].charCodeAt()-64)+"'/> ":c+=t[r]:n+=t[r];return i&&(c+="\uff0c<color=#FFEA00>\u79fb\u9664</c>"),c},analysisTip:function(t){var e="<img src='"+{13:"dodge",21:"burn",22:"freeze",23:"frail",24:"weak",25:"silence",26:"poison",27:"curse",28:"lock",29:"chaos",30:"blind"}[t]+"'/>";return e+="<color="+{13:"FFF830",21:"FF5567",22:"42EBFF",23:"FF5567",24:"D68F5E",25:"42EBFF",26:"BF7FE4",27:"B1B1B1",28:"E2BD6D",29:"FFF830",30:"B1B1B1"}[t]+">"+{13:"\u95ea\u907f",21:"\u71c3\u70e7",22:"\u51bb\u7ed3",23:"\u6613\u4f24",24:"\u865a\u5f31",25:"\u6c89\u9ed8",26:"\u4e2d\u6bd2",27:"\u8bc5\u5492",28:"\u7981\u9522",29:"\u6df7\u4e71",30:"\u76f2\u76ee"}[t]+": </c>"+{13:"\u8eb2\u907f\u5bf9\u624b\u4f7f\u7528\u7684\u653b\u51fb\u724c\uff0c\u89e6\u53d1\u540e\u5c42\u6570-1",21:"\u4f7f\u7528\u71c3\u70e7\u7684\u5361\u724c\u65f6\uff0c\u53d7\u52303\u706b\u4f24\u5bb3",22:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u88ab\u91cd\u63b7",23:"\u989d\u5916\u627f\u53d740%\u7684\u5361\u724c\u4f24\u5bb3\uff0c \u56de\u5408\u5f00\u59cb\u65f6\u5c42\u6570-1",24:"\u5361\u724c\u9020\u6210\u7684\u4f24\u5bb3\u51cf\u5c1130%\uff0c \u56de\u5408\u7ed3\u675f\u65f6\u5c42\u6570-1",25:"\u4f7f\u5361\u724c\u65e0\u6cd5\u4f7f\u7528",26:"\u56de\u5408\u5f00\u59cb\u65f6\u53d7\u5230\u4e2d\u6bd2\u5c42\u6570\u7684\u4f24\u5bb3\uff0c\u4e2d\u6bd2\u5c42\u6570-1",27:"\u4f7f\u7528\u5361\u724c\u65f6\u670950%\u6982\u7387\u65e0\u6548\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",28:"\u4f7f\u9ab0\u5b50\u65e0\u6cd5\u4f7f\u7528",29:"\u4f7f\u7528\u653b\u51fb\u724c\u65f6\u670950%\u6982\u7387\u653b\u51fb\u81ea\u8eab\uff0c \u89e6\u53d1\u540e\u5c42\u6570-1",30:"\u4f7f\u9ab0\u5b50\u7684\u5143\u7d20\u65e0\u6cd5\u88ab\u67e5\u770b"}[t]}};e.exports=o,cc._RF.pop()},{Config:"Config"}],Guide:[function(t,e,i){"use strict";cc._RF.push(e,"de3f2Q4A3JOtrWLJf8I4ofG","Guide");var c=t("Game");cc.Class({extends:cc.Component,properties:{mask:cc.Node,label:cc.Label,hand:cc.Node,btnNode:cc.Node,btnNode2:cc.Node,box:cc.Node},init:function(t){window.guide=this,this.id=t;var e=this.num=c.data.guide[t],i=!1,o=!1;c.data.guide[this.id]++,0==t?0==e?(this.hand.active=!1,this.btnNode.active=!0,i=!0,this.label.string="\u4eb2\u7231\u7684\u5192\u9669\u8005\uff0c\u662f\u5426\u9700\u8981\u6211\u6765\u5e2e\u52a9\u4f60\u4e86\u89e3\u4e00\u4e0b \u6e38\u620f\u73a9\u6cd5 \u5462\uff1f",this.btnNode.opacity=1,this.btnNode.y-=30,this.btnNode.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveBy(.2,cc.v2(0,30)),cc.fadeIn(.2))))):1==e?(this.hand.position=cc.v2(0,270),this.label.string="\u5411\u4e0a\u6ed1\u52a8 \u6216 \u70b9\u51fb\u51fa\u53e3 \u8fdb\u5165\u4e0b\u4e00\u4e2a\u623f\u95f4\u3002"):2==e&&(this.hand.rotation=180,this.hand.position=cc.v2(0,180),this.label.string="\u906d\u9047\u602a\u7269\uff0c\u70b9\u51fb\u8fdb\u5165\u6218\u6597\u3002"):1==t?0==e?(o=!0,this.hand.rotation=180,this.hand.position=cc.v2(0,-cc.winSize.height/2+310),this.label.string="\u4e0b\u65b9\u662f\u4f60\u63b7\u51fa\u6765\u7684\u5143\u7d20\u9ab0\u5b50\u3002"):1==e?(o=!0,this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u4e0a\u9762\u662f\u4f60\u643a\u5e26\u7684\u5143\u7d20\u6280\u80fd\u5361\u724c\u3002"):2==e?(this.hand.position=cc.v2(-248,-cc.winSize.height/2+600),this.label.string="\u70b9\u4eae\u5361\u724c\u6240\u9700\u5143\u7d20\uff0c\u5373\u53ef\u4f7f\u7528\u5361\u724c\u3002\u70b9\u51fb\u91ca\u653e\u5361\u724c\u6280\u80fd!"):3==e?(this.hand.rotation=180,this.hand.position=cc.v2(310,-cc.winSize.height/2+180),this.label.string="\u672a\u70b9\u4eae\u7684\u5361\u724c\u4e0d\u80fd\u4f7f\u7528\uff0c\u600e\u4e48\u529e\u5462\uff1f\u70b9\u51fb \u91cd\u63b7 \u6309\u94ae\uff0c\u53ef\u4ee5\u91cd\u65b0\u6295\u51fa\u9ab0\u5b50\u3002",window.host.checkBtnRoll()):4==e?(this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u8fd0\u6c14\u4e0d\u9519\uff01\u6210\u529f\u70b9\u4eae\u5361\u724c\uff0c\u70b9\u51fb\u91ca\u653e\uff01"):5==e&&(this.hand.position=cc.v2(290,-cc.winSize.height/2+760),this.label.string="\u5b8c\u7f8e\uff01\u624b\u724c\u5168\u90e8\u6253\u5b8c\uff0c\u70b9\u51fb \u56de\u5408\u7ed3\u675f\u3002\u4e0b\u56de\u5408\u770b\u4f60\u7684\u8868\u73b0\uff01"):2==t?0==e?(this.hand.rotation=180,this.hand.position=cc.v2(-110,-cc.winSize.height/2+310),this.label.string="\u70b9\u51fb\u9ab0\u5b50 \u53ef\u9501\u5b9a/\u89e3\u9501\uff0c\u5728\u91cd\u63b7\u9ab0\u5b50\u65f6\u88ab\u4fdd\u7559\uff0c\u9002\u5408\u70b9\u4eae\u591a\u9700\u6c42\u5361\u724c\u3002"):1==e?(this.hand.rotation=180,this.hand.position=cc.v2(-280,-cc.winSize.height/2+230),this.label.string="\u70b9\u51fb \u6548\u679c\u56fe\u6807 \u53ef\u67e5\u770b\u6548\u679c\u8be6\u7ec6\u8bf4\u660e\u3002"):2==e&&(this.hand.rotation=180,this.hand.position=cc.v2(70,-cc.winSize.height/2+180),this.label.string="\u53d7\u5230\u4f24\u5bb3\u53ef\u83b7\u5f97\u6012\u6c14\u3002\u6d88\u8017\u4e00\u5b9a\u6012\u6c14\uff0c\u53ef\u91ca\u653e\u6012\u6c14\u6280\u80fd\uff0c\u70b9\u51fb\u91ca\u653e\u3002"):3==t?0==e?(o=!0,this.hand.position=cc.v2(0,-cc.winSize.height/2+600),this.label.string="\u63b7\u51fa\u7684\u9ab0\u5b50\u5143\u7d20\u7b26\u5408\u5956\u52b1\u5f00\u542f\u6761\u4ef6\uff0c\u5373\u53ef\u6fc0\u6d3b\u5956\u52b1\u3002"):1==e?(o=!0,this.hand.rotation=180,this.hand.position=cc.v2(160,-cc.winSize.height/2+130),this.label.string="\u4e24\u4e2a\u5c0f\u6280\u80fd 2\u90091 \u91ca\u653e\uff0c\u53ef\u5e2e\u52a9\u4f60\u83b7\u5f97\u66f4\u591a\u5956\u52b1\u3002"):2==e?(o=!0,this.hand.position=cc.v2(190,-cc.winSize.height/2+810),this.label.string="\u89c9\u5f97\u6ee1\u610f\u4e86\u968f\u65f6\u53ef\u4ee5\u9886\u53d6\u5956\u52b1\u79bb\u5f00\uff0c\u4e0d\u8981\u592a\u8d2a\u5fc3\u54af\u3002"):3==e&&(o=!0,this.hand.active=!1,this.label.string="\u63a5\u4e0b\u6765\u5c31\u770b\u4f60\u7684\u5566\u3002"):4==t?(this.hand.active=!1,this.btnNode2.active=!0,i=!0,this.label.string="\u57fa\u7840\u4ecb\u7ecd\u5b8c\u6210!\r\n\u6b63\u5f0f\u7684\u5192\u9669\u8fd8\u6709\u66f4\u591a\u7cbe\u5f69\u5185\u5bb9!\r\n\u63a5\u4e0b\u6765\u4f60\u60f3..."):5==t&&(0==e?(this.hand.rotation=180,this.hand.position=cc.v2(312,-cc.winSize.height/2+110),this.label.string="\u83b7\u5f97\u65b0\u7684\u5361\u724c\u540e\uff0c\u53ef\u8fdb\u5165\u5361\u5305\u66f4\u6362\u51fa\u6218\u5361\u724c\u3002"):1==e&&(o=!0,this.hand.position=cc.v2(0,cc.winSize.height/2-400),this.label.string="\u70b9\u51fb\u5df2\u51fa\u6218\u5361\u724c\u53ef\u653e\u56de\u5361\u5305\uff0c\u70b9\u51fb\u5361\u5305\u4e2d\u7684\u724c\u53ef\u66f4\u6362\u4e3a\u51fa\u6218\u5361\u724c\u3002")),this.box.opacity=1,this.box.y-=30,this.label.node.opacity=1,this.label.node.y-=30,this.box.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,30)),cc.fadeIn(.2))),this.label.node.runAction(cc.sequence(cc.delayTime(.1),cc.spawn(cc.moveBy(.2,cc.v2(0,30)),cc.fadeIn(.2)),cc.callFunc(function(){o?this.mask.once(cc.Node.EventType.TOUCH_START,this.close,this):i||(this.mask.active=!1)}.bind(this)))),180==this.hand.rotation?this.hand.runAction(cc.sequence(cc.spawn(cc.moveBy(.3,cc.v2(0,-20)),cc.scaleTo(.3,1,.9)),cc.moveBy(.3,cc.v2(0,20)),cc.scaleTo(.3,1,1)).repeatForever()):this.hand.runAction(cc.sequence(cc.spawn(cc.moveBy(.3,cc.v2(0,20)),cc.scaleTo(.3,1,.9)),cc.moveBy(.3,cc.v2(0,-20)),cc.scaleTo(.3,1,1)).repeatForever())},close:function(){var t=c.data.guide[this.id];this.node&&this.node.destroy(),window.guide=null,0==this.id?1==t&&window.homeLayer.showGuide(0):1==this.id?1!=t&&2!=t&&4!=t&&5!=t||window.mainLayer.showGuide(1):3==this.id&&t<4&&window.tavernLayer.showGuide(3)},startGuide:function(){this.close(),window.homeLayer.initPath(),window.homeLayer.refreshPath(),c.data.floorQuests[0]=[[1],[3],[1],[4],[7],[6],[8]],c.data.deck=[67,1,2]},skip:function(){c.guiding=!1,c.data.rookie?(c.data.rookie=!1,c.data.guide=[-1,-1,-1,-1,-1,c.data.guide[5]],this.node.destroy(),window.guide=null,window.homeLayer.initPath(),window.homeLayer.refreshPath()):(c.tempGuideData&&(c.data=c.tempGuideData),window.loadingBrown.doStart(function(){window.homeLayer=null,cc.director.loadScene("cover")}.bind(this)))},reguide:function(){this.close(),c.setDataToBase(),c.data.guide=[0,0,0,0,0,c.data.guide[5]],c.begin=!0,c.newCard=!1,window.loadingMask.close(function(){cc.director.loadScene("helloworld",function(){window.loadingMask.open()}.bind(this))}.bind(this))},goBattle:function(){this.close(),c.setDataToBase(),c.data.guide=[-1,-1,-1,-1,-1,c.data.guide[5]],c.guiding=!1,c.data.rookie?(c.data.rookie=!1,c.data.startTime=Date.now(),c.data.restartCount=999,c.begin=!0,c.newCard=!1,window.loadingMask.close(function(){cc.director.loadScene("helloworld",function(){window.loadingMask.open()}.bind(this))}.bind(this))):(c.tempGuideData&&(c.data=c.tempGuideData),window.loadingBrown.doStart(function(){window.homeLayer=null,cc.director.loadScene("cover")}.bind(this)))}}),cc._RF.pop()},{Game:"Game"}],HelloWorld:[function(t,e,i){"use strict";cc._RF.push(e,"ccc53972FhL0qaXGUz6Mc6F","HelloWorld");var c=t("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,roomPrefab:cc.Prefab,stripHp:cc.ProgressBar,txtHp:cc.Label,stripExp:cc.ProgressBar,head:cc.Sprite,txtName:cc.Label,txtLevel:cc.Label,txtCopper:cc.Label,markRed:cc.Node,campPrefab:cc.Prefab,treasurePrefab:cc.Prefab,eventPrefab:cc.Prefab,bagPrefab:cc.Prefab,bag2Prefab:cc.Prefab,equipPrefab:cc.Prefab,shopPrefab:cc.Prefab,mapPrefab:cc.Prefab,lvUpPrefab:cc.Prefab,btnEquip:cc.Button,btnDeck:cc.Button,chessPrefab:cc.Prefab,fortPrefab:cc.Prefab,boxFort:cc.Node,cardChangePrefab:cc.Prefab,cardDeletePrefab:cc.Prefab,guidePrefab:cc.Prefab,btnEdit:cc.Node,layerNode:cc.Node,healAnimation:dragonBones.ArmatureDisplay,settingPrefab:cc.Prefab,btnNode:cc.Node},onLoad:function(){window.homeLayer=this,cc.audioEngine.playMusic(window.sound.bgmMap[4==c.data.castle?2:c.data.castle-1],!0),this.boxFort.active=!1,c.guiding&&0==c.data.guide[0]||this.initPath(),c.data.historyChoose.length<=1&&this.initGameConfig(),this.hero=cc.instantiate(this.chessPrefab),this.bg.addChild(this.hero),this.createRoom(),this.refreshHeroData(),c.data.levelUp&&this.scheduleOnce(this.openLvUp,.3),c.data.deck.length+c.data.cardBag.length>=7&&!c.guiding&&0==c.data.guide[5]&&this.showGuide(5);var t=750*cc.winSize.height/cc.winSize.width;this.btnEdit.runAction(cc.sequence(cc.delayTime(1),cc.moveBy(.3,cc.v2(0,t>1600?-140:-80)))),this.scheduleOnce(function(){t>1600&&(this.boxFort.y-=60)}.bind(this),.1)},createRoom:function(){var t=cc.instantiate(this.roomPrefab);this.bg.addChild(t),this.room=t,this.hero.parent=t,this.hero.zIndex=10,c.begin?(t.getComponent("Room").init(!1),c.begin=!1):t.getComponent("Room").init(!1)},changeRoom:function(t){var e=cc.instantiate(this.roomPrefab);this.bg.addChild(e),e.getComponent("Room").init(!0);var i=cc.v2();0==t?(e.position=cc.v2(0,1450),i=cc.v2(0,-1450)):1==t?(e.position=cc.v2(1080,0),i=cc.v2(-1080,0)):2==t?(e.position=cc.v2(0,-1450),i=cc.v2(0,1450)):3==t&&(e.position=cc.v2(-1080,0),i=cc.v2(1080,0));var c=this.room;c.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.hero.parent=e,this.hero.zIndex=10,c.destroy()}.bind(this)))),e.runAction(cc.sequence(cc.moveBy(.3,i),cc.callFunc(function(){this.room=e,e.getComponent("Room").initHero()}.bind(this))))},openAlter:function(){if(2==c.data.roomType){if(!window.campLayer){var t=cc.instantiate(this.campPrefab);this.node.addChild(t)}}else if(3==c.data.roomType)window.treasureLayer||this.openTreasure();else if(4==c.data.roomType){if(!window.eventLayer){var e=cc.instantiate(this.eventPrefab);this.node.addChild(e)}}else if(5==c.data.roomType){if(!window.shopLayer){var i=cc.instantiate(this.shopPrefab);this.layerNode.addChild(i),this.btnNode.runAction(cc.moveTo(.2,cc.v2(45,this.btnNode.y)))}}else 6==c.data.roomType&&window.loadingRoll.doStart(function(){cc.director.loadScene("tavern"),window.homeLayer=null}.bind(this))},refreshHeroData:function(){this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax;var t=[5,15,21,39,47,73,150][c.data.level-1];this.stripExp.progress=c.data.exp/t;this.txtName.string=["\u65e0\u754f\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9884\u8a00\u8005","\u5192\u9669\u8005","\u5192\u9669\u8005"][c.data.heroId-1],this.txtLevel.string="Lv."+c.data.level,this.txtCopper.string=c.data.copper,cc.loader.loadRes("Texture/hero/head/"+c.data.heroId,cc.SpriteFrame,function(t,e){this.head.spriteFrame=e}.bind(this)),this.markRed.active=c.newCard},openMap:function(){this.scheduleOnce(function(){var t=cc.instantiate(this.mapPrefab);this.node.addChild(t)}.bind(this),.2)},openCardBag:function(){if(!c.guiding||0!=c.data.guide[1]){var t=cc.instantiate(4==c.data.heroId?this.bag2Prefab:this.bagPrefab);this.node.addChild(t),this.btnDeck.interactable=!1}},openEquip:function(){if(!c.guiding||0!=c.data.guide[1]){var t=cc.instantiate(this.equipPrefab);this.node.addChild(t),this.btnEquip.interactable=!1}},openTreasure:function(){var t=cc.instantiate(this.treasurePrefab);t.getComponent("TreasureLayer").init(),this.node.addChild(t)},openLvUp:function(){var t=cc.instantiate(this.lvUpPrefab);this.node.addChild(t)},openSetting:function(){var t=cc.instantiate(this.settingPrefab);this.node.addChild(t,100)},initDeck:function(){if(4==c.data.heroId)c.data.cardBag=[1,2,3,4,5,6];else{var t=5==c.data.heroId?2:3;if(c.data.deck.length+c.data.cardBag.length<=t)for(;c.data.deck.length+c.data.cardBag.length<t;){var e=c.getNewCardId(null,!0);c.getCard(e)}}},initGameConfig:function(){this.initDeck(),c.data.eventIds=[];for(var t=0;t<30;t++){var e=Math.floor(Math.random()*(c.data.eventIds.length+1));c.data.eventIds.splice(e,0,t+1)}c.data.specialRoomIds=[3,4];for(var i=[[2,6,5],[2,3,4,6,5],[2,3,4,6]],o=0;o<3;o++)for(var n=i[o],a=n.length-1;a>=0;a--){var s=Math.floor(Math.random()*n.length);c.data.specialRoomIds.push(n[s]),n.splice(s,1)}c.data.specialRoomIds.push(5),c.data.floorQuests=[[],[],[],[[8],[-1]]];for(var r=0;r<3;r++)for(var d=0;d<13;d++)this.initFloorConfig(r,d)},initFloorConfig:function(t,e){var i=[];if(0==e)i=[1];else if(4==e)i=[7,7];else if(11==e)i=[8];else if(12==e)i=[0];else if(2==e||5==e||7==e||9==e)i=Math.random()<.4?[1,1,1]:[1,1];else{var o=c.data.specialRoomIds.shift();i=Math.random()<.3?[o,1,1]:[o,1]}c.data.floorQuests[t].push(i)},gotoEdit:function(){cc.director.loadScene("edit")},goBattle:function(){window.loadingRoll.doStart(function(){window.homeLayer=null,cc.director.loadScene("mainLayer")}.bind(this))},initPath:function(){this.boxFort.active=!0,this.boxFort.removeAllChildren(),this.pathList=[];for(var t=4==c.data.castle?2:c.guiding?8:13,e=0;e<t;e++){var i=cc.instantiate(this.fortPrefab);i.x=-(t-1)/2*34+34*e,this.boxFort.addChild(i),this.pathList.push(i),0==e?(i.x-=10,i.getComponent("Fort").init(0,1)):e==t-1?(i.x+=10,i.getComponent("Fort").init(8,1)):e<=c.data.historyChoose.length-2?i.getComponent("Fort").init(1,1):i.getComponent("Fort").init(1,0)}},refreshPath:function(){this.pathList&&(this.pathList[c.data.floor-1].getComponent("Fort").show(),c.data.floor>1&&this.pathList[c.data.floor-2].getComponent("Fort").hide())},getCard:function(t){if(1==c.data.heroId&&3==c.data.difficulty)if(c.data.deck.length<6)c.getCard(t);else{var e=cc.instantiate(this.cardChangePrefab);e.getComponent("CardChangeLayer").init(t),this.node.addChild(e,100)}else c.getCard(t)},openDelete:function(){var t=cc.instantiate(this.cardDeletePrefab);this.node.addChild(t,100)},showGuide:function(t){this.scheduleOnce(function(){if(!window.guide){var e=cc.instantiate(this.guidePrefab);e.getComponent("Guide").init(t),this.node.addChild(e)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],HeroCard:[function(t,e,i){"use strict";cc._RF.push(e,"96967OGdmJM/I9AKOkmBBWg","HeroCard"),cc.Class({extends:cc.Component,properties:{bg:cc.Node,txtName:cc.Label,cover:cc.Sprite,figure:cc.Sprite,back:cc.Sprite,mask:cc.Node},init:function(t,e){var i=["\u65e0\u754f\u8005","\u6697\u6740\u8005","\u6b4c\u9882\u8005","\u9884\u8a00\u8005"];e>0?this.txtName.string=i[t-1]+"\u3010"+["\u666e\u901a","\u9ad8\u624b","\u5927\u5e08","\u738b\u8005"][e-1]+"\u3011":(this.txtName.string=i[t-1],e=1);this.txtName.node.color=this.txtName.getComponent(cc.LabelOutline).color=cc.Color.WHITE.fromHEX(["#44EB7E","#58F1FF","#FE98FC","#FEEC42"][e-1]);var c=[cc.color(35,96,46),cc.color(36,74,117),cc.color(132,26,152),cc.color(169,30,13)];this.bg.color=c[e-1],cc.loader.loadRes("Texture/hero/figure/"+t,cc.SpriteFrame,function(t,e){this.figure.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/hero/card/card"+e,cc.SpriteFrame,function(t,e){this.cover.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/hero/card/back"+e,cc.SpriteFrame,function(t,e){this.back.spriteFrame=e}.bind(this))},runOut:function(){this.back.node.active=!0,this.mask.active=!0,this.bg.opacity=0,this.node.opacity=0,this.node.scale=.4,this.node.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.3,1)),cc.callFunc(function(){this.bg.opacity=255,this.mask.runAction(cc.sequence(cc.fadeOut(.2),cc.delayTime(.3),cc.callFunc(function(){this.turn()}.bind(this))))}.bind(this))))},turn:function(){this.node.runAction(cc.sequence(cc.scaleTo(.2,0,1),cc.callFunc(function(){this.back.node.active=!1}.bind(this)),cc.scaleTo(.2,1)))}}),cc._RF.pop()},{}],Hero:[function(t,e,i){"use strict";var c;function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"7311fX1RYNN1bDgBGcTZsee","Hero");var n=t("Game");cc.Class({extends:cc.Component,properties:(c={stripHp:cc.ProgressBar,barHp:cc.Node,txtHp:cc.Label,stripPower:cc.ProgressBar,txtPower:cc.Label,boxBuff:cc.Node,txtNum:cc.Node,boxArmor:cc.Node,txtArmor:cc.Label,txtBuff:cc.RichText,boxEquip:cc.Node,skillPrefab:cc.Prefab,head:cc.Node,skillNode:cc.Node},o(c,"head",cc.Sprite),o(c,"btnRoll",cc.Button),o(c,"imageShadow",cc.Node),o(c,"txtRollCount",cc.Label),o(c,"diceAnimation",dragonBones.ArmatureDisplay),c),onLoad:function(){this.player=this.getComponent("Player"),this.buff=this.getComponent("Buff"),this.equip=this.getComponent("Equip"),cc.loader.loadRes("Texture/hero/head/"+n.data.heroId,cc.SpriteFrame,function(t,e){this.head.spriteFrame=e}.bind(this))},init:function(){this.btnEnd=window.mainLayer.btnEnd,this.initDeck(),this.diceCount=5,3==n.data.heroId&&(3==n.data.difficulty?this.diceCount=2:this.diceCount=4),this.player.init(0),this.hpMax=n.data.hpMax,this.hp=n.data.hp,this.power=n.data.power,n.guiding&&0==n.data.guide[2]&&(this.power=3),this.powerMax=n.data.powerMax,this.armor=0,this.rollabled=!0,this.round=0,this.refreshStrip(),this.initSkills()},startRound:function(t){if(!window.mainLayer.gameOver){if(t)window.mainLayer.txtRound.string="\u989d\u5916\u56de\u5408";else{if(this.round++,this.round>15)return void window.mainLayer.showEnd(1);window.mainLayer.txtRound.string=this.round>=15?"\u6700\u7ec8\u56de\u5408":"\u7b2c"+this.round+"\u56de\u5408"}var e=window.mainLayer.boxHeroRound;e.y=8,e.scale=.2,e.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.scaleTo(.25,1.05),cc.scaleTo(.1,1),cc.callFunc(function(){this.player.startRound()}.bind(this)),cc.delayTime(.6),cc.spawn(cc.moveBy(.3,cc.v2(0,300)),cc.fadeOut(.3)),cc.callFunc(function(){this.player.checkStart(),this.scheduleOnce(function(){1==n.data.guide[2]?window.mainLayer.showGuide(2):2==n.data.guide[2]&&(this.power<10&&this.addPower(10-this.power),window.mainLayer.showGuide(2))}.bind(this),.2),this.scheduleOnce(function(){window.mainLayer.gameOver||(this.btnEnd.runAction(cc.moveTo(.2,cc.v2(285,this.btnEnd.y))),this.btnEnd.getComponent(cc.Button).interactable=!0)}.bind(this),1),this.player.checkEquipAbled(),this.player.opponent.checkEquipAbled()}.bind(this))))}},endRound:function(){for(var t=0;t<2;t++)this.btnSkills[t].getComponent("Skill").abled=!0;this.checkSkills(),this.btnEnd.stopAllActions(),this.btnEnd.runAction(cc.moveTo(.2,cc.v2(485,this.btnEnd.y))),this.btnEnd.getComponent(cc.Button).interactable=!1,this.player.totalRollCount=this.player.rollCount,this.player.rollCount=0,this.checkBtnRoll()},refreshStrip:function(){this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},roll:function(){this.rollabled&&(this.diceAnimation.playAnimation("play1"),this.rollabled=!1,this.scheduleOnce(function(){this.rollabled=!0,this.btnRoll.interactable?(this.diceAnimation.playAnimation("play0"),this.imageShadow.active=!1):(this.diceAnimation.node.active=!1,this.imageShadow.active=!0)}.bind(this),.5),3==n.data.heroId?window.mainLayer.chooseDice():this.player.roll())},onHurt:function(t,e,i,c){if(!window.mainLayer.gameOver){var o=this.hp;if(i=i||7,c=null!=c?c:1,this.player.onHurt(t,e,i,c),this.hp<=0&&(this.hp=0,window.mainLayer.showEnd(1)),o>this.hp){var n=o-this.hp;this.equip.checkWithTrigger(163)&&(n*=2),this.addPower(n)}}},onHeal:function(t){this.equip.checkWithTrigger(76)&&(t=Math.floor(1.5*t)),this.player.onHeal(t),this.player.assertHpChange("+"+t,1),this.hp=Math.min(this.hp,this.hpMax),this.txtHp.string=this.hp+"/"+this.hpMax,this.stripHp.progress=this.hp/this.hpMax},addPower:function(t){t>0&&this.player.opponent.equip.checkWithTrigger(178)||(this.power+=t,this.power=Math.min(this.power,this.powerMax),this.txtPower.string=this.power+"/"+this.powerMax,this.stripPower.progress=this.power/this.powerMax,this.checkSkills())},initSkills:function(){this.btnSkills=[];for(var t=0;t<2;t++){var e=cc.instantiate(this.skillPrefab);e.position=cc.v2(0==t?-58:58,-42),e.getComponent("Skill").init(t),this.skillNode.addChild(e),this.btnSkills.push(e)}},checkSkills:function(){for(var t=0;t<2;t++)this.btnSkills[t].getComponent("Skill").check()},checkBtnRoll:function(t){var e=!1;this.player.rollCount>0&&this.player.diceList.length>0&&(e=!0),n.guiding&&(2==n.data.floor&&n.data.guide[1]<4||4==n.data.floor&&0==n.data.guide[2])&&(e=!1),e?(this.btnRoll.interactable=!0,this.imageShadow.active=!1,this.diceAnimation.node.active||(this.diceAnimation.node.active=!0,this.diceAnimation.playAnimation("play0"))):(this.btnRoll.interactable=!1,"play0"==this.diceAnimation.animationName&&(this.diceAnimation.node.active=!1,this.imageShadow.active=!0)),this.player.rollCount>0?"0"==this.txtRollCount.string?(this.txtRollCount.string=this.player.rollCount,this.txtRollCount.node.runAction(cc.scaleTo(.2,1))):this.txtRollCount.string-this.player.rollCount!=0&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=this.player.rollCount}.bind(this)),cc.scaleTo(.2,1))):"0"!=this.txtRollCount.string&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=0}.bind(this))))},initDeck:function(){if(4==n.data.heroId){if(this.deck=n.data.cardBag.concat(),3==n.data.difficulty)for(var t=0;t<n.data.level;t++)this.deck.push(224)}else this.deck=n.data.deck.concat()},doShake:function(t){var e={1:"EA6769",2:"30EEFF",3:"24A63B",4:"978535",5:"B98D24",6:"5A688F",7:"B8565D",8:"B8565D",9:"B8565D",16:"9C434A",21:"EA6769",22:"30EEFF",23:"986951",24:"70821F",25:"52E3A2",26:"6E2363",27:"486545",28:"A17B2A",29:"B98D24",30:"677651"};e[t]&&(this.head.color=cc.Color.WHITE.fromHEX("#"+e[t]),window.mainLayer.camera.stopAllActions(),window.mainLayer.camera.runAction(cc.sequence(cc.moveTo(.05,cc.v2(5,5)),cc.moveTo(.1,cc.v2(-5,-5)),cc.moveTo(.08,cc.v2(0,0)),cc.callFunc(function(){window.mainLayer.camera.position=cc.v2(0,0),this.head.color=cc.Color.WHITE}.bind(this)))))}}),cc._RF.pop()},{Game:"Game"}],ItemCollection:[function(t,e,i){"use strict";cc._RF.push(e,"ab80d9GfjVBrqTZMJrGxGF9","ItemCollection");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,txtQuality:cc.Label,txtDesc:cc.RichText,icon:cc.Sprite,boxHead:cc.Sprite},init:function(t,e){this.index=e;var i=o.get("cfg_item",t);this.cfg=i;var n=[cc.color(85,229,255),cc.color(255,128,242),cc.color(255,154,73)];this.txtName.string=i.name;var a=c.analysisDesc(i.desc1,1),s=-1;10==t?s=c.data.itemEffect.feather>0?1:0:28==t?s=c.data.itemEffect.vase:29==t?s=c.data.itemEffect.flagon:74==t?s=c.data.itemEffect.pen:158==t&&(s=c.data.itemEffect.reviveBook>0?1:0),s>=0&&(a+="<color=#EBC82E>  (\u5269\u4f59\u6b21\u6570"+s+")</c>"),this.txtDesc.string=a,this.txtQuality.string=["\u666e\u901a","\u7a00\u6709","\u53f2\u8bd7"][i.quality-1],this.txtQuality.node.color=n[i.quality-1],cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/UI/box_icon"+i.quality,cc.SpriteFrame,function(t,e){this.boxHead.spriteFrame=e}.bind(this))},touch:function(){for(var t=[],e=this.cfg.desc1.split("#"),i=0;i<e.length;i++){var c=parseInt(e[i]);(13==c||c>=21&&c<=30)&&t.push(c)}window.equipLayer.showTips(t,this.index)}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ItemCommodity:[function(t,e,i){"use strict";cc._RF.push(e,"f3b0dTDz+lCm6po5gYe0nnB","ItemCommodity");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{txtName:cc.Label,icon:cc.Sprite,bg:cc.Sprite,txtDesc:cc.RichText,boxIcon:cc.Sprite,btn:cc.Button,mask:cc.Node,txtChosen:cc.Node,markDelete:cc.Node,txtEmpty:cc.Node,nail:cc.Node,tip:cc.Node,tipNode:cc.Node},init:function(t,e){if(t<=0)this.btn.node.active=!1,this.markDelete.active=!0,this.txtEmpty.active=!0;else{var i=o.get("cfg_item",t);this.cfg=i,this.cfgId=t,this.txtName.string=i.name,this.txtDesc.string=c.analysisDesc(i.desc1),cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/UI/box_item"+i.quality,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this)),this.btn.interactable=e}},runOut:function(t,e){this.index=e,this.mask.active=!0,this.node.opacity=1,this.bg.node.opacity=1,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*e),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,t),cc.scaleTo(.2,1)),cc.callFunc(function(){this.bg.node.opacity=255,this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},enableChoosen:function(){this.btn.interactable=!0,this.txtChosen.active=!0,this.txtChosen.opacity=0,this.txtChosen.y-=50,this.txtChosen.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))),cc.callFunc(function(){this.showTip()}.bind(this))))},hideBox:function(){cc.loader.loadRes("Texture/UI/box_icon"+this.cfg.quality,cc.SpriteFrame,function(t,e){this.boxIcon.spriteFrame=e}.bind(this)),this.bg.node.active=!1,this.tipNode.active=!1},choose:function(){window.treasureLayer?(c.getItem(this.cfgId),this.got(),window.treasureLayer.close(this.index),cc.audioEngine.playEffect(window.sound.selectSound)):window.treasureChest?window.treasureChest.chooseEquip(this.cfgId):window.levelUpLayer&&window.levelUpLayer.choose(this.cfgId),this.btn.interactable=!1},got:function(){this.hideBox(),this.txtChosen.active=!1;var t=cc.winSize.height/cc.winSize.width*750;this.boxIcon.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.spawn(cc.scaleTo(.3,.3),cc.moveTo(.3,cc.v2(175-this.node.x,-t/2+65-this.node.y-this.node.parent.y)))))},showTip:function(){for(var t=this,e=[],i=this.cfg.desc1.split("#"),o=0;o<i.length;o++){var n=parseInt(i[o]);(13==n||n>=21&&n<=30)&&e.push(n)}this.tips=[];for(var a=0,s=function(i){var o=e[i],n=cc.instantiate(t.tip);n.active=!0;var s=n.getChildren()[0];n.position=cc.v2(0,60),t.tipNode.addChild(n),t.tips.push(n),n.runAction(cc.sequence(cc.delayTime(.2*i),cc.moveTo(.2,cc.v2(0,140+a)),cc.callFunc(function(){s.runAction(cc.fadeIn(.2))}.bind(t)))),s.getComponent(cc.RichText).string=c.analysisTip(o),n.height=10+s.height,a+=n.height+10},r=0;r<e.length;r++)s(r)},hideTip:function(){if(this.tips)for(var t=0;t<this.tips.length;t++)this.tips[t].runAction(cc.fadeOut(.2));this.txtChosen.active&&this.txtChosen.runAction(cc.fadeOut(.2))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],Item:[function(t,e,i){"use strict";cc._RF.push(e,"3a4a3eddFJBpLM6kSrb9Bn8","Item");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{icon:cc.Sprite,iconBtn:cc.Button,boxNum:cc.Node,txtCount:cc.Label,tip:cc.Node,txtDesc:cc.RichText,box:cc.Node,bg:cc.Sprite},init:function(t,e,i){this.cfgId=t,this.cfg=o.get("cfg_item",t),this.equip=e,cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),43!=t&&146!=t&&166!=t||(this.boxNum.active=!0),i&&(this.boxNum.active=!1,cc.loader.loadRes("Texture/UI/box_icon"+this.cfg.quality,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this))),this.layer=window.mainLayer||window.completeLayer},trigger:function(){this.action&&this.icon.node.stopAction(this.action),this.action=cc.sequence(cc.scaleTo(.25,1.5),cc.scaleTo(.25,1),cc.callFunc(function(){this.action=null,1==this.cfg.num&&this.doDisabled()}.bind(this))),this.icon.node.runAction(this.action)},doDisabled:function(){this.iconBtn.enableAutoGrayEffect=!0},doAbled:function(){this.iconBtn.enableAutoGrayEffect=!1},openTip:function(){if(!this.equip||1!=this.equip.index){if(this.layer.equipTip){if(this.layer.equipTip==this)return void this.hideTip();this.layer.equipTip.hideTip()}this.tip.active=!0,this.layer.equipTip=this;this.txtDesc.string="<color=#"+["5CC7FF","C262FF","FF9231"][this.cfg.quality-1]+">"+this.cfg.name+"\uff1a</c>"+c.analysisDesc(this.cfg.desc1),this.box.height=this.txtDesc.node.height+15,this.node.x<-220?this.box.x=-220-this.node.x:this.node.x>220&&(this.box.x=220-this.node.x),this.scheduleOnce(this.hideTip,5)}},hideTip:function(){this.unscheduleAllCallbacks(),this.tip.active=!1,this.layer.equipTip=null},refresh:function(t){this.cfgId=t,this.cfg=o.get("cfg_item",t),cc.loader.loadRes("Texture/equip/"+t,cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),43!=t&&146!=t&&166!=t||(this.boxNum.active=!0),this.iconBtn.enableAutoGrayEffect=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LevelUpLayer:[function(t,e,i){"use strict";cc._RF.push(e,"bdb92ld599JPZMXSf9CLd3t","LevelUpLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{box:cc.Node,cover:cc.Node,txtLevel:cc.Label,mask:cc.Node,boxSkill:cc.Node,iconSkill:cc.Sprite,txtSkillName:cc.Label,txtSkillDesc:cc.Label,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,hand:cc.Node,hand1:cc.Node,hand2:cc.Node,boxNode:cc.Node,coverNode:cc.Node,bg:cc.Node,txtTitle:cc.Label},onLoad:function(){window.levelUpLayer=this,this.type=3,3==c.data.level?this.initSkill():5==c.data.level||7==c.data.level?(this.type=2,this.initItems()):(this.type=1,this.initCards()),this.txtLevel.string=c.data.level,cc.audioEngine.playEffect(window.sound.levelUpSound),this.doActions()},doActions:function(){this.hand1.x+=200,this.hand2.x+=200,this.bg.y-=1200,this.bg.runAction(cc.sequence(cc.moveBy(.4,cc.v2(0,1200)),cc.callFunc(function(){this.bg.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever()),this.hand1.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(-200,0)))),this.hand2.runAction(cc.sequence(cc.delayTime(.6),cc.moveBy(.2,cc.v2(-200,0))))}.bind(this)))),this.mask.runAction(cc.fadeTo(.4,210)),this.coverNode.runAction(cc.sequence(cc.delayTime(1.3),cc.moveBy(.1,cc.v2(0,10)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.2,cc.v2(0,140)),cc.moveBy(.3,cc.v2(40,600)))),this.cover.runAction(cc.sequence(cc.delayTime(1.3),cc.rotateTo(.1,-.5),cc.rotateTo(.1,1),cc.rotateTo(.2,-5),cc.rotateTo(.3,5)))},initCards:function(){this.itemIdList=[],this.items=[];for(var t=0;t<=0;){var e=c.getNewCardId(null,null,!0);(c.data.castle>1||o.get("cfg_card",e).quality<3)&&(t=e)}this.itemIdList.push(t);for(var i=0;i<=0;){var n=c.getNewCardId(null,null,!0);n!=t&&(c.data.castle>1||o.get("cfg_card",n).quality<3)&&(i=n)}this.itemIdList.push(i);for(var a=0;a<2;a++){var s=cc.instantiate(this.cardPrefab);s.getComponent("CardCollection").init(this.itemIdList[a],3),s.getComponent("CardCollection").txtChosen.active=!0,s.getComponent("CardCollection").txtChosen.y+=20,s.position=cc.v2(0==a?-140:140,-60),this.box.addChild(s),this.items.push(s)}},initItems:function(){this.itemIdList=[],this.items=[];var t=c.getNewItemId(0,null,!0);this.itemIdList.push(t);for(var e=0;e<=0;){var i=c.getNewItemId(0,null,!0);i!=t&&(e=i)}this.itemIdList.push(e);for(var o=0;o<2;o++){var n=cc.instantiate(this.itemPrefab);n.getComponent("ItemCommodity").init(this.itemIdList[o],!0),n.getComponent("ItemCommodity").txtChosen.active=!0,n.position=cc.v2(0==o?-140:140,-55),this.box.addChild(n),this.items.push(n)}},initSkill:function(){this.txtTitle.string="\u89e3\u9501\u6012\u6c14\u6280\u80fd",this.boxSkill.active=!0;var t=o.get("cfg_hero",c.data.heroId);this.txtSkillName.string=t.skill2,this.txtSkillDesc.string=t.skillDesc2,cc.loader.loadRes("Texture/hero/skill/"+2*c.data.heroId,cc.SpriteFrame,function(t,e){this.iconSkill.spriteFrame=e}.bind(this)),this.scheduleOnce(function(){this.mask.on(cc.Node.EventType.TOUCH_START,this.close,this)}.bind(this),3)},choose:function(t){1==this.type?window.homeLayer.getCard(t):c.getItem(t);for(var e=0,i=0;i<this.itemIdList.length;i++)if(t==this.itemIdList[i]){e=i;break}var o=this.items[e],n=this.items[1-e];n.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){n.destroy()}.bind(this)))),o.runAction(cc.moveTo(.2,cc.v2(0,o.y)));for(var a=0;a<this.items.length;a++)1==this.type?this.items[a].getComponent("CardCollection").txtChosen.runAction(cc.fadeOut(.2)):2==this.type&&this.items[a].getComponent("ItemCommodity").txtChosen.runAction(cc.fadeOut(.2));cc.audioEngine.playEffect(window.sound.selectSound),this.scheduleOnce(this.close,1.3)},close:function(){this.cover.runAction(cc.rotateTo(.3,0)),this.coverNode.runAction(cc.sequence(cc.moveBy(.3,cc.v2(-40,-770)),cc.delayTime(.1),cc.callFunc(function(){this.hand1.runAction(cc.moveBy(.2,cc.v2(200,0))),this.hand2.runAction(cc.moveBy(.2,cc.v2(200,0))),this.bg.runAction(cc.moveBy(.5,cc.v2(0,-1200))),this.mask.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){window.levelUpLayer=null,c.data.levelUp=!1,this.node.destroy()}.bind(this))))}.bind(this))))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],LoadingBrown:[function(t,e,i){"use strict";cc._RF.push(e,"8f7b6j+OwJOe6ZG9ItVZNtB","LoadingBrown"),cc.Class({extends:cc.Component,properties:{bg:cc.Node,animation:dragonBones.ArmatureDisplay},doStart:function(t){this.node.active=!0,this.bg.active=!0,this.bg.opacity=0,this.bg.runAction(cc.sequence(cc.fadeIn(.2),cc.callFunc(function(){this.animation.playAnimation("play1")}.bind(this)),cc.delayTime(.3),cc.callFunc(function(){cc.audioEngine.stopMusic()}.bind(this)),cc.delayTime(.2),cc.callFunc(function(){cc.audioEngine.stopMusic(),this.animation.playAnimation("play0"),t&&t()}.bind(this))))},close:function(){this.bg.runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(.2),cc.callFunc(function(){this.node.active=!1}.bind(this))))}}),cc._RF.pop()},{}],LoadingMask:[function(t,e,i){"use strict";cc._RF.push(e,"0f541cea71NQ48MP0zaCIiW","LoadingMask");var c=t("Game");cc.Class({extends:cc.Component,properties:{view:cc.Mask,bg:cc.Node,image:cc.Sprite},refresh:function(){var t=[cc.color(220,72,58),cc.color(50,99,175),cc.color(65,155,85),cc.color(239,139,43),cc.color(211,185,74),cc.color(142,88,184)];this.bg.color=t[c.maskElement-1],cc.loader.loadRes("Texture/UI/mask_loading"+c.maskElement,cc.SpriteFrame,function(t,e){this.view.spriteFrame=e,this.frameScale=e.getOriginalSize().width/e.getOriginalSize().height,0==this.status?this.view.node.width=this.view.node.height=0:(this.view.node.height=3500,this.view.node.width=3500*this.frameScale),this.view.node.active=!0,this.schedule(this.updateMask,0)}.bind(this)),cc.loader.loadRes("Texture/UI/mask_element"+c.maskElement,cc.SpriteFrame,function(t,e){this.image.spriteFrame=e}.bind(this))},close:function(t){this.callBack=t;var e=Math.floor(6*Math.random())+1;c.maskElement=e,this.status=2,this.speed=168,this.node.active=!0,this.view.node.active=!1,this.refresh()},open:function(){if(this.status=0,this.speed=0,this.node.active=!0,this.view.node.active=!0,c.maskElement)this.schedule(this.updateMask,0);else{var t=Math.floor(6*Math.random())+1;c.maskElement=t,this.refresh()}},updateMask:function(){0==this.status?(this.speed+=4,this.view.node.width+=this.speed*this.frameScale,this.view.node.height+=this.speed,this.view.node.width>=3500&&this.view.node.height>=3500&&(this.unschedule(this.updateMask),this.view.node.active=!1,this.status)):2==this.status&&(this.speed-=4,this.speed=Math.max(4,this.speed),this.view.node.width-=this.speed*this.frameScale,this.view.node.height-=this.speed,(this.view.node.width<=0||this.view.node.height<=0)&&(this.view.node.width=this.view.node.height=0,this.unschedule(this.updateMask),cc.audioEngine.stopMusic(),this.scheduleOnce(function(){this.callBack&&this.callBack()}.bind(this),.5)))}}),cc._RF.pop()},{Game:"Game"}],LoadingRoll:[function(t,e,i){"use strict";cc._RF.push(e,"ea2c0Fo8FBKlqWFefeN0OKw","LoadingRoll"),cc.Class({extends:cc.Component,properties:{bg:cc.Node,image:cc.Sprite,labelNode:cc.Node,label:cc.Label,dicePrefab:cc.Prefab,markGood:cc.Node},doStart:function(t){this.bg.y=-1700,this.labelNode.y=-867,this.callBack=t,this.node.active=!0,this.bg.active=!0,this.element=Math.floor(6*Math.random())+1,this.refresh(),this.initDices(),this.bg.runAction(cc.sequence(cc.moveTo(.4,cc.v2(0,0)),cc.delayTime(.1),cc.callFunc(function(){cc.audioEngine.stopMusic(),this.roll()}.bind(this))))},refresh:function(){var t=[cc.color(220,72,58),cc.color(50,99,175),cc.color(65,155,85),cc.color(239,139,43),cc.color(211,185,74),cc.color(142,88,184)];this.bg.color=t[this.element-1],cc.loader.loadRes("Texture/UI/mask_element"+this.element,cc.SpriteFrame,function(t,e){this.image.spriteFrame=e}.bind(this))},initDices:function(){if(!this.diceList){this.diceList=[];for(var t=0;t<5;t++){var e=cc.instantiate(this.dicePrefab);this.bg.addChild(e),this.diceList[t]=e}}for(var i=0;i<5;i++)this.diceList[i].position=cc.v2(110*i-220,-867)},roll:function(){for(var t=this,e=0,i=function(i){var c=t.diceList[i],s=[1,2,3,4,5,6,t.element,t.element,t.element,t.element][Math.floor(10*Math.random())],r=c.getComponent("DiceYahtzee").sprite;cc.loader.loadRes("Texture/battle/ebement"+s,cc.SpriteFrame,function(t,e){r.spriteFrame=e}.bind(t)),o=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254),cc.color(150,150,158)],r.node.color=o[s-1];var d=50*Math.random()+150*i-325;n=350*Math.random()-350,a=150*Math.random()-75,c.runAction(cc.spawn(cc.moveTo(.3,cc.v2(d,n)),cc.rotateTo(.3,a))),s==t.element&&e++},c=0;c<5;c++){var o,n,a;i(c)}this.label.string=["\u4e0d\u80fd\u9760\u8138\u73a9\u6e38\u620f\u5416\u3002","\u8fd9\u6b21\u4e0d\u7b97\u592a\u5dee\uff01","\u8fd8\u4e0d\u9519\uff01","\u8d85\u5389\u5bb3\u7684\uff01","\u592a\u4e0d\u53ef\u601d\u8bae\u4e86\uff01","\u771f. \u6b27\u7687\uff01"][e],this.labelNode.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.markGood.x=40-this.label.node.width/2-30}.bind(this)),cc.moveTo(.3,cc.v2(0,-430)),cc.callFunc(function(){this.callBack&&this.callBack()}.bind(this)))),cc.audioEngine.playEffect(window.sound.rollSound)},close:function(){this.bg.runAction(cc.sequence(cc.moveBy(.4,cc.v2(0,1700)),cc.callFunc(function(){this.bg.active=!1}.bind(this))))}}),cc._RF.pop()},{}],LoseLayer:[function(t,e,i){"use strict";cc._RF.push(e,"83cb32zixhKjK+z7d0tg7ub","LoseLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{btnRestart:cc.Node,btnQuit:cc.Node,txtCount:cc.Label,image:cc.Node},onLoad:function(){this.btnRestart.opacity=1,this.btnQuit.opacity=1,this.btnRestart.y-=150,this.btnQuit.y-=150,this.image.scale=.5,this.image.runAction(cc.sequence(cc.scaleTo(.2,1.1),cc.scaleTo(.1,1),cc.callFunc(function(){this.btnRestart.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.btnQuit.runAction(cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.v2(0,160)),cc.moveBy(.1,cc.v2(0,-10))))),this.scheduleOnce(function(){this.txtCount.string=c.data.restartCount>100?"":"\u5269\u4f59\u6b21\u6570 "+c.data.restartCount}.bind(this),.4)}.bind(this)))),c.data.restartCount<=0&&(this.btnRestart.getComponent(cc.Button).interactable=!1),cc.audioEngine.playEffect(window.sound.lose)},restart:function(){var t=JSON.parse(JSON.stringify(c.data));c.data=c.tempData,c.data.historyPath=t.historyPath,c.data.historyChoose=t.historyChoose,c.data.monsterList=t.monsterList,c.data.restartCount--,window.loadingMask.close(function(){cc.director.loadScene("helloworld",function(){window.loadingMask.open()}.bind(this))}.bind(this)),this.btnRestart.getComponent(cc.Button).interactable=!1,this.btnQuit.getComponent(cc.Button).interactable=!1},quit:function(){this.txtCount.string="",this.btnRestart.runAction(cc.spawn(cc.fadeOut(.2),cc.moveBy(.2,cc.v2(0,-150)))),this.btnQuit.runAction(cc.spawn(cc.fadeOut(.2),cc.moveBy(.2,cc.v2(0,-150)))),this.image.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){window.summaryLayer.doScroll(),window.summaryLayer.title.runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(0,-235)),cc.moveBy(.1,cc.v2(0,20)))),this.node.destroy()}.bind(this)))),this.btnRestart.getComponent(cc.Button).interactable=!1,this.btnQuit.getComponent(cc.Button).interactable=!1}}),cc._RF.pop()},{Game:"Game"}],MainLayer:[function(t,e,i){"use strict";cc._RF.push(e,"cb09czDdDRJ2K8f7XUVtYKQ","MainLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{heroPrefab:cc.Prefab,enemyPrefab:cc.Prefab,enemyNode:cc.Node,endPrefab:cc.Prefab,summaryPrefab:cc.Prefab,editEndPrefab:cc.Prefab,boxCardHero:cc.Node,boxDiceHero:cc.Node,boxCardEnemy:cc.Node,boxDiceEnemy:cc.Node,board:cc.Node,camera:cc.Node,bg:cc.Sprite,chooseDiceLayer:cc.Prefab,guidePrefab:cc.Prefab,btnEdit:cc.Node,btnEnd:cc.Node,boxHeroRound:cc.Node,boxEnemyRound:cc.Node,txtRound:cc.Label,settingPrefab:cc.Prefab},onLoad:function(){window.mainLayer=this,this.gameOver=!1,cc.loader.loadRes("Texture/scene/castle"+c.data.castle,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this)),this.bg.node.on(cc.Node.EventType.TOUCH_START,this.hideTip,this)},start:function(){var t=cc.instantiate(this.heroPrefab);t.position=cc.v2(0,84-cc.winSize.height/2),this.node.addChild(t),this.hero=t.getComponent("Hero");var e=cc.instantiate(this.enemyPrefab);e.position=cc.v2(0,cc.winSize.height/2-330),this.enemyNode.addChild(e),this.enemy=e.getComponent("Enemy"),this.enemy.init(),this.hero.init(),this.roundId=1;var i=750*cc.winSize.height/cc.winSize.width;this.scheduleOnce(function(){i>1600&&(e.y-=60,this.boxCardEnemy.y-=60,this.boxDiceEnemy.y-=60)}.bind(this),.1),this.scheduleOnce(function(){window.loadingRoll.close()}.bind(this),1),this.scheduleOnce(function(){cc.audioEngine.playMusic(window.sound.bgmBattle[c.data.castle-1],!0),this.enemy.comeIn(),this.btnEdit.runAction(cc.sequence(cc.delayTime(1),cc.moveBy(.3,cc.v2(0,i>1600?-140:-80))))}.bind(this),1.3),this.scheduleOnce(function(){this.enemy.equip.checkWithTrigger(141)&&!this.hero.equip.checkWithTrigger(141)&&(this.roundId=0),this.doRound()}.bind(this),1.9)},doRound:function(){this.roundId=1-this.roundId,window.player=0==this.roundId?this.hero.player:this.enemy.player,window.host=window.player.host,window.opponent=1==this.roundId?this.hero.player:this.enemy.player,window.host.startRound()},showEnd:function(t,e){if(!this.gameOver)if(this.gameOver=!0,c.editCfg){var i=cc.instantiate(this.editEndPrefab);this.node.addChild(i)}else this.scheduleOnce(function(){if(0==t)this.scheduleOnce(function(){var t=cc.instantiate(this.endPrefab);t.getComponent("EndLayer").init(e),this.node.addChild(t)}.bind(this),.8),1==c.data.roomType?c.data.highRecord[1]++:7==c.data.roomType?c.data.highRecord[2]++:8==c.data.roomType&&c.data.highRecord[3]++;else{c.data.monsterUnbeats.push(c.monsterId);var i=cc.instantiate(this.summaryPrefab);i.getComponent("Summary").init(-1),this.node.addChild(i)}}.bind(this),.5)},endRound:function(t){c.guiding&&(2==c.data.floor&&c.data.guide[1]<6||4==c.data.floor&&0==c.data.guide[2])||(0==this.roundId&&(this.hero.player.endRound(),t&&cc.audioEngine.playEffect(window.sound.btnStart)),window.guide&&window.guide.close())},chooseDice:function(){var t=cc.instantiate(this.chooseDiceLayer);this.node.addChild(t,100)},hideTip:function(){this.equipTip&&this.equipTip.hideTip(),this.buffTip&&this.buffTip.hideTip()},showGuide:function(t){this.scheduleOnce(function(){if(!window.guide){var e=cc.instantiate(this.guidePrefab);e.getComponent("Guide").init(t),this.node.addChild(e)}}.bind(this),.1)},openSetting:function(){var t=cc.instantiate(this.settingPrefab);this.node.addChild(t,100)}}),cc._RF.pop()},{Game:"Game"}],MapLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2be16dXDepLLbZP42Rqq+om","MapLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{mask:cc.Node,view:cc.Node,top:cc.Node,bottom:cc.Node,box:cc.Node,maskList:[cc.Node],dice:dragonBones.ArmatureDisplay},onLoad:function(){window.mapLayer=this,this.box.opacity=1,this.mask.opacity=1,this.mask.runAction(cc.sequence(cc.fadeTo(.2,210),cc.callFunc(function(){this.openMap()}.bind(this))));for(var t=0;t<4;t++)t<c.data.castle-1&&(this.maskList[t].active=!1);this.scheduleOnce(this.roll,.5),cc.audioEngine.playEffect(window.sound.bagOpenSound)},openMap:function(){this.box.opacity=255,this.winHeight=cc.winSize.height/cc.winSize.width*750,this.bottom.y=-this.winHeight/2+275,this.bottom.runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.05,cc.v2(0,-150)),cc.moveBy(.1,cc.v2(0,-50)),cc.moveBy(.1,cc.v2(0,15)))),this.top.y=-this.winHeight/2+380,this.top.runAction(cc.sequence(cc.delayTime(.05),cc.moveTo(.3,cc.v2(0,this.winHeight/2-39)),cc.moveBy(.1,cc.v2(0,20)),cc.moveBy(.1,cc.v2(0,-10)))),this.view.height=50,this.view.y=(this.bottom.y+this.top.y)/2-30,this.frame=0,this.schedule(this.updateFrame,0)},updateFrame:function(){this.frame++,this.view.height=this.top.y-this.bottom.y-15,this.view.y=(this.bottom.y+this.top.y)/2-30},roll:function(){var t=[cc.v2(10,-430),cc.v2(-50,-135),cc.v2(-25,125),cc.v2(-65,390)];this.dice.node.position=t[c.data.castle-1],c.data.castle%2==0&&(this.dice.node.scaleX=-1),this.dice.playAnimation("play0",1),this.dice.on(dragonBones.EventObject.LOOP_COMPLETE,function(){this.maskList[c.data.castle-1].runAction(cc.fadeOut(.5))}.bind(this)),cc.audioEngine.playEffect(window.sound.rollSound),this.scheduleOnce(this.close,2.5)},close:function(){this.bottom.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.moveBy(.1,cc.v2(0,50)),cc.moveTo(.1,cc.v2(0,-this.winHeight/2+280)))),this.top.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,10)),cc.moveBy(.1,cc.v2(0,-20)),cc.moveTo(.2,cc.v2(0,-this.winHeight/2+385)))),this.mask.runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(.2))),this.box.runAction(cc.sequence(cc.delayTime(.4),cc.moveBy(.15,cc.v2(0,-400)),cc.callFunc(function(){this.node.destroy(),window.mapLayer=null,window.room.showHero()}.bind(this)))),cc.audioEngine.playEffect(window.sound.bagCloseSound)}}),cc._RF.pop()},{Game:"Game"}],Opening:[function(t,e,i){"use strict";cc._RF.push(e,"52880hyyK1GjLw1tAGJFFaD","Opening");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{logo:cc.Node,partner:cc.Node},onLoad:function(){this.login(),this.ready=!1,c.opening?this.logo.runAction(cc.sequence(cc.fadeIn(.3),cc.delayTime(2.5),cc.callFunc(function(){this.ready?cc.director.loadScene("cover"):this.ready=!0}.bind(this)))):this.ready=!0},login:function(){o.load(function(){c.getData(function(){c.data.rookie?c.data.guide=[0,0,0,0,0,0]:c.data.guide=[-1,-1,-1,-1,-1,c.data.guide[5]],this.ready?cc.director.loadScene("cover"):this.ready=!0}.bind(this))}.bind(this))},loadRes:function(){}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerTavern:[function(t,e,i){"use strict";cc._RF.push(e,"f1734zLgkZCHperU+957PgJ","PlayerTavern");t("Game");var c=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,btnRoll:cc.Button,boxCard:cc.Node,boxDice:cc.Node,txtRollCount:cc.Label,imageShadow:cc.Node,diceAnimation:dragonBones.ArmatureDisplay},onLoad:function(){window.player=this,this.rollabled=!0,this.initCards(),this.scheduleOnce(this.startRound,.5)},startRound:function(){this.rollCount=2,this.initDices()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];for(var t=0;t<5;t++){var e=cc.instantiate(this.dicePrefab);e.position=cc.v2(110*t-220,-200),this.boxDice.addChild(e),this.diceList.push(e)}this.scheduleOnce(function(){this.roll(!0)}.bind(this),2.6)},initCards:function(){this.cardList=[],this.deck=this.getRandomCards();for(var t=0;t<6;t++){var e=cc.instantiate(this.cardPrefab);e.getComponent("CardTavern").init(this.deck[t]),e.position=cc.v2(t%3*218-216,84-203*Math.floor(t/3)),this.boxCard.addChild(e,100),this.cardList.push(e)}},getRandomCards:function(t){for(var e=[],i=0;e.length<6;){for(var o=0,n=Math.random(),a=0,s=e.length<4?1:19,r=e.length<4?18:30,d=s;d<=r;d++){if(n<(a+=c.get("cfg_tavern",d).rate)){o=d;break}}e.indexOf(o)<0&&(!t||t.indexOf(o)<0)&&(o>=9&&o<=11||15==o?i<2&&(e.push(o),i++):e.push(o))}return e},doRoll:function(){this.rollabled&&(this.diceAnimation.playAnimation("play1"),this.rollabled=!1,this.scheduleOnce(function(){this.rollabled=!0,this.btnRoll.interactable?(this.diceAnimation.playAnimation("play0"),this.imageShadow.active=!1):(this.diceAnimation.node.active=!1,this.imageShadow.active=!0)}.bind(this),.5),this.roll())},roll:function(t){for(var e=0;e<this.diceList.length;e++){var i=this.diceList[e].getComponent("DiceTavern");1==t?i.roll():i.holded||i.roll()}this.endRoll(t),t?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound)},endRoll:function(t){t?this.scheduleOnce(function(){this.checkElement(),this.checkBtnRoll()}.bind(this),.2):(this.checkElement(),this.rollCount--,this.checkBtnRoll())},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var t=0;t<this.diceList.length;t++){var e=this.diceList[t].getComponent("DiceTavern");this.elementList[e.element-1]++}this.cardAbledCount=this.checkCardsRequire()},checkCardsRequire:function(){for(var t=0,e=0;e<this.cardList.length;e++){this.cardList[e].getComponent("CardTavern").checkRequire()&&t++}return t},addRollCount:function(){this.rollCount++,this.checkBtnRoll()},checkBtnRoll:function(){this.rollCount>0?(this.btnRoll.interactable=!0,this.imageShadow.active=!1,this.diceAnimation.node.active||(this.diceAnimation.node.active=!0,this.diceAnimation.playAnimation("play0")),"0"==this.txtRollCount.string?(this.txtRollCount.string=this.rollCount,this.txtRollCount.node.runAction(cc.scaleTo(.2,1))):this.txtRollCount.string-this.rollCount!=0&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=this.rollCount}.bind(this)),cc.scaleTo(.2,1)))):(this.btnRoll.interactable=!1,"play0"==this.diceAnimation.animationName&&(this.diceAnimation.node.active=!1,this.imageShadow.active=!0),"0"!=this.txtRollCount.string&&this.txtRollCount.node.runAction(cc.sequence(cc.scaleTo(.2,0),cc.callFunc(function(){this.txtRollCount.string=0}.bind(this)))))},changeAllCards:function(){var t=this.deck.concat();this.deck=this.getRandomCards(t);for(var e=0;e<6;e++){this.cardList[e].getComponent("CardTavern").change(this.deck[e])}this.checkCardsRequire(),this.checkBtnRoll()},checkRewards:function(){for(var t=[],e=0;e<this.cardList.length;e++){var i=this.cardList[e].getComponent("CardTavern");i.usable&&t.push(i.cfgId)}return t}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],PlayerYahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"acbae8MQJVMtrUiAPUu8RmS","PlayerYahtzee"),cc.Class({extends:cc.Component,properties:{boxDice:cc.Node,dicePrefab:cc.Prefab,btn:cc.Node,txtBtn:cc.Label,crowns:[cc.Sprite]},init:function(t){this.index=t,this.win=0,this.diceList=[];for(var e=0;e<5;e++){var i=cc.instantiate(this.dicePrefab);i.getComponent("DiceYahtzee").init(e,t),i.opacity=0,this.boxDice.addChild(i),this.diceList.push(i)}this.ai=this.getComponent("AIYahtzee")},startRound:function(){this.initDices(),this.rollCount=3,this.holdList=[],this.txtBtn.string="\u6295\u63b7",this.btn.active=0==this.index},initDices:function(){for(var t=0;t<5;t++)this.diceList[t].getComponent("DiceYahtzee").show();this.scheduleOnce(function(){0==this.index?this.btn.active=!0:this.roll()}.bind(this),.3)},roll:function(){if(this.holdList.length<5){for(var t=0;t<5;t++){var e=this.diceList[t].getComponent("DiceYahtzee");e.holded||e.roll()}this.rollCount--,this.rollCount<=0?(0==this.index&&(this.btn.active=!1),this.recycle()):1==this.index&&this.ai.check(),cc.audioEngine.playEffect(window.sound.rollSound2)}else 0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()},recycle:function(){this.scheduleOnce(function(){for(var t=0;t<5;t++){var e=this.diceList[t].getComponent("DiceYahtzee");e.holded||e.hold(),e.abled=!1}cc.audioEngine.playEffect(window.sound.holdSound)}.bind(this),.5),this.scheduleOnce(function(){0==this.index?(this.btn.active=!1,window.yahtzeeLayer.endRound(),cc.audioEngine.playEffect(window.sound.endRound)):window.yahtzeeLayer.doRound()}.bind(this),1)},calculateScore:function(){for(var t=[0,0,0,0,0,0],e=0;e<5;e++){t[this.diceList[e].getComponent("DiceYahtzee").element-1]++}t.sort(function(t,e){return e-t}),5==t[0]?this.score=7:4==t[0]?this.score=6:3==t[0]?2==t[1]?this.score=5:this.score=4:2==t[0]?2==t[1]?this.score=3:this.score=1:this.score=2},doWin:function(){var t=window.yahtzeeLayer.crowns[this.index];t.node.active=!0,t.playAnimation("play0",1),this.win<=0&&t.on(dragonBones.EventObject.COMPLETE,function(){"play0"==t.animationName?t.node.runAction(cc.sequence(cc.moveTo(.4,cc.v2(130+60*this.win,0==this.index?-557:548)),cc.callFunc(function(){t.playAnimation("play1",1),cc.loader.loadRes("Texture/battle/mark_crown1",cc.SpriteFrame,function(t,e){this.crowns[this.win].spriteFrame=e,this.win++}.bind(this)),cc.audioEngine.playEffect(window.sound.bingo)}.bind(this)))):"play1"==t.animationName&&(t.node.position=cc.v2(0,-30),t.node.active=!1)}.bind(this))}}),cc._RF.pop()},{}],Player:[function(t,e,i){"use strict";cc._RF.push(e,"ba4f5YaUElBy61UWqBofsfz","Player");var c=t("Game"),o=t("Utils"),n=t("Config"),a=t("CardManager");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,dicePrefab:cc.Prefab,chestPrefab:cc.Prefab,dmgAnimation:cc.Prefab},init:function(t){this.index=t,0==t?(this.host=this.getComponent("Hero"),this.opponent=window.mainLayer.enemy.player,this.boxCard=window.mainLayer.boxCardHero,this.boxDice=window.mainLayer.boxDiceHero):(this.host=this.getComponent("Enemy"),this.opponent=window.mainLayer.hero.player,this.boxCard=window.mainLayer.boxCardEnemy,this.boxDice=window.mainLayer.boxDiceEnemy),this.cardPool=new cc.NodePool;for(var e=0;e<6;e++){var i=cc.instantiate(this.cardPrefab);this.cardPool.put(i)}this.dicePool=new cc.NodePool;for(var o=0;o<5;o++){var n=cc.instantiate(this.dicePrefab);this.dicePool.put(n)}this.round=0,this.extraDice=0,this.showQueue=[],this.cardPlayed=0,this.cardPlayedRound=0,this.atkPlayed=0,this.atkRound=0,this.dmgRound=0,this.diceUsabld=!0,this.cardUsabled=!0,this.elementList=[0,0,0,0,0,0],this.createDiceRound=[0,0,0,0,0,0],this.delayCard=[],this.legacyDice=[],this.deck=this.host.deck,0==this.index&&(3==c.data.heroId&&4==c.data.difficulty?this.bag=c.data.cardBag.concat():4==c.data.heroId&&2==c.data.difficulty&&(this.cemetery=[]));var a=cc.instantiate(this.dmgAnimation);this.node.addChild(a),0==this.index?(a.scale=.8,a.position=cc.v2(-302,33)):a.position=cc.v2(0,this.host.figureNode.y+this.host.figure.height/2),this.anim=a.getComponent("DmgAnimation"),this.anim.init(t)},start:function(){this.equip=this.getComponent("Equip"),this.equip.init(),this.buff=this.getComponent("Buff"),this.buff.init(),this.diceCount=this.host.diceCount;for(var t=[85,86,89,90,91,92],e=0;e<t.length;e++)this.equip.checkWithTrigger(t[e])&&this.diceCount++;this.equip.trigger(88)&&this.diceCount++,this.scheduleOnce(function(){this.checkGameBegin(),0==this.index&&c.data.debuff>0&&this.host.onHurt(5*c.data.debuff,1,7,2)}.bind(this),1),0==this.index&&3==c.data.heroId&&2==c.data.difficulty&&(this.totalRollCount=this.equip.checkWithTrigger(58)?7:6)},startRound:function(){this.round++,this.rollCount=this.equip.checkWithTrigger(58)?4:3,0==this.index?2==c.data.heroId?this.rollCount=1:3==c.data.heroId&&(2==c.data.difficulty?this.rollCount=this.totalRollCount:3==c.data.difficulty&&this.rollCount--):(this.rollCount+=this.host.exRollCount,2==c.data.heroId&&4==c.data.difficulty&&this.rollCount++),0==this.index&&(this.diceUsabld=!1,this.cardUsabled=!1,4==c.data.heroId?(2!=c.data.difficulty||this.round<=1)&&(this.deckArray=this.deck.concat(),this.deckArray.sort(function(t,e){return.5-Math.random()})):5==c.data.heroId&&(this.chestList=[null,null,null],this.createChest())),this.initCards(),this.initDices()},initDices:function(){this.diceList=[],this.holdList=[0,0,0,0,0,0];var t=this.diceCount+this.extraDice,e=o.getDifferentRandomNum(t,t-1,0),i=Math.min(this.buff.lock,t),n=e.splice(0,i);this.buff.removeBuff(28,i);var a=Math.min(this.buff.freeze,t-i),s=e.splice(0,a);this.buff.removeBuff(22,a);var r=e.concat(s),d=Math.min(this.buff.blind,t-i),h=r.splice(0,d);this.buff.removeBuff(30,d);for(var l=0;l<t;l++){for(var u=[],f=0;f<n.length;f++)if(l==n[f]){u.push(28);break}if(0==u.length){for(var p=0;p<s.length;p++)if(l==s[p]){u.push(22);break}for(var m=0;m<h.length;m++)if(l==h[m]){u.push(30);break}}var g=null;g=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab);var y=0;y=t<=6?-(t-1)/2*110+110*l:640/(t-1)*l-320,g.position=cc.v2(y,0==window.mainLayer.roundId?-200:700),g.opacity=1,g.getComponent("Dice").init(l,u),this.boxDice.addChild(g),this.diceList.push(g),3==c.data.heroId&&3==c.data.difficulty&&(g.getComponent("Dice").remembered=!0)}},initCards:function(){this.cardList=[];var t=this.deck;0==this.index&&4==c.data.heroId&&(t=this.deckArray);for(var e=Math.min(t.length,6),i=this.buff.silence,o=this.buff.burn,a=0;a<e;a++){var s=null,r=n.get("cfg_card",t[a]).element;this.buff.silenceDark&&6==r?s=25:Math.random()<i/(e-a)?(s=25,i--,this.buff.removeBuff(25,1)):this.buff.burnIce&&2==r?s=21:Math.random()<o/(e-a)&&(s=21,o--,this.buff.removeBuff(21,1)),this.drawCard(t[a],s,!1,!0)}0==this.index&&4==c.data.heroId&&this.deckArray.splice(0,e)},showToken:function(){for(var t=0;t<this.cardList.length;t++)this.cardList[t].getComponent("Card").show();this.scheduleOnce(function(){this.roll(!0)}.bind(this),this.cardList.length>3?.5:.3)},drawCard:function(t,e,i,c){var o=this.getEmptyIndex();if(!(o<0||window.mainLayer.gameOver)){var n=null;return(n=this.cardPool.size()>0?this.cardPool.get():cc.instantiate(this.cardPrefab)).getComponent("Card").init(t,o,e,c),n.getComponent("Card").isTemp=i,this.boxCard.addChild(n,100+o%3),this.cardList.push(n),n}},patchCard:function(t,e,i){var o=this.buff,a=null;t=t||c.getRandomCardId();var s=n.get("cfg_card",t).element;o.silenceDark&&6==s?a=25:o.silence>0?(a=25,o.removeBuff(25,1)):o.burnIce&&2==s?a=21:o.burn>0&&(a=21,o.removeBuff(21,1));var r=this.drawCard(t,a,!e);if(r)return r.getComponent("Card").initBuff(),i&&r.getComponent("Card").disCost(),this.checkCardsRequire(),this.host.checkBtnRoll&&this.host.checkBtnRoll(),this.equip.trigger(119),r},suppleCard:function(){if(!(this.deckArray.length<=0)){var t=this.deckArray[0];this.patchCard(t,!0)&&this.deckArray.shift()}},roll:function(t,e){var i=void 0;c.guiding&&(0==this.index?0==c.data.guide[1]?i=[2,2,5,6,2]:4==c.data.guide[1]?i=[4,1,4,6,5]:5==c.data.guide[1]?i=[3,2,1,3,6]:0==c.data.guide[2]&&(i=[1,c.guideChoose+3,1,2,5]):2==c.data.guide[2]&&(i=[4,2,5,6]));for(var o=0;o<this.diceList.length;o++){var n=this.diceList[o].getComponent("Dice");i?n.roll(i[o]):1==t?0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.lastDices&&this.lastDices[o]?n.roll(this.lastDices[o]):n.roll():n.freeze||n.lock||n.temp||(e?(n.holded&&n.hold(),n.roll(e)):n.holded||n.roll(),n.initBuff())}this.endRoll(t),t?cc.audioEngine.playEffect(window.sound.rollSound2):cc.audioEngine.playEffect(window.sound.rollSound),window.guide&&4==c.data.guide[1]&&window.guide.close()},endRoll:function(t){if(t)this.scheduleOnce(function(){this.refreshCardBuff(),this.checkElement(),0==this.index&&3==c.data.heroId&&2==c.data.difficulty||this.rollCount--;for(var t=0;t<this.legacyDice.length;t++)this.createExDice(this.legacyDice[t],!0);this.legacyDice=[],c.guiding&&0==c.data.guide[1]&&window.mainLayer.showGuide(1)}.bind(this),.2);else{this.checkElement();for(var e=0,i=0;i<6;i++)this.elementList[i]>0&&e++;if(e>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.rollCount--,this.host.checkBtnRoll&&this.host.checkBtnRoll(!0),this.opponent.equip.trigger(176),0==this.index)if(2==c.data.heroId){if(3==c.data.difficulty);else if(5==c.data.difficulty){for(var o=[],n=0;n<this.diceList.length;n++){var a=this.diceList[n].getComponent("Dice");a.blind||a.lock||o.push(a)}if(o.length>0){var s=o[Math.floor(Math.random()*o.length)];s.buffList.push(30),s.blind=!0,s.markBlind.active=!0}else window.player.buff.addBuff(30,1)}}else 4==c.data.heroId&&5==c.data.difficulty&&Math.random()<.5&&this.buff.addBuff(27,1)}},checkElement:function(){this.elementList=[0,0,0,0,0,0];for(var t=0;t<this.diceList.length;t++){var e=this.diceList[t].getComponent("Dice");e.lock||this.elementList[e.element-1]++}if(this.cardAbledCount=this.checkCardsRequire(),this.chestList)for(var i=0;i<3;i++)this.chestList[i]&&this.chestList[i].getComponent("Chest").checkRequire()},refreshCardBuff:function(){for(var t=0;t<this.cardList.length;t++)this.cardList[t].getComponent("Card").initBuff();this.scheduleOnce(function(){this.refreshDiceBuff()}.bind(this),.2),this.opponent.equip.trigger(170)},refreshDiceBuff:function(){for(var t=0;t<this.diceList.length;t++)this.diceList[t].getComponent("Dice").initBuff();if(this.checkElement(),1==this.index&&1==c.data.heroId&&4==c.data.difficulty&&this.cardList.length<6){var e=c.getRandomCardId(null,3);this.patchCard(e)}else 0==this.index&&2==c.data.heroId&&3==c.data.difficulty&&(this.cardList.length>=6&&this.cardList[5].getComponent("Card").discard(!0),this.randomCard=this.patchCard(),this.randomCard.getComponent("Card").discribeRandom());for(var i=0,o=0;o<6;o++)this.elementList[o]>0&&i++;i>=5&&(this.equip.trigger(115),this.equip.trigger(116)),this.cardAbledCount<=0&&this.equip.trigger(45);for(var n=48;n<=53;n++)this.equip.trigger(n);this.equip.trigger(93),this.equip.trigger(128),this.equip.trigger(174),this.host.checkBtnRoll&&(this.host.checkBtnRoll(!0),this.diceUsabld=!0,this.cardUsabled=!0)},createExDice:function(t,e,i){var o=[];this.buff.lock>0?(o.push(28),this.buff.removeBuff(28,1)):(this.buff.freeze>0&&(o.push(22),this.buff.removeBuff(22,1)),this.buff.blind>0&&(o.push(30),this.buff.removeBuff(30,1)));var n=null;n=this.dicePool.size()>0?this.dicePool.get():cc.instantiate(this.dicePrefab),this.diceList.length<=5?n.x=this.diceList.length/2*110:n.x=320,n.getComponent("Dice").init(this.diceList.length-1,o),this.boxDice.addChild(n),this.diceList.push(n),n.getComponent("Dice").roll(t),n.getComponent("Dice").initBuff(),t&&!e&&n.getComponent("Dice").doTemp(),3==c.data.heroId&&3==c.data.difficulty&&i&&(n.getComponent("Dice").remembered=!0);for(var a=0;a<this.diceList.length;a++){var s=this.diceList[a];s.stopAllActions(),s.opacity=255;var r=0;r=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*a:640/(this.diceList.length-1)*a-320,s.runAction(cc.moveTo(.2,cc.v2(r,0)))}this.checkElement(),this.extraDice++},endRound:function(){if(this.cardList)for(var t=this.cardList.length-1;t>=0;t--){if(0==this.index)if(3==c.data.heroId&&4==c.data.difficulty){if(this.bag.length>0){var e=this.deck.indexOf(this.cardList[t].getComponent("Card").cfgId);if(e>=0){var i=Math.floor(Math.random()*this.bag.length),o=this.bag.splice(i,1);this.deck.splice(e,1,o),this.bag.push(this.cardList[t].getComponent("Card").cfgId)}}}else 4==c.data.heroId&&2==c.data.difficulty&&this.deckArray.unshift(this.cardList[t].getComponent("Card").cfgId);this.cardList[t].getComponent("Card").remove(!0)}if(this.lastDices=[],this.diceList)for(var n=0;n<this.diceList.length;n++)0==this.index&&3==c.data.heroId&&3==c.data.difficulty&&this.diceList[n].getComponent("Dice").remembered&&this.lastDices.push(this.diceList[n].getComponent("Dice").element),this.diceList[n].getComponent("Dice").remove();if(0==this.index&&4==c.data.heroId&&2==c.data.difficulty&&(this.deckArray=this.deckArray.concat(this.cemetery),this.cemetery=[]),this.chestList)for(var a=0;a<3;a++)this.chestList[a]&&this.chestList[a].getComponent("Chest").remove();this.host.endRound(),this.scheduleOnce(function(){window.mainLayer.gameOver||(this.buff.exRound>0?(this.host.startRound(!0),this.buff.removeBuff(101,1)):window.mainLayer.doRound())}.bind(this),.5),this.extraDice=0,window.mainLayer.gameOver||(this.settleBuff(),this.settleEquip())},checkCardsRequire:function(){for(var t=0,e=0;e<this.cardList.length;e++){this.cardList[e].getComponent("Card").checkRequire()&&t++}return t},checkGameBegin:function(){for(var t=[37,6,12,13,14,15,16,17,18,19,20,21,30,44,89,91,96,114,124],e=0;e<t.length;e++)this.equip.trigger(t[e]);this.equip.check(77)&&(this.equip.magicSheild=1),this.equip.check(101)&&(this.equip.goldArmor=1),this.equip.check(43)&&(this.equip.luckyCard=1),c.data.roomType>=7&&this.equip.trigger(61)},checkStart:function(){this.showQueue=[],this.round>1&&this.buff.removeBuff(13,this.buff.table[13]);for(var t=[5,9,25,30,84,86,105,111,126,129,142,143,145,146,147,152,155,160,162,165,168,121],e=0;e<t.length;e++)this.equip.trigger(t[e]);if(this.dmgRound=0,this.buff.poison>0&&!this.equip.checkWithTrigger(67)){var i=Math.floor(this.buff.poison*(this.opponent.equip.checkWithTrigger(112)?1.5:1));this.host.onHurt(i,1,26,0),this.opponent.equip.checkWithTrigger(103)||this.buff.removeBuff(26,1)}this.buff.undead>0&&this.buff.removeBuff(102,1),this.buff.table[23]>0&&this.buff.removeBuff(23,1);for(var c=0;c<this.delayCard.length;c++)a.doDelayEffect(this.delayCard[c]);this.delayCard=[],this.host.hp>0&&this.showToken()},settleBuff:function(){this.buff.removeBuff(21,this.buff.table[21]),this.buff.removeBuff(22,this.buff.table[22]),this.buff.removeBuff(25,this.buff.table[25]),this.buff.removeBuff(27,this.buff.table[27]),this.buff.removeBuff(28,this.buff.table[28]),this.buff.removeBuff(29,this.buff.table[29]),this.buff.removeBuff(30,this.buff.table[30]),this.buff.table[24]>0&&this.buff.removeBuff(24,1);for(var t=0;t<4;t++)this.buff.removeBuff(103+t,this.buff.tempBuff[t]),this.buff.tempBuff[t]=0;this.buff.multiCast=this.buff.multiCastMax=0,this.buff.elementRoundCasted=[0,0,0,0,0,0],this.buff.burnIce=!1,this.buff.silenceDark=!1,this.buff.selfHarmCast=this.buff.selfHarmCastMax=0,this.buff.doubleWind=!1,this.buff.darkRedice=0},settleEquip:function(){for(var t=[2,3,27,57,59,60,104,110,138,148,150,151,156,161,11],e=0;e<t.length;e++)this.equip.trigger(t[e]);this.opponent.equip.trigger(118),this.equip.doDisabled(139),this.equip.doDisabled(140),this.cardPlayedRound=0,this.atkRound=0,this.dmgRound=0,this.createDiceRound=[0,0,0,0,0,0],this.equip.swiftGlove=!1,this.equip.luckDice=!1,this.equip.luckFlag=!1,this.equip.suckRemainder=0,this.equip.armorRemainder=0,this.equip.elementPlayed=[0,0,0,0,0,0]},checkEquipAbled:function(){for(var t=[48,49,50,51,52,53,132,133,134,135,136,137,172,173],e=0;e<t.length;e++)window.mainLayer.hero.round%2==1?this.equip.doAbled(t[e]):this.equip.doDisabled(t[e])},onHurt:function(t,e,i,o){if(1==o){if(i<=6){if(this.equip.checkWithTrigger(130)&&(t*=.5),window.mainLayer.hero.round%2==1){this.equip.checkWithTrigger([133,132,135,134,137,136][i-1])&&(t*=2)}}else this.equip.checkWithTrigger(131)&&(t*=.5);if(this.buff.frail>0&&0==e){var n=.4;this.opponent.equip.checkWithTrigger(54)&&(n+=.2),this.equip.checkWithTrigger(56)&&(n-=.2),this.equip.checkWithTrigger(113)&&(n*=2),this.opponent.equip.checkWithTrigger(113)&&(n*=2),t*=n+1}this.host.hp<.3*this.host.hpMax&&this.opponent.equip.checkWithTrigger(154)&&(t*=2),t=Math.round(t),0==e&&(t+=this.opponent.buff.atkAdd),this.opponent.equip.checkWithTrigger(21),this.opponent.equip.checkWithTrigger(147),this.opponent.host.hp<.3*this.opponent.host.hpMax&&this.opponent.equip.checkWithTrigger(75),i<=6?0==this.round&&this.equip.checkWithTrigger(139)?t=0:window.mainLayer.hero.round%2==1&&this.equip.checkWithTrigger(i+131)&&(t=0):0==this.round&&this.equip.checkWithTrigger(140)&&(t=0),t>0&&this.equip.magicSheild>0&&(this.equip.magicSheild--,this.equip.doTrigger(77),t=1),t>10&&this.equip.goldArmor>0&&(this.equip.goldArmor--,this.equip.doTrigger(101),t=1),t>0&&this.buff.hurtReduce>0&&(t=Math.max(0,t-this.buff.hurtReduce),this.equip.checkWithTrigger(114),this.equip.checkWithTrigger(124)),t>5&&this.equip.checkWithTrigger(125)&&(t=5);var a=!1;if(t>=this.host.hp+this.host.armor&&(this.host.hp%2==1&&this.equip.checkWithTrigger(179)||this.equip.checkWithTrigger(180)||0==this.index&&c.guiding)&&(a=!0,t=0),9==i&&t>0&&this.opponent.host.onHeal(t),this.opponent.equip.suckRemainder+=t,this.opponent.equip.trigger(23),this.opponent.equip.armorRemainder+=t,this.opponent.equip.trigger(164),this.equip.feedBack>0&t>0){var s=0;this.equip.feedBack>t?(s=t,this.equip.feedBack-=t,t=0):(s=this.equip.feedBack,t-=this.equip.feedBack,this.equip.feedBack=0),this.equip.checkWithTrigger(146),this.equip.refreshItemNum(146,this.equip.feedBack),this.opponent.host.onHurt(s,2,16)}this.buff.atkBack>0&&0==e&&t>0&&this.opponent.host.onHurt(this.buff.atkBack,1,16)}if(this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(98)&&(t=0),t>0&&this.index==window.mainLayer.roundId&&this.equip.checkWithTrigger(99)&&this.opponent.host.onHurt(t,2,16),1==o&&(this.opponent.dmgRound+=t),a?this.assertHpChange("MISS",2):this.assertHpChange("-"+t,0),this.anim.show(i),this.host.armor>0){if(this.host.armor>=t)return void this.updateArmor(-t);t-=this.host.armor,this.updateArmor(-this.armor)}this.host.hp-=t,this.host.hp<=0&&this.buff.undead>0&&(this.anim.show(201),this.host.hp=1),1==o&&t>0&&this.equip.checkWithTrigger(175)&&this.updateArmor(t),this.host.hp<=0&&this.equip.trigger(10),this.host.hp<=0&&this.equip.trigger(158),this.equip.trigger(75),this.host.txtHp.string=this.host.hp+"/"+this.host.hpMax,this.host.stripHp.progress=this.host.hp/this.host.hpMax},updateArmor:function(t){var e=this.host.armor;this.host.armor+=t,this.host.armor>0?(this.host.boxArmor.active=!0,this.host.txtArmor.string=this.host.armor,this.host.stripHp.node.color=cc.color(26,52,65),this.host.barHp.color=cc.color(92,215,255)):(this.host.armor=0,this.host.boxArmor.active=!1,this.host.stripHp.node.color=cc.color(105,37,26),this.host.barHp.color=cc.color(255,56,49)),t>0?this.anim.show(11):e>this.host.armor&&this.equip.checkWithTrigger(167)&&this.opponent.host.onHurt(e-this.host.armor,2)},onHeal:function(t){if(this.equip.checkWithTrigger(122)){var e=Math.min(t,this.host.hpMax-this.host.hp);this.opponent.host.onHurt(e,2)}this.host.hp+=t,this.equip.trigger(102),this.equip.trigger(123),this.anim.show(12),this.equip.trigger(75)},assertHpChange:function(t,e){this.showQueue.push([t,e]),1==this.showQueue.length&&this.showHpChange()},showHpChange:function(){var t=this.showQueue[0],e=t[0],i=t[1],c=[cc.Color.WHITE,cc.color(139,255,70),cc.color(255,40,40),cc.color(60,247,255)],o=cc.instantiate(this.host.txtNum);o.getComponent(cc.Label).string=e,o.color=c[i],o.position=this.host.txtNum.position,this.node.addChild(o),o.scale=0;var n=cc.spawn(cc.moveBy(.1,cc.v2(30,10)),cc.scaleTo(.1,1.1));n=cc.spawn(cc.moveBy(.05,cc.v2(0,0==this.index?0:-10)),cc.scaleTo(.05,1));o.runAction(cc.sequence(n,n,cc.moveBy(.05,cc.v2(13+10*Math.random(),3+5*Math.random())),cc.moveBy(.1,cc.v2(3+10*Math.random(),-3-10*Math.random())),cc.fadeOut(.5),cc.callFunc(function(){o.destroy()}.bind(this)))),o.runAction(cc.sequence(cc.delayTime(.15),cc.callFunc(function(){this.showQueue.shift(),this.showQueue.length>0&&this.showHpChange()}.bind(this)))),"MISS"==e&&cc.audioEngine.playEffect(window.sound.missSound)},getEmptyIndex:function(){for(var t=0;t<6;t++){var e=!1;if(this.chestList&&this.chestList[t%3]&&(e=!0),!e)for(var i=0;i<this.cardList.length;i++){if(this.cardList[i].getComponent("Card").index==t){e=!0;break}}if(!e)return t}return-1},addRollCount:function(){if(0==this.index&&2==c.data.heroId){var t=2==c.data.difficulty?0:1;if(this.rollCount>=t)return}this.rollCount++,this.host.checkBtnRoll&&this.host.checkBtnRoll()},deleteDice:function(t){for(var e=[],i=0;i<this.diceList.length;i++){var c=this.diceList[i].getComponent("Dice");if(!c.lock)if(7==t)e.push(this.diceList[i]);else if(c.element==t){this.dicePool.put(this.diceList[i]),this.diceList.splice(i,1);break}}if(7==t&&e.length>0){var o=e[Math.floor(Math.random()*e.length)],n=this.diceList.indexOf(o);n>=0&&(this.dicePool.put(this.diceList[n]),this.diceList.splice(n,1))}for(var a=0;a<this.diceList.length;a++){var s=this.diceList[a];s.stopAllActions(),s.opacity=255;var r=0;r=this.diceList.length<=6?-(this.diceList.length-1)/2*110+110*a:640/(this.diceList.length-1)*a-320,s.runAction(cc.moveTo(.2,cc.v2(r,0)))}this.checkElement(),this.host.checkBtnRoll()},createChest:function(t){for(var e=-1,i=2;i>=0;i--)if(!this.chestList[i]){e=i;break}if(e>=0){var c=cc.instantiate(this.chestPrefab);c.getComponent("Chest").init(e),this.boxCard.addChild(c,100),this.chestList[e]=c,t&&c.getComponent("Chest").checkRequire()}}}),cc._RF.pop()},{CardManager:"CardManager",Config:"Config",Game:"Game",Utils:"Utils"}],PrepareLayer:[function(t,e,i){"use strict";cc._RF.push(e,"c0348borGFFHIk076MyCFu2","PrepareLayer");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{btnCharacters:[cc.Button],txtName:cc.Label,txtDesc:cc.Label,txtSkillNames:[cc.Label],txtSkillDescs:[cc.Label],iconSkills:[cc.Sprite],boxInfo:cc.Node,boxUpon:cc.Node,hand:cc.Node,seals:[cc.Node],btnBack:cc.Button,boxCharacter:cc.Node,boxDifficulty:cc.Node,txtTitle:cc.Label,title:cc.Node,txtDifficulty:cc.Label,txtDifficultyDesc:cc.Label,btnDifficulty:[cc.Button],iconDifficulty:[cc.Sprite],figure:cc.Sprite,btnNext:cc.Node,txtUnopen:cc.Node,txtLockHero:cc.Label,txtLockDifficulty:cc.Label,btnStart:cc.Node},onLoad:function(){this.heroId=1,this.difficultyId=1,this.status=1,this.refreshInfo(),cc.audioEngine.playMusic(window.sound.bgmPrepare,!0),window.loadingBrown.close()},refreshInfo:function(){var t=this,e=["#20944C","#5e379d","#F14033","#3570D3"],i=o.get("cfg_hero",this.heroId);this.txtName.string=i.name,this.txtName.node.color=cc.Color.WHITE.fromHEX(e[this.heroId-1]),this.txtName.getComponent(cc.LabelOutline).color=cc.Color.WHITE.fromHEX(e[this.heroId-1]),this.txtDesc.string=i.desc,cc.loader.loadRes("Texture/hero/figure/"+this.heroId,cc.SpriteFrame,function(t,e){this.figure.spriteFrame=e}.bind(this));for(var n=function(e){var c=t.iconSkills[e];cc.loader.loadRes("Texture/hero/skill/"+(2*(t.heroId-1)+e+1),cc.SpriteFrame,function(t,e){c.spriteFrame=e}.bind(t)),t.txtSkillNames[e].string=i["skill"+(e+1)],t.txtSkillDescs[e].string=i["skillDesc"+(e+1)]},a=0;a<2;a++)n(a);c.heroUnlock?(this.btnNext.active=!0,this.txtLockHero.node.active=!1,this.txtUnopen.active=!1):this.heroId>=2?(this.btnNext.active=!1,this.txtUnopen.active=!0):1==this.heroId?(this.btnNext.active=!0,this.txtLockHero.node.active=!1,this.txtUnopen.active=!1):(this.btnNext.active=!1,this.txtLockHero.node.active=!0,this.txtUnopen.active=!1);var s=c.data.clearance[this.heroId-1],r=function(e){var i=t.iconDifficulty[e];cc.loader.loadRes("Texture/UI/prepare/"+(s<e?"lock":"icon"+(e+1)+(s>e?1:0)),cc.SpriteFrame,function(t,e){i.spriteFrame=e}.bind(t))};for(a=0;a<4;a++)r(a)},selectCharacter:function(t,e){this.btnCharacters[this.heroId-1].interactable=!0,this.heroId=parseInt(e)+1,this.btnCharacters[this.heroId-1].interactable=!1,cc.audioEngine.playEffect(window.sound.paper2);var i=cc.instantiate(this.boxInfo);this.boxUpon.addChild(i),i.runAction(cc.sequence(cc.spawn(cc.rotateBy(.5,40),cc.moveBy(.5,cc.v2(-770,600)).easing(cc.easeIn(3))),cc.callFunc(function(){i.destroy(),this.hand.runAction(cc.moveTo(.3,cc.v2(-323,339)))}.bind(this)))),this.hand.zIndex=10,this.hand.stopAllActions(),this.hand.position=cc.v2(-323,339),this.hand.runAction(cc.moveTo(.4,cc.v2(-462,509)).easing(cc.easeIn(2))),this.refreshInfo()},goBack:function(){1==this.status?window.loadingBrown.doStart(function(){cc.director.loadScene("cover")}.bind(this)):this.changeMode()},changeMode:function(){if(this.btnBack.node.zIndex=10,this.title.zIndex=10,this.btnBack.interactable=!1,1==this.status){this.selectDifficulty(null,0,!0),this.txtTitle.string="\u9009\u62e9\u6a21\u5f0f",this.status=2,this.seals[0].active=!0,this.boxCharacter.zIndex=2,this.boxDifficulty.zIndex=1,this.boxDifficulty.rotation=0,this.boxDifficulty.position=cc.v2(360,198.5),this.boxCharacter.runAction(cc.sequence(cc.rotateTo(.4,-50),cc.rotateTo(.2,-35),cc.moveBy(.6,cc.v2(0,-700)),cc.callFunc(function(){this.btnBack.interactable=!0}.bind(this))));var t=c.data.clearance[this.heroId-1];t>0&&t<4&&this.btnStart.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){this.selectDifficulty(null,t)}.bind(this))))}else this.txtTitle.string="\u9009\u62e9\u89d2\u8272",this.status=1,this.seals[0].active=!1,this.boxCharacter.zIndex=1,this.boxDifficulty.zIndex=2,this.boxCharacter.rotation=0,this.boxCharacter.position=cc.v2(360,198.5),this.boxDifficulty.runAction(cc.sequence(cc.rotateTo(.4,-50),cc.rotateTo(.2,-35),cc.moveBy(.6,cc.v2(0,-700)),cc.callFunc(function(){this.btnBack.interactable=!0}.bind(this))));cc.audioEngine.playEffect(window.sound.paper)},selectDifficulty:function(t,e,i){this.btnStart.stopAllActions();var o=this.btnDifficulty[this.difficultyId-1];o.interactable=!0;var n=c.data.clearance[this.heroId-1];if(n>=this.difficultyId-1){var a=this.iconDifficulty[this.difficultyId-1];cc.loader.loadRes("Texture/UI/prepare/icon"+this.difficultyId+(n<this.difficultyId?0:1),cc.SpriteFrame,function(t,e){a.spriteFrame=e}.bind(this))}i?o.node.position=cc.v2(154*(this.difficultyId-1)-589,-42.5):o.node.runAction(cc.moveTo(.2,cc.v2(154*(this.difficultyId-1)-589,-42.5))),this.difficultyId=parseInt(e)+1;var s=this.btnDifficulty[e];if(s.interactable=!1,n>=this.difficultyId-1){var r=this.iconDifficulty[e];cc.loader.loadRes("Texture/UI/prepare/icon"+this.difficultyId+"2",cc.SpriteFrame,function(t,e){r.spriteFrame=e}.bind(this))}i?s.node.position=cc.v2(154*e-589,-67.5):s.node.runAction(cc.moveTo(.2,cc.v2(154*e-589,-67.5))),this.refreshDifficulty(),i||cc.audioEngine.playEffect(window.sound.btn1)},refreshDifficulty:function(){var t=o.get("cfg_hero",this.heroId),e=["\u666e\u901a","\u9ad8\u624b","\u5927\u5e08","\u738b\u8005"];this.txtDifficulty.string=e[this.difficultyId-1]+"\u6a21\u5f0f",this.txtDifficultyDesc.string=t["difficulty"+this.difficultyId];var i=c.data.clearance[this.heroId-1];!c.heroUnlock&&this.difficultyId>i+1?(this.btnStart.active=!1,this.txtLockDifficulty.node.active=!0,this.txtLockDifficulty.string="\u901a\u5173"+e[this.difficultyId-2]+"\u6a21\u5f0f\u89e3\u9501"):(this.btnStart.active=!0,this.txtLockDifficulty.node.active=!1)},goBattle:function(){c.setDataToBase(),this.btnBack.interactable=!1,this.seals[1].active=!0,c.data.heroId=this.heroId,c.data.difficulty=this.difficultyId,c.data.startTime=Date.now(),c.data.restartCount=1==this.difficultyId?999:2==this.difficultyId?3:1,cc.audioEngine.playEffect(window.sound.btnStart),c.begin=!0,c.newCard=!1,window.loadingBrown.doStart(function(){cc.director.loadScene("helloworld",function(){window.loadingBrown.close()}.bind(this))}.bind(this))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],RequireRound:[function(t,e,i){"use strict";cc._RF.push(e,"3a0eeaFa/FFsJmcvXZBEaHe","RequireRound"),cc.Class({extends:cc.Component,properties:{circle:cc.Sprite,sprite:cc.Sprite},init:function(t,e){if(this.hide=!1,this.unCost=!1,this.satisfied=!1,t>0&&(this.element=t,this.refreshElement()),e>0){var i=[cc.color(117,29,28),cc.color(28,50,133),cc.color(15,97,51),cc.color(148,78,29),cc.color(153,123,33),cc.color(92,45,115),cc.color(91,91,91)];this.node.color=i[e-1]}else this.node.color=-2==e?cc.color(133,42,35):cc.color(114,79,60)},refreshElement:function(t){t&&(this.element=t),cc.loader.loadRes("Texture/battle/element"+this.element,cc.SpriteFrame,function(t,e){this.unCost||(this.sprite.node.active=!0,this.sprite.spriteFrame=e)}.bind(this))},refreshSatisfy:function(t){if(this.satisfied=t,this.satisfied&&!this.unCost&&this.element){var e=[cc.color(255,57,36),cc.color(21,104,224),cc.color(0,183,79),cc.color(255,127,18),cc.color(255,236,38),cc.color(166,52,254)];this.sprite.node.color=e[this.element-1]}else this.sprite.node.color=cc.color(157,157,157)},hideElement:function(){this.element=null,this.sprite.node.active=!1},disCost:function(){this.unCost=!0,cc.loader.loadRes("Texture/battle/image_requireLine2",cc.SpriteFrame,function(t,e){this.circle.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/battle/unelement"+this.element,cc.SpriteFrame,function(t,e){this.sprite.node.active&&(this.sprite.spriteFrame=e,this.sprite.node.color=cc.Color.WHITE)}.bind(this)),this.refreshSatisfy(!0)}}),cc._RF.pop()},{}],Reward:[function(t,e,i){"use strict";cc._RF.push(e,"6c1e8bWcJdJ5L93heyAlzGO","Reward");var c=t("Game");cc.Class({extends:cc.Component,properties:{txtDesc:cc.Label,markChange:cc.Node,changeNode:cc.Node,settleBoardPrefab:cc.Prefab,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab},init:function(t,e){this.type=e;var i=t.length;this.getCardList=[];for(var c=0;c<i;c++)this.checkReward(t[c],1==i?0:2*c-1);this.txtDesc.node.color=1==e?cc.color(255,234,0):cc.color(255,248,217)},checkReward:function(t,e){var i;if(t<=3)i=this.getCard(t);else if(4==t)i=this.getCard();else if(5==t)i=this.copyCard();else if(t<=8)i=this.getItem(t-5);else if(9==t)i=this.getItem();else if(t<=16){var c=[20,50,88,100,188,Math.floor(99*Math.random())+1,-1];i=this.getCopper(c[t-10])}else if(t<=19){i=this.getHp([10,-2,-1][t-17])}else if(t<=22){i=this.getHpMax([5,10,15][t-20])}else if(23==t)this.changeCard();else if(t<=25)i=this.deleteCard(t-24);else if(26==t)this.changeItem();else if(27==t)i=this.deleteItem();else if(t<=31){i=this.loseCopper([20,50,100,-1][t-28])}else if(t<=33){i=this.loseHp([10,-2][t-32])}else if(t<=35){i=this.loseHpMax([5,10][t-34])}else 36==t?i=this.getDebuff():37==t&&(i=this.getItem(null,73));i&&(i.x=166*e)},getCard:function(t,e){var i=e||c.getNewCardId(t),o=cc.instantiate(this.cardPrefab);return o.getComponent("CardCollection").init(i),o.getComponent("CardCollection").nail.active=2==this.type,this.node.addChild(o),1==this.type&&o.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){o.getComponent("CardCollection").showTip()}.bind(this)))),1==c.data.heroId&&3==c.data.difficulty&&c.data.deck.length>=6?this.getCardList.push(i):c.getCard(i),o},copyCard:function(){this.txtDesc.string="\u83b7\u5f97\u590d\u5236\u7684\u5361\u724c";var t=c.data.deck[Math.floor(Math.random()*c.data.deck.length)];return 4==c.data.heroId&&(t=c.data.cardBag[Math.floor(Math.random()*c.data.cardBag.length)]),this.getCard(null,t)},getItem:function(t,e){var i=e||c.getNewItemId(0,t);c.getItem(i);var o=cc.instantiate(this.itemPrefab);return o.getComponent("ItemCommodity").init(i),o.getComponent("ItemCommodity").nail.active=2==this.type,o.y=20,this.node.addChild(o),1==this.type&&o.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){o.getComponent("ItemCommodity").showTip()}.bind(this)))),o},getCopper:function(t){var e=cc.instantiate(this.settleBoardPrefab);return e.getComponent("SettleBoard").init(1,t,0),e.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(e),e},getHp:function(t){var e=cc.instantiate(this.settleBoardPrefab);return e.getComponent("SettleBoard").init(3,t,0),e.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(e),e},getHpMax:function(t){var e=cc.instantiate(this.settleBoardPrefab);return e.getComponent("SettleBoard").init(4,t,0),e.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(e),e},changeCard:function(){this.txtDesc.string="\u53d8\u6362\u80cc\u5305\u4e2d\u7684\u5361\u724c";var t=Math.floor(Math.random()*c.data.cardBag.length),e=c.data.cardBag[t];if(e){c.data.cardBag.splice(t,1),this.markChange.active=!0;var i=c.getNewCardId();c.getCard(i);var o=cc.instantiate(this.cardPrefab);o.getComponent("CardCollection").init(e),o.x=-166,this.changeNode.addChild(o),o.getComponent("CardCollection").markDelete.active=!0,o.getComponent("CardCollection").nail.active=2==this.type;var n=cc.instantiate(this.cardPrefab);n.getComponent("CardCollection").init(i),n.x=166,this.changeNode.addChild(n),n.getComponent("CardCollection").nail.active=2==this.type,1==this.type&&n.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){n.getComponent("CardCollection").showTip()}.bind(this))))}else{var a=cc.instantiate(this.cardPrefab);a.getComponent("CardCollection").init(-1),this.changeNode.addChild(a)}},deleteCard:function(t){var e=[];if(0==t?(e=c.data.deck,this.txtDesc.string="\u5931\u53bb\u51fa\u6218\u724c\u7ec4\u4e2d\u7684\u5361\u724c"):(e=c.data.cardBag,this.txtDesc.string="\u5931\u53bb\u80cc\u5305\u4e2d\u7684\u5361\u724c"),e.length>0){var i=Math.floor(Math.random()*e.length),o=e[i];e.splice(i,1);var n=cc.instantiate(this.cardPrefab);return n.getComponent("CardCollection").init(o),n.getComponent("CardCollection").markDelete.active=!0,n.getComponent("CardCollection").nail.active=2==this.type,this.node.addChild(n),n}var a=cc.instantiate(this.cardPrefab);return a.getComponent("CardCollection").init(-2),this.node.addChild(a),a},changeItem:function(){if(this.txtDesc.string="\u53d8\u6362\u5df2\u6709\u7684\u88c5\u5907",c.data.equip.length>0){this.markChange.active=!0;var t=c.deleteItem(),e=c.getNewItemId(0);c.getItem(e);var i=cc.instantiate(this.itemPrefab);i.getComponent("ItemCommodity").init(t),i.x=-166,i.y=20,this.changeNode.addChild(i),i.getComponent("ItemCommodity").markDelete.active=!0,i.getComponent("ItemCommodity").nail.active=2==this.type;var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(e),o.x=166,o.y=20,this.changeNode.addChild(o),o.getComponent("ItemCommodity").nail.active=2==this.type}else{var n=cc.instantiate(this.itemPrefab);n.getComponent("ItemCommodity").init(-1),this.changeNode.addChild(n)}},deleteItem:function(){if(this.txtDesc.string="\u5931\u53bb\u5df2\u6709\u7684\u88c5\u5907",c.data.equip.length>0){var t=c.deleteItem(),e=cc.instantiate(this.itemPrefab);return e.getComponent("ItemCommodity").init(t),e.y=20,this.node.addChild(e),e.getComponent("ItemCommodity").markDelete.active=!0,e.getComponent("ItemCommodity").nail.active=2==this.type,e}var i=cc.instantiate(this.itemPrefab);return i.getComponent("ItemCommodity").init(-2),this.node.addChild(i),i},loseCopper:function(t){var e=cc.instantiate(this.settleBoardPrefab);return e.getComponent("SettleBoard").init(5,t,0),e.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(e),e},loseHp:function(t){var e=cc.instantiate(this.settleBoardPrefab);return e.getComponent("SettleBoard").init(6,t,0),e.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(e),e},loseHpMax:function(t){var e=cc.instantiate(this.settleBoardPrefab);return e.getComponent("SettleBoard").init(7,t,0),e.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(e),e},getDebuff:function(){var t=cc.instantiate(this.settleBoardPrefab);return t.getComponent("SettleBoard").init(8,-1,0),t.getComponent("SettleBoard").nail.active=2==this.type,this.node.addChild(t),t}}),cc._RF.pop()},{Game:"Game"}],Room:[function(t,e,i){"use strict";cc._RF.push(e,"20286qrg/RMq6rq0m6qk3EY","Room");var c=t("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Sprite,circle:cc.Sprite,doorPrefab:cc.Prefab,btnCamp:cc.Node,btnNpc:cc.Node,npcFigure:cc.Sprite,btnTreasure:cc.Node,btnShop:cc.Node,btnTavern:cc.Node,monsterNode:cc.Node,monsterFigure:cc.Sprite,decoration:cc.Node,boxTip:cc.Node,top1:cc.Node,top2:cc.Node,crystal:cc.Node,carpet:cc.Sprite,shopKeeper:[cc.Node],tavernKeeper:[cc.Node],crystalShadow:cc.Node,crystalBase:cc.Node,star:cc.Node,starNode:cc.Node,starAnimation:cc.Node,laser:dragonBones.ArmatureDisplay},init:function(t){if(window.room=this,this.pos=c.data.heroPos,this.abled=!1,this.ready=!1,this.isNewRoom=t,t||c.begin){this.initFloorConfig();var e=(new Date).getTime(),i=e-c.data.startTime;i<72e5&&(c.data.duration+=i,c.data.totalTime+=i),c.data.startTime=e,c.data.floor>1&&c.data.highRecord[0]++}else this.typeList=c.data.historyPath[c.data.floor-1];this.initDoors(),this.initRoom(),this.initTouchEvents(),t||this.initHero(),this.initMap()},initHero:function(){this.hero=window.homeLayer.hero.getComponent("Chess"),window.homeLayer.refreshPath(),this.isNewRoom?(this.hero.come(this.pos,function(){0==c.data.roomType&&this.scheduleOnce(this.doReady,.2),this.doors[this.pos]&&(this.doors[this.pos].close(!0),cc.audioEngine.playEffect(window.sound.door)),2==c.data.guide[0]&&window.homeLayer.showGuide(0)}.bind(this)),this.checkEquip(),this.doors[this.pos]&&this.doors[this.pos].open(!1)):(this.scheduleOnce(this.doReady,.5),this.doors[this.pos]&&this.doors[this.pos].close(!1),c.begin?(this.hero.stay(0),c.guiding?window.homeLayer.showGuide(0):(this.hero.node.opacity=1,window.homeLayer.openMap())):this.hero.stay(this.pos))},showHero:function(){this.abled=!1,this.laser.node.zIndex=25,this.laser.node.active=!0,this.laser.playAnimation("play0",1),this.hero.node.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(.2),cc.callFunc(function(){this.laser.node.active=!1,this.abled=!0}.bind(this)))),cc.audioEngine.playEffect(window.sound.laser)},initDoors:function(){this.doors=[];for(var t=[cc.v2(0,315),cc.v2(315,0),cc.v2(0,-315),cc.v2(-315,0)],e=0;e<4;e++){var i=this.typeList[e];if(-2==i&&(i=c.data.roomType),i>=0){var o=cc.instantiate(this.doorPrefab);o.getComponent("Door").init(i,e),o.rotation=90*e,o.position=t[e],o.zIndex=20,this.node.addChild(o),this.doors[e]=o.getComponent("Door")}}},initRoom:function(){1==c.data.roomType||c.data.roomType>=7?this.isNewRoom&&(this.monsterNode.active=!0,this.monsterNode.zIndex=10,c.guiding&&(0==c.data.guide[1]?c.monsterId=3:0==c.data.guide[2]&&(c.monsterId=1)),cc.loader.loadRes("Texture/monster/figure/"+c.monsterId,cc.SpriteFrame,function(t,e){this.monsterFigure&&(this.monsterFigure.spriteFrame=e)}.bind(this)),this.monsterNode.runAction(cc.sequence(cc.scaleTo(.2,.96,1.03),cc.scaleTo(.4,1.03,.96),cc.scaleTo(.2,1,1)).repeatForever())):c.data.roomType>0&&this.initAlter()},gotoDoor:function(t){t!=this.pos&&this.abled&&(this.abled=!1,c.tempData=JSON.parse(JSON.stringify(c.data)),c.data.heroPos=(parseInt(t)+2)%4,c.data.floor++,c.data.floor>13&&(c.data.floor=1,c.data.castle++,c.data.historyPath=[],c.data.historyChoose=[0],c.data.floorBeats=[],c.data.monsterList=[]),this.hero.leave(t,function(){if(window.homeLayer.changeRoom(t),1==c.data.floor){this.hero.node.opacity=1,window.homeLayer.openMap();for(var e=window.homeLayer.pathList,i=0;i<e.length;i++)e[i].destroy();window.homeLayer.initPath()}}.bind(this)),c.data.roomType=this.typeList[t],c.data.historyChoose[c.data.floor-1]=c.data.roomType,(1==c.data.roomType||c.data.roomType>=7)&&(c.monsterId=this.checkMonster()),window.guide&&window.guide.close())},initTouchEvents:function(){this.bg.node.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this);for(var t=0;t<4;t++)this.doors[t]&&this.doors[t].node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this);this.btnTreasure.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnCamp.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnNpc.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnShop.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnTavern.on(cc.Node.EventType.TOUCH_END,this.touchEvent,this),this.btnTreasure.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnCamp.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnNpc.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnShop.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this),this.btnTavern.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEvent,this)},touchEvent:function(t){var e=t.touch._startPoint,i=t.touch._point.sub(e);if(this.abled&&i.mag()>60){var c=0;c=Math.abs(i.x)>Math.abs(i.y)?i.x>0?1:3:i.y>0?0:2;for(var o=0;o<4;o++)if(this.doors[o]&&this.doors[o].index==c){this.doors[o].btn.interactable&&this.doors[o].onEvent();break}}},initAlter:function(){if(2==c.data.roomType)if(this.btnCamp.active=!0,c.data.floorBeats[c.data.floor-1])this.crystal.active=!1,this.crystalBase.active=!1,this.crystalShadow.active=!1,this.starNode.active=!1;else{this.crystal.active=!0,this.crystal.runAction(cc.sequence(cc.moveBy(.7,cc.v2(0,25)),cc.moveBy(.7,cc.v2(0,-25))).repeatForever()),this.crystalShadow.runAction(cc.sequence(cc.moveBy(.7,cc.v2(0,-25)),cc.moveBy(.7,cc.v2(0,25))).repeatForever());for(var t=0;t<30;t++){var e=cc.instantiate(this.star);e.x=250*Math.random()-125;var i=Math.sqrt(Math.pow(125,2)-Math.pow(e.x,2));e.y=Math.random()*i*2-i,e.opacity=255*Math.random(),this.starNode.addChild(e);var o=3*Math.random()+.5;e.runAction(cc.sequence(cc.fadeIn(o),cc.fadeOut(o)).repeatForever())}}else 3==c.data.roomType?(this.btnTreasure.active=!0,this.btnTreasure.zIndex=10,c.data.floorBeats[c.data.floor-1]?(this.btnTreasure.y=-75,this.btnTreasure.scale=1,this.btnTreasure.stopAllActions(),this.top1.active=!1,this.top2.active=!0,this.starAnimation.active=!1):this.btnTreasure.runAction(cc.sequence(cc.scaleTo(.3,.98,1.02),cc.scaleTo(.6,1.02,.98),cc.scaleTo(.3,1,1)).repeatForever())):4==c.data.roomType?(this.btnNpc.active=!0,this.btnNpc.zIndex=10,c.data.floorBeats[c.data.floor-1]&&cc.loader.loadRes("Texture/map/alter/book2",cc.SpriteFrame,function(t,e){this.npcFigure.spriteFrame=e}.bind(this))):5==c.data.roomType?(this.btnShop.active=!0,this.btnShop.zIndex=10,this.shopKeeper[0].runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0)).repeatForever()),this.shopKeeper[1].runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0)).repeatForever())):6==c.data.roomType&&(this.btnTavern.active=!0,this.btnTavern.zIndex=10,this.tavernKeeper[0].runAction(cc.sequence(cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0)).repeatForever()),this.tavernKeeper[1].runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0)).repeatForever()),c.guiding&&c.data.guide[3]>0&&window.homeLayer.showGuide(4))},openAlter:function(){5!=c.data.roomType&&c.data.floorBeats[c.data.floor-1]?6!=c.data.roomType||this.boxTip.active||(this.boxTip.active=!0,this.boxTip.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){this.boxTip.active=!1}.bind(this))))):(window.homeLayer.openAlter(),3==c.data.roomType?this.btnTreasure.active=!1:6==c.data.roomType&&(this.btnTavern.getComponent(cc.Button).interactable=!1))},doReady:function(t){this.abled=!0,this.ready=!0;for(var e=0;e<4;e++)this.doors[e]&&e!=this.pos&&this.doors[e].open(!0);cc.audioEngine.playEffect(window.sound.door),c.saveData()},goBattle:function(){this.monsterNode.getComponent(cc.Button).interactable=!1,window.homeLayer.goBattle(),window.guide&&window.guide.close()},checkEquip:function(){3==c.data.roomType&&c.data.equip.indexOf(42)>=0&&c.updateCopper(50)},initFloorConfig:function(){if(c.data.historyPath[c.data.floor-1]&&c.data.historyPath[c.data.floor-1].indexOf(-2)==this.pos)this.typeList=c.data.historyPath[c.data.floor-1];else{var t=c.data.floorQuests[c.data.castle-1][c.data.floor-1].concat();if(1==t.length)this.typeList=[-1,-1,-1,-1],c.data.floor>1&&(this.typeList[this.pos]=-2),this.typeList[(this.pos+2)%4]=t[0];else{for(;t.length<3;)t.splice(Math.floor(Math.random()*(t.length+1)),0,-1);t.splice(this.pos,0,-2),this.typeList=t}c.data.historyPath[c.data.floor-1]=this.typeList,5==c.data.roomType&&this.initShopCfg()}},initShopCfg:function(t){var e=[0,0,0];if(t)for(var i=0;i<3;i++){var o=c.data.shopIds[i+6];o&&o<0&&(e[i]=-o)}c.data.shopIds=[];for(var n=[],a=[],s=[[0,.7,.3],[0,.5,.5],[0,.3,.7]];n.length<3;){for(var r=0,d=Math.random(),h=0,l=0;l<3;l++)if(d<(h+=s[c.data.castle-1][l])){r=l+1;break}for(var u=c.getNewCardId(r),f=!1,p=0;p<n.length;p++)if(u==n[p]){f=!0;break}f||n.push(u)}for(s=[[.4,.3,.3],[.3,.4,.3],[.2,.4,.4]];a.length<3;){for(var m=0,g=Math.random(),y=0,v=0;v<3;v++)if(g<(y+=s[c.data.castle-1][v])){m=v+1;break}for(var w=c.getNewItemId(1,m),b=!1,C=0;C<a.length;C++)if(w==a[C]){b=!0;break}b||a.push(w)}c.data.shopIds=n.concat(a,e)},checkMonster:function(){if(c.data.monsterList[c.data.floor-1]||(c.data.monsterList[c.data.floor-1]=[0,0,0,0]),!c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]){var t=2*(c.data.castle-1)+(c.data.floor<=6?1:2),e=7==c.data.roomType?1:8==c.data.roomType?2:0;4==c.data.castle&&(e=3),c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]=c.getNewMonsterId(t,e)}return c.data.monsterList[c.data.floor-1][(c.data.heroPos+2)%4]},initMap:function(){var t=this;cc.loader.loadRes("Texture/scene/map"+c.data.castle,cc.SpriteFrame,function(t,e){this.bg.spriteFrame=e}.bind(this));var e=[null,null,"camp","treasure","event","shop","tavern"][c.data.roomType];cc.loader.loadRes("Texture/map/floor/"+(e||"castle"+c.data.castle),cc.SpriteFrame,function(t,e){this.circle.spriteFrame=e}.bind(this)),e||cc.loader.loadRes("Texture/map/floor/carpet"+c.data.castle+(4==c.data.castle?"":Math.floor(3*Math.random()+1)),cc.SpriteFrame,function(t,e){this.carpet.spriteFrame=e}.bind(this));for(var i=0;i<4;i++)for(var o=0;o<5;){var n=0;n=i%2==0?155*-Math.random()-220:155*Math.random()+220;var a=0,s=cc.winSize.height/cc.winSize.width*750;a=i<2?Math.random()*(s/2-130)+130:-Math.random()*(s/2-130)-130,cc.v2(n,a).mag()>=410&&function(){var e=cc.instantiate(t.decoration);e.scaleX=Math.random()<.5?1:-1,e.position=cc.v2(n,a),t.bg.node.addChild(e),o++,cc.loader.loadRes("Texture/map/decoration/"+Math.floor(29*Math.random()+1),cc.SpriteFrame,function(t,i){e&&(e.getComponent(cc.Sprite).spriteFrame=i)}.bind(t))}()}}}),cc._RF.pop()},{Game:"Game"}],Score:[function(t,e,i){"use strict";cc._RF.push(e,"e24d120s1dGX63Z839rwA++","Score");var c=t("Game");cc.Class({extends:cc.Component,properties:{box1:cc.Sprite,box2:cc.Sprite,icon:cc.Sprite,txtName:cc.Label,txtScore:cc.Label},init:function(t){if(9==t)cc.loader.loadRes("Texture/UI/complete/box_score2",cc.SpriteFrame,function(t,e){this.box1.spriteFrame=e,this.box2.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/UI/complete/icon_total",cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this)),this.txtName.string="\u672c\u6b21\u6311\u6218\u603b\u5206",this.txtScore.string=c.score;else{cc.loader.loadRes("Texture/UI/complete/icon"+(t+1),cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this));var e=c.data.highRecord[t],i=0,o="";if(t<4){o=["\u63a2\u7d22\u7684\u623f\u95f4","\u51fb\u6740\u7684\u602a\u7269","\u51fb\u6740\u7684\u7cbe\u82f1","\u51fb\u6740\u7684\u9886\u4e3b"][t],i=e*[5,10,30,50][t],this.txtName.string=o+" ("+e+")"}else 4==t?(e>600?(o="\u8d2a\u5a6a\u8005",i=60):e>500?(o="\u5927\u5bcc\u8c6a",i=40):e>=400&&(o="\u6709\u94b1\u4eba",i=20),this.txtName.string=o+" (\u7d2f\u8ba1\u83b7\u5f97"+e+"\u91d1\u5e01)"):5==t?(e>35?(o="\u5361\u724c\u5927\u5e08",i=30):e>30?(o="\u5361\u724c\u6536\u85cf\u5bb6",i=20):e>=20&&(o="\u5361\u724c\u7231\u597d\u8005",i=10),this.txtName.string=o+" (\u7d2f\u8ba1\u83b7\u5f97"+e+"\u5361\u724c)"):6==t?(e>17?(o="\u88c5\u5907\u5927\u5e08",i=30):e>13?(o="\u88c5\u5907\u8fbe\u4eba",i=20):e>=10&&(o="\u88c5\u5907\u6536\u96c6\u8005",i=10),this.txtName.string=o+" (\u7d2f\u8ba1\u83b7\u5f97"+e+"\u88c5\u5907)"):7==t?(e>=4?(o="\u9152\u9986\u5927\u660e\u661f",i=30):3==e?(o="\u9152\u9986\u540d\u4eba",i=20):2==e&&(o="\u9152\u9986\u65b0\u661f",i=10),this.txtName.string=o+" (\u5355\u4e2a\u9152\u9986\u6fc0\u6d3b"+e+"\u5f20\u5361)"):8==t&&(3==e?(o="\u8d4c\u795e",i=30):2==e?(o="\u8d62\u5bb6",i=20):1==e&&(o="\u8d4c\u5f92",i=10),this.txtName.string=o+" (\u9ab0\u5b50\u6e38\u620f\u80dc\u5229"+e+"\u6b21)");this.txtScore.string=i,c.score+=i}}}),cc._RF.pop()},{Game:"Game"}],SettingLayer:[function(t,e,i){"use strict";cc._RF.push(e,"5aaf8g21CFNarRoBa5QzfSd","SettingLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{bg:cc.Node,btnSpider:cc.Node,mask:cc.Node,btnLanguage:cc.Node,btnQuit:cc.Node,btnHome:cc.Node,btnGiveup:cc.Node,markMusic:cc.Sprite,markSound:cc.Sprite,txtMusic:cc.Label,txtSound:cc.Label,confirmPrefab:cc.Prefab},onLoad:function(){window.settingLayer=this,window.homeLayer||window.mainLayer?(this.btnLanguage.active=this.btnQuit.active=!1,this.btnHome.active=this.btnGiveup.active=!0):(this.btnLanguage.active=this.btnQuit.active=!0,this.btnHome.active=this.btnGiveup.active=!1),this.refreshMusic(),this.refreshSound(),this.mask.runAction(cc.fadeTo(.2,210)),this.bg.y=cc.winSize.height-230,this.bg.runAction(cc.sequence(cc.moveTo(.25,cc.v2(0,40)),cc.moveBy(.15,cc.v2(0,20)))),this.btnSpider.runAction(cc.sequence(cc.delayTime(.25),cc.moveBy(.15,cc.v2(0,90)),cc.callFunc(function(){this.mask.on(cc.Node.EventType.TOUCH_START,this.close,this)}.bind(this)))),cc.audioEngine.playEffect(window.sound.btn2)},refreshMusic:function(){cc.loader.loadRes("Texture/UI/setting/mark_music"+(c.data.music?1:2),cc.SpriteFrame,function(t,e){this.markMusic.spriteFrame=e}.bind(this)),this.txtMusic.string="\u97f3\u4e50     "+(c.data.music?"\u5f00":"\u5173")},refreshSound:function(){cc.loader.loadRes("Texture/UI/setting/mark_sound"+(c.data.sound?1:2),cc.SpriteFrame,function(t,e){this.markSound.spriteFrame=e}.bind(this)),this.txtSound.string="\u97f3\u6548     "+(c.data.sound?"\u5f00":"\u5173")},onMusic:function(){c.data.music=!c.data.music,cc.audioEngine.setMusicVolume(c.data.music?1:0),this.refreshMusic(),c.saveData()},onSound:function(){c.data.sound=!c.data.sound,cc.audioEngine.setEffectsVolume(c.data.sound?1:0),this.refreshSound(),c.saveData()},onQuit:function(){cc.game.end()},onHome:function(){if(window.mainLayer||window.homeLayer&&!window.room.ready){var t=JSON.parse(JSON.stringify(c.data));c.data=c.tempData,c.data.historyPath=t.historyPath,c.data.historyChoose=t.historyChoose,c.data.monsterList=t.monsterList}window.loadingBrown.doStart(function(){window.homeLayer=null,window.mainLayer=null,cc.director.loadScene("cover")}.bind(this))},onGiveup:function(){var t=cc.instantiate(this.confirmPrefab);this.node.addChild(t),t.getComponent("Confirm").init("\u662f\u5426\u653e\u5f03\u5f53\u524d\u8fdb\u5ea6\uff1f",function(){window.loadingBrown.doStart(function(){c.setDataToBase(),window.homeLayer=null,window.mainLayer=null,cc.director.loadScene("cover")}.bind(this))}.bind(this))},close:function(){cc.audioEngine.playEffect(window.sound.btn2),this.btnSpider.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,-90)),cc.callFunc(function(){this.mask.runAction(cc.fadeOut(.2))}.bind(this)))),this.bg.runAction(cc.sequence(cc.moveBy(.15,cc.v2(0,-20)),cc.moveTo(.25,cc.v2(0,cc.winSize.height-230)),cc.callFunc(function(){this.node.destroy(),window.settingLayer=null}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}],SettleBoard:[function(t,e,i){"use strict";cc._RF.push(e,"7d135XUjf5JtqfAq8hhMcbl","SettleBoard");var c=t("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,txtName:cc.Label,txtCount:cc.Label,mark:cc.Sprite,mask:cc.Node,nail:cc.Node,btn:cc.Button,txtChosen:cc.Node},init:function(t,e,i){this.type=t,this.value=e;this.title.color=cc.Color.WHITE.fromHEX(["#ED9E21","#21C151","#FF413A","#FF413A","#50668f","#50668f","#50668f","#50668f"][t-1]);this.txtName.string=["\u83b7\u5f97\u91d1\u5e01","\u83b7\u5f97\u7ecf\u9a8c","\u751f\u547d\u56de\u590d","\u989d\u5916\u751f\u547d","\u5931\u53bb\u91d1\u5e01","\u5931\u53bb\u751f\u547d","\u751f\u547d\u6700\u5927\u503c","\u6028\u5ff5"][t-1],cc.loader.loadRes("Texture/UI/yahtzee/reward"+t,cc.SpriteFrame,function(t,e){this.mark.spriteFrame=e}.bind(this)),e>=0?this.txtCount.string=(t<=4?"+":"-")+this.value:(1==t?(this.value=c.data.copper,this.txtCount.string="\u91d1\u5e01\u6570\u91cf\u7ffb\u500d"):3==t?-1==e?(this.value=c.data.hpMax,this.txtCount.string="\u56de\u590d\u5168\u90e8\u751f\u547d"):-2==e&&(this.value=Math.floor(.3*c.data.hpMax),this.txtCount.string="\u56de\u590d30%\u6700\u5927\u751f\u547d"):5==t?(this.value=Math.floor(c.data.copper/2),this.txtCount.string="\u91d1\u5e01\u6570\u91cf\u51cf\u534a"):6==t&&(this.value=Math.floor(.3*c.data.hpMax),this.txtCount.string="30%\u6700\u5927\u751f\u547d"),8==t&&(this.txtCount.string="\u6218\u6597\u5f00\u59cb\u65f6\u751f\u547d-3")),0==i?this.getReward():1==i&&this.scheduleOnce(function(){this.enableChoosen()}.bind(this),.2)},runOut:function(t,e){this.index=e,this.mask.active=!0,this.node.opacity=1,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*e),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,t),cc.scaleTo(.2,1)),cc.callFunc(function(){this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},getReward:function(){if(1==this.type)c.updateCopper(this.value);else if(2==this.type){c.data.exp+=this.value;var t=[5,15,21,39,47,73,150][c.data.level-1];c.data.exp>=t&&(c.data.exp-=t,c.data.level++,c.data.hpMax+=10,c.data.hp=window.mainLayer.hero.hp=c.data.hpMax,c.data.levelUp=!0)}else 3==this.type?c.data.hp=Math.min(c.data.hp+this.value,c.data.hpMax):4==this.type?(c.data.hpMax+=this.value,c.data.hp+=this.value):5==this.type?c.updateCopper(-this.value):6==this.type?c.data.hp-=this.value:7==this.type?(c.data.hpMax-=this.value,c.data.hp=Math.min(c.data.hp,c.data.hpMax)):8==this.type&&c.data.debuff++},enableChoosen:function(){this.btn.interactable=!0,this.txtChosen.active=!0,this.txtChosen.opacity=0,this.txtChosen.y-=50,this.txtChosen.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))},choose:function(){this.getReward(),window.treasureLayer?(this.got(),window.treasureLayer.close(this.index)):window.treasureChest&&window.treasureChest.chooseBoard(),1==this.type?cc.audioEngine.playEffect(window.sound.copperSound):3==this.type&&cc.audioEngine.playEffect(window.sound.healSound),this.btn.interactable=!1},got:function(){this.btn.node.active=!1,this.title.active=!1,this.txtChosen.active=!1;var t=cc.winSize.height/cc.winSize.width*750;this.mark.node.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.spawn(cc.scaleTo(.3,.3),cc.moveTo(.3,cc.v2(-337-this.node.x,-t/2+125-this.node.y-this.node.parent.y)))))}}),cc._RF.pop()},{Game:"Game"}],SettleCard:[function(t,e,i){"use strict";cc._RF.push(e,"30a7fQ+EPRM5ZqgNv4W+srK","SettleCard");var c=t("Game");cc.Class({extends:cc.Component,properties:{title:cc.Node,txtName:cc.Label,txtCount:cc.Label,mark:cc.Sprite,mask:cc.Node,numNode:cc.Node,strip:cc.ProgressBar,bar:cc.Node,txtNum:cc.Label,copperNode:cc.Node,txtCopper:cc.Label},init:function(t,e){this.type=t,this.value=e;this.title.color=cc.Color.WHITE.fromHEX(["#ED9E21","#21C151","#FF413A"][t-1]);this.txtName.string=["\u91d1 \u5e01","\u7ecf \u9a8c","\u751f\u547d\u56de\u590d"][t-1],cc.loader.loadRes("Texture/UI/yahtzee/reward"+t,cc.SpriteFrame,function(t,e){this.mark.spriteFrame=e}.bind(this)),this.txtCount.string="+"+this.value},runOut:function(t,e){this.mask.active=!0,this.node.opacity=0,this.node.scale=.6,this.node.runAction(cc.sequence(cc.delayTime(.2*e),cc.spawn(cc.fadeIn(.1),cc.moveTo(.2,t),cc.scaleTo(.2,1)),cc.callFunc(function(){this.mask.runAction(cc.fadeOut(.2))}.bind(this))))},showStrip:function(){if(1==this.type)this.copperNode.active=!0,this.txtCopper.string=c.data.copper,this.copper=c.data.copper,this.getReward();else{if(this.strip.node.active=!0,this.bar.color=2==this.type?cc.color(0,247,98):cc.color(255,56,49),2==this.type){var t=[5,15,21,39,47,73,150][c.data.level-1];this.strip.progress=c.data.exp/t,this.txtNum.string=c.data.exp+"/"+t,this.exp=c.data.exp,this.expMax=t}else this.strip.progress=c.data.hp/c.data.hpMax,this.txtNum.string=c.data.hp+"/"+c.data.hpMax,this.hp=c.data.hp;if(this.getReward(),this.overload=0,2==this.type){t=[5,15,21,39,47,73,150][c.data.level-1];this.targetProgress=c.data.exp/t,this.targetProgress<this.strip.progress&&this.overload++}else this.targetProgress=c.data.hp/c.data.hpMax}this.numNode.opacity=0,this.numNode.y-=50,this.numNode.runAction(cc.sequence(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))),cc.callFunc(function(){this.schedule(this.updateProgress,0),this.schedule(this.updateNum,1/30)}.bind(this))))},getReward:function(){if(1==this.type)c.updateCopper(this.value);else if(2==this.type){c.data.exp+=this.value;var t=[5,15,21,39,47,73,150][c.data.level-1];c.data.exp>=t&&(c.data.exp-=t,c.data.level++,c.data.hpMax+=10,c.data.hp=window.mainLayer.hero.hp=c.data.hpMax,c.data.levelUp=!0)}else 3==this.type?c.data.hp=Math.min(c.data.hp+this.value,c.data.hpMax):4==this.type&&(c.data.hpMax+=this.value,c.data.hp+=this.value)},updateNum:function(){if(1==this.type)this.copper<c.data.copper&&(this.copper++,this.txtCopper.string=this.copper);else if(2==this.type){var t=[5,15,21,39,47,73,150][c.data.level-1];(this.expMax<t||this.exp<c.data.exp)&&(this.exp<this.expMax&&this.exp++,this.txtNum.string=this.exp+"/"+this.expMax)}else this.hp<c.data.hp&&(this.hp++,this.txtNum.string=this.hp+"/"+c.data.hpMax)},updateProgress:function(){if(this.type>1&&(this.overload>0||this.strip.progress<this.targetProgress)&&(this.strip.progress+=.01,this.strip.progress>=1&&2==this.type)){this.strip.progress=0,this.overload--;var t=[5,15,21,39,47,73,150][c.data.level-1];this.exp=0,this.expMax=t,this.txtNum.string=this.exp+"/"+this.expMax}}}),cc._RF.pop()},{Game:"Game"}],ShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"47158KpbiJMF46lKbQmGdRL","ShopItem");var c=t("Game"),o=t("Config");cc.Class({extends:cc.Component,properties:{cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,txtCost:cc.Label,boxDiscount:cc.Node,txtDiscount:cc.Label,iconNode:cc.Node,markDelete:cc.Node,markPotion:cc.Node,markRrefresh:cc.Node,txtPotion:cc.Label},init:function(t,e,i){this.cfgId=t,this.type=e;var c=void 0;0==e?((c=cc.instantiate(this.cardPrefab)).getComponent("CardCollection").init(t),this.cost=3*o.get("cfg_card",t).value,c.y=8):1==e?((c=cc.instantiate(this.itemPrefab)).getComponent("ItemCommodity").init(t),this.cost=6*o.get("cfg_item",t).value,c.y=30):2==e?this.markPotion.active=!0:3==e?(this.markRrefresh.active=!0,this.cost=30*(t+1)):4==e&&(this.markDelete.active=!0,this.cost=50*(t+1)),c&&(this.iconNode.addChild(c),this.item=c),i&&(this.boxDiscount.active=!0,0==e?(this.cost=Math.ceil(.5*this.cost),this.txtDiscount.string="5\u6298"):(this.boxDiscount.y+=50,this.cost=Math.ceil(.7*this.cost),this.txtDiscount.string="7\u6298"),this.txtCost.node.color=cc.Color.BLACK.fromHEX("#3EFFE6"),this.txtCost.getComponent(cc.LabelOutline).color=cc.Color.BLACK.fromHEX("#3EFFE6")),this.refreshCostColor(),this.txtCost.string=this.cost},buy:function(){if(c.data.copper>=this.cost&&this.cost>0){if(c.updateCopper(-this.cost),0==this.type?window.homeLayer.getCard(this.cfgId):1==this.type?c.getItem(this.cfgId):2==this.type?c.data.hp+=this.cost/2:3==this.type?window.shopLayer.refreshItem():4==this.type&&window.homeLayer.openDelete(),this.type<2){var t=c.data.shopIds.indexOf(this.cfgId,3*this.type);c.data.shopIds[t]=0}else{t=4+this.type;c.data.shopIds[t]=-(c.data.shopIds[t]+1)}this.node.destroy(),window.homeLayer.refreshHeroData(),cc.audioEngine.playEffect(window.sound.buy);t=window.shopLayer.shopItems.indexOf(this);window.shopLayer.shopItems.splice(t,1);for(var e=0;e<window.shopLayer.shopItems.length;e++)window.shopLayer.shopItems[e].refreshCostColor()}else this.iconNode.runAction(cc.sequence(cc.rotateTo(.05,10),cc.rotateTo(.1,-10),cc.rotateTo(.1,10),cc.rotateTo(.1,-10),cc.rotateTo(.05,0))),cc.audioEngine.playEffect(window.sound.errorSound)},refreshCostColor:function(){if(2==this.type){if(c.data.hp>=c.data.hpMax)this.txtPotion.string="\u751f\u547d\u5df2\u6ee1",this.cost=0;else{var t=c.data.hpMax-c.data.hp;this.cost=Math.min(2*t,2*Math.floor(c.data.copper/2)),this.txtPotion.string="\u751f\u547d +"+t}this.txtCost.string=this.cost}(c.data.copper<this.cost||this.cost<=0)&&(this.txtCost.node.color=this.txtCost.getComponent(cc.LabelOutline).color=cc.Color.BLACK.fromHEX("#F72837"))}}),cc._RF.pop()},{Config:"Config",Game:"Game"}],ShopLayer:[function(t,e,i){"use strict";cc._RF.push(e,"f8baepveSxIlbuJL5yNDtxX","ShopLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{boxs:[cc.Node],shopItemPrefab:cc.Prefab,curtain:cc.Node,title:cc.Node,btnClose:cc.Node},onLoad:function(){window.shopLayer=this,this.shopItems=[],this.initCards(),this.initEquip(),this.initOthers(),this.curtain.runAction(cc.moveTo(.15,cc.v2(0,-17))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.moveTo(.25,cc.v2(9,-35)))),this.title.runAction(cc.sequence(cc.delayTime(.15),cc.skewTo(.2,2,0),cc.skewTo(.2,-2,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,1,0),cc.skewTo(.2,-1,0),cc.skewTo(.2,0,0))),cc.audioEngine.playEffect(window.sound.shopOpen)},initCards:function(){for(var t=0;t<3;t++){var e=c.data.shopIds[t];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,0,c.data.itemEffect.vip2),i.position=cc.v2(t%3*245-245,0),this.boxs[0].addChild(i),this.shopItems.push(i.getComponent("ShopItem"))}}this.boxs[0].x=-750,this.boxs[0].y+=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[0].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0))))},initEquip:function(){for(var t=0;t<3;t++){var e=c.data.shopIds[t+3];if(e>0){var i=cc.instantiate(this.shopItemPrefab);i.getComponent("ShopItem").init(e,1,c.data.itemEffect.vip1),i.position=cc.v2(t%3*245-245,0),this.boxs[1].addChild(i),this.shopItems.push(i.getComponent("ShopItem"))}}this.boxs[1].x=750,this.boxs[1].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0))))},initOthers:function(){var t=c.data.shopIds[6];if(t>=0){var e=cc.instantiate(this.shopItemPrefab);e.getComponent("ShopItem").init(t,2),e.position=cc.v2(-245,0),this.boxs[2].addChild(e),this.shopItems.push(e.getComponent("ShopItem"))}if(4==c.data.heroId){var i=c.data.shopIds[8];if(i>=0){var o=cc.instantiate(this.shopItemPrefab);o.getComponent("ShopItem").init(i,4),this.boxs[2].addChild(o),this.shopItems.push(o.getComponent("ShopItem"))}}var n=c.data.shopIds[7];if(n>=0){var a=cc.instantiate(this.shopItemPrefab);a.getComponent("ShopItem").init(n,3),a.position=cc.v2(4==c.data.heroId?245:0,0),this.boxs[2].addChild(a),this.shopItems.push(a.getComponent("ShopItem"))}this.boxs[2].x=-750,this.boxs[2].y-=(cc.winSize.height/cc.winSize.width*750-1334)/4,this.boxs[2].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.2,cc.v2(750,0))))},close:function(){this.btnClose.active=!1,this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.sequence(cc.delayTime(.1),cc.moveBy(.2,cc.v2(750,0)))),this.boxs[0].runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.2,cc.v2(-750,0)))),this.title.runAction(cc.moveTo(.2,cc.v2(9,230))),this.curtain.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.1,cc.v2(0,43)))),window.homeLayer.btnNode.runAction(cc.moveTo(.2,cc.v2(235,window.homeLayer.btnNode.y))),this.scheduleOnce(function(){this.node.destroy()}.bind(this),.4),window.shopLayer=null,window.room.doReady(),cc.audioEngine.playEffect(window.sound.shopClose)},refreshItem:function(){this.boxs[0].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.boxs[1].runAction(cc.moveBy(.2,cc.v2(750,0))),this.boxs[2].runAction(cc.moveBy(.2,cc.v2(-750,0))),this.scheduleOnce(function(){for(var t=0;t<this.shopItems.length;t++)this.shopItems[t].node.destroy();this.shopItems=[],window.room.initShopCfg(!0),this.initCards(),this.initEquip(),this.initOthers()}.bind(this),.2)}}),cc._RF.pop()},{Game:"Game"}],SkillManager:[function(t,e,i){"use strict";cc._RF.push(e,"f9b8a6FzCFFt4zg92Jc9Ljj","SkillManager");var c=t("Game"),o={doCast:function(t){var e=window.mainLayer.hero,i=window.mainLayer.enemy;if(1==c.data.heroId)0==t?i.onHurt(5,4):1==t&&e.buff.addBuff(107,1);else if(2==c.data.heroId){if(0==t){for(var o=[],n=e.player.cardList.length-1;n>=0;n--){var a=e.player.cardList[n].getComponent("Card");a.unCost||a.isCopy||a.silence||o.push(n)}if(o.length>0){var s=Math.floor(o.length*Math.random());e.player.cardList[o[s]].getComponent("Card").disCost(),o.splice(s,1)}e.player.checkCardsRequire()}else if(1==t)for(var r=e.player.cardList.length,d=0;d<6-r;d++)e.player.patchCard()}else if(3==c.data.heroId){if(0==t)e.player.rollCount++,e.player.roll();else if(1==t)for(var h=0;h<6;h++)e.player.elementList[h]>0&&i.buff.addBuff(21+h,e.player.elementList[h])}else if(4==c.data.heroId){if(0==t){for(var l=e.player.cardList.length,u=[],f=l-1;f>=0;f--){var p=e.player.cardList[f].getComponent("Card");u.push(p.cfgId),p.discard(!0)}for(var m=Math.min(e.player.deckArray.length,l),g=0;g<m;g++)e.player.suppleCard();for(var y=0;y<u.length;y++)e.player.deckArray.push(u[y]);if(e.player.deckArray.sort(function(){return.5-Math.random()}),m<l)for(var v=0;v<l-m;v++)e.player.suppleCard();e.scheduleOnce(function(){window.mainLayer.hero.checkBtnRoll(!0)},.3)}else if(1==t){for(var w=0;w<2;w++)e.player.createExDice();window.mainLayer.hero.checkBtnRoll(!0)}}else if(5==c.data.heroId)if(0==t)e.player.createExDice();else if(1==t){for(var b=e.player.cardList.length-1;b>=0;b--)e.player.cardList[b].getComponent("Card").discard();e.player.cardList=[],e.player.createChest(!0)}}};e.exports=o,cc._RF.pop()},{Game:"Game"}],Skill:[function(t,e,i){"use strict";cc._RF.push(e,"84424zovvVHiZ6bvX7VE49L","Skill");var c=t("Game"),o=t("Config"),n=t("SkillManager");cc.Class({extends:cc.Component,properties:{box:cc.Sprite,icon:cc.Sprite,mask:cc.Node,boxTip:cc.Node,txtDesc:cc.Label},init:function(t){if(this.index=t,this.unlock=!0,this.abled=!0,this.cost=10*(t+1),1==t&&c.data.level<3&&(this.unlock=!1),this.unlock){cc.loader.loadRes("Texture/hero/skill/"+(2*c.data.heroId-1+t),cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e}.bind(this));var e=o.get("cfg_hero",c.data.heroId);this.txtDesc.string=e["skill"+(t+1)]+": "+e["skillDesc"+(t+1)]+"\uff0c\u6d88\u8017"+this.cost+"\u6012\u6c14"}else cc.loader.loadRes("Texture/battle/mark_skill",cc.SpriteFrame,function(t,e){this.icon.spriteFrame=e,this.txtDesc.string="3\u7ea7\u89e3\u9501\u6280\u80fd"}.bind(this));this.btnStatus=0,this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel,this),this.check()},check:function(){window.mainLayer.gameOver?this.changeBtnSprite(2):this.unlock?177==window.mainLayer.enemy.equipList[0]?this.changeBtnSprite(2):this.abled&&window.mainLayer.hero.power>=this.cost?this.changeBtnSprite(0):this.changeBtnSprite(2):this.changeBtnSprite(2),this.btnStatus<2?(this.mask.active=!1,this.icon.getComponent(cc.Button).enableAutoGrayEffect=!1):(this.mask.active=!0,this.icon.getComponent(cc.Button).enableAutoGrayEffect=this.unlock)},doSkill:function(){c.guiding&&c.data.guide[2]<3||0==window.mainLayer.roundId&&(this.abled=!1,window.mainLayer.hero.addPower(-this.cost),n.doCast(this.index),this.check(),window.guide&&window.guide.close())},changeBtnSprite:function(t){this.btnStatus!=t&&(this.btnStatus=t,cc.loader.loadRes("Texture/battle/btn_skill"+(0==t?"":t+1),cc.SpriteFrame,function(t,e){this.box.spriteFrame=e}.bind(this)))},touchStart:function(){0==this.btnStatus&&this.changeBtnSprite(1),this.node.runAction(cc.sequence(cc.delayTime(.6),cc.callFunc(function(){this.boxTip.active=!0,this.boxTip.height=this.txtDesc.node.height+20}.bind(this))))},touchEnd:function(){this.node.stopAllActions(),this.boxTip.active?(this.boxTip.active=!1,this.check()):1==this.btnStatus&&this.doSkill()},touchCancel:function(){1==this.btnStatus&&this.check(),this.node.stopAllActions(),this.boxTip.active=!1}}),cc._RF.pop()},{Config:"Config",Game:"Game",SkillManager:"SkillManager"}],Sound:[function(t,e,i){"use strict";cc._RF.push(e,"77726IJdzpF843mufBZFnYQ","Sound");var c=t("Game");cc.Class({extends:cc.Component,properties:{btn1:{type:cc.AudioClip,default:null},btn2:{type:cc.AudioClip,default:null},btnStart:{type:cc.AudioClip,default:null},selectSound:{type:cc.AudioClip,default:null},levelUpSound:{type:cc.AudioClip,default:null},endRound:{type:cc.AudioClip,default:null},copperSound:{type:cc.AudioClip,default:null},blackSound:{type:cc.AudioClip,default:null},delete:{type:cc.AudioClip,default:null},shopOpen:{type:cc.AudioClip,default:null},shopClose:{type:cc.AudioClip,default:null},buy:{type:cc.AudioClip,default:null},skySound:{type:cc.AudioClip,default:null},coverSound:{type:cc.AudioClip,default:null},bookSound:{type:cc.AudioClip,default:null},finger:{type:cc.AudioClip,default:null},bookOpen:{type:cc.AudioClip,default:null},paper:{type:cc.AudioClip,default:null},paper2:{type:cc.AudioClip,default:null},fireSound:{type:cc.AudioClip,default:null},iceSound:{type:cc.AudioClip,default:null},windSound:{type:cc.AudioClip,default:null},earthSound:{type:cc.AudioClip,default:null},lightSound:{type:cc.AudioClip,default:null},darkSound:{type:cc.AudioClip,default:null},atkSound:{type:cc.AudioClip,default:null},armorSound:{type:cc.AudioClip,default:null},healSound:{type:cc.AudioClip,default:null},dodgeSound:{type:cc.AudioClip,default:null},frailSound:{type:cc.AudioClip,default:null},weakSound:{type:cc.AudioClip,default:null},silenceSound:{type:cc.AudioClip,default:null},poisonSound:{type:cc.AudioClip,default:null},curseSound:{type:cc.AudioClip,default:null},lockSound:{type:cc.AudioClip,default:null},blindSound:{type:cc.AudioClip,default:null},reviveSound:{type:cc.AudioClip,default:null},undeadSound:{type:cc.AudioClip,default:null},burnSound:{type:cc.AudioClip,default:null},counterSound:{type:cc.AudioClip,default:null},errorSound:{type:cc.AudioClip,default:null},discardSound:{type:cc.AudioClip,default:null},missSound:{type:cc.AudioClip,default:null},bagOpenSound:{type:cc.AudioClip,default:null},bagCloseSound:{type:cc.AudioClip,default:null},rollSound:{type:cc.AudioClip,default:null},rollSound2:{type:cc.AudioClip,default:null},holdSound:{type:cc.AudioClip,default:null},drawSound:{type:cc.AudioClip,default:null},laser:{type:cc.AudioClip,default:null},seal:{type:cc.AudioClip,default:null},bell:{type:cc.AudioClip,default:null},spin:{type:cc.AudioClip,default:null},wood:{type:cc.AudioClip,default:null},back:{type:cc.AudioClip,default:null},event:{type:cc.AudioClip,default:null},chest:{type:cc.AudioClip,default:null},treasureSound:{type:cc.AudioClip,default:null},win:{type:cc.AudioClip,default:null},reward:{type:cc.AudioClip,default:null},lose:{type:cc.AudioClip,default:null},bingo:{type:cc.AudioClip,default:null},end:{type:cc.AudioClip,default:null},cheer:{type:cc.AudioClip,default:null},door:{type:cc.AudioClip,default:null},camp:{type:cc.AudioClip,default:null},bgmTavetn:{type:cc.AudioClip,default:null},bgmPrepare:{type:cc.AudioClip,default:null},bgmYahtzee:{type:cc.AudioClip,default:null},bgmMap:{type:[cc.AudioClip],default:[]},bgmBattle:{type:[cc.AudioClip],default:[]},bgmComplete:{type:cc.AudioClip,default:null},monsterSound:{type:[cc.AudioClip],default:[]},wolfSound:{type:cc.AudioClip,default:null}},onLoad:function(){cc.audioEngine.setMusicVolume(c.data.music?1:0),cc.audioEngine.setEffectsVolume(c.data.sound?1:0)}}),cc._RF.pop()},{Game:"Game"}],Summary:[function(t,e,i){"use strict";cc._RF.push(e,"019a8lICP1CvqD9bgKhQLEq","Summary");var c=t("Game");cc.Class({extends:cc.Component,properties:{titleWin:cc.Node,titleLose:cc.Node,bg:cc.Node,mask:cc.Node,elementNode:cc.Node,elementLine:cc.Node,label:cc.Node,scroll:cc.Node,shine1:cc.Node,shine2:cc.Node,smoke:dragonBones.ArmatureDisplay,losePrefab:cc.Prefab,content:cc.Node,scorePrefab:cc.Prefab,topScroll:cc.Node,bottomScroll:cc.Node,view:cc.Node,loseBtns:cc.Node,btnNext:cc.Node,unlockNode:cc.Node,titleUnlock:cc.Node,txtTitle:cc.Label,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,heroCardPrefab:cc.Prefab,completePrefab:cc.Prefab,seal1:cc.Node,seal2:cc.Node,seals1:[cc.Node],seals2:[cc.Node]},init:function(t){window.summaryLayer=this,this.index=t,this.title=t>0?this.titleWin:this.titleLose,this.title.active=!0,this.title.y+=350,this.title.runAction(cc.moveBy(.2,cc.v2(0,-350))),this.bg.opacity=0,this.bg.color=cc.Color.WHITE.fromHEX(t>0?"#FC4953":"#1579E9"),this.bg.runAction(cc.fadeIn(.3)),this.mask.zIndex=10;for(var e=this.elementNode.getChildren(),i=0;i<e.length;i++)e[i].color=cc.Color.WHITE.fromHEX(t>0?"#FD7D7D":"#3395F5");for(var c=0;c<2;c++){var o=cc.instantiate(this.elementNode);o.x=0==c?-698:698,this.elementLine.addChild(o)}this.elementLines=[this.elementLine];for(var n=1;n<9;n++){var a=cc.instantiate(this.elementLine);a.position=cc.v2(32*n,218*n),this.bg.addChild(a),this.elementLines.push(a)}for(var s=1;s<9;s++){var r=cc.instantiate(this.elementLine);r.position=cc.v2(-32*s,-218*s),this.bg.addChild(r),this.elementLines.push(r),8==s&&(this.bottom=r)}if(this.shine=t>0?this.shine1:this.shine2,this.abled=!1,this.scroll.scale=0,this.shine.active=!0,this.shine.scale=0,this.label.opacity=0,this.label.y-=50,t<0){var d=cc.instantiate(this.losePrefab);this.node.addChild(d)}else this.scroll.y=-120,this.doScroll(),this.title.y+=215,this.title.opacity=0,this.title.runAction(cc.sequence(cc.delayTime(.1),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,-235)),cc.moveBy(.1,cc.v2(0,20)))));this.level=0,this.status=0,this.bg.on(cc.Node.EventType.TOUCH_START,this.knock,this)},doScroll:function(){this.seal=this.index>0?this.seal1:this.seal2,this.sealList=this.index>0?this.seals1:this.seals2,this.seal.active=!0,this.scroll.runAction(cc.spawn(cc.sequence(cc.scaleTo(.4,1.1),cc.scaleTo(.1,1)),cc.rotateBy(.5,360),cc.moveTo(.3,cc.v2(0,0)))),this.shine.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,1))),this.label.runAction(cc.sequence(cc.delayTime(.6),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))),cc.callFunc(function(){this.abled=!0}.bind(this))))},update:function(){for(var t=0;t<this.elementLines.length;t++){var e=this.elementLines[t];e.y+=2,e.y>1600&&(e.y=this.bottom.y-218,e.x=this.bottom.x-32,e.x<-300&&(e.x+=493.5,e.y+=493.5),this.bottom=e)}},knock:function(){if(this.abled)if(this.abled=!1,this.scroll.runAction(cc.sequence(cc.moveTo(.1,cc.v2(0,-8)),cc.moveTo(.1,cc.v2(4,6)),cc.moveTo(.1,cc.v2(-5,-5)),cc.moveTo(.1,cc.v2(0,0)))),cc.audioEngine.playEffect(window.sound.seal),this.sealList[this.status].active=!1,this.status++,this.status<=2)this.smoke.playAnimation("play0",1),this.sealList[this.status].active=!0,this.seal.runAction(cc.sequence(cc.scaleTo(.15,1.1),cc.scaleTo(.15,1),cc.callFunc(function(){this.abled=!0}.bind(this))));else{for(var t=[cc.v2(100,-205),cc.v2(-220,90),cc.v2(170,200),cc.v2(-100,215)],e=0;e<4;e++){var i=this.sealList[e+3];i.active=!0,i.runAction(cc.spawn(cc.moveTo(.2,t[e]),cc.scaleTo(.2,.2),cc.fadeOut(.2)))}cc.audioEngine.playEffect(window.sound.selectSound),this.smoke.playAnimation("play1",1),this.seal.runAction(cc.sequence(cc.scaleTo(.1,1.1),cc.scaleTo(.1,1),cc.callFunc(function(){this.label.runAction(cc.fadeOut(.2)),this.openScroll()}.bind(this))))}},openScroll:function(){this.content.zIndex=10;var t=[];c.score=0;for(var e=[1,1,1,1,400,20,10,2,1],i=0;i<10;i++)if(9==i||c.data.highRecord[i]>=e[i]){var o=cc.instantiate(this.scorePrefab);o.getComponent("Score").init(i),this.content.addChild(o),t.push(o)}this.content.height=189+60*t.length;for(var n=0;n<t.length;n++)t[n].y=this.content.height/2-94-60*n,n==t.length-1&&(t[n].y-=40);cc.audioEngine.playEffect(window.sound.bagOpenSound),this.topScroll.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,-15)),cc.spawn(cc.scaleTo(.3,1,72/101),cc.moveTo(.3,cc.v2(0,this.content.height/2+12))))),this.bottomScroll.runAction(cc.sequence(cc.moveBy(.1,cc.v2(0,15)),cc.spawn(cc.scaleTo(.3,1,81/113),cc.moveTo(.3,cc.v2(0,-this.content.height/2-10))))),this.schedule(function(){this.view.height=this.topScroll.y-this.bottomScroll.y-22}.bind(this),0),this.title.runAction(cc.scaleTo(.2,0)),this.scheduleOnce(function(){var t=this.index<0?this.loseBtns:this.btnNext;t.active=!0,t.opacity=1,t.y=-this.content.height/2-215,t.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))}.bind(this),.7),this.index>0&&cc.audioEngine.playMusic(window.sound.bgmComplete,!0)},restart:function(){cc.audioEngine.playEffect(window.sound.back),window.loadingBrown.doStart(function(){window.summaryLayer=null,window.homeLayer=null,window.mainLayer=null,c.setDataToBase(),cc.director.loadScene("prepare")}.bind(this))},quit:function(){cc.audioEngine.playEffect(window.sound.back),window.loadingBrown.doStart(function(){window.summaryLayer=null,window.homeLayer=null,window.mainLayer=null,c.setDataToBase(),cc.director.loadScene("cover")}.bind(this))},doNext:function(){if(this.btnNext.active=!1,this.level<=0)cc.audioEngine.playEffect(window.sound.bagCloseSound),this.topScroll.runAction(cc.spawn(cc.scaleTo(.3,1),cc.moveTo(.3,cc.v2(0,40)))),this.bottomScroll.runAction(cc.spawn(cc.scaleTo(.3,1,1),cc.moveTo(.3,cc.v2(0,-38)))),this.scroll.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,0)),cc.callFunc(function(){this.checkUnlock()}.bind(this))));else{for(var t=0;t<this.itemList.length;t++)this.itemList[t].runAction(cc.fadeOut(.2));this.heroCard&&this.heroCard.runAction(cc.fadeOut(.2)),this.titleUnlock.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){1==this.level?this.unlockMode():2==this.level?this.unlockHero():3==this.level&&this.openComplete()}.bind(this))))}},checkUnlock:function(){if(c.data.clearance[c.data.heroId-1]<c.data.difficulty){c.data.clearance[c.data.heroId-1]=c.data.difficulty;var t=[[[136,230],[59,95],[220,229],[111,120]],[[163,197],[70,112],[167,198],[117,121]],[[142,168],[76,162],[105,202],[104,144]],[[207,208],[157,174],[391,409],[16,37]]][c.data.heroId-1][c.data.difficulty-1];1==c.data.difficulty||3==c.data.difficulty?this.unlockItems(t,1):this.unlockItems(t,2)}else this.openComplete()},unlockItems:function(t,e){if(this.level=1,this.titleUnlock.active=!0,this.titleUnlock.opacity=0,this.titleUnlock.runAction(cc.fadeIn(.3)),this.itemList=[],1==e){this.txtTitle.string="\u89e3\u9501\u65b0\u5361\u724c";for(var i=0;i<2;i++){var c=cc.instantiate(this.cardPrefab);c.getComponent("CardCollection").init(t[i]),c.position=cc.v2(160*i-80,-50),this.unlockNode.addChild(c),c.getComponent("CardCollection").runOut(cc.v2(280*i-140,-30),0),this.itemList.push(c),c.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever())}}else{this.txtTitle.string="\u89e3\u9501\u65b0\u88c5\u5907";for(var o=0;o<2;o++){var n=cc.instantiate(this.itemPrefab);n.getComponent("ItemCommodity").init(t[o]),n.position=cc.v2(160*o-80,-50),this.unlockNode.addChild(n),n.getComponent("ItemCommodity").runOut(cc.v2(280*o-140,-20),0),this.itemList.push(n),n.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever())}}cc.audioEngine.playEffect(window.sound.end),this.scheduleOnce(function(){this.btnNext.active=!0,this.btnNext.opacity=1,this.btnNext.y=-525,this.btnNext.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))}.bind(this),.5)},unlockMode:function(){if(this.level=2,4!=c.data.difficulty){this.titleUnlock.active=!0,this.titleUnlock.y=346,this.titleUnlock.opacity=0,this.titleUnlock.runAction(cc.fadeIn(.3)),this.txtTitle.string="\u89e3\u9501\u65b0\u6a21\u5f0f";var t=cc.instantiate(this.heroCardPrefab);t.getComponent("HeroCard").init(c.data.heroId,c.data.difficulty+1),t.y=-30,this.unlockNode.addChild(t),this.heroCard=t,t.getComponent("HeroCard").runOut(),t.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever()),cc.audioEngine.playEffect(window.sound.end),this.scheduleOnce(function(){this.btnNext.active=!0,this.btnNext.opacity=1,this.btnNext.y=-525,this.btnNext.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))}.bind(this),.5)}else this.openComplete()},unlockHero:function(){if(this.level=3,1==c.data.heroId&&1==c.data.difficulty||2==c.data.heroId&&2==c.data.difficulty||3==c.data.heroId&&2==c.data.difficulty){this.titleUnlock.active=!0,this.titleUnlock.y=346,this.titleUnlock.opacity=0,this.titleUnlock.runAction(cc.fadeIn(.3)),this.txtTitle.string="\u89e3\u9501\u65b0\u804c\u4e1a";var t=cc.instantiate(this.heroCardPrefab);t.getComponent("HeroCard").init(c.data.heroId+1,0),t.y=-30,this.unlockNode.addChild(t),this.heroCard=t,t.getComponent("HeroCard").runOut(),t.runAction(cc.sequence(cc.moveBy(.8,cc.v2(0,5)),cc.moveBy(.8,cc.v2(0,-5))).repeatForever()),cc.audioEngine.playEffect(window.sound.end),this.scheduleOnce(function(){this.btnNext.active=!0,this.btnNext.opacity=1,this.btnNext.y=-525,this.btnNext.runAction(cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,50))))}.bind(this),.5)}else this.openComplete()},openComplete:function(){var t=cc.instantiate(this.completePrefab);this.node.addChild(t)}}),cc._RF.pop()},{Game:"Game"}],TavernLayer:[function(t,e,i){"use strict";cc._RF.push(e,"f73f9BbTilOdoWM2Ad26x3Z","TavernLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{cover:cc.Node,arms:[cc.Node],hands:[cc.Node],figure:cc.Node,pipe:cc.Node,mouth:cc.Node,fire:cc.Node,smoke:dragonBones.ArmatureDisplay,btnEnd:cc.Node,dialog:cc.Node,txtDialog:cc.Label,endPrefab:cc.Prefab,stripHp:cc.ProgressBar,txtHp:cc.Label,stripEnergy:cc.ProgressBar,txtEnergy:cc.Label,txtCopper:cc.Label,btnSkills:[cc.Button],maskSkills:[cc.Node],iconSkills:[cc.Button],numSkills:[cc.Node],labelSkills:[cc.Node],guidePrefab:cc.Prefab},onLoad:function(){window.tavernLayer=this,this.gameOver=!0,this.txtHp.string=c.data.hp+"/"+c.data.hpMax,this.stripHp.progress=c.data.hp/c.data.hpMax,this.txtCopper.string=c.data.copper,this.scheduleOnce(function(){window.loadingRoll.close()}.bind(this),1),this.scheduleOnce(function(){this.doStart(),cc.audioEngine.playMusic(window.sound.bgmTavetn,!0)}.bind(this),1.3)},doStart:function(){for(var t=0;t<2;t++)this.arms[t].y+=70,this.hands[t].y+=70,this.arms[t].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.4,cc.v2(0,-70)))),this.hands[t].runAction(cc.sequence(cc.delayTime(.3),cc.moveBy(.4,cc.v2(0,-70))));this.cover.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.wood)}.bind(this)),cc.moveBy(.3,cc.v2(0,-480)))),this.btnEnd.runAction(cc.sequence(cc.delayTime(1),cc.moveBy(.15,cc.v2(0,45)),cc.callFunc(function(){this.gameOver=!1,c.guiding&&window.tavernLayer.showGuide(3)}.bind(this)))),this.figure.runAction(cc.sequence(cc.scaleTo(.4,.997,1.003),cc.scaleTo(.8,1.003,.997),cc.scaleTo(.3,1,1)).repeatForever()),this.mouth.runAction(cc.sequence(cc.delayTime(3),cc.moveBy(.15,cc.v2(0,10)),cc.moveBy(.15,cc.v2(0,-10)),cc.delayTime(.5)).repeatForever()),this.pipe.runAction(cc.sequence(cc.delayTime(3),cc.rotateBy(.2,-5),cc.rotateBy(.4,10),cc.rotateBy(.2,-5)).repeatForever()),this.fire.runAction(cc.sequence(cc.delayTime(3.2),cc.fadeIn(.3),cc.fadeOut(.3),cc.delayTime(3.8)).repeatForever()),this.smoke.node.runAction(cc.sequence(cc.delayTime(7),cc.callFunc(function(){this.smoke.playAnimation("play0",1)}.bind(this)),cc.delayTime(.6)).repeatForever())},doSkill:function(t,e){if(!this.gameOver){0==e?(window.player.addRollCount(),cc.audioEngine.playEffect(window.sound.blackSound)):1==e&&(window.player.changeAllCards(),cc.audioEngine.playEffect(window.sound.spin)),this.stripEnergy.progress=0,this.txtEnergy.string="0/10";for(var i=0;i<2;i++)this.btnSkills[i].interactable=!1,this.maskSkills[i].active=!0,this.iconSkills[i].enableAutoGrayEffect=!0,this.numSkills[i].active=!1,this.labelSkills[i].color=cc.Color.WHITE.fromHEX("#3f2331")}},showEnd:function(t){var e=cc.instantiate(this.endPrefab);e.getComponent("EndTavernLayer").init(t),this.node.addChild(e)},checkRewards:function(){if(!this.gameOver){this.gameOver=!0,cc.audioEngine.playEffect(window.sound.btnStart),cc.audioEngine.playEffect(window.sound.wood),this.cover.runAction(cc.moveBy(.3,cc.v2(0,480))),this.btnEnd.runAction(cc.moveBy(.15,cc.v2(0,-45))),this.dialog.active=!0,this.dialog.scale=0,this.dialog.runAction(cc.scaleTo(.2,1)),this.txtDialog.node.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(.2)));var t=window.player.checkRewards();this.scheduleOnce(function(){this.showEnd(t)}.bind(this),1);this.txtDialog.string=["\u4e0b\u6b21\u518d\u6765","\u4e0d\u7b97\u592a\u5dee","\u8868\u73b0\u4e0d\u9519\uff01","\u592a\u5389\u5bb3\u4e86\uff01","\u5e74\u5ea6\u6700\u4f73\uff01","\u4e0d\u53ef\u601d\u8bae\uff01\uff01","\u5e78\u8fd0\u4e4b\u795e\uff01\uff01"][t.length],c.data.highRecord[7]=Math.max(c.data.highRecord[7],t.length)}},showGuide:function(t){this.scheduleOnce(function(){if(!window.guide){var e=cc.instantiate(this.guidePrefab);e.getComponent("Guide").init(t),this.node.addChild(e)}}.bind(this),.1)}}),cc._RF.pop()},{Game:"Game"}],TreasureChest:[function(t,e,i){"use strict";cc._RF.push(e,"6533fKzUy5Bxpam9JTZSSr8","TreasureChest");var c=t("Game");cc.Class({extends:cc.Component,properties:{top:cc.Sprite,bottom:cc.Sprite,light:cc.Sprite,box:cc.Node,shadow:cc.Node,animation:dragonBones.ArmatureDisplay,settleCardPrefab:cc.Prefab,settleBoardPrefab:cc.Prefab,rewardNode:cc.Node,cardPrefab:cc.Prefab,itemPrefab:cc.Prefab,summaryPrefab:cc.Prefab},init:function(t){window.treasureChest=this,this.status=0,this.id=t,this.itemList=[],cc.loader.loadRes("Texture/battle/image_chest"+t+"1",cc.SpriteFrame,function(t,e){this.top.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/battle/image_chest"+t+"2",cc.SpriteFrame,function(t,e){this.bottom.spriteFrame=e}.bind(this)),cc.loader.loadRes("Texture/battle/image_chestLight"+t,cc.SpriteFrame,function(t,e){this.light.spriteFrame=e}.bind(this)),1==t?this.shadow.y+=20:2==t&&(this.top.node.y=-95)},jumpIn:function(){this.node.scale=.4,this.node.runAction(cc.sequence(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.scaleTo(.2,.8,1.1)),cc.spawn(cc.moveBy(.2,cc.v2(0,-50)),cc.scaleTo(.2,1.02,.98)),cc.scaleTo(.05,1,1))),cc.audioEngine.playEffect(window.sound.chest)},open:function(){var t=this,e=0;if(1==this.status){for(var i=function(e){var i=t.settleList[e].node;i.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){i.destroy()}.bind(t))))},c=0;c<this.settleList.length;c++)i(c);this.top.node.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.moveTo(.1,cc.v2(0,2==this.id?-95:-75)),cc.scaleTo(.1,1)))),e=.3}this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(){cc.audioEngine.playEffect(window.sound.treasureSound)}.bind(this)),cc.scaleTo(.1,.8),cc.scaleTo(.1,1),cc.callFunc(function(){this.top.node.stopAllActions(),this.top.node.runAction(cc.spawn(cc.moveTo(.1,cc.v2(0,2==this.id?-45:-25)),cc.scaleTo(.1,1,.8))),this.light.node.active=!0,this.animation.playAnimation("play0",1),this.status=1}.bind(this))))},openReward:function(t){this.open(),this.scheduleOnce(function(){this.doReward(t),this.scheduleOnce(function(){for(var t=0;t<this.settleList.length;t++)this.settleList[t].showStrip()}.bind(this),.2*t.length)}.bind(this),.2)},doReward:function(t){var e=t.length;this.settleList=[];for(var i=0;i<e;i++){var c=cc.instantiate(this.settleCardPrefab);c.getComponent("SettleCard").init(t[i].type,t[i].value),c.position=cc.v2(e>2?120*i-120:120*i-60,50),this.rewardNode.addChild(c),c.getComponent("SettleCard").runOut(cc.v2(e>2?220*i-220:300*i-150,300),i),this.settleList.push(c.getComponent("SettleCard"))}},openCard:function(t,e){var i=0==this.status?.2:.5;this.open(),this.scheduleOnce(function(){for(var i=t.length,c=0;c<i;c++)if(t[c]>0){var o=cc.instantiate(this.cardPrefab);o.getComponent("CardCollection").init(t[c],e?3:null),o.position=cc.v2(i>1?200*c-100:0,50),this.rewardNode.addChild(o),o.getComponent("CardCollection").runOut(cc.v2(i>1?320*c-160:0,320),c),this.itemList.push(o),e||(this.selectCard=t[c])}this.scheduleOnce(function(){for(var t=0;t<this.itemList.length;t++)this.itemList[t].getComponent("CardCollection")&&(e?this.itemList[t].getComponent("CardCollection").enableChoosen():this.itemList[t].getComponent("CardCollection").showTip());window.endLayer&&window.endLayer.showGiveUp()}.bind(this),.2*i+.2)}.bind(this),i)},chooseCard:function(t){this.getCard(t);for(var e=0,i=0;i<this.itemList.length;i++)if(this.itemList[i].getComponent("CardCollection")&&t==this.itemList[i].getComponent("CardCollection").cfgId){e=i;break}var o=this.itemList[e],n=this.itemList[1-e];n.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){n.destroy()}.bind(this)))),o.runAction(cc.moveTo(.2,cc.v2(0,320))),c.guiding&&0==c.data.guide[2]&&(c.guideChoose=parseInt(e));for(var a=0;a<this.itemList.length;a++)this.itemList[a].getComponent("CardCollection")&&this.itemList[a].getComponent("CardCollection").hideTip();window.endLayer.btnOut.active=!0,window.endLayer.btnOut.opacity=1,window.endLayer.btnOut.y-=50,window.endLayer.btnOut.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),window.endLayer.hideGiveUp(),cc.audioEngine.playEffect(window.sound.selectSound)},getCard:function(t){1==c.data.heroId&&3==c.data.difficulty?c.data.deck.length<6?c.getCard(t):window.endLayer.openCardChange(t):c.getCard(t)},openEquip:function(t,e){var i=0==this.status?.2:.5;this.open(),this.scheduleOnce(function(){for(var i=t.length,c=0;c<i;c++)if(t[c]>0){var o=cc.instantiate(this.itemPrefab);o.getComponent("ItemCommodity").init(t[c],e),o.position=cc.v2(i>1?200*c-100:0,70),this.rewardNode.addChild(o),o.getComponent("ItemCommodity").runOut(cc.v2(i>1?320*c-160:0,320),c),this.itemList.push(o),e||(this.selectEquip=t[c])}this.scheduleOnce(function(){for(var t=0;t<this.itemList.length;t++)e&&this.itemList[t].getComponent("ItemCommodity")&&this.itemList[t].getComponent("ItemCommodity").enableChoosen();window.endLayer&&window.endLayer.showGiveUp()}.bind(this),.2*i+.2)}.bind(this),i)},chooseEquip:function(t){c.getItem(t);for(var e=0,i=0;i<this.itemList.length;i++)if(t==this.itemList[i].getComponent("ItemCommodity").cfgId){e=i;break}var o=this.itemList[e],n=this.itemList[1-e];n.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){n.destroy()}.bind(this)))),o.runAction(cc.moveTo(.2,cc.v2(0,320)));for(var a=0;a<this.itemList.length;a++)this.itemList[a].getComponent("ItemCommodity").hideTip();window.endLayer.btnOut.active=!0,window.endLayer.btnOut.opacity=1,window.endLayer.btnOut.y-=50,window.endLayer.btnOut.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),window.endLayer.hideGiveUp(),cc.audioEngine.playEffect(window.sound.selectSound)},openBoard:function(t,e){var i=0==this.status?.2:.5;this.open(),this.scheduleOnce(function(){for(var i=t.length,c=0;c<i;c++)if(t[c]){var o=cc.instantiate(this.settleBoardPrefab);o.getComponent("SettleBoard").init(t[c].type,t[c].value,e?1:0),o.position=cc.v2(i>1?200*c-100:0,50),this.rewardNode.addChild(o),o.getComponent("SettleBoard").runOut(cc.v2(i>1?320*c-160:0,300),c),this.itemList.push(o)}}.bind(this),i)},chooseBoard:function(){this.itemList[1].runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){this.itemList[1].destroy()}.bind(this)))),this.itemList[0].runAction(cc.moveTo(.2,cc.v2(0,300))),this.itemList[0].getComponent("SettleBoard").txtChosen.runAction(cc.fadeOut(.2)),window.endLayer.btnOut.active=!0,window.endLayer.btnOut.opacity=1,window.endLayer.btnOut.y-=50,window.endLayer.btnOut.runAction(cc.spawn(cc.moveBy(.2,cc.v2(0,50)),cc.fadeIn(.2))),window.endLayer.hideGiveUp(),cc.audioEngine.playEffect(window.sound.selectSound)},openComplete:function(){this.open(),this.scheduleOnce(function(){var t=cc.instantiate(this.summaryPrefab);t.getComponent("Summary").init(1),window.endLayer.node.addChild(t)}.bind(this),.2)},getUnchosen:function(){this.selectCard&&this.getCard(this.selectCard),this.selectEquip&&c.getItem(this.selectEquip)}}),cc._RF.pop()},{Game:"Game"}],TreasureLayer:[function(t,e,i){"use strict";cc._RF.push(e,"c1d70SEhyZLb7VHewO3MZ0k","TreasureLayer");var c=t("Game");cc.Class({extends:cc.Component,properties:{treasurePrefab:cc.Prefab,btnClose:cc.Node,mask:cc.Node,treasureNode:cc.Node,title:cc.Node},init:function(){window.treasureLayer=this,this.toChoose=!0;for(var t=0,e=[[.6,.4,0],[.4,.4,.2],[.1,.6,.3]],i=Math.random(),o=0,n=0;n<3;n++)if(i<(o+=e[c.data.castle-1][n])){t=n+1;break}5==c.data.roomType?t++:c.data.itemEffect.vase>0&&(c.data.itemEffect.vase--,t++),t=Math.min(t,3),this.cfgIdList=[];var a=1;c.data.itemEffect.flagon>0&&(c.data.itemEffect.flagon--,a=2,this.toChoose=!1);var s=c.getNewItemId(0,t);if(this.cfgIdList.push(s),2==a){for(var r=0;r<=0;){var d=c.getNewItemId(0,t);d!=s&&(r=d)}this.cfgIdList.push(r)}c.guiding&&0==c.data.guide[2]&&(this.cfgIdList=[180],this.toChoose=!1,c.getItem(180)),this.initItem(),this.mask.runAction(cc.fadeTo(.3,210)),this.toChoose||(this.btnClose.active=!0,this.btnClose.opacity=1,this.btnClose.y-=150,this.btnClose.runAction(cc.sequence(cc.delayTime(.8),cc.spawn(cc.fadeIn(.2),cc.moveBy(.2,cc.v2(0,150))))))},initItem:function(){var t=cc.instantiate(this.treasurePrefab);t.getComponent("TreasureChest").init(2),this.treasureNode.addChild(t),this.chest=t.getComponent("TreasureChest"),this.chest.jumpIn(),this.treasureNode.runAction(cc.sequence(cc.delayTime(.2),cc.moveTo(.3,cc.v2(0,-250)),cc.callFunc(function(){this.toChoose?(this.chest.openBoard([{type:1,value:80},null],!0),this.chest.openEquip([0,this.cfgIdList[0]],!0)):this.chest.openEquip(this.cfgIdList)}.bind(this))))},close:function(t){if(c.data.floorBeats[c.data.floor-1]=!0,window.room.initAlter(),window.room.doReady(),window.treasureLayer=null,this.title.active=!1,this.chest.box.active=!1,this.toChoose)for(var e=0;e<this.chest.itemList.length;e++)e!=t&&(this.chest.itemList[e].active=!1);else for(var i=0;i<this.chest.itemList.length;i++)this.chest.itemList[i].getComponent("ItemCommodity").got();this.mask.runAction(cc.fadeOut(.2)),this.btnClose.active=!1,this.scheduleOnce(function(){this.node.destroy(),window.homeLayer.refreshHeroData()}.bind(this),.4)}}),cc._RF.pop()},{Game:"Game"}],Utils:[function(t,e,i){"use strict";cc._RF.push(e,"85bfaYPayFNlrAFvtzNUMAc","Utils");var c={numberFormat:function(t){return t/1e13>=1?Math.floor(t/1e12)+"T":t/1e10>=1?Math.floor(t/1e9)+"B":t/1e7>=1?Math.floor(t/1e6)+"M":t/1e4>=1?Math.floor(t/1e3)+"K":t},timeFormat:function(t,e){var i=Math.round(t/1e3),c=i%60,o=e>1?Math.floor(i/60)%60:Math.floor(i/60),n=3==e?Math.floor(i/3600)%24:Math.floor(i/3600),a=Math.floor(i/86400),s=function(t){return t<10?"0"+t:t};return 1==e?s(o)+":"+s(c):2==e?s(n)+":"+s(o)+":"+s(c):a+"\u5929"+n+"\u65f6"+o+"\u5206"},getDifferentRandomNum:function(t,e,i){e=e||1,i=i||0;for(var c=[];c.length<t;){for(var o=Math.floor(Math.random()*(e-i+1))+i,n=!1,a=0;a<c.length;a++)if(c[a]-o==0){n=!0;break}n||c.push(o)}return c},createImage:function(t,e){if(void 0!=window.wx)try{var i=wx.createImage();i.onload=function(){try{var t=new cc.Texture2D;t.initWithElement(i),t.handleLoadedTexture(),e.spriteFrame=new cc.SpriteFrame(t)}catch(t){cc.log(t),e.node.active=!1}},i.src=t}catch(t){cc.log(t),e.node.active=!1}else try{cc.loader.load({url:t,type:"jpg"},function(t,i){e.spriteFrame=new cc.SpriteFrame(i)})}catch(t){cc.log(t),e.node.active=!1}},substring:function(t,e){if(t.replace(/[\u4e00-\u9fa5]/g,"**").length<=e)return t;for(var i=0,c="",o=0;o<t.length&&(/[\u4e00-\u9fa5]/.test(t[o])?i+=2:i+=1,!(i>e));o++)c+=t[o];return c},getMd5Url:function(t){return cc.loader.md5Pipe?cc.loader.md5Pipe.transformURL(cc.url.raw(t)):cc.url.raw(t)},numToStr:function(t,e){e=e||1;for(var i=""+t,c=1;c<=e;c++)t<Math.pow(10,c)&&(i="0"+i);return i},getDirectionVector:function(t,e){return[cc.v2(0,1),cc.v2(1,0),cc.v2(0,-1),cc.v2(-1,0)][t].mul(e)}};e.exports=c,cc._RF.pop()},{}],Yahtzee:[function(t,e,i){"use strict";cc._RF.push(e,"1712d0/b9dFZ4ZZ+rHnJsH3","Yahtzee");var c=t("Game");cc.Class({extends:cc.Component,properties:{heroNode:cc.Node,enemyNode:cc.Node,endPrefab:cc.Prefab,txtRound:cc.Label,boxDesc:cc.Node,btnGuide:cc.Node,guide:cc.Node,mask:cc.Node,head:cc.Sprite,reelNode:cc.Node,reels:[cc.Node],content:cc.Node,hole:cc.Node,flag:cc.Sprite,txtFlag:cc.Label,crowns:[dragonBones.ArmatureDisplay],dialog:cc.Node,txtDialog:cc.Label},onLoad:function(){window.yahtzeeLayer=this,this.descOpen=!0,this.began=!1,cc.loader.loadRes("Texture/hero/head/"+c.data.heroId,cc.SpriteFrame,function(t,e){this.head.spriteFrame=e}.bind(this)),this.heroNode.rotation-=90,this.heroNode.y-=350,this.enemyNode.rotation+=90,this.enemyNode.y+=350,this.scheduleOnce(function(){window.loadingRoll.close()}.bind(this),1),this.scheduleOnce(function(){this.doStart(),cc.audioEngine.playMusic(window.sound.bgmYahtzee,!0)}.bind(this),1.3)},doStart:function(){this.hero=this.heroNode.getComponent("PlayerYahtzee"),this.enemy=this.enemyNode.getComponent("PlayerYahtzee"),this.hero.init(0),this.enemy.init(1),this.btnGuide.active=!0,c.guiding?this.openGuide():this.beginGame()},beginGame:function(){this.roundId=1,this.hostId=0,this.began=!0,this.heroNode.runAction(cc.spawn(cc.moveBy(.3,cc.v2(0,350)),cc.rotateBy(.3,90))),this.enemyNode.runAction(cc.spawn(cc.moveBy(.3,cc.v2(0,-350)),cc.rotateBy(.3,-90))),this.doRound(),this.scheduleOnce(function(){this.openDesc()}.bind(this),1.2)},doRound:function(){this.hostId=1-this.hostId,window.player=0==this.hostId?this.hero:this.enemy,0==this.hostId?window.player.startRound():this.scheduleOnce(function(){this.reelNode.active=!0,this.reelNode.scale=.5,this.reelNode.y=-30,this.reels[1].runAction(cc.sequence(cc.scaleTo(.4,212/70,1),cc.delayTime(.5),cc.scaleTo(.4,1))),this.reels[0].runAction(cc.sequence(cc.moveBy(.4,cc.v2(-71,0)),cc.delayTime(.5),cc.moveBy(.4,cc.v2(71,0)))),this.reels[2].runAction(cc.sequence(cc.moveBy(.4,cc.v2(71,0)),cc.delayTime(.5),cc.moveBy(.4,cc.v2(-71,0)))),this.content.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(.2),cc.delayTime(.5),cc.fadeOut(.2))),this.reelNode.runAction(cc.sequence(cc.scaleTo(.2,1),cc.delayTime(.8),cc.spawn(cc.scaleTo(.2,0),cc.moveBy(.2,cc.v2(0,-80))),cc.callFunc(function(){window.player.startRound()}.bind(this))))}.bind(this),.3)},endRound:function(){for(var t=0;t<5;t++){this.hero.diceList[t].runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,300)),cc.delayTime(1.8),cc.fadeOut(.2)))}for(var e=0;e<5;e++){this.enemy.diceList[e].runAction(cc.sequence(cc.moveBy(.3,cc.v2(0,-300)),cc.delayTime(1.8),cc.fadeOut(.2)))}this.result=0,this.hero.calculateScore(),this.enemy.calculateScore(),this.hero.score>this.enemy.score?this.result=1:this.hero.score<this.enemy.score&&(this.result=-1);this.txtFlag.string=["\u5931\u8d25","\u5e73\u624b","\u83b7\u80dc"][this.result+1],cc.loader.loadRes("Texture/UI/yahtzee/flag"+(this.result<0?2:1),cc.SpriteFrame,function(t,e){this.flag.spriteFrame=e}.bind(this)),this.scheduleOnce(function(){this.hole.active=!0,this.hole.opacity=255,this.hole.runAction(cc.sequence(cc.scaleTo(0,.5,1),cc.scaleTo(.2,1),cc.delayTime(1.4),cc.fadeOut(.2))),this.flag.node.y+=400,this.flag.node.scaleX=.5,this.flag.node.runAction(cc.sequence(cc.spawn(cc.moveBy(.15,cc.v2(0,-400)),cc.scaleTo(.15,1.2,.8)),cc.scaleTo(.1,1,1)))}.bind(this),.5),this.scheduleOnce(function(){this.result>0?this.hero.doWin():this.result<0?this.enemy.doWin():(this.hero.doWin(),this.enemy.doWin())}.bind(this),.9),this.scheduleOnce(function(){this.checkEnd()}.bind(this),2.5)},checkEnd:function(){this.hero.win>=2&&this.enemy.win>=2?this.showEnd(0):this.hero.win>=2&&this.enemy.win<2?this.showEnd(1):this.hero.win<2&&this.enemy.win>=2?this.showEnd(-1):(this.roundId++,this.txtRound.string="\u7b2c"+this.roundId+"\u5c40",this.doRound())},showEnd:function(t){this.dialog.active=!0,this.txtDialog.string=t>=0?"\u8fd9\u6b21\u7b97\u4f60\u8d70\u8fd0\uff0c\u6211\u4eec\u4e0b\u6b21\u518d\u4f1a\uff01":"\u624b\u4e0b\u8d25\u5c06\uff0c\u6211\u968f\u65f6\u7b49\u4f60\u7ea6\u6218\uff01",this.scheduleOnce(function(){this.dialog.active=!1;var e=cc.instantiate(this.endPrefab);e.getComponent("EndYahtzeeLayer").init(t),this.node.addChild(e)}.bind(this),2)},openDesc:function(){this.boxDesc.stopAllActions(),this.descOpen?(this.descOpen=!1,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-428,93)))):(this.descOpen=!0,this.boxDesc.runAction(cc.moveTo(.15,cc.v2(-279,93))))},openGuide:function(){this.mask.active=!0,this.mask.opacity=1,this.mask.runAction(cc.fadeTo(.2,210)),this.btnGuide.active=!1,this.guide.active=!0,this.guide.scale=.1,this.guide.rotation=-30,this.guide.position=this.btnGuide.position,this.guide.runAction(cc.spawn(cc.moveTo(.2,cc.v2(0,0)),cc.scaleTo(.2,1),cc.rotateTo(.2,0)))},closeGuide:function(){this.mask.runAction(cc.fadeOut(.2)),this.guide.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,this.btnGuide.position),cc.scaleTo(.2,.1),cc.rotateTo(.2,-30)),cc.callFunc(function(){this.guide.active=!1,this.mask.active=!1,this.btnGuide.active=!0,c.guiding&&!this.began&&this.beginGame()}.bind(this))))}}),cc._RF.pop()},{Game:"Game"}]},{},["AI","AIYahtzee","Buff","CampLayer","Card","CardBagLayer","CardBagMageLayer","CardChangeLayer","CardCollection","CardDeleteLayer","CardManager","CardTavern","Chess","Chest","ChooseDiceLayer","CompleteLayer","Config","Confirm","Cover","Dice","DiceChoose","DiceTavern","DiceYahtzee","DmgAnimation","Door","Edit","EditEndLayer","EndLayer","EndTavernLayer","EndYahtzeeLayer","Enemy","Equip","EquipLayer","EventLayer","Fort","Game","Guide","HelloWorld","Hero","HeroCard","Item","ItemCollection","ItemCommodity","LevelUpLayer","LoadingBrown","LoadingMask","LoadingRoll","LoseLayer","MainLayer","MapLayer","Opening","Player","PlayerTavern","PlayerYahtzee","PrepareLayer","RequireRound","Reward","Room","Score","SettingLayer","SettleBoard","SettleCard","ShopItem","ShopLayer","Skill","SkillManager","Sound","Summary","TavernLayer","TreasureChest","TreasureLayer","Utils","Yahtzee"]);